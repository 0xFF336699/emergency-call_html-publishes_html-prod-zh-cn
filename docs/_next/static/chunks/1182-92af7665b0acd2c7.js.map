{"version":3,"file":"static/chunks/1182-92af7665b0acd2c7.js","mappings":"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","sources":["webpack://_N_E/./src/components/report/ReportButton/index.tsx","webpack://_N_E/../../libs/app/model/src/remote/report/submit.ts","webpack://_N_E/./src/components/report/ReportSubmitModal/index.tsx","webpack://_N_E/../../libs/app/model/src/remote/emc/inviteContacts.ts","webpack://_N_E/../../libs/app/model/src/remote/emc/tmsEmcGetContactTypes.ts","webpack://_N_E/./src/components/dialogs/InviteContactDialog.tsx","webpack://_N_E/./src/components/emergency-audio-control/stopAllHandler.ts","webpack://_N_E/./src/components/emergency-audio-control/EmergencyStopButton.tsx","webpack://_N_E/./src/components/emergency-tts-settings/EmergencyTTSSettings.tsx","webpack://_N_E/./src/components/emergency-tts-settings/index.ts","webpack://_N_E/./src/components/error-display/ErrorDisplay.tsx","webpack://_N_E/./src/components/pages/home/components/FallRescueAnimation.tsx","webpack://_N_E/./src/components/pages/home/components/PermissionStatusPanel.tsx","webpack://_N_E/../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/lodash.js","webpack://_N_E/./src/components/pages/home/components/PreAlarmConfig.tsx","webpack://_N_E/./src/components/pages/home/components/EmergencyTTSSettings.tsx","webpack://_N_E/./src/components/pages/home/components/index.ts","webpack://_N_E/./src/components/pages/home/components/VoiceEmergencySettings.tsx","webpack://_N_E/./src/components/pages/home/FallDetectionSettings.tsx","webpack://_N_E/./src/components/pages/home/constants.ts","webpack://_N_E/./src/components/pages/home/FallDetectionWrapper.tsx","webpack://_N_E/./src/components/pages/home/EmergencyCallSettings.tsx","webpack://_N_E/./src/components/pages/home/FunctionWrapper.tsx","webpack://_N_E/./src/components/pages/home/ShakeDetectionSettings.tsx","webpack://_N_E/./src/components/pages/home/components/AddWidgetButton.tsx","webpack://_N_E/./src/components/pages/home/components/AddSecurityWidgetButton.tsx","webpack://_N_E/./src/components/pages/home/index.ts","webpack://_N_E/../../libs/app/model/src/remote/emergency-call/list_pending_received_invitations.ts","webpack://_N_E/./src/components/PendingInvitationsList/PendingInvitationsList.tsx","webpack://_N_E/./src/components/pre-alarm-config2/index.tsx","webpack://_N_E/./src/components/privacies/PrivacyDialogAuto.tsx","webpack://_N_E/./src/components/privacies/ListenShowPrivacyContent.tsx","webpack://_N_E/./src/components/permission-status/PermissionStatusPanel.tsx","webpack://_N_E/./src/components/permission-status/index.ts","webpack://_N_E/./src/components/sensor-monitor/SensorMonitor.tsx","webpack://_N_E/./src/components/shakeconfig/ShakeConfigUI.tsx","webpack://_N_E/./src/components/test/TestEmergencyCall.tsx","webpack://_N_E/./src/pages/home/index.tsx","webpack://_N_E/./src/components/navbar/NavBar.tsx","webpack://_N_E/../../libs/app/model/src/remote/emergency-call/list_all_invitations.ts","webpack://_N_E/../../libs/app/ui/src/components/tabbar/Tabbar.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { Button, ButtonProps } from '@mui/material';\nimport AddCommentIcon from '@mui/icons-material/AddComment';\nimport { trackingPrint } from '@app/model';\nimport { ReportSubmitModal } from '../ReportSubmitModal';\n\n// Allow passing standard Button props to customize the button\ninterface ReportButtonProps extends Omit<ButtonProps, 'onClick'> {\n    buttonText?: string;\n}\n\n/**\n * A self-contained button component that triggers the report submission modal.\n */\nexport const ReportButton: React.FC<ReportButtonProps> = ({ buttonText = '举报', ...rest }) => {\n    const [modalOpen, setModalOpen] = useState(false);\n\n    const handleSuccess = () => {\n        // A snackbar could be triggered here in a real app.\n        console.log('Report submitted successfully.');\n        \n        // 举报成功埋点\n        trackingPrint({params:{\n            type:\"用户操作\",\n            title:\"举报功能\",\n            subtitle:\"举报-提交成功\",\n            extra:{\n                timestamp: Date.now(),\n                buttonText: buttonText\n            }\n        }});\n    };\n\n    const handleClick = () => {\n        // 按钮点击埋点\n        trackingPrint({params:{\n            type:\"用户操作\",\n            title:\"举报功能\",\n            subtitle:\"举报-按钮点击\",\n            extra:{\n                timestamp: Date.now(),\n                buttonText: buttonText\n            }\n        }});\n        \n        setModalOpen(true);\n    };\n\n    return (\n        <>\n            <Button\n                variant=\"contained\"\n                startIcon={<AddCommentIcon />}\n                onClick={handleClick}\n                {...rest} // Pass down other props like color, size, etc.\n            >\n                {buttonText}\n            </Button>\n\n            <ReportSubmitModal\n                open={modalOpen}\n                onClose={() => {\n                    // 模态框关闭埋点\n                    trackingPrint({params:{\n                        type:\"模态框操作\",\n                        title:\"举报对话框\",\n                        subtitle:\"对话框-关闭\",\n                        extra:{\n                            timestamp: Date.now(),\n                            buttonText: buttonText\n                        }\n                    }});\n                    setModalOpen(false);\n                }}\n                onSuccess={handleSuccess}\n            />\n        </>\n    );\n};\n","\nimport { request } from \"@fanfanlo\";\nimport { tms } from \"../tms\";\n\n// --- 类型定义 ---\n\n/**\n * @description 提交举报的请求参数\n */\nexport interface ISubmitReportParams {\n    reported_mobile: string; // 改为手机号\n    report_type: string;\n    target_ref?: string;\n    reason: string;\n    content_snapshot?: any;\n}\n\n/**\n * @description 提交举报的响应结果\n */\nexport interface ISubmitReportResult {\n    is_ok: boolean;\n    msg: string;\n    report_id?: string;\n}\n\n/**\n * @description 提交一个新的举报\n * @param {ISubmitReportParams} params - 举报的详细信息\n * @returns {Promise<ISubmitReportResult>}\n */\nexport async function submitReport(params: ISubmitReportParams)  {\n    return await request<ISubmitReportResult>(\n        tms.TReport,\n        tms.MReportSubmit,\n        params\n    );\n}\n","import React, { useState } from 'react';\nimport {\n    Button,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogContentText,\n    DialogTitle,\n    TextField,\n    CircularProgress,\n    Box\n} from '@mui/material';\nimport { submitReport } from '@app/model';\n\ninterface ReportSubmitModalProps {\n    open: boolean;\n    onClose: () => void;\n    onSuccess?: () => void; // Optional: callback on successful submission\n}\n\nexport const ReportSubmitModal: React.FC<ReportSubmitModalProps> = ({ open, onClose, onSuccess }) => {\n    const [mobile, setMobile] = useState('');\n    const [reason, setReason] = useState('');\n    const [error, setError] = useState('');\n    const [loading, setLoading] = useState(false);\n\n    const handleClose = () => {\n        // Reset state on close\n        setMobile('');\n        setReason('');\n        setError('');\n        setLoading(false);\n        onClose();\n    };\n\n    const handleSubmit = async () => {\n        if (!mobile || !reason) {\n            setError('手机号和举报原因均不能为空。');\n            return;\n        }\n        setError('');\n        setLoading(true);\n\n        try {\n            const result = await submitReport({\n                reported_mobile: mobile,\n                reason: reason,\n                report_type: 'user_report_from_app', // or make this dynamic if needed\n            });\n\n            if (result.shellIsOk) {\n                // alert('举报成功，感谢您的反馈！'); // Or use a Snackbar for better UX\n                if (onSuccess) {\n                    onSuccess();\n                }\n                handleClose();\n            } else {\n                setError(result.err?.message || '提交失败，请稍后再试。');\n            }\n        } catch (e) {\n            setError('网络错误，请检查您的连接。');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <Dialog open={open} onClose={handleClose}>\n            <DialogTitle>提交举报</DialogTitle>\n            <DialogContent>\n                <DialogContentText>\n                    请输入您要举报的用户的手机号码和具体原因。我们会尽快处理您的举报。\n                </DialogContentText>\n                <TextField\n                    autoFocus\n                    margin=\"dense\"\n                    id=\"mobile\"\n                    label=\"被举报人手机号、账号或ID\"\n                    type=\"tel\"\n                    fullWidth\n                    variant=\"standard\"\n                    value={mobile}\n                    onChange={(e) => setMobile(e.target.value)}\n                    disabled={loading}\n                />\n                <TextField\n                    margin=\"dense\"\n                    id=\"reason\"\n                    label=\"举报原因\"\n                    type=\"text\"\n                    fullWidth\n                    multiline\n                    rows={4}\n                    variant=\"standard\"\n                    value={reason}\n                    onChange={(e) => setReason(e.target.value)}\n                    disabled={loading}\n                />\n                {error && (\n                    <Box sx={{ color: 'error.main', mt: 2 }}>\n                        {error}\n                    </Box>\n                )}\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={handleClose} disabled={loading}>取消</Button>\n                <Button onClick={handleSubmit} disabled={loading}>\n                    {loading ? <CircularProgress size={24} /> : '提交'}\n                </Button>\n            </DialogActions>\n        </Dialog>\n    );\n};\n\n","import { IRequestParams, IResultContent, request } from \"@fanfanlo\";\nimport { tms } from \"../tms\";\nimport { IRequestOptions } from \"../IRequestOptions\";\n\n/**\n * @description 单个联系人的信息，由前端提供\n */\nexport interface IEmcContactIdentity {\n    identity: string;\n    identityType: 'email' | 'mobile';\n}\n\n/**\n * @description 邀请联系人的请求参数\n */\nexport interface IEmcInviteContactsParams extends IRequestParams {\n    contacts: IEmcContactIdentity[];\n    remark?: string;\n    type: string;\n    message?: string;\n    matrix_access_token: string; // 新增：用于创建 Matrix 房间的授权 Token\n}\n\n/**\n * @description 单个邀请的处理结果，由后端返回\n */\nexport interface IEmcInviteResultItem {\n    identity: string;\n    result_code: string; // 使用 ResultCode 的字符串形式\n    msg: string;\n}\n\n/**\n * @description 邀请联系人的完整响应体\n */\n// export interface IEmcInviteContactsResult extends IResultContent {\n//     data: {\n//         data: {\n//             results: IEmcInviteResultItem[];\n//             msg?: string;\n//         };\n//         msg?: string;\n//     };\n//     results?: IEmcInviteResultItem[]; // 保持向后兼容\n// }\n\nexport interface IEmcInviteContactsResult extends IResultContent {\n    data: {\n        is_ok:boolean;\n        results: IEmcInviteResultItem[];\n        msg?: string;\n    };\n}\n\n/**\n * @description 调用邀请联系人接口的函数\n * @param opts 包含 params, gateway, handler 的请求选项\n */\nexport async function tmsEmcInviteContacts(opts: IRequestOptions<IEmcInviteContactsParams>) {\n    const res = await request<IEmcInviteContactsResult>(tms.TEmc, tms.MEmcInviteContacts, opts.params, opts.gateway, opts.handler);\n    return res;\n}","import { IRequestParams, IResultContent, request } from \"@fanfanlo\";\nimport { tms } from \"../tms\";\nimport { IRequestOptions } from \"../IRequestOptions\";\n\n/**\n * @description 获取联系人类型的请求参数\n */\nexport interface IEmcGetContactTypesParams extends IRequestParams {\n    // 可能不需要额外参数，但保留结构以备将来扩展\n}\n\n/**\n * @description 单个联系人类型\n */\nexport interface IEmcContactTypeItem {\n    id: string;\n    name: string;\n    // 根据实际需要可以添加更多字段，例如 icon, description 等\n}\n\n/**\n * @description 获取联系人类型的完整响应体\n */\nexport interface IEmcGetContactTypesResult extends IResultContent {\n    data: {\n        types: Array<{\n            uuid: string;\n            name: string;\n            is_system: boolean;\n        }>;\n    };\n}\n\n/**\n * @description 调用获取联系人类型接口的函数\n * @param opts 包含 params, gateway, handler 的请求选项\n */\nexport async function tmsEmcGetContactTypes(opts: IRequestOptions<IEmcGetContactTypesParams>) {\n    const res = await request<IEmcGetContactTypesResult>(tms.TEmc, tms.MEmcGetContactTypes, opts.params, opts.gateway, opts.handler);\n    return res;\n}\n","import {\n    Button,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogTitle,\n    TextField,\n    Box,\n    CircularProgress,\n    Autocomplete,\n} from '@mui/material';\nimport { useState, useCallback, useEffect, useRef, SyntheticEvent } from 'react';\nimport { \n    IEmcInviteContactsParams, \n    tmsEmcInviteContacts, \n    IEmcContactIdentity, \n    user, \n    tmsEmcGetContactTypes,\n    IEmcGetContactTypesResult,\n    IEmcContactTypeItem,\n    IEmcInviteResultItem,\n    trackingPrint,\n} from '@app/model';\nimport toast from 'react-hot-toast';\nimport { matrixUser } from '@im/matrix';\nimport { authService } from '@src/services/authService';\nimport { Log, useProxyWatch,\n    IRequestResult } from '@fanfanlo';\nconst fileLogger = new Log(false, 'InviteContactDialog.tsx');\n\nconst isValidIdentity = (text: string) => /(^\\d{11}$)|(^[a-zA-Z0-9]{32}$)/.test(text);\nconst is11DigitNumber = (text: string) => /^\\d{11}$/.test(text);\n\ninterface InviteContactDialogProps {\n    open: boolean;\n    onClose: () => void;\n    onInviteSent?: () => void;\n}\n\nexport function InviteContactDialog({ open, onClose, onInviteSent }: InviteContactDialogProps) {\n    const uiLogger = fileLogger.sub(false, 'InviteContactDialog_ui');\n\n    const [contacts, setContacts] = useState('');\n    const [remark, setRemark] = useState('');\n    const [callType, setCallType] = useState<string | null>(null);\n    const [availableCallTypes, setAvailableCallTypes] = useState<readonly IEmcContactTypeItem[]>([]);\n    \n    // Debug effect to log availableCallTypes changes\n    useEffect(() => {\n        console.log('availableCallTypes updated:', availableCallTypes);\n    }, [availableCallTypes]);\n    \n    // Debug effect to log callType changes\n    useEffect(() => {\n        console.log('callType updated:', callType);\n    }, [callType]);\n    const [message, setMessage] = useState('');\n    const [isLoading, setIsLoading] = useState(false);\n    const [isTypesLoading, setIsTypesLoading] = useState(false);\n\n    const [pendingParams, setPendingParams] = useState<Omit<IEmcInviteContactsParams, 'matrix_access_token'> | null>(null);\n    const executionLock = useRef(false);\n    const [accessToken] = useProxyWatch(matrixUser.userData.userInfo, 'loginResponse.access_token', matrixUser.userData.userInfo.loginResponse?.access_token);\n    const [isUserLoggedIn] = useProxyWatch(user.data.sessionData, 'global_user_info', !!user.data.sessionData.global_user_info);\n    const [userToken] = useProxyWatch(user, 'data.storeData.user_token', user.data.storeData.user_token);\n    useEffect(() => {\n        if (accessToken && pendingParams && !executionLock.current) {\n            executionLock.current = true;\n            const finalParams: IEmcInviteContactsParams = {\n                ...pendingParams,\n                matrix_access_token: accessToken,\n                contacts: pendingParams?.contacts || [],\n                type: pendingParams?.type || ''\n            };\n            executeApiCall(finalParams);\n        }\n    }, [accessToken, pendingParams]);\n\n    const executeApiCall = useCallback(async (params: IEmcInviteContactsParams) => {\n        if (!params.contacts || !params.type) {\n            toast.error('请填写联系人和呼叫类型');\n            return;\n        }\n\n        setIsLoading(true);\n        \n        try {\n            const res = await tmsEmcInviteContacts({\n                params,\n                handler: { printLog: true }\n            });\n\n            console.log('Invite response:', res);\n\n            // 处理响应结果\n            if (res.err || !res.shellIsOk || !res.dataIsOk) {\n                const errorMessage = res.err?.message || '邀请失败，请稍后重试';\n                toast.error(errorMessage);\n                return;\n            }\n\n            // 处理嵌套的响应结构\n            const responseData = res.data;\n            if (!responseData?.data?.results) {\n                const errorMessage = responseData?.data?.msg || res.data?.msg || '未返回有效的结果';\n                toast.error(errorMessage);\n                return;\n            }\n            \n            const results: IEmcInviteResultItem[] = responseData.data.results;\n\n            // 统计成功和失败的数量\n            const successResults = results.filter(r => r.result_code === 'SUCCESS');\n            const infoResults = results.filter(r => r.result_code === 'INVITE_ALREADY_SENT' || r.result_code === 'ALREADY_A_CONTACT');\n            const errorResults = results.filter(r => r.result_code !== 'SUCCESS' && r.result_code !== 'INVITE_ALREADY_SENT' && r.result_code !== 'ALREADY_A_CONTACT');\n\n            if (successResults.length > 0) {\n                toast.success(`成功邀请 ${successResults.length} 个联系人`);\n                onInviteSent?.();\n            }\n            \n            if (infoResults.length > 0) {\n                const infoMessages = infoResults.map(r => r.msg).filter(Boolean).join('\\n');\n                if (infoMessages) {\n                    // 使用默认的 toast 替代 toast.info\n                    toast(infoMessages);\n                }\n            }\n            \n            if (errorResults.length > 0) {\n                const errorMessages = errorResults.map(r => r.msg).filter(Boolean).join('\\n');\n                if (errorMessages) {\n                    toast.error(`部分邀请失败：\\n${errorMessages}`);\n                }\n            }\n        } catch (error) {\n            console.error('Error in executeApiCall:', error);\n            toast.error('处理请求时发生错误，请稍后重试');\n        } finally {\n            setIsLoading(false);\n        }\n    }, [onInviteSent]);\n\n    const fetchCallTypes = useCallback(async () => {\n        const logger = uiLogger.sub(false, 'fetchCallTypes_fn');\n        logger.log('Fetching call types...');\n        setIsTypesLoading(true);\n        const res: IRequestResult<IEmcGetContactTypesResult, any> = await tmsEmcGetContactTypes({ params: {}, handler: { printLog: true } });\n        logger.log('Call types response:', JSON.stringify(res));\n        setIsTypesLoading(false);\n\n        if (res.err || !res.shellIsOk || !res.dataIsOk) {\n            const errorMessage = res.err?.message || '加载呼叫类型失败。';\n            toast.error(errorMessage);\n            setAvailableCallTypes([]);\n            logger.error('Failed to load call types:', errorMessage);\n        } else {\n            // 从 res.data.data.types 获取数据\n            const types = res.data?.data?.types || [];\n            logger.log('Setting availableCallTypes:', JSON.stringify(types));\n            \n            // 转换为 IEmcContactTypeItem[] 格式\n            const formattedTypes = types.map(type => ({\n                id: type.uuid,\n                name: type.name,\n                is_system: type.is_system\n            }));\n            \n            setAvailableCallTypes(formattedTypes);\n            \n            // 只在 callType 为空时设置默认值\n            if (formattedTypes.length > 0 && !callType) {\n                const defaultType = formattedTypes[0].name;\n                logger.log('Setting default call type:', defaultType);\n                setCallType(defaultType);\n            } else if (formattedTypes.length === 0) {\n                logger.warn('No call types available');\n            }\n        }\n    }, []); // 移除了 callType 依赖\n\n    useEffect(() => {\n        if (open) {\n            fetchCallTypes();\n        } else {\n            setContacts('');\n            setRemark('');\n            setCallType(null);\n            setAvailableCallTypes([]);\n            setMessage('');\n            setIsLoading(false);\n            setPendingParams(null);\n            executionLock.current = false;\n        }\n    }, [open, fetchCallTypes]);\n\n    const handleSendInvitation = useCallback(async () => {\n        const contactInputs = contacts.split('\\n').map(c => c.trim()).filter(c => c);\n        if (contactInputs.length === 0) {\n            toast.error('请输入至少一个联系人。');\n            return;\n        }\n\n        const contactIdentities: IEmcContactIdentity[] = [];\n        for (const input of contactInputs) {\n            if (isValidIdentity(input)) {\n                const type = is11DigitNumber(input) ? 'mobile' : 'email';\n                contactIdentities.push({ identity: input, identityType: type });\n            } else {\n                toast.error(`联系人格式无效: ${input}。必须是11位手机号或32位字符串。`);\n                return;\n            }\n        }\n\n        if (!callType || callType.trim() === '') {\n            toast.error('请选择或输入一个呼叫类型。');\n            return;\n        }\n\n        setIsLoading(true);\n\n        if (!userToken) {\n            const appLoggedIn = await authService.showLoginDialog();\n            if (!appLoggedIn) {\n                setIsLoading(false);\n                return; \n            }\n        }\n\n        const currentAccessToken = matrixUser.userData.userInfo.loginResponse?.access_token;\n        const params: Omit<IEmcInviteContactsParams, 'matrix_access_token'> = {\n            contacts: contactIdentities,\n            type: callType.trim(),\n            remark: remark.trim(),\n            message: message.trim(),\n        };\n\n        if (currentAccessToken) {\n            executionLock.current = true;\n            const apiParams: IEmcInviteContactsParams = {\n                ...params,\n                matrix_access_token: currentAccessToken,\n                contacts: params.contacts || [],\n                type: params.type || ''\n            };\n            executeApiCall(apiParams);\n        } else {\n            toast('等待登录...');\n            setPendingParams(params);\n        }\n\n    }, [contacts, remark, callType, message, executeApiCall, isUserLoggedIn]);\n\n    return (\n        <Dialog open={open} onClose={() => onClose()} maxWidth=\"sm\" fullWidth>\n            <DialogTitle>邀请紧急联系人</DialogTitle>\n            <DialogContent>\n                <Box component=\"form\" sx={{ mt: 2 }}>\n                    <TextField\n                        autoFocus\n                        margin=\"dense\"\n                        id=\"contacts\"\n                        label=\"联系人 (11位手机号)\"\n                        type=\"text\"\n                        fullWidth\n                        multiline\n                        rows={4}\n                        variant=\"outlined\"\n                        placeholder=\"13800138000\"\n                        value={contacts}\n                        onChange={(e) => setContacts(e.target.value)}\n                        disabled={isLoading}\n                    />\n                    <TextField\n                        margin=\"dense\"\n                        id=\"remark\"\n                        label=\"备注名 (可选)\"\n                        type=\"text\"\n                        fullWidth\n                        variant=\"outlined\"\n                        value={remark}\n                        onChange={(e) => setRemark(e.target.value)}\n                        disabled={isLoading}\n                    />\n                    <Autocomplete\n                        freeSolo\n                        id=\"call-type-autocomplete\"\n                        options={availableCallTypes.map((option) => option.name)}\n                        value={callType || ''}\n                        onChange={(event: SyntheticEvent, newValue: string | null) => {\n                            console.log('Call type changed to:', newValue);\n                            setCallType(newValue);\n                        }}\n                        inputValue={callType || ''}\n                        onInputChange={(event, newInputValue, reason) => {\n                            // Only update when the user is typing, not when an option is selected\n                            if (reason === 'input') {\n                                console.log('Input value changed to:', newInputValue);\n                                setCallType(newInputValue);\n                            }\n                        }}\n                        disablePortal\n                        disableClearable\n                        forcePopupIcon={!isTypesLoading}\n                        sx={{ mt: 1, mb: 1, width: '100%' }}\n                        renderInput={(params) => (\n                            <TextField\n                                {...params}\n                                label=\"呼叫类型\"\n                                variant=\"outlined\"\n                                fullWidth\n                                InputProps={{\n                                    ...params.InputProps,\n                                    endAdornment: (\n                                        <>\n                                            {isTypesLoading ? <CircularProgress color=\"inherit\" size={20} /> : null}\n                                            {params.InputProps.endAdornment}\n                                        </>\n                                    ),\n                                }}\n                            />\n                        )}\n                        ListboxProps={{\n                            style: {\n                                maxHeight: '200px',\n                                overflow: 'auto',\n                            },\n                        }}\n                    />\n                    <TextField\n                        margin=\"dense\"\n                        id=\"message\"\n                        label=\"邀请信息 (可选)\"\n                        type=\"text\"\n                        fullWidth\n                        multiline\n                        rows={3}\n                        variant=\"outlined\"\n                        placeholder=\"我已将您添加为我的紧急联系人，请接受邀请。\"\n                        value={message}\n                        onChange={(e) => setMessage(e.target.value)}\n                        disabled={isLoading}\n                    />\n                </Box>\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={() => onClose()} disabled={isLoading}>关闭</Button>\n                <Button onClick={handleSendInvitation} variant=\"contained\" disabled={isLoading}>\n                    {isLoading ? <CircularProgress size={24} /> : '发送邀请'}\n                </Button>\n            </DialogActions>\n        </Dialog>\n    );\n}","import { autoWebViewJs } from \"@droid/android\";\r\nimport { Log } from \"@fanfanlo\";\r\n\r\nconst fileLog = new Log(false, 'stopAllHandler_f');\r\n\r\nexport function stopAllHandler() {\r\n\r\n    try {\r\n      fileLog.log('开始停止所有紧急音频和震动...');\r\n\r\n      // 使用正确的停止方法（与EmergencyAudioControl.tsx保持一致）\r\n      const stopEmergencyMethods = [\r\n        // 停止监控\r\n        // `com.fanfanlo.emergencycall.manager.SensorManager.stopMonitoring();`,\r\n        `\r\n        try {\r\n          com.fanfanlo.emergencycall.manager.SoundManager.stop();\r\n          com.fanfanlo.emergencycall.manager.AlarmSoundManager.stop();\r\n          com.fanfanlo.emergencycall.v2.core.EmergencySystemV2.forceStopHelpSound();\r\n        } catch(e) {\r\n          // console.log('停止呼救者声音失败:', e);\r\n        }\r\n        `,\r\n        \r\n        // 停止联系人报警声音（主要方法）\r\n        `\r\n        try {\r\n          com.fanfanlo.emergencycall.manager.SoundManager.stopEmergencyAlarm();\r\n          \r\n          // 备用方案：如果WebViewActivity的Android接口可用，也调用它\r\n          if(typeof Android !== 'undefined' && typeof Android.stopAlarm === 'function') {\r\n            Android.stopAlarm();\r\n          }\r\n        } catch(e) {\r\n          console.log('停止联系人报警声音失败:', e);\r\n        }\r\n        `\r\n      ];\r\n\r\n      for (const script of stopEmergencyMethods) {\r\n        try {\r\n          fileLog.log(`调用停止脚本: ${script.trim()}`);\r\n          autoWebViewJs.callScript(script);\r\n        } catch (methodError) {\r\n          fileLog.warn(`停止方法调用失败:`, methodError);\r\n          // 继续尝试其他方法\r\n        }\r\n      }\r\n\r\n      fileLog.log('已停止所有紧急音频和震动');\r\n      return true;\r\n    //   setMessage({\r\n    //     type: 'success',\r\n    //     text: '已停止所有紧急音频和震动'\r\n    //   });\r\n    } catch (error) {\r\n      fileLog.error('停止紧急音频失败:', error);\r\n    //   setMessage({\r\n    //     type: 'error',\r\n    //     text: `停止失败: ${error instanceof Error ? error.message : '未知错误'}`\r\n    //   });\r\n    return false;\r\n    } finally {\r\n    //   setLoading(false);\r\n    }\r\n    \r\n}","import React, { useState } from 'react';\nimport {\n  Button,\n  Snackbar,\n  Alert,\n  Fab,\n  Tooltip\n} from '@mui/material';\nimport {\n  Stop as StopIcon,\n  VolumeOff as VolumeOffIcon\n} from '@mui/icons-material';\nimport { autoWebViewJs } from \"@droid/android\";\nimport { Log } from \"@fanfanlo\";\nimport { trackingPrint } from \"@app/model\";\nimport { stopAllHandler } from './stopAllHandler';\n\nconst fileLog = new Log(false, 'EmergencyStopButton');\n\ninterface EmergencyStopButtonProps {\n  variant?: 'button' | 'fab';\n  size?: 'small' | 'medium' | 'large';\n  fullWidth?: boolean;\n}\n\n/**\n * 紧急停止按钮组件\n * 快速停止所有紧急呼救相关的音频和震动\n */\nconst EmergencyStopButton: React.FC<EmergencyStopButtonProps> = ({ \n  variant = 'button',\n  size = 'medium',\n  fullWidth = false\n}) => {\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);\n\n  /**\n   * 检查是否在Android WebView环境中\n   */\n  const isAndroidWebView = (): boolean => {\n    try {\n      return !!(autoWebViewJs && typeof autoWebViewJs.callScript === 'function');\n    } catch (e) {\n      fileLog.error('检查WebView环境时出错:', e);\n      return false;\n    }\n  };\n\n  /**\n   * 停止所有紧急呼救音频和震动\n   */\n  const handleStopAllEmergencyAudio = async (): Promise<void> => {\n    setLoading(true);\n    setMessage(null);\n\n    // 添加按钮点击埋点\n    trackingPrint({params:{\n      type:\"用户操作\",\n      title:\"紧急停止\",\n      subtitle:\"停止按钮-点击\",\n      extra:{\n        buttonType: variant,\n        timestamp: Date.now(),\n        isAndroidWebView: isAndroidWebView()\n      }\n    }});\n\n    try {\n      const bl = stopAllHandler();\n      if (bl){\n        // 成功埋点\n        trackingPrint({params:{\n          type:\"系统事件\",\n          title:\"紧急停止\",\n          subtitle:\"停止成功\",\n          extra:{\n            result: \"success\",\n            timestamp: Date.now()\n          }\n        }});\n        \n        setMessage({\n          type: 'success',\n          text: '已停止所有紧急音频和震动'\n        });\n      }else{\n        // 失败埋点\n        trackingPrint({params:{\n          type:\"系统异常\",\n          title:\"紧急停止\",\n          subtitle:\"停止失败\",\n          extra:{\n            result: \"failed\",\n            timestamp: Date.now(),\n            reason: \"stopAllHandler返回false\"\n          }\n        }});\n        \n        setMessage({\n          type: 'error',\n          text: `停止失败`\n        });\n      }\n    } catch (error) {\n      // 异常埋点\n      trackingPrint({params:{\n        type:\"系统异常\",\n        title:\"紧急停止\",\n        subtitle:\"停止异常\",\n        extra:{\n          error: error instanceof Error ? error.message : String(error),\n          stack: error instanceof Error ? error.stack : undefined,\n          timestamp: Date.now()\n        }\n      }});\n      \n      setMessage({\n        type: 'error',\n        text: '停止时发生异常'\n      });\n    }\n    \n    setLoading(false);\n  };\n\n  /**\n   * 关闭消息提示\n   */\n  const handleCloseMessage = () => {\n    setMessage(null);\n  };\n\n  // 浮动操作按钮样式\n  if (variant === 'fab') {\n    return (\n      <>\n        <Tooltip title=\"停止所有紧急音频和震动\" placement=\"left\">\n          <Fab\n            color=\"error\"\n            onClick={handleStopAllEmergencyAudio}\n            disabled={loading}\n            size={size}\n            sx={{\n              position: 'fixed',\n              bottom: 80,\n              right: 16,\n              zIndex: 1000\n            }}\n          >\n            {loading ? <VolumeOffIcon /> : <StopIcon />}\n          </Fab>\n        </Tooltip>\n\n        <Snackbar\n          open={!!message}\n          autoHideDuration={4000}\n          onClose={handleCloseMessage}\n          anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n        >\n          <Alert \n            onClose={handleCloseMessage} \n            severity={message?.type || 'info'}\n            sx={{ width: '100%' }}\n          >\n            {message?.text}\n          </Alert>\n        </Snackbar>\n      </>\n    );\n  }\n\n  // 普通按钮样式\n  return (\n    <>\n      <Button\n        variant=\"contained\"\n        color=\"error\"\n        size={size}\n        fullWidth={fullWidth}\n        startIcon={loading ? <VolumeOffIcon /> : <StopIcon />}\n        onClick={handleStopAllEmergencyAudio}\n        disabled={loading}\n        sx={{ mb: 1 }}\n      >\n        🔕 静音\n      </Button>\n\n      <Snackbar\n        open={!!message}\n        autoHideDuration={4000}\n        onClose={handleCloseMessage}\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n      >\n        <Alert \n          onClose={handleCloseMessage} \n          severity={message?.type || 'info'}\n          sx={{ width: '100%' }}\n        >\n          {message?.text}\n        </Alert>\n      </Snackbar>\n    </>\n  );\n};\n\nexport default EmergencyStopButton;","import React, { useState, useEffect, useCallback } from 'react';\nimport {\n  Box,\n  Typography,\n  Switch,\n  TextField,\n  Paper,\n  Button,\n  FormControlLabel,\n  Slider,\n  Divider,\n  Alert,\n  Snackbar,\n  Collapse,\n  List,\n  ListItem,\n  ListItemText,\n  ListItemSecondaryAction,\n  IconButton,\n  Chip,\n  LinearProgress,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Tabs,\n  Tab,\n  CircularProgress,\n} from '@mui/material';\nimport { \n  PlayArrow, \n  Stop, \n  VolumeUp, \n  Settings, \n  ExpandLess, \n  Mic,\n  Save,\n  Share,\n  Delete,\n  Refresh,\n  Star,\n  StarBorder,\n  MusicNote,\n  CloudUpload,\n  AudioFile,\n  InsertDriveFile,\n} from '@mui/icons-material';\nimport { autoJsStoreUtils, autoWebViewJs } from '@droid/android';\nimport { user } from '@app/model';\nimport { authService } from '@src/services/authService';\nimport { ReportButton } from '../report/ReportButton';\n\n// 完整的TTS设置数据结构（整合录制功能后）\ninterface EmergencyTTSSettings {\n  enabled: boolean;\n  message: string;\n  repeatInterval: number;\n  voiceSpeed: number;\n  voicePitch: number;\n  useCustomAudio: boolean;        // 是否使用自定义录音\n  medicalEmergencyAudioPath?: string; // 医疗呼救音频路径\n  lastUpdated: number;\n}\n\n// TTS文件信息接口（扩展版本）\ninterface TTSFileInfo {\n  fileName: string;\n  filePath: string;\n  fileSize: number;\n  createTime: number;\n  type: 'general' | 'medical' | 'security' | 'custom';\n  source: 'recorded' | 'uploaded';  // 新增来源标识\n  isDefault?: boolean;\n  duration?: number;  // 音频时长（毫秒）\n  format?: string;    // 文件格式\n  mimeType?: string;  // MIME类型\n}\n\n// 录制结果接口\ninterface TTSRecordResult {\n  success: boolean;\n  filePath: string;\n  message: string;\n}\n\n// 语音配置接口\ninterface VoiceEmergencyConfig {\n  medicalDefault?: string;\n  securityDefault?: string;\n  lastUpdated: number;\n}\n\n// 文件上传相关接口\ninterface FileSelectResult {\n  success: boolean;\n  filePath: string;\n  message: string;\n  fileInfo?: SelectedFileInfo;\n}\n\ninterface SelectedFileInfo {\n  filePath: string;\n  fileName: string;\n  fileSize: number;\n  mimeType: string;\n  duration?: number;\n}\n\ninterface FileUploadResult {\n  success: boolean;\n  filePath: string;\n  message: string;\n  fileInfo?: TTSFileInfo;\n}\n\ninterface FileValidationResult {\n  isValid: boolean;\n  message: string;\n  fileSize: number;\n  duration: number;\n  format: string;\n  warnings: string[];\n}\n\ninterface SupportedFormats {\n  formats: string[];\n  maxFileSizeMB: number;\n  maxDurationSeconds: number;\n  recommendedDurationSeconds: number;\n}\n\n// 默认设置\nconst DEFAULT_SETTINGS: EmergencyTTSSettings = {\n  enabled: false,\n  message: '我遇到了紧急情况，需要帮助！请立即联系紧急服务！',\n  repeatInterval: 3000,\n  voiceSpeed: 1.0,\n  voicePitch: 1.0,\n  useCustomAudio: false,\n  lastUpdated: Date.now(),\n};\n\nconst DEFAULT_VOICE_CONFIG: VoiceEmergencyConfig = {\n  lastUpdated: Date.now(),\n};\n\nconst TTS_SETTINGS_KEY = 'emergencyTTSSettings';\nconst VOICE_CONFIG_KEY = 'voiceEmergencyConfig';\n\nexport const EmergencyTTSSettings: React.FC = () => {\n  const [settings, setSettings] = useState<EmergencyTTSSettings>(DEFAULT_SETTINGS);\n  const [voiceConfig, setVoiceConfig] = useState<VoiceEmergencyConfig>(DEFAULT_VOICE_CONFIG);\n  const [fileList, setFileList] = useState<TTSFileInfo[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [testing, setTesting] = useState(false);\n  const [showSuccess, setShowSuccess] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [successMessage, setSuccessMessage] = useState('');\n  const [expanded, setExpanded] = useState(false);\n  const [activeTab, setActiveTab] = useState(0);\n  \n  // 录制相关状态\n  const [isRecording, setIsRecording] = useState(false);\n  const [playingFile, setPlayingFile] = useState<string | null>(null);\n  const [recordText, setRecordText] = useState(DEFAULT_SETTINGS.message);\n  const [recordSpeed, setRecordSpeed] = useState(1.0);\n  const [recordPitch, setRecordPitch] = useState(1.0);\n  const [showRecordDialog, setShowRecordDialog] = useState(false);\n  const [ttsAvailable, setTtsAvailable] = useState<boolean | null>(null);\n  \n  // 文件上传相关状态\n  const [isUploading, setIsUploading] = useState(false);\n  const [selectedFile, setSelectedFile] = useState<SelectedFileInfo | null>(null);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [supportedFormats, setSupportedFormats] = useState<SupportedFormats | null>(null);\n\n  async function onRecordClick(){\n    if(user.data.storeData.user_token){\n      setShowRecordDialog(true)\n    }else{\n      // 弹出登录页面\n\n      const appLoggedIn = await authService.showLoginDialog();\n      if(appLoggedIn){\n        setShowRecordDialog(true);\n      }\n    }\n  }\n  // 加载所有设置和数据\n  useEffect(() => {\n    const loadData = async () => {\n      try {\n        setLoading(true);\n        \n        // 加载TTS设置\n        const savedSettings = await autoJsStoreUtils.read<EmergencyTTSSettings>(\n          TTS_SETTINGS_KEY, \n          DEFAULT_SETTINGS\n        );\n        setSettings(savedSettings);\n        \n        // 加载语音配置\n        const savedConfig = await autoJsStoreUtils.read<VoiceEmergencyConfig>(\n          VOICE_CONFIG_KEY,\n          DEFAULT_VOICE_CONFIG\n        );\n        setVoiceConfig(savedConfig);\n        \n        // 检查TTS可用性\n        checkTTSAvailability();\n        \n        // 加载文件列表\n        loadFileList();\n      } catch (err) {\n        console.error('加载数据失败:', err);\n        setError('加载设置失败');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadData();\n  }, []);\n\n  // 初始化时加载支持的音频格式\n  useEffect(() => {\n    loadSupportedFormats();\n  }, []);\n\n  // 加载支持的音频格式\n  const loadSupportedFormats = useCallback(() => {\n    try {\n      const script = `var data = com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.getSupportedAudioFormats();\ndata;`;\n      const { javaResultString } = autoWebViewJs.callScript(script);\n      const formats = JSON.parse(javaResultString || '{}') as SupportedFormats;\n      setSupportedFormats(formats);\n    } catch (error) {\n      console.error('加载支持格式失败:', error);\n      setSupportedFormats({\n        formats: ['mp3', 'wav', 'm4a', 'aac'],\n        maxFileSizeMB: 10,\n        maxDurationSeconds: 60,\n        recommendedDurationSeconds: 30\n      });\n    }\n  }, []);\n\n  // 加载文件列表\n  const loadFileList = useCallback(() => {\n    try {\n      const script = `var data = com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.getFileList();\ndata;`;\n      const { javaResultString: listJson } = autoWebViewJs.callScript(script);\n      const files = JSON.parse((listJson || \"[]\") as string) as TTSFileInfo[];\n      \n      // 为现有文件设置默认类型（兼容性处理）\n      const filesWithType = files.map(file => ({\n        ...file,\n        type: (file as any).type || 'general' as const,\n        isDefault: (file as any).isDefault || false,\n      }));\n      \n      setFileList(filesWithType);\n    } catch (error) {\n      console.error('加载文件列表失败:', error);\n      setFileList([]);\n    }\n  }, []);\n\n  // 选择并上传音频文件（整合操作）\n  const handleSelectAndUploadAudioFile = useCallback(async () => {\n    if (isUploading) return;\n    \n    try {\n      setIsUploading(true);\n      setUploadProgress(0);\n      \n      const script = `var data = com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.selectAndUploadAudioFile();\ndata;`;\n      \n      // 模拟上传进度\n      const progressInterval = setInterval(() => {\n        setUploadProgress(prev => {\n          if (prev >= 90) {\n            clearInterval(progressInterval);\n            return 90;\n          }\n          return prev + 10;\n        });\n      }, 300);\n      \n      const { javaResultString } = autoWebViewJs.callScript(script);\n      const result = JSON.parse(javaResultString || '{}') as FileUploadResult;\n      \n      clearInterval(progressInterval);\n      setUploadProgress(100);\n      \n      if (result.success) {\n        setSuccessMessage('音频文件上传成功！');\n        setShowSuccess(true);\n        loadFileList(); // 刷新文件列表\n      } else {\n        setError(result.message || '上传失败');\n      }\n    } catch (error) {\n      console.error('文件上传失败:', error);\n      setError('文件上传异常：' + (error as Error).message);\n    } finally {\n      setIsUploading(false);\n      setUploadProgress(0);\n    }\n  }, [isUploading, loadFileList]);\n\n  // 检查TTS可用性\n  const checkTTSAvailability = useCallback(() => {\n    try {\n      const script = `var data = com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.isTTSAvailable();\ndata;`;\n      const { javaResultString } = autoWebViewJs.callScript(script);\n      setTtsAvailable(javaResultString === 'true');\n    } catch (error) {\n      console.error('检查TTS可用性失败:', error);\n      setTtsAvailable(false);\n    }\n  }, []);\n\n  // 保存设置\n  const saveSettings = async (newSettings: EmergencyTTSSettings) => {\n    try {\n      const settingsToSave = {\n        ...newSettings,\n        lastUpdated: Date.now(),\n      };\n      \n      await autoJsStoreUtils.write(TTS_SETTINGS_KEY, settingsToSave);\n      setSettings(settingsToSave);\n      setSuccessMessage('设置保存成功');\n      setShowSuccess(true);\n      setError(null);\n    } catch (err) {\n      console.error('保存TTS设置失败:', err);\n      setError('保存设置失败');\n    }\n  };\n\n  // 保存语音配置\n  const saveVoiceConfig = async (newConfig: VoiceEmergencyConfig) => {\n    try {\n      const configToSave = {\n        ...newConfig,\n        lastUpdated: Date.now(),\n      };\n      \n      await autoJsStoreUtils.write(VOICE_CONFIG_KEY, configToSave);\n      setVoiceConfig(configToSave);\n    } catch (err) {\n      console.error('保存语音配置失败:', err);\n      setError('保存配置失败');\n    }\n  };\n\n  // 录制TTS\n  const handleRecord = useCallback(() => {\n    if (!recordText.trim()) {\n      setError('请输入要录制的文字');\n      return;\n    }\n\n    if (!ttsAvailable) {\n      setError('TTS服务不可用，无法录制');\n      return;\n    }\n\n    try {\n      setIsRecording(true);\n      // 生成文件名：TTS_YYYYMMDD_HHMMSS.wav\n      const now = new Date();\n      const timestamp = now.getFullYear().toString() + \n                       (now.getMonth() + 1).toString().padStart(2, '0') + \n                       now.getDate().toString().padStart(2, '0') + '_' +\n                       now.getHours().toString().padStart(2, '0') + \n                       now.getMinutes().toString().padStart(2, '0') + \n                       now.getSeconds().toString().padStart(2, '0');\n      const fileName = `TTS_${timestamp}.wav`;\n      \n      const script = `var data = com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.recordTTS(\"${recordText.replace(/\"/g, '\\\\\"')}\", \"${fileName}\", ${recordSpeed}, ${recordPitch});\ndata;`;\n      \n      // 模拟异步录制过程\n      setTimeout(() => {\n        try {\n          const { javaResultString: resultJson } = autoWebViewJs.callScript(script);\n          console.log('录制结果:', resultJson);\n          const result = JSON.parse(resultJson || '{}') as TTSRecordResult;\n          \n          if (result.success) {\n            setSuccessMessage('录制成功！');\n            setShowSuccess(true);\n            setShowRecordDialog(false);\n            loadFileList(); // 刷新文件列表\n          } else {\n            setError(result.message || '录制失败');\n          }\n        } catch (error) {\n          console.error('录制失败:', error);\n          setError('录制异常：' + (error as Error).message);\n        } finally {\n          setIsRecording(false);\n        }\n      }, 2000);\n    } catch (error) {\n      setError('录制异常：' + (error as Error).message);\n      setIsRecording(false);\n    }\n  }, [recordText, recordSpeed, recordPitch, ttsAvailable, loadFileList]);\n\n  // 播放文件\n  const handlePlayFile = useCallback((filePath: string) => {\n    try {\n      if (playingFile === filePath) {\n        setPlayingFile(null);\n        return;\n      }\n\n      const script = `var data = com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.playFile(\"${filePath.replace(/\"/g, '\\\\\"')}\");\ndata;`;\n      const { javaResultString: success } = autoWebViewJs.callScript(script);\n      if (success === 'true') {\n        setPlayingFile(filePath);\n        setTimeout(() => setPlayingFile(null), 3000);\n      } else {\n        setError('播放失败');\n      }\n    } catch (error) {\n      setError('播放异常：' + (error as Error).message);\n    }\n  }, [playingFile]);\n\n  // 分享文件\n  const handleShareFile = useCallback((filePath: string) => {\n    try {\n      const script = `var data = com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.shareFile(\"${filePath.replace(/\"/g, '\\\\\"')}\", \"紧急呼救语音\");\ndata;`;\n      const { javaResultString: success } = autoWebViewJs.callScript(script);\n      if (success !== 'true') {\n        setError('分享失败');\n      }\n    } catch (error) {\n      setError('分享异常：' + (error as Error).message);\n    }\n  }, []);\n\n  // 删除文件\n  const handleDeleteFile = useCallback((filePath: string) => {\n    if (window.confirm('确定要删除这个文件吗？')) {\n      try {\n        const script = `var data = com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.deleteFile(\"${filePath.replace(/\"/g, '\\\\\"')}\");\ndata;`;\n        const { javaResultString: success } = autoWebViewJs.callScript(script);\n        if (success === 'true') {\n          setSuccessMessage('文件删除成功');\n          setShowSuccess(true);\n          loadFileList();\n        } else {\n          setError('删除失败');\n        }\n      } catch (error) {\n        setError('删除异常：' + (error as Error).message);\n      }\n    }\n  }, [loadFileList]);\n\n  // 设置为默认音频\n  const setAsDefaultAudio = useCallback(async (filePath: string, type: 'medical' | 'security') => {\n    try {\n      // 调用Android端设置默认音频\n      const script = `var data = com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.setFileAsDefault(\"${filePath.replace(/\"/g, '\\\\\"')}\", \"${type}\");\ndata;`;\n      const { javaResultString: success } = autoWebViewJs.callScript(script);\n      \n      if (success !== 'true') {\n        setError('设置默认音频失败');\n        return;\n      }\n      \n      const newConfig = { ...voiceConfig };\n      if (type === 'medical') {\n        newConfig.medicalDefault = filePath;\n        // 同时更新TTS设置中的路径\n        const updatedSettings = {\n          ...settings,\n          medicalEmergencyAudioPath: filePath,\n          useCustomAudio: true,\n        };\n        setSettings(updatedSettings);\n        await saveSettings(updatedSettings);\n      } else {\n        newConfig.securityDefault = filePath;\n      }\n      \n      await saveVoiceConfig(newConfig);\n      \n      // 更新文件列表中的默认标记\n      const updatedFiles = fileList.map(file => ({\n        ...file,\n        isDefault: file.filePath === filePath,\n      }));\n      setFileList(updatedFiles);\n      \n      setSuccessMessage(`已设置为${type === 'medical' ? '医疗' : '安全'}呼救默认音频`);\n      setShowSuccess(true);\n    } catch (err) {\n      console.error('设置默认音频失败:', err);\n      setError('设置默认音频失败');\n    }\n  }, [voiceConfig, fileList, settings, saveSettings, saveVoiceConfig]);\n\n  // 格式化文件大小\n  const formatFileSize = (bytes: number): string => {\n    if (bytes < 1024) return `${bytes} B`;\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n    return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n  };\n\n  // 格式化时间\n  const formatTime = (timestamp: number): string => {\n    return new Date(timestamp).toLocaleString();\n  };\n\n  // 格式化时长\n  const formatDuration = (milliseconds: number): string => {\n    if (!milliseconds || milliseconds <= 0) return '';\n    const seconds = Math.floor(milliseconds / 1000);\n    const minutes = Math.floor(seconds / 60);\n    const remainingSeconds = seconds % 60;\n    if (minutes > 0) {\n      return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;\n    }\n    return `${seconds}s`;\n  };\n\n  // 测试TTS\n  const testTTS = async () => {\n    if (!settings.message.trim()) {\n      setError('请输入呼救文字后再测试');\n      return;\n    }\n\n    try {\n      setTesting(true);\n      \n      // 调用Android端TTS测试方法\n      const script = `\n        com.fanfanlo.emergencycall.manager.EmergencyTTSManager.testTTS(\"${settings.message}\", ${settings.voiceSpeed}, ${settings.voicePitch});\n      `;\n      \n      await new Promise(resolve => setTimeout(resolve, 500)); // 模拟测试时间\n      // TODO: 实际调用时取消注释\n      autoWebViewJs.callScript(script);\n      \n    } catch (err) {\n      console.error('TTS测试失败:', err);\n      setError('TTS测试失败');\n    } finally {\n      setTesting(false);\n    }\n  };\n\n  // 停止TTS测试\n  const stopTest = async () => {\n    try {\n      const script = `\n        com.fanfanlo.emergencycall.manager.EmergencyTTSManager.stopTest();\n      `;\n      // TODO: 实际调用时取消注释\n      autoWebViewJs.callScript(script);\n      setTesting(false);\n    } catch (err) {\n      console.error('停止TTS测试失败:', err);\n    }\n  };\n\n  const handleSettingChange = (key: keyof EmergencyTTSSettings, value: any) => {\n    const newSettings = { ...settings, [key]: value };\n    setSettings(newSettings);\n    \n    // 对于启用/禁用这样的关键设置，立即保存\n    if (key === 'enabled') {\n      saveSettings(newSettings);\n    }\n  };\n\n  const handleSave = () => {\n    if (settings.enabled && !settings.useCustomAudio && !settings.message.trim()) {\n      setError('启用TTS功能时，呼救文字不能为空');\n      return;\n    }\n    saveSettings(settings);\n  };\n\n  if (loading) {\n    return (\n      <Box sx={{ p: 2, textAlign: 'center' }}>\n        <Typography>加载中...</Typography>\n      </Box>\n    );\n  }\n\n  return (\n    <Box sx={{ mb: 3 }}>\n      {/* 折叠头部 */}\n      <Paper \n        elevation={1} \n        sx={{ \n          p: 2, \n          display: 'flex', \n          alignItems: 'center',\n          justifyContent: 'space-between',\n          borderRadius: 1,\n        }}\n      >\n        <Box sx={{ \n          display: 'flex', \n          alignItems: 'center', \n          gap: { xs: 1, sm: 2 },\n          flexWrap: { xs: 'wrap', sm: 'nowrap' },\n          flex: 1,\n          minWidth: 0\n        }}>\n          <Typography \n            variant=\"subtitle1\" \n            sx={{ \n              display: 'flex', \n              alignItems: 'center', \n              gap: 1,\n              fontSize: { xs: '0.95rem', sm: '1.25rem' },\n              minWidth: 0,\n              flexShrink: 0\n            }}\n          >\n            <VolumeUp fontSize=\"small\" />\n            <Box component=\"span\" sx={{ \n              display: { xs: 'none', sm: 'inline' }\n            }}>紧急呼救语音设置</Box>\n            <Box component=\"span\" sx={{ \n              display: { xs: 'inline', sm: 'none' }\n            }}>呼救语音</Box>\n          </Typography>\n          \n          <Box sx={{ \n            display: 'flex', \n            alignItems: 'center', \n            gap: { xs: 1, sm: 2 },\n            flexWrap: { xs: 'wrap', sm: 'nowrap' }\n          }}>\n            <FormControlLabel\n              control={\n                <Switch\n                  checked={settings.enabled}\n                  onChange={(e) => handleSettingChange('enabled', e.target.checked)}\n                  color=\"primary\"\n                  size=\"small\"\n                />\n              }\n              label={settings.enabled ? '已启用' : '未启用'}\n              sx={{ \n                margin: 0,\n                '& .MuiFormControlLabel-label': {\n                  fontSize: { xs: '0.8rem', sm: '0.875rem' }\n                }\n              }}\n            />\n            \n            {/* 状态指示器 */}\n            {/* <Chip \n              size=\"small\"\n              icon={ttsAvailable ? <VolumeUp /> : <MusicNote />}\n              label={ttsAvailable === null ? '检测中...' : (ttsAvailable ? 'TTS可用' : 'TTS不可用')}\n              color={ttsAvailable === null ? 'default' : (ttsAvailable ? 'success' : 'warning')}\n              variant=\"outlined\"\n              sx={{ \n                fontSize: { xs: '0.7rem', sm: '0.8125rem' },\n                height: { xs: '24px', sm: '32px' }\n              }}\n            /> */}\n          </Box>\n        </Box>\n        \n        <Button\n          variant=\"outlined\"\n          size=\"small\"\n          startIcon={expanded ? <ExpandLess /> : <Settings />}\n          onClick={() => setExpanded(!expanded)}\n          sx={{ \n            fontSize: { xs: '0.75rem', sm: '0.875rem' },\n            padding: { xs: '4px 8px', sm: '6px 16px' },\n            minWidth: { xs: 'auto', sm: '64px' },\n            flexShrink: 0\n          }}\n        >\n          <Box component=\"span\" sx={{ display: { xs: 'none', sm: 'inline' } }}>\n            {expanded ? '收起设置' : '设置'}\n          </Box>\n          <Box component=\"span\" sx={{ display: { xs: 'inline', sm: 'none' } }}>\n            {expanded ? '收起' : '设置'}\n          </Box>\n        </Button>\n      </Paper>\n\n      {/* 折叠内容 */}\n      <Collapse in={expanded}>\n        <Paper \n          elevation={0} \n          sx={{ \n            mt: 1, \n            p: 0,\n            border: '1px solid', \n            borderColor: 'divider',\n            borderRadius: 1,\n          }}\n        >\n          {/* 功能标签页 */}\n          <Tabs \n            value={activeTab} \n            onChange={(_, newValue) => setActiveTab(newValue)}\n            variant=\"fullWidth\"\n          >\n            {/* <Tab label=\"文字设置\" /> */}\n            <Tab label=\"上传/文字转语音\" />\n            <Tab label=\"文件管理\" />\n          </Tabs>\n\n          {/* 标签页内容 */}\n          <Box sx={{ p: 2 }}>\n            {/* 文字设置 Tab */}\n            {activeTab === -1 && (\n              <Box>\n                {/* 呼救文字设置 */}\n                <Box sx={{ mb: 3 }}>\n                  <Typography variant=\"subtitle2\" fontWeight=\"bold\" sx={{ mb: 2 }}>\n                    呼救文字内容\n                  </Typography>\n                  <TextField\n                    fullWidth\n                    multiline\n                    rows={3}\n                    value={settings.message}\n                    onChange={(e) => handleSettingChange('message', e.target.value)}\n                    placeholder=\"请输入紧急情况下要播报的文字...\"\n                    disabled={!settings.enabled}\n                    helperText={`当前字数: ${settings.message.length} 字符`}\n                    sx={{ \n                      '& .MuiInputBase-input': {\n                        fontSize: '16px',\n                        lineHeight: 1.5,\n                      }\n                    }}\n                  />\n                </Box>\n\n                {/* 语音设置 */}\n                {settings.enabled && (\n                  <>\n                    <Divider sx={{ my: 3 }} />\n                    \n                    <Typography variant=\"subtitle2\" fontWeight=\"bold\" sx={{ mb: 2 }}>\n                      语音参数设置\n                    </Typography>\n\n                    {/* 重复间隔 */}\n                    <Box sx={{ mb: 3 }}>\n                      <Typography variant=\"body2\" sx={{ mb: 1 }}>\n                        重复间隔: {settings.repeatInterval / 1000} 秒\n                      </Typography>\n                      <Slider\n                        value={settings.repeatInterval}\n                        onChange={(_, value) => handleSettingChange('repeatInterval', value)}\n                        min={2000}\n                        max={10000}\n                        step={500}\n                        marks={[\n                          { value: 2000, label: '2s' },\n                          { value: 5000, label: '5s' },\n                          { value: 10000, label: '10s' },\n                        ]}\n                        valueLabelDisplay=\"auto\"\n                        valueLabelFormat={(value) => `${value / 1000}s`}\n                      />\n                    </Box>\n\n                    {/* 语音速度 */}\n                    <Box sx={{ mb: 3 }}>\n                      <Typography variant=\"body2\" sx={{ mb: 1 }}>\n                        语音速度: {settings.voiceSpeed}x\n                      </Typography>\n                      <Slider\n                        value={settings.voiceSpeed}\n                        onChange={(_, value) => handleSettingChange('voiceSpeed', value)}\n                        min={0.5}\n                        max={2.0}\n                        step={0.1}\n                        marks={[\n                          { value: 0.5, label: '0.5x' },\n                          { value: 1.0, label: '1.0x' },\n                          { value: 2.0, label: '2.0x' },\n                        ]}\n                        valueLabelDisplay=\"auto\"\n                      />\n                    </Box>\n\n                    {/* 语音音调 */}\n                    <Box sx={{ mb: 3 }}>\n                      <Typography variant=\"body2\" sx={{ mb: 1 }}>\n                        语音音调: {settings.voicePitch}x\n                      </Typography>\n                      <Slider\n                        value={settings.voicePitch}\n                        onChange={(_, value) => handleSettingChange('voicePitch', value)}\n                        min={0.5}\n                        max={2.0}\n                        step={0.1}\n                        marks={[\n                          { value: 0.5, label: '低' },\n                          { value: 1.0, label: '标准' },\n                          { value: 2.0, label: '高' },\n                        ]}\n                        valueLabelDisplay=\"auto\"\n                      />\n                    </Box>\n                  </>\n                )}\n              </Box>\n            )}\n\n            {/* 录制音频 Tab */}\n            {activeTab === 0 && (\n              <Box>\n                {/* 录制语音区域 */}\n                <Box sx={{ mb: 4 }}>\n                  <Typography variant=\"subtitle2\" fontWeight=\"bold\" sx={{ mb: 2 }}>\n                    录制新的呼救语音\n                  </Typography>\n                  \n                  {!ttsAvailable ? (\n                    <Alert severity=\"warning\" sx={{ mb: 2 }}>\n                      TTS服务不可用，无法录制语音。请检查设备设置或联系技术支持。\n                    </Alert>\n                  ) : (\n                    <Button\n                      variant=\"contained\"\n                      startIcon={<Mic />}\n                      onClick={onRecordClick}\n                      disabled={isUploading}\n                      sx={{ mb: 3 }}\n                    >\n                      录制新语音\n                    </Button>\n                  )}\n                  \n                  <Typography variant=\"body2\" color=\"text.secondary\">\n                    • 点击\"录制新语音\"开始录制<br />\n                    • 可以调节语速和音调参数<br />\n                    • 录制完成后会自动保存到文件列表<br />\n                    • 在文件管理中可以设置为默认呼救音频\n                  </Typography>\n                </Box>\n\n                <Divider sx={{ my: 3 }} />\n\n                {/* 上传音频文件区域 */}\n                <Box>\n                  <Typography variant=\"subtitle2\" fontWeight=\"bold\" sx={{ mb: 2 }}>\n                    上传音频文件\n                  </Typography>\n                  \n                  <Button\n                    variant=\"outlined\"\n                    startIcon={isUploading ? <CircularProgress size={16} /> : <CloudUpload />}\n                    onClick={handleSelectAndUploadAudioFile}\n                    disabled={isUploading}\n                    sx={{ mb: 2 }}\n                  >\n                    {isUploading ? '上传中...' : '选择并上传音频文件'}\n                  </Button>\n                  \n                  {/* 上传进度 */}\n                  {isUploading && uploadProgress > 0 && (\n                    <Box sx={{ mb: 2 }}>\n                      <LinearProgress \n                        variant=\"determinate\" \n                        value={uploadProgress} \n                        sx={{ mb: 1 }}\n                      />\n                      <Typography variant=\"body2\" color=\"text.secondary\" sx={{ textAlign: 'center' }}>\n                        上传中... {uploadProgress}%\n                      </Typography>\n                    </Box>\n                  )}\n                  \n                  {supportedFormats && supportedFormats.formats && (\n                    <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 2 }}>\n                      支持格式: {supportedFormats.formats.join(', ').toUpperCase()}<br />\n                      文件大小限制: {supportedFormats.maxFileSizeMB}MB<br />\n                      推荐时长: {supportedFormats.recommendedDurationSeconds}秒内\n                    </Typography>\n                  )}\n                  \n                  <Typography variant=\"body2\" color=\"text.secondary\">\n                    • 支持从设备中选择现有的音频文件<br />\n                    {/* • 文件会被自动复制到应用私有目录<br />\n                    • 上传前会自动验证文件格式和大小<br /> */}\n                    • 上传成功后可在文件管理中设置为默认音频\n                  </Typography>\n                </Box>\n              </Box>\n            )}\n\n            {/* 文件管理 Tab */}\n            {activeTab === 1 && (\n              <Box>\n                <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n                  <Typography variant=\"subtitle2\" fontWeight=\"bold\">\n                    录制文件列表\n                  </Typography>\n                  <Button\n                    size=\"small\"\n                    startIcon={<Refresh />}\n                    onClick={loadFileList}\n                  >\n                    刷新\n                  </Button>\n                </Box>\n\n                {fileList.length === 0 ? (\n                  <Typography color=\"text.secondary\" sx={{ textAlign: 'center', py: 3 }}>\n                    暂无录制文件\n                  </Typography>\n                ) : (\n                  <List dense>\n                    {fileList.map((file, index) => (\n                      <React.Fragment key={file.filePath}>\n                        <ListItem sx={{ pl: 0 }}>\n                          <ListItemText\n                            primary={\n                              <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, flexWrap: 'wrap' }}>\n                                <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                                  {file.source === 'uploaded' ? <InsertDriveFile fontSize=\"small\" /> : <Mic fontSize=\"small\" />}\n                                  <Typography variant=\"body2\" fontWeight=\"medium\">\n                                    {file.fileName}\n                                  </Typography>\n                                </Box>\n                                \n                                {/* 标签集合 */}\n                                <Box sx={{ display: 'flex', gap: 0.5 }}>\n                                  {file.isDefault && (\n                                    <Chip size=\"small\" label=\"默认\" color=\"primary\" />\n                                  )}\n                                  <Chip \n                                    size=\"small\" \n                                    label={file.source === 'uploaded' ? '上传' : '录制'} \n                                    color={file.source === 'uploaded' ? 'secondary' : 'default'}\n                                    variant=\"outlined\"\n                                  />\n                                  {file.format && (\n                                    <Chip \n                                      size=\"small\" \n                                      label={file.format.toUpperCase()} \n                                      color=\"default\" \n                                      variant=\"outlined\"\n                                    />\n                                  )}\n                                </Box>\n                              </Box>\n                            }\n                            secondary={\n                              <Box>\n                                <Typography variant=\"caption\" color=\"text.secondary\">\n                                  {formatFileSize(file.fileSize)} • {formatTime(file.createTime)}\n                                  {file.duration && file.duration > 0 && ` • ${formatDuration(file.duration)}`}\n                                </Typography>\n                                {file.mimeType && (\n                                  <Typography variant=\"caption\" color=\"text.secondary\" sx={{ display: 'block' }}>\n                                    {file.mimeType}\n                                  </Typography>\n                                )}\n                              </Box>\n                            }\n                          />\n                          <ListItemSecondaryAction>\n                            <Box sx={{ display: 'flex', gap: 0.5 }}>\n                              <IconButton\n                                size=\"small\"\n                                onClick={() => handlePlayFile(file.filePath)}\n                                color={playingFile === file.filePath ? \"primary\" : \"default\"}\n                              >\n                                {playingFile === file.filePath ? <Stop /> : <PlayArrow />}\n                              </IconButton>\n                              <IconButton\n                                size=\"small\"\n                                onClick={() => setAsDefaultAudio(file.filePath, 'medical')}\n                                color={file.isDefault ? \"primary\" : \"default\"}\n                              >\n                                {file.isDefault ? <Star /> : <StarBorder />}\n                              </IconButton>\n                              <IconButton\n                                size=\"small\"\n                                onClick={() => handleShareFile(file.filePath)}\n                              >\n                                <Share />\n                              </IconButton>\n                              <IconButton\n                                size=\"small\"\n                                onClick={() => handleDeleteFile(file.filePath)}\n                                color=\"error\"\n                              >\n                                <Delete />\n                              </IconButton>\n                            </Box>\n                          </ListItemSecondaryAction>\n                        </ListItem>\n                        {index < fileList.length - 1 && <Divider />}\n                      </React.Fragment>\n                    ))}\n                  </List>\n                )}\n              </Box>\n            )}\n\n            {/* 通用操作按钮 */}\n            <Divider sx={{ my: 3 }} />\n            \n            {/* <Box sx={{ display: 'flex', gap: 2, flexWrap: 'wrap', mb: 2 }}>\n              <Button\n                variant=\"contained\"\n                onClick={handleSave}\n                sx={{ minWidth: 100 }}\n              >\n                保存设置\n              </Button>\n\n              {settings.enabled && settings.message.trim() && (\n                <>\n                  {!testing ? (\n                    <Button\n                      variant=\"outlined\"\n                      startIcon={<PlayArrow />}\n                      onClick={testTTS}\n                      sx={{ minWidth: 100 }}\n                    >\n                      测试呼救\n                    </Button>\n                  ) : (\n                    <Button\n                      variant=\"outlined\"\n                      color=\"error\"\n                      startIcon={<Stop />}\n                      onClick={stopTest}\n                      sx={{ minWidth: 100 }}\n                    >\n                      停止测试\n                    </Button>\n                  )}\n                </>\n              )}\n            </Box> */}\n\n            {/* 使用说明 */}\n            <Box sx={{ p: 2, backgroundColor: 'rgba(0,0,0,0.05)', borderRadius: 1 }}>\n              <Typography variant=\"body2\" color=\"text.secondary\">\n                <strong>智能音频回退说明:</strong><br />\n                • 第1级: 检查是否启用呼救功能<br />\n                • 第2级: 优先播放设置为默认的自定义音频文件<br />\n                {/* • 第3级: 降级到文字转语音播报<br /> */}\n                • 第3级: 最终降级到系统默认提示音<br />\n                <br />\n                <strong>使用建议:</strong><br />\n                • 建议录制或上传个人化的呼救信息，包含您的姓名、病情和紧急联系人<br />\n                • 在文件管理中点击五角星设置为默认音频<br />\n                • 先测试语音效果，确保在紧急情况下能清楚传达<br />\n                • 定期检查和更新呼救音频内容\n              </Typography>\n            </Box>\n          </Box>\n        </Paper>\n      </Collapse>\n\n      {/* 录制对话框 */}\n      <Dialog open={showRecordDialog} onClose={() => setShowRecordDialog(false)} maxWidth=\"md\" fullWidth>\n        <DialogTitle>录制新语音</DialogTitle>\n        <DialogContent>\n          <TextField\n            fullWidth\n            multiline\n            rows={4}\n            label=\"录制文字内容\"\n            value={recordText}\n            onChange={(e) => setRecordText(e.target.value)}\n            margin=\"normal\"\n            placeholder=\"请输入要录制的紧急呼救内容...\"\n            helperText={`字数: ${recordText.length} 字符`}\n          />\n          \n          {isRecording && (\n            <Box sx={{ mt: 2 }}>\n              <LinearProgress />\n              <Typography variant=\"body2\" sx={{ mt: 1, textAlign: 'center' }}>\n                正在录制中，请稍候...\n              </Typography>\n            </Box>\n          )}\n          \n          <Box sx={{ mt: 3 }}>\n            <Typography variant=\"subtitle2\" gutterBottom>\n              录制参数\n            </Typography>\n            \n            <Box sx={{ mt: 2 }}>\n              <Typography variant=\"body2\" gutterBottom>\n                语音速度: {recordSpeed}x\n              </Typography>\n              <Slider\n                value={recordSpeed}\n                onChange={(_, value) => setRecordSpeed(value as number)}\n                min={0.5}\n                max={2.0}\n                step={0.1}\n                marks={[\n                  { value: 0.5, label: '慢' },\n                  { value: 1.0, label: '标准' },\n                  { value: 2.0, label: '快' },\n                ]}\n                disabled={isRecording}\n              />\n            </Box>\n            \n            <Box sx={{ mt: 2 }}>\n              <Typography variant=\"body2\" gutterBottom>\n                语音音调: {recordPitch}x\n              </Typography>\n              <Slider\n                value={recordPitch}\n                onChange={(_, value) => setRecordPitch(value as number)}\n                min={0.5}\n                max={2.0}\n                step={0.1}\n                marks={[\n                  { value: 0.5, label: '低' },\n                  { value: 1.0, label: '标准' },\n                  { value: 2.0, label: '高' },\n                ]}\n                disabled={isRecording}\n              />\n            </Box>\n          </Box>\n        </DialogContent>\n        <DialogActions>\n          <ReportButton />\n          <Button \n            onClick={() => setShowRecordDialog(false)}\n            disabled={isRecording}\n          >\n            取消\n          </Button>\n          <Button \n            onClick={handleRecord} \n            variant=\"contained\"\n            disabled={!recordText.trim() || isRecording}\n            startIcon={isRecording ? undefined : <Mic />}\n          >\n            {isRecording ? '录制中...' : '开始录制'}\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      {/* 成功提示 */}\n      <Snackbar\n        open={showSuccess}\n        autoHideDuration={3000}\n        onClose={() => setShowSuccess(false)}\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n      >\n        <Alert onClose={() => setShowSuccess(false)} severity=\"success\">\n          {successMessage || 'TTS设置保存成功！'}\n        </Alert>\n      </Snackbar>\n\n      {/* 错误提示 */}\n      <Snackbar\n        open={!!error}\n        autoHideDuration={6000}\n        onClose={() => setError(null)}\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n      >\n        <Alert onClose={() => setError(null)} severity=\"error\">\n          {error}\n        </Alert>\n      </Snackbar>\n    </Box>\n  );\n};","export { EmergencyTTSSettings } from './EmergencyTTSSettings';","import React, { useState, useEffect } from 'react';\nimport { autoJsStoreUtils, autoWebViewJs } from '@droid/android';\n\ninterface ErrorInfo {\n  id: string;\n  timestamp: number;\n  errorType: string;\n  severity: string;\n  message: string;\n  stackTrace?: string;\n  context?: Record<string, string>;\n}\n\ninterface ErrorStorage {\n  errors: ErrorInfo[];\n}\n\nexport const ErrorDisplay: React.FC = () => {\n  const [errors, setErrors] = useState<ErrorInfo[]>([]);\n  const [isVisible, setIsVisible] = useState(false);\n\n  const loadErrors = () => {\n    try {\n      const parsed = autoJsStoreUtils.read<ErrorStorage>('EMERGENCY_ERRORS_STORAGE', {\"errors\":[]});\n      // const parsed: ErrorStorage = JSON.parse(errorData);\n      \n      if (parsed && parsed.errors && parsed.errors.length > 0) {\n        setErrors(parsed.errors);\n        setIsVisible(true);\n      } else {\n        setErrors([]);\n        setIsVisible(false);\n      }\n    } catch (e) {\n      console.error('读取错误信息失败:', e);\n      setErrors([]);\n      setIsVisible(false);\n    }\n  };\n\n  const clearErrors = () => {\n    try {\n      // 清除本地存储\n      autoJsStoreUtils.write('EMERGENCY_ERRORS_STORAGE', '{\"errors\":[]}');\n      setErrors([]);\n      setIsVisible(false);\n      \n      console.log('错误信息已清除');\n    } catch (e) {\n      console.error('清除错误信息失败:', e);\n    }\n  };\n\n  const handleErrorEvent = () => {\n    console.log('收到错误事件，重新加载错误列表');\n    loadErrors();\n  };\n\n  const handleErrorClearedEvent = () => {\n    console.log('收到错误清除事件');\n    setErrors([]);\n    setIsVisible(false);\n  };\n\n  useEffect(() => {\n    // 页面加载时检查错误\n    loadErrors();\n\n    // 监听错误事件\n    const handleFocus = () => {\n      console.log('窗口获得焦点，检查错误信息');\n      loadErrors();\n    };\n\n    // 监听自定义事件\n    const handleCustomError = (event: any) => {\n      console.log('收到自定义错误事件:', event);\n      handleErrorEvent();\n    };\n\n    const handleCustomErrorCleared = (event: any) => {\n      console.log('收到自定义错误清除事件:', event);\n      handleErrorClearedEvent();\n    };\n\n    // 添加事件监听器\n    window.addEventListener('focus', handleFocus);\n    window.addEventListener('emergency_error_added', handleCustomError);\n    window.addEventListener('emergency_errors_cleared', handleCustomErrorCleared);\n\n    return () => {\n      window.removeEventListener('focus', handleFocus);\n      window.removeEventListener('emergency_error_added', handleCustomError);\n      window.removeEventListener('emergency_errors_cleared', handleCustomErrorCleared);\n    };\n  }, []);\n\n  const getSeverityColor = (severity: string) => {\n    switch (severity) {\n      case 'critical': return 'bg-red-100 border-red-500 text-red-800';\n      case 'high': return 'bg-orange-100 border-orange-500 text-orange-800';\n      case 'medium': return 'bg-yellow-100 border-yellow-500 text-yellow-800';\n      case 'low': return 'bg-blue-100 border-blue-500 text-blue-800';\n      default: return 'bg-gray-100 border-gray-500 text-gray-800';\n    }\n  };\n\n  const getSeverityText = (severity: string) => {\n    switch (severity) {\n      case 'critical': return '严重';\n      case 'high': return '高';\n      case 'medium': return '中';\n      case 'low': return '低';\n      default: return '未知';\n    }\n  };\n\n  const getErrorTypeText = (type: string) => {\n    switch (type) {\n      case 'network_error': return '网络错误';\n      case 'api_error': return 'API错误';\n      case 'system_error': return '系统错误';\n      default: return type;\n    }\n  };\n\n  const formatTime = (timestamp: number) => {\n    return new Date(timestamp).toLocaleString('zh-CN');\n  };\n\n  if (!isVisible || errors.length === 0) {\n    return null;\n  }\n\n  return (\n    <div className=\"fixed top-4 left-4 right-4 z-50 max-w-2xl mx-auto\">\n      <div className=\"bg-white border border-red-300 rounded-lg shadow-lg p-4\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <h3 className=\"text-lg font-semibold text-red-800 flex items-center\">\n            <span className=\"mr-2\">⚠️</span>\n            发现 {errors.length} 个错误\n          </h3>\n          <button\n            onClick={clearErrors}\n            className=\"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 text-sm\"\n          >\n            我已知道\n          </button>\n        </div>\n        \n        <div className=\"max-h-64 overflow-y-auto space-y-2\">\n          {errors.slice(0, 3).map((error) => (\n            <div\n              key={error.id}\n              className={`p-3 rounded border-l-4 ${getSeverityColor(error.severity)}`}\n            >\n              <div className=\"flex items-center justify-between mb-1\">\n                <span className=\"font-medium text-sm\">\n                  {getErrorTypeText(error.errorType)}\n                </span>\n                <span className=\"text-xs opacity-75\">\n                  {getSeverityText(error.severity)} | {formatTime(error.timestamp)}\n                </span>\n              </div>\n              \n              <p className=\"text-sm mb-2\">{error.message}</p>\n              \n              {error.context && Object.keys(error.context).length > 0 && (\n                <div className=\"text-xs opacity-75\">\n                  <strong>上下文:</strong>\n                  {Object.entries(error.context).map(([key, value]) => (\n                    <span key={key} className=\"ml-2\">\n                      {key}: {value}\n                    </span>\n                  ))}\n                </div>\n              )}\n              \n              {error.stackTrace && (\n                <details className=\"mt-2\">\n                  <summary className=\"text-xs cursor-pointer opacity-75\">\n                    查看详细错误信息\n                  </summary>\n                  <pre className=\"text-xs mt-1 p-2 bg-gray-100 rounded overflow-x-auto whitespace-pre-wrap\">\n                    {error.stackTrace}\n                  </pre>\n                </details>\n              )}\n            </div>\n          ))}\n          \n          {errors.length > 3 && (\n            <div className=\"text-center text-sm text-gray-600 py-2\">\n              还有 {errors.length - 3} 个错误未显示...\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n","import React, { useState, useEffect } from 'react';\nimport { Box, Typography, useTheme, IconButton } from '@mui/material';\nimport { PlayArrow, Pause, RestartAlt } from '@mui/icons-material';\n\ninterface FallRescueAnimationProps {\n    isVisible?: boolean;\n    type?: 'fall' | 'shake';\n    onAnimationComplete?: () => void;\n}\n\n// 动画阶段枚举\nenum AnimationPhase {\n    WALKING = 'WALKING',\n    DIZZY = 'DIZZY',\n    FALLING = 'FALLING',\n    PHONE_ALERT = 'PHONE_ALERT',\n    TEXT_DISPLAY = 'TEXT_DISPLAY'\n}\n\nconst FallRescueAnimation: React.FC<FallRescueAnimationProps> = ({\n    isVisible = true,\n    type = 'fall',\n    onAnimationComplete\n}) => {\n    const theme = useTheme();\n    \n    // 动画状态\n    const [currentPhase, setCurrentPhase] = useState<AnimationPhase>(AnimationPhase.WALKING);\n    const [isFalling, setIsFalling] = useState(false);\n    const [showPhone, setShowPhone] = useState(false);\n    const [showTextDisplay, setShowTextDisplay] = useState(false);\n    const [currentTextIndex, setCurrentTextIndex] = useState(0);\n    const [currentCharIndex, setCurrentCharIndex] = useState(0);\n    \n    // 轮播控制状态\n    const [isLooping, setIsLooping] = useState(true);\n    const [loopCount, setLoopCount] = useState(0);\n\n    // 动画序列控制\n    useEffect(() => {\n        if (!isVisible) return;\n\n        const runAnimationSequence = async () => {\n            while (isVisible && isLooping) {\n                // 阶段1: 正常走路 (2秒)\n                setIsFalling(false);\n                setCurrentPhase(AnimationPhase.WALKING);\n                await new Promise(resolve => setTimeout(resolve, 2000));\n\n                if (!isVisible || !isLooping) break;\n\n                // 阶段2: 头晕 (2秒) \n                setCurrentPhase(AnimationPhase.DIZZY);\n                await new Promise(resolve => setTimeout(resolve, 2000));\n\n                if (!isVisible || !isLooping) break;\n\n                // 阶段3: 摔倒 (3秒) - 三维向后仰倒\n                setCurrentPhase(AnimationPhase.FALLING);\n                setIsFalling(true);\n                await new Promise(resolve => setTimeout(resolve, 3000));\n\n                if (!isVisible || !isLooping) break;\n\n                // 阶段4: 手机报警 (10秒) - 显示手机和报警文字\n                setCurrentPhase(AnimationPhase.PHONE_ALERT);\n                setShowPhone(true);\n                await new Promise(resolve => setTimeout(resolve, 10000));\n\n                if (!isVisible || !isLooping) break;\n\n                // 阶段5: 文字展示 (30秒左右) - 清空画面显示宣传文字\n                setCurrentPhase(AnimationPhase.TEXT_DISPLAY);\n                setShowPhone(false);\n                setIsFalling(false);\n                setShowTextDisplay(true);\n                setCurrentTextIndex(0);\n                setCurrentCharIndex(0);\n                \n                // 执行逐字显示动画\n                await new Promise(resolve => {\n                    const textLines = [\n                        '紧急呼救，守护您的安全',\n                        '同时联系多人',\n                        '实时同步地理位置',\n                        '多人同时音视频',\n                        '手机自动向周边行人呼救'\n                    ];\n                    \n                    let totalTime = 0;\n                    let lineIndex = 0;\n                    let charIndex = 0;\n                    \n                    const typeChar = () => {\n                        if (!isVisible || !isLooping) {\n                            resolve(undefined);\n                            return;\n                        }\n                        \n                        if (lineIndex < textLines.length) {\n                            if (charIndex < textLines[lineIndex].length) {\n                                setCurrentTextIndex(lineIndex);\n                                setCurrentCharIndex(charIndex + 1);\n                                charIndex++;\n                                setTimeout(typeChar, 350); // 0.35秒一个字\n                                totalTime += 1000;\n                            } else {\n                                // 当前行完成，等待1秒后开始下一行\n                                lineIndex++;\n                                charIndex = 0;\n                                setTimeout(typeChar, 350);\n                                totalTime += 1000;\n                            }\n                        } else {\n                            // 所有文字显示完成，等待3秒\n                            setTimeout(() => resolve(undefined), 3000);\n                        }\n                    };\n                    \n                    typeChar();\n                });\n\n                if (!isVisible || !isLooping) break;\n\n                // 更新轮播计数\n                setLoopCount(prev => prev + 1);\n                \n                // 重置状态准备下一轮\n                setIsFalling(false);\n                setShowPhone(false);\n                setShowTextDisplay(false);\n                setCurrentTextIndex(0);\n                setCurrentCharIndex(0);\n                \n                // 轮播间隔 (1秒)\n                await new Promise(resolve => setTimeout(resolve, 1000));\n            }\n            \n            onAnimationComplete?.();\n        };\n\n        runAnimationSequence();\n\n        return () => {\n            setIsLooping(false);\n        };\n    }, [isVisible, isLooping, onAnimationComplete]);\n\n    // 轮播控制功能\n    // const pauseAnimation = () => setIsLooping(false);\n    // const resumeAnimation = () => setIsLooping(true);\n    // const restartAnimation = () => {\n    //     setLoopCount(0);\n    //     setIsLooping(true);\n    // };\n\n    // 获取当前阶段的内容\n    const getPhaseContent = () => {\n        switch (currentPhase) {\n            case AnimationPhase.WALKING:\n                return {\n                    person: '🚶',\n                    tip: '正常走路'\n                };\n            case AnimationPhase.DIZZY:\n                return {\n                    person: '🤦',\n                    tip: '头晕'\n                };\n            case AnimationPhase.FALLING:\n                return {\n                    person: '🧍',\n                    tip: '摔倒'\n                };\n            case AnimationPhase.PHONE_ALERT:\n                return {\n                    person: '🧍',\n                    tip: '手机自动呼救中...'\n                };\n            case AnimationPhase.TEXT_DISPLAY:\n                return {\n                    person: '',\n                    tip: ''\n                };\n            default:\n                return {\n                    person: '🚶',\n                    tip: '正常走路'\n                };\n        }\n    };\n\n    const phaseContent = getPhaseContent();\n\n    return (\n        <Box\n            sx={{\n                width: '100%',\n                height: '300px',\n                position: 'relative',\n                backgroundColor: '#FFFFFF',\n                borderRadius: 1,\n                overflow: 'hidden',\n                perspective: '1500px' // 增强3D透视效果\n            }}\n        >\n            {/* 地面 */}\n            <Box\n                sx={{\n                    position: 'absolute',\n                    bottom: 0,\n                    left: 0,\n                    right: 0,\n                    height: '20%',\n                    backgroundColor: '#F5F5F5'\n                }}\n            />\n\n            {/* 人物阴影 - 仅在摔倒时显示 */}\n            {isFalling && (\n                <Box\n                    sx={{\n                        position: 'absolute',\n                        left: '50%',\n                        bottom: '20%',\n                        width: '80px',\n                        height: '20px',\n                        borderRadius: '50%',\n                        backgroundColor: 'rgba(0, 0, 0, 0.2)',\n                        transform: 'translateX(-50%)',\n                        filter: 'blur(3px)',\n                        zIndex: 0\n                    }}\n                />\n            )}\n\n            {/* 人物 */}\n            <Box\n                sx={{\n                    position: 'absolute',\n                    left: '50%',\n                    bottom: '25%',\n                    fontSize: '120px',\n                    transform: `translateX(-50%) ${(isFalling || showPhone) ? 'rotateX(-45deg) rotateY(15deg) rotateZ(-15deg) translateZ(25px)' : 'rotateX(0deg) rotateY(0deg) rotateZ(0deg)'}`,\n                    transition: (isFalling || showPhone) ? 'transform 2.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)' : 'none',\n                    transformOrigin: 'center 80%',\n                    transformStyle: 'preserve-3d',\n                    zIndex: 1\n                }}\n            >\n                {phaseContent.person}\n            </Box>\n\n            {/* 手机 - 仅在报警阶段显示 */}\n            {showPhone && (\n                <Box\n                    sx={{\n                        position: 'absolute',\n                        left: '58%',\n                        bottom: '32%',\n                        fontSize: '60px',\n                        zIndex: 2,\n                        animation: 'phoneVibrate 0.1s infinite',\n                        '@keyframes phoneVibrate': {\n                            '0%': { transform: 'translateX(0px) translateY(0px)' },\n                            '25%': { transform: 'translateX(1px) translateY(1px)' },\n                            '50%': { transform: 'translateX(-1px) translateY(0px)' },\n                            '75%': { transform: 'translateX(1px) translateY(-1px)' },\n                            '100%': { transform: 'translateX(0px) translateY(0px)' }\n                        }\n                    }}\n                >\n                    📱\n                </Box>\n            )}\n\n            {/* 头顶文字 */}\n            <Box\n                sx={{\n                    position: 'absolute',\n                    left: '50%',\n                    top: 'calc(15% - 25px)',\n                    transform: 'translateX(-50%)',\n                    textAlign: 'center',\n                    zIndex: 10\n                }}\n            >\n                <Typography\n                    variant=\"h6\"\n                    sx={{\n                        color: '#1976D2',\n                        fontWeight: 'bold',\n                        backgroundColor: 'rgba(255, 255, 255, 0.9)',\n                        px: 2,\n                        py: 1,\n                        borderRadius: 2,\n                        boxShadow: '0 2px 8px rgba(0,0,0,0.15)',\n                        fontSize: '18px'\n                    }}\n                >\n                    {phaseContent.tip}\n                </Typography>\n            </Box>\n\n            {/* 左上角女儿接电话场景 - 仅在报警阶段显示 */}\n            {showPhone && (\n                <Box\n                    sx={{\n                        position: 'absolute',\n                        top: 8,\n                        left: 8,\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: 1,\n                        backgroundColor: 'rgba(255, 255, 255, 0.95)',\n                        borderRadius: 2,\n                        padding: 1.5,\n                        boxShadow: '0 4px 12px rgba(0,0,0,0.2)',\n                        zIndex: 10\n                    }}\n                >\n                    {/* 女儿头像 */}\n                    <Box sx={{ fontSize: '40px' }}>\n                        👩🏻‍🦰\n                    </Box>\n                    \n                    {/* 缩小的手机图标 */}\n                    <Box sx={{ \n                        fontSize: '24px',\n                        animation: 'phoneVibrate 0.1s infinite'\n                    }}>\n                        📱\n                    </Box>\n                </Box>\n            )}\n\n            {/* 右上角爸爸接电话场景 - 仅在报警阶段显示 */}\n            {showPhone && (\n                <Box\n                    sx={{\n                        position: 'absolute',\n                        top: 8,\n                        right: 8,\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: 1,\n                        backgroundColor: 'rgba(255, 255, 255, 0.95)',\n                        borderRadius: 2,\n                        padding: 1.5,\n                        boxShadow: '0 4px 12px rgba(0,0,0,0.2)',\n                        zIndex: 10\n                    }}\n                >\n                    {/* 爸爸头像 */}\n                    <Box sx={{ fontSize: '40px' }}>\n                        👨🏻\n                    </Box>\n                    \n                    {/* 缩小的手机图标 */}\n                    <Box sx={{ \n                        fontSize: '24px',\n                        animation: 'phoneVibrate 0.1s infinite'\n                    }}>\n                        📱\n                    </Box>\n                </Box>\n            )}\n\n            {/* 右上角爸爸对话文字 - 仅在报警阶段显示 */}\n            {showPhone && (\n                <Box\n                    sx={{\n                        position: 'absolute',\n                        top: 70,\n                        right: 8,\n                        backgroundColor: 'rgba(255, 255, 255, 0.95)',\n                        borderRadius: 2,\n                        padding: 1,\n                        boxShadow: '0 2px 8px rgba(0,0,0,0.15)',\n                        zIndex: 10,\n                        maxWidth: '200px'\n                    }}\n                >\n                    <Typography\n                        variant=\"body2\"\n                        sx={{\n                            color: '#000',\n                            fontWeight: 'bold',\n                            fontSize: '14px'\n                        }}\n                    >\n                        爸，您怎么摔倒了\n                    </Typography>\n                </Box>\n            )}\n\n            {/* 左上角女儿滚动文字 - 仅在报警阶段显示 */}\n            {showPhone && (\n                <Box\n                    sx={{\n                        position: 'absolute',\n                        top: 70,\n                        left: 8,\n                        backgroundColor: 'rgba(255, 255, 255, 0.95)',\n                        borderRadius: 2,\n                        padding: 1,\n                        boxShadow: '0 2px 8px rgba(0,0,0,0.15)',\n                        zIndex: 10,\n                        maxWidth: '250px',\n                        minHeight: '60px',\n                        overflow: 'hidden'\n                    }}\n                >\n                    <Typography\n                        variant=\"body2\"\n                        sx={{\n                            color: '#000',\n                            fontWeight: 'bold',\n                            fontSize: '14px',\n                            lineHeight: 1.4\n                        }}\n                    >\n                        爸，您怎么摔倒了\n                        <br />\n                        女儿已通过视频看到现场画面\n                    </Typography>\n                </Box>\n            )}\n\n            {/* 左下角朋友场景 - 仅在报警阶段显示 */}\n            {showPhone && (\n                <Box\n                    sx={{\n                        position: 'absolute',\n                        bottom: 60,\n                        left: 8,\n                        display: 'flex',\n                        alignItems: 'center',\n                        gap: 1,\n                        backgroundColor: 'rgba(255, 255, 255, 0.95)',\n                        borderRadius: 2,\n                        padding: 1.5,\n                        boxShadow: '0 4px 12px rgba(0,0,0,0.2)',\n                        zIndex: 10\n                    }}\n                >\n                    {/* 朋友头像 */}\n                    <Box sx={{ fontSize: '40px' }}>\n                        🧔🏻\n                    </Box>\n                    \n                    {/* 缩小的手机图标 */}\n                    <Box sx={{ \n                        fontSize: '24px',\n                        animation: 'phoneVibrate 0.1s infinite'\n                    }}>\n                        📱\n                    </Box>\n                </Box>\n            )}\n\n            {/* 左下角朋友对话文字 - 仅在报警阶段显示 */}\n            {showPhone && (\n                <Box\n                    sx={{\n                        position: 'absolute',\n                        bottom: 130,\n                        left: 8,\n                        backgroundColor: 'rgba(255, 255, 255, 0.95)',\n                        borderRadius: 2,\n                        padding: 1,\n                        boxShadow: '0 2px 8px rgba(0,0,0,0.15)',\n                        zIndex: 10,\n                        maxWidth: '280px'\n                    }}\n                >\n                    <Typography\n                        variant=\"body2\"\n                        sx={{\n                            color: '#000',\n                            fontWeight: 'bold',\n                            fontSize: '14px'\n                        }}\n                    >\n                        老李，我离你一百米，马上到\n                    </Typography>\n                </Box>\n            )}\n\n            {/* 右下角救护车场景 - 仅在报警阶段显示 */}\n            {showPhone && (\n                <Box\n                    sx={{\n                        position: 'absolute',\n                        bottom: 60,\n                        right: 8,\n                        display: 'flex',\n                        flexDirection: 'column',\n                        alignItems: 'center',\n                        gap: 1,\n                        backgroundColor: 'rgba(255, 255, 255, 0.95)',\n                        borderRadius: 2,\n                        padding: 1.5,\n                        boxShadow: '0 4px 12px rgba(0,0,0,0.2)',\n                        zIndex: 10\n                    }}\n                >\n                    {/* 救护车图标 */}\n                    <Box sx={{ \n                        fontSize: '50px',\n                        animation: 'ambulanceMove 1s ease-in-out infinite',\n                        '@keyframes ambulanceMove': {\n                            '0%': { transform: 'translateY(0px)' },\n                            '50%': { transform: 'translateY(-3px)' },\n                            '100%': { transform: 'translateY(0px)' }\n                        }\n                    }}>\n                        🚑\n                    </Box>\n                    \n                    {/* 救护车文字 */}\n                    <Typography\n                        variant=\"caption\"\n                        sx={{\n                            color: '#000',\n                            fontWeight: 'bold',\n                            fontSize: '12px',\n                            textAlign: 'center'\n                        }}\n                    >\n                        救护车赶往现场\n                    </Typography>\n                </Box>\n            )}\n\n            {/* 文字展示阶段 - 清空所有其他内容 */}\n            {showTextDisplay && (\n                <Box\n                    sx={{\n                        position: 'absolute',\n                        top: 0,\n                        left: 0,\n                        right: 0,\n                        bottom: 0,\n                        backgroundColor: '#ffffff',\n                        display: 'flex',\n                        flexDirection: 'column',\n                        justifyContent: 'center',\n                        alignItems: 'center',\n                        zIndex: 100,\n                        padding: 4\n                    }}\n                >\n                    {[\n                        '紧急呼救，守护您的安全',\n                        '同时联系多人',\n                        '实时同步地理位置',\n                        '多人同时音视频',\n                        '手机自动向周边行人呼救'\n                    ].map((text, lineIndex) => (\n                        <Box\n                            key={lineIndex}\n                            sx={{\n                                marginBottom: 1.5,\n                                minHeight: '40px',\n                                display: 'flex',\n                                alignItems: 'center',\n                                width: '100%',\n                                justifyContent: 'center'\n                            }}\n                        >\n                            <Typography\n                                variant=\"h4\"\n                                sx={{\n                                    fontSize: { xs: '20px', sm: '24px', md: '28px' },\n                                    fontWeight: 'bold',\n                                    color: '#1976D2',\n                                    textAlign: 'center',\n                                    lineHeight: 1.2\n                                }}\n                            >\n                                {lineIndex <= currentTextIndex ? \n                                    (lineIndex === currentTextIndex ? \n                                        text.substring(0, currentCharIndex) : \n                                        text) \n                                    : ''\n                                }\n                                {lineIndex === currentTextIndex && currentCharIndex < text.length && (\n                                    <Box\n                                        component=\"span\"\n                                        sx={{\n                                            display: 'inline-block',\n                                            width: '3px',\n                                            height: '1em',\n                                            backgroundColor: '#1976D2',\n                                            marginLeft: '2px',\n                                            animation: 'blink 1s infinite',\n                                            '@keyframes blink': {\n                                                '0%, 50%': { opacity: 1 },\n                                                '51%, 100%': { opacity: 0 }\n                                            }\n                                        }}\n                                    />\n                                )}\n                            </Typography>\n                        </Box>\n                    ))}\n                </Box>\n            )}\n\n        </Box>\n    );\n};\n\nexport default FallRescueAnimation;","import React, { useState, useEffect } from 'react';\nimport {\n  Box,\n  Typography,\n  Paper,\n  List,\n  ListItem,\n  Button,\n  Chip,\n  Alert,\n  IconButton,\n  Tooltip,\n  CircularProgress,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n  Divider\n} from '@mui/material';\nimport {\n  CheckCircle as CheckCircleIcon,\n  Error as ErrorIcon,\n  Help as HelpIcon,\n  Settings as SettingsIcon,\n  Refresh as RefreshIcon,\n  Security as SecurityIcon,\n  Info as InfoIcon\n} from '@mui/icons-material';\nimport { autoWebViewJs, isRealInAndroid } from '@droid/android';\nimport { trackingPrint } from '@app/model';\n\n// 与摔倒检测无关的权限ID列表\nconst FALL_DETECTION_EXCLUDED_PERMISSIONS = [\n  'notification',           // 消息推送 - 与摔倒检测无直接关联\n  'desktop_shortcut'        // 桌面快捷方式 - 与摔倒检测无直接关联\n];\n\ninterface Permission {\n  id: string;\n  name: string;\n  type: 'runtime' | 'special' | 'vendor';\n  status: 'granted' | 'denied' | 'unknown';\n  canDetect: boolean;\n  description: string;\n  settingsAction: string;\n}\n\ninterface PermissionsData {\n  permissions: Permission[];\n  timestamp: number;\n  deviceBrand: string;\n  apiLevel: number;\n  error?: string;\n}\n\ninterface PermissionStatusPanelProps {\n  isExpanded: boolean;\n  onStatsChange: (stats: { granted: number; denied: number; unknown: number }) => void;\n}\n\nexport const PermissionStatusPanel: React.FC<PermissionStatusPanelProps> = ({\n  isExpanded,\n  onStatsChange\n}) => {\n  const [permissionsData, setPermissionsData] = useState<PermissionsData | null>(null);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [infoDialogOpen, setInfoDialogOpen] = useState(false);\n  const [selectedPermission, setSelectedPermission] = useState<Permission | null>(null);\n\n  const fetchPermissions = async () => {\n    try {\n      if(!isRealInAndroid) return;\n      setLoading(true);\n      setError(null);\n      \n      // 权限刷新埋点\n      trackingPrint({params:{\n        type:\"用户操作\",\n        title:\"权限检查\",\n        subtitle:\"权限刷新-开始\",\n        extra:{\n          timestamp: Date.now(),\n          isAndroid: isRealInAndroid\n        }\n      }});\n      \n      const script = `\n        var info = com.fanfanlo.emergencycall.manager.PermissionJSInterface.getAllPermissionsStatus();\n        info;\n      `;\n      \n      const { javaResultString } = autoWebViewJs.callScript(script);\n      \n      if (!javaResultString) {\n        throw new Error('No response from permission interface');\n      }\n      \n      const data = JSON.parse(javaResultString) as PermissionsData;\n      \n      if (data.error) {\n        throw new Error(data.error);\n      }\n      \n      setPermissionsData(data);\n      console.log('Permissions data loaded:', data);\n      \n      // 权限加载成功埋点\n      trackingPrint({params:{\n        type:\"系统事件\",\n        title:\"权限检查\",\n        subtitle:\"权限加载-成功\",\n        extra:{\n          timestamp: Date.now(),\n          permissionsCount: data.permissions.length,\n          grantedCount: data.permissions.filter(p => p.status === 'granted').length,\n          deniedCount: data.permissions.filter(p => p.status === 'denied').length,\n          unknownCount: data.permissions.filter(p => p.status === 'unknown').length,\n          deviceBrand: data.deviceBrand,\n          apiLevel: data.apiLevel\n        }\n      }});\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Unknown error';\n      setError(errorMessage);\n      console.error('Error fetching permissions:', err);\n      \n      // 权限加载失败埋点\n      trackingPrint({params:{\n        type:\"系统异常\",\n        title:\"权限检查\",\n        subtitle:\"权限加载-失败\",\n        extra:{\n          timestamp: Date.now(),\n          error: errorMessage,\n          isAndroid: isRealInAndroid\n        }\n      }});\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // 过滤摔倒检测相关权限\n  const filterRelevantPermissions = (permissions: Permission[]): Permission[] => {\n    return permissions.filter(permission => \n      !FALL_DETECTION_EXCLUDED_PERMISSIONS.includes(permission.id)\n    );\n  };\n\n  // 计算统计数据并上报\n  const updateStats = (permissions: Permission[]) => {\n    // 先过滤出摔倒检测相关权限\n    const relevantPermissions = filterRelevantPermissions(permissions);\n    \n    const granted = relevantPermissions.filter(p => p.status === 'granted').length;\n    const denied = relevantPermissions.filter(p => p.status === 'denied').length;\n    const unknown = relevantPermissions.filter(p => p.status === 'unknown').length;\n    onStatsChange({ granted, denied, unknown });\n  };\n\n  useEffect(() => {\n    fetchPermissions();\n  }, []);\n\n  // 定时刷新逻辑 - 只在展开时启动\n  useEffect(() => {\n    let intervalId: NodeJS.Timeout | null = null;\n    \n    if (isExpanded && permissionsData) {\n      intervalId = setInterval(() => {\n        fetchPermissions();\n      }, 1500); // 每1.5秒刷新一次\n    }\n    \n    return () => {\n      if (intervalId) {\n        clearInterval(intervalId);\n      }\n    };\n  }, [isExpanded, permissionsData]);\n\n  // 监听权限数据变化，更新统计\n  useEffect(() => {\n    if (permissionsData?.permissions) {\n      updateStats(permissionsData.permissions);\n    }\n  }, [permissionsData, onStatsChange]);\n\n  const handleOpenSettings = (permission: Permission) => {\n    try {\n      // 权限设置按钮点击埋点\n      trackingPrint({params:{\n        type:\"用户操作\",\n        title:\"权限设置\",\n        subtitle:\"设置按钮-点击\",\n        extra:{\n          timestamp: Date.now(),\n          permissionId: permission.id,\n          permissionName: permission.name,\n          permissionType: permission.type,\n          currentStatus: permission.status,\n          canDetect: permission.canDetect\n        }\n      }});\n      \n      const script = `\n        com.fanfanlo.emergencycall.manager.PermissionJSInterface.openPermissionSettings(\"${permission.id}\");\n      `;\n      autoWebViewJs.callScript(script);\n      console.log(`Opening settings for permission: ${permission.id}`);\n      \n      // 如果是消息推送权限，用户从设置页面返回后自动检查JPush状态\n      if (permission.id === 'notification') {\n        // 延迟执行，给用户时间完成权限设置\n        setTimeout(() => {\n          try {\n            const jpushScript = `\n              com.fanfanlo.emergencycall.jpush.JpushManager.checkAndReinitializeIfNeeded();\n            `;\n            autoWebViewJs.callScript(jpushScript);\n            console.log('JPush reinitialization check triggered');\n            \n            // 刷新权限状态\n            setTimeout(() => fetchPermissions(), 1000);\n          } catch (jpushErr) {\n            console.error('Error checking JPush status:', jpushErr);\n            \n            // JPush重新初始化失败埋点\n            trackingPrint({params:{\n              type:\"系统异常\",\n              title:\"JPush重初始化\",\n              subtitle:\"JPush-重初始化失败\",\n              extra:{\n                timestamp: Date.now(),\n                error: jpushErr instanceof Error ? jpushErr.message : String(jpushErr)\n              }\n            }});\n          }\n        }, 3000); // 3秒后检查\n      }\n    } catch (err) {\n      console.error('Error opening permission settings:', err);\n      \n      // 权限设置打开失败埋点\n      trackingPrint({params:{\n        type:\"系统异常\",\n        title:\"权限设置\",\n        subtitle:\"设置打开-失败\",\n        extra:{\n          timestamp: Date.now(),\n          permissionId: permission.id,\n          error: err instanceof Error ? err.message : String(err)\n        }\n      }});\n    }\n  };\n\n  // const handleConfirmLockScreenPermission = () => {\n  //   try {\n  //     // 锁屏权限确认埋点\n  //     trackingPrint({params:{\n  //       type:\"用户操作\",\n  //       title:\"锁屏权限\",\n  //       subtitle:\"权限确认-点击\",\n  //       extra:{\n  //         timestamp: Date.now()\n  //       }\n  //     }});\n      \n  //     const script = `\n  //       com.fanfanlo.emergencycall.manager.PermissionJSInterface.confirmLockScreenPermission();\n  //     `;\n  //     autoWebViewJs.callScript(script);\n  //     console.log('Confirmed lock screen permission');\n      \n  //     // 刷新权限状态\n  //     setTimeout(() => fetchPermissions(), 500);\n  //   } catch (err) {\n  //     console.error('Error confirming lock screen permission:', err);\n      \n  //     // 锁屏权限确认失败埋点\n  //     trackingPrint({params:{\n  //       type:\"系统异常\",\n  //       title:\"锁屏权限\",\n  //       subtitle:\"权限确认-失败\",\n  //       extra:{\n  //         timestamp: Date.now(),\n  //         error: err instanceof Error ? err.message : String(err)\n  //       }\n  //     }});\n  //   }\n  // };\n\n  const handleShowPermissionInfo = (permission: Permission) => {\n    // 权限信息查看埋点\n    trackingPrint({params:{\n      type:\"用户操作\",\n      title:\"权限信息\",\n      subtitle:\"信息按钮-点击\",\n      extra:{\n        timestamp: Date.now(),\n        permissionId: permission.id,\n        permissionName: permission.name,\n        permissionStatus: permission.status\n      }\n    }});\n    \n    setSelectedPermission(permission);\n    setInfoDialogOpen(true);\n  };\n\n  const handleCloseInfoDialog = () => {\n    // 权限信息对话框关闭埋点\n    trackingPrint({params:{\n      type:\"模态框操作\",\n      title:\"权限信息\",\n      subtitle:\"信息对话框-关闭\",\n      extra:{\n        timestamp: Date.now(),\n        permissionId: selectedPermission?.id\n      }\n    }});\n    \n    setInfoDialogOpen(false);\n    setSelectedPermission(null);\n  };\n\n  const getPermissionReason = (permission: Permission): string => {\n    const reasonMap: Record<string, string> = {\n      'android.permission.ACCESS_FINE_LOCATION': '精确定位权限用于在紧急情况下获取您的准确位置信息，以便救援人员能够快速找到您。这对于户外活动、老人独居等场景下的紧急救助至关重要。',\n      'android.permission.ACCESS_COARSE_LOCATION': '大概位置权限作为精确定位的备用选择，在精确定位不可用时仍能提供基本的位置信息，确保紧急情况下不会完全失去位置服务。',\n      'android.permission.BODY_SENSORS': '身体传感器权限用于访问手机的加速度计、陀螺仪等传感器，实现跌倒检测功能。当检测到您可能发生跌倒时，系统会自动触发紧急呼叫，对老人和高危工作者尤为重要。',\n      'android.permission.CAMERA': '相机权限用于在紧急情况下自动拍摄现场照片，为救援人员和家属提供重要的环境信息，帮助判断紧急情况的严重程度和选择合适的救援方案。',\n      'android.permission.RECORD_AUDIO': '录音权限用于记录紧急情况发生时的环境声音，可以为救援人员提供重要线索，同时支持语音紧急呼叫功能，让您在无法操作手机时也能求救。',\n      'android.permission.ACTIVITY_RECOGNITION': '身体活动识别权限用于识别您当前的活动状态(如走路、跑步、静止等)，结合传感器数据提高跌倒检测的准确性，减少误报的同时确保真正的紧急情况不会被遗漏。',\n      'overlay': '悬浮窗权限允许应用在任何界面上显示紧急呼叫窗口，确保即使您在使用其他应用时，紧急呼叫功能也能立即激活，不会被其他应用界面阻挡。',\n      'lock_screen_popup': '后台弹出界面权限确保应用在后台运行时仍能在检测到紧急情况时立即弹出呼叫界面，即使手机处于息屏或锁定状态也不会影响紧急功能的响应速度。',\n      'lock_screen_display': '锁屏显示权限允许应用在手机锁屏状态下显示紧急信息和呼叫界面，确保紧急情况发生时不会因为屏幕锁定而延误救援时机。这对于意外昏迷等无法解锁手机的情况尤为重要。',\n      'desktop_shortcut': '桌面快捷方式权限允许应用在桌面创建一键紧急呼叫的快捷图标，让您在紧急情况下能够更快速地启动求救功能，特别适合老年用户或紧急情况下的快速操作。',\n      'notification': '消息推送权限用于接收紧急呼叫、跌倒检测警报、系统通知等重要消息。这是确保您能及时收到紧急信息和家人求救通知的关键权限，对于紧急救援场景至关重要。'\n    };\n    return reasonMap[permission.id] || '该权限对于应用的正常运行是必要的，请根据您的需要进行授权。';\n  };\n\n  const getPermissionImpact = (permission: Permission): string => {\n    const impactMap: Record<string, string> = {\n      'android.permission.ACCESS_FINE_LOCATION': '🚨 高影响：没有位置权限将无法在紧急情况下提供准确的位置信息给救援人员',\n      'android.permission.ACCESS_COARSE_LOCATION': '⚠️ 中影响：作为位置服务的备用选择，建议配合精确位置一起授权',\n      'android.permission.BODY_SENSORS': '🚨 高影响：没有此权限将无法实现自动跌倒检测功能',\n      'android.permission.CAMERA': '⚠️ 中影响：无法自动拍摄现场照片，但不影响基本呼叫功能',\n      'android.permission.RECORD_AUDIO': '⚠️ 中影响：无法录制环境音或使用语音功能，但不影响基本呼叫功能',\n      'android.permission.ACTIVITY_RECOGNITION': '⚠️ 中影响：跌倒检测准确性可能降低，增加误报或漏报风险',\n      'overlay': '🚨 高影响：无法在其他应用界面上显示紧急呼叫，可能错过紧急救援时机',\n      'lock_screen_popup': '🚨 高影响：手机锁屏时无法自动弹出紧急呼叫界面',\n      'lock_screen_display': '🚨 高影响：锁屏状态下无法显示紧急信息，可能延误救援',\n      'desktop_shortcut': '💡 低影响：无法创建桌面快捷方式，但不影响应用内的紧急呼叫功能',\n      'notification': '🚨 高影响：无法接收紧急推送消息，可能错过家人求救信号或重要安全警报'\n    };\n    return impactMap[permission.id] || '该权限的具体影响取决于您的使用场景。';\n  };\n\n  const getStatusIcon = (permission: Permission) => {\n    const iconProps = { fontSize: 18 };\n    switch (permission.status) {\n      case 'granted':\n        return <CheckCircleIcon sx={{ color: 'success.main', ...iconProps }} />;\n      case 'denied':\n        return <ErrorIcon sx={{ color: 'error.main', ...iconProps }} />;\n      case 'unknown':\n        return <HelpIcon sx={{ color: 'warning.main', ...iconProps }} />;\n      default:\n        return <HelpIcon sx={{ color: 'grey.500', ...iconProps }} />;\n    }\n  };\n\n  const getStatusChip = (permission: Permission) => {\n    const statusConfig = {\n      granted: { label: '✓', color: 'success' as const },\n      denied: { label: '✗', color: 'error' as const },\n      unknown: { label: '?', color: 'warning' as const }\n    };\n\n    const config = statusConfig[permission.status];\n    return (\n      <Chip \n        label={config.label} \n        color={config.color} \n        size=\"small\"\n        sx={{ \n          minWidth: 24,\n          height: 20,\n          fontSize: '0.7rem',\n          '& .MuiChip-label': { px: 0.5 }\n        }}\n      />\n    );\n  };\n\n  const getTypeLabel = (type: string) => {\n    const typeLabels = {\n      runtime: '运行时',\n      special: '特殊',\n      vendor: '厂商'\n    };\n    return typeLabels[type as keyof typeof typeLabels] || type;\n  };\n\n  if (loading) {\n    return (\n      <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\" minHeight=\"120px\">\n        <CircularProgress size={20} />\n        <Typography variant=\"caption\" sx={{ ml: 1 }}>加载中...</Typography>\n      </Box>\n    );\n  }\n\n  if (error) {\n    return (\n      <Alert severity=\"error\" sx={{ py: 1 }}>\n        <Typography variant=\"body2\">权限检查失败: {error}</Typography>\n        <Button \n          onClick={() => {\n            // 重试按钮点击埋点\n            trackingPrint({params:{\n              type:\"用户操作\",\n              title:\"权限检查\",\n              subtitle:\"重试按钮-点击\",\n              extra:{\n                timestamp: Date.now(),\n                previousError: error\n              }\n            }});\n            fetchPermissions();\n          }} \n          size=\"small\" \n          sx={{ mt: 0.5 }}\n        >\n          重试\n        </Button>\n      </Alert>\n    );\n  }\n\n  if (!permissionsData) {\n    return (\n      <Alert severity=\"info\" sx={{ py: 1 }}>\n        <Typography variant=\"body2\">无权限数据，请重新加载</Typography>\n      </Alert>\n    );\n  }\n\n  const { permissions, deviceBrand, apiLevel } = permissionsData;\n  // 过滤出摔倒检测相关权限\n  const relevantPermissions = filterRelevantPermissions(permissions);\n\n  return (\n    <Paper elevation={1} sx={{ p: 1 }}>\n      {/* 标题栏 */}\n      {/* <Box display=\"flex\" alignItems=\"center\" justifyContent=\"space-between\" mb={1}>\n        <Box display=\"flex\" alignItems=\"center\">\n          <SecurityIcon sx={{ mr: 0.5, color: 'primary.main', fontSize: 18 }} />\n          <Typography variant=\"body2\" fontWeight=\"medium\">权限状态</Typography>\n        </Box>\n        <Tooltip title=\"刷新\">\n          <IconButton \n            onClick={() => {\n              // 刷新按钮点击埋点\n              trackingPrint({params:{\n                type:\"用户操作\",\n                title:\"权限检查\",\n                subtitle:\"刷新按钮-点击\",\n                extra:{\n                  timestamp: Date.now(),\n                  currentPermissionsCount: permissionsData?.permissions.length || 0\n                }\n              }});\n              fetchPermissions();\n            }} \n            size=\"small\" \n            sx={{ p: 0.5 }}\n          >\n            <RefreshIcon fontSize=\"small\" />\n          </IconButton>\n        </Tooltip>\n      </Box> */}\n\n      {/* 说明 */}\n      {/* <Alert severity=\"info\" sx={{ mb: 1, py: 0.5 }}>\n        <Typography variant=\"caption\" display=\"block\">\n          🟢已授权 🔴未授权 🟡无法检测\n        </Typography>\n        <Typography variant=\"caption\" color=\"textSecondary\">\n          {deviceBrand} • API{apiLevel}\n        </Typography>\n      </Alert> */}\n\n      {/* 权限列表 */}\n      <List sx={{ py: 0 }}>\n        {relevantPermissions.map((permission) => (\n          <ListItem\n            key={permission.id}\n            sx={{\n              borderLeft: 2,\n              borderLeftColor: \n                permission.status === 'granted' ? 'success.main' :\n                permission.status === 'denied' ? 'error.main' : 'warning.main',\n              mb: 0.5,\n              py: 0.5,\n              px: 0.5,\n              borderRadius: 0.5,\n              bgcolor: 'grey.50',\n              display: 'block' // 改为block布局\n            }}\n          >\n            {/* 第一行：图标 + 名称 + 状态 + 信息按钮 */}\n            <Box display=\"flex\" alignItems=\"center\" mb={0.5}>\n              <Box sx={{ mr: 0.5 }}>\n                {getStatusIcon(permission)}\n              </Box>\n              <Typography \n                variant=\"body2\" \n                fontWeight=\"medium\" \n                sx={{ flex: 1, minWidth: 0 }}\n              >\n                {permission.name}\n              </Typography>\n              <Tooltip title=\"查看权限说明\">\n                <IconButton\n                  size=\"large\"\n                  onClick={() => handleShowPermissionInfo(permission)}\n                  sx={{ mr: 0.5, p: 0.25 }}\n                >\n                  <InfoIcon sx={{ fontSize: 16, color: 'primary.main' }} />\n                </IconButton>\n              </Tooltip>\n              {/* {getStatusChip(permission)} */}\n            </Box>\n            \n            {/* 第二行：类型标签 + 确认信息 */}  \n            <Box display=\"flex\" alignItems=\"center\" justifyContent=\"space-between\" mb={0.5}>\n              <Box display=\"flex\" alignItems=\"center\" gap={0.5}>\n                <Chip \n                  label={getTypeLabel(permission.type)} \n                  variant=\"outlined\" \n                  size=\"small\"\n                  sx={{ \n                    fontSize: '0.65rem',\n                    height: 18,\n                    '& .MuiChip-label': { px: 0.5, py: 0 }\n                  }}\n                />\n                {!permission.canDetect && (\n                  <Typography variant=\"caption\" color=\"textSecondary\" sx={{ fontSize: '0.65rem' }}>\n                    需确认\n                  </Typography>\n                )}\n              </Box>\n            </Box>\n            \n            {/* 第三行：操作按钮 */}\n            <Box display=\"flex\" gap={0.5}>\n              {/* {(permission.id === 'lock_screen' || permission.id === 'lock_screen_popup' || permission.id === 'lock_screen_display') && permission.status === 'unknown' && (\n                <Button\n                  variant=\"outlined\"\n                  size=\"small\" \n                  color=\"success\"\n                  onClick={handleConfirmLockScreenPermission}\n                  sx={{ \n                    fontSize: '0.65rem',\n                    minWidth: 'auto',\n                    px: 0.5,\n                    py: 0.25,\n                    height: 24\n                  }}\n                >\n                  已授权\n                </Button>\n              )} */}\n              <Button\n                variant=\"outlined\"\n                size=\"small\"\n                startIcon={<SettingsIcon sx={{ fontSize: 12 }} />}\n                onClick={() => handleOpenSettings(permission)}\n                sx={{ \n                  fontSize: '0.65rem',\n                  minWidth: 'auto',\n                  px: 0.5,\n                  py: 0.25,\n                  height: 24\n                }}\n              >\n                设置\n              </Button>\n            </Box>\n          </ListItem>\n        ))}\n      </List>\n\n      {/* 底部时间戳 */}\n      {/* <Box mt={0.5} py={0.25} px={0.5} bgcolor=\"grey.100\" borderRadius={0.25}>\n        <Typography variant=\"caption\" color=\"textSecondary\" sx={{ fontSize: '0.6rem' }}>\n          更新: {new Date(permissionsData.timestamp).toLocaleTimeString()}\n          {isExpanded && <> • 每1.5秒自动刷新</>}\n        </Typography>\n      </Box> */}\n\n      {/* 权限说明对话框 */}\n      <Dialog\n        open={infoDialogOpen}\n        onClose={handleCloseInfoDialog}\n        maxWidth=\"sm\"\n        fullWidth\n        PaperProps={{\n          sx: { mx: 1 } // 移动端适配\n        }}\n      >\n        <DialogTitle sx={{ pb: 1 }}>\n          <Box display=\"flex\" alignItems=\"center\">\n            <SecurityIcon sx={{ mr: 1, color: 'primary.main' }} />\n            <Box>\n              <Typography variant=\"h6\" component=\"div\">\n                {selectedPermission?.name}\n              </Typography>\n              <Typography variant=\"caption\" color=\"textSecondary\">\n                {selectedPermission && getTypeLabel(selectedPermission.type)}权限\n              </Typography>\n            </Box>\n          </Box>\n        </DialogTitle>\n        \n        <DialogContent sx={{ pt: 0 }}>\n          {selectedPermission && (\n            <Box>\n              {/* 权限状态 */}\n              <Box display=\"flex\" alignItems=\"center\" mb={2}>\n                <Typography variant=\"subtitle2\" sx={{ mr: 1 }}>当前状态:</Typography>\n                <Box display=\"flex\" alignItems=\"center\">\n                  {getStatusIcon(selectedPermission)}\n                  <Typography variant=\"body2\" sx={{ ml: 0.5 }}>\n                    {selectedPermission.status === 'granted' ? '已授权' : \n                     selectedPermission.status === 'denied' ? '未授权' : '待确认'}\n                  </Typography>\n                </Box>\n              </Box>\n              \n              <Divider sx={{ mb: 2 }} />\n              \n              {/* 权限用途说明 */}\n              <Box mb={2}>\n                <Typography variant=\"subtitle2\" gutterBottom color=\"primary.main\">\n                  🎯 为什么需要这个权限？\n                </Typography>\n                <Typography variant=\"body2\" color=\"textSecondary\" lineHeight={1.6}>\n                  {getPermissionReason(selectedPermission)}\n                </Typography>\n              </Box>\n              \n              <Divider sx={{ mb: 2 }} />\n              \n              {/* 影响说明 */}\n              <Box mb={1}>\n                <Typography variant=\"subtitle2\" gutterBottom color=\"warning.main\">\n                  ⚡ 不授权的影响\n                </Typography>\n                <Typography variant=\"body2\" color=\"textSecondary\" lineHeight={1.6}>\n                  {getPermissionImpact(selectedPermission)}\n                </Typography>\n              </Box>\n            </Box>\n          )}\n        </DialogContent>\n        \n        <DialogActions sx={{ px: 3, pb: 2 }}>\n          <Button \n            onClick={() => {\n              // 权限信息\"我知道了\"按钮埋点\n              trackingPrint({params:{\n                type:\"用户操作\",\n                title:\"权限信息\",\n                subtitle:\"我知道了-点击\",\n                extra:{\n                  timestamp: Date.now(),\n                  permissionId: selectedPermission?.id,\n                  permissionStatus: selectedPermission?.status\n                }\n              }});\n              handleCloseInfoDialog();\n            }} \n            color=\"primary\"\n          >\n            我知道了\n          </Button>\n          {selectedPermission && (\n            <Button\n              variant=\"contained\"\n              onClick={() => {\n                // 权限信息\"去设置\"按钮埋点\n                trackingPrint({params:{\n                  type:\"用户操作\",\n                  title:\"权限设置\",\n                  subtitle:\"去设置-对话框点击\",\n                  extra:{\n                    timestamp: Date.now(),\n                    permissionId: selectedPermission.id,\n                    permissionName: selectedPermission.name,\n                    currentStatus: selectedPermission.status,\n                    fromDialog: true\n                  }\n                }});\n                \n                handleOpenSettings(selectedPermission);\n                handleCloseInfoDialog();\n              }}\n              color=\"primary\"\n            >\n              去设置\n            </Button>\n          )}\n        </DialogActions>\n      </Dialog>\n    </Paper>\n  );\n};","export * from \"C:\\\\work\\\\android-droid\\\\html\\\\website-2024-12\\\\node_modules\\\\.pnpm\\\\lodash@4.17.21\\\\node_modules\\\\lodash\\\\lodash.js\"","import React, { useState, useCallback } from 'react';\nimport {\n    Box,\n    Switch,\n    Button,\n    Typography,\n    Paper,\n    Collapse,\n    Divider,\n    IconButton,\n    TextField,\n    FormControlLabel,\n    Tooltip,\n    Stack,\n    FormControl,\n    MenuItem,\n    InputLabel,\n    Select,\n} from '@mui/material';\nimport {\n    DragIndicator as DragIndicatorIcon,\n    ExpandMore,\n    Delete,\n    PlayArrow,\n    Stop,\n    VolumeUp as VolumeUpIcon,\n    Vibration as VibrationIcon\n} from '@mui/icons-material';\nimport { DndContext, closestCenter, KeyboardSensor, PointerSensor, TouchSensor, useSensor, useSensors, DragEndEvent } from '@dnd-kit/core';\nimport { arrayMove, SortableContext, sortableKeyboardCoordinates, useSortable, verticalListSortingStrategy } from '@dnd-kit/sortable';\nimport { CSS } from '@dnd-kit/utilities';\nimport { debounce } from 'lodash';\nimport { autoJsStoreUtils } from '@droid/android';\n\nconst PRE_ALARM_CONFIG_KEY = 'PRE_ALARM_ACTIONS_CONFIG';\n\ninterface PreAlarmAction {\n    id: string;\n    type: 'sound' | 'vibration';\n    duration: number;\n    resourceId?: string;\n}\n\ninterface PreAlarmConfig {\n    enabled: boolean;\n    actions: PreAlarmAction[];\n    maxWaitDuration: number;\n}\n\nconst defaultSoundResources = [\n    { id: 'siren_gentle', name: '缓和警报' },\n    { id: 'beep_short', name: '短提示音' },\n    { id: 'alarm_clock', name: '闹钟' },\n];\n\nconst SortableActionItem: React.FC<{\n    action: PreAlarmAction;\n    isPlaying: boolean;\n    onUpdate: (id: string, updates: Partial<Omit<PreAlarmAction, 'id'>>) => void;\n    onRemove: (id: string) => void;\n    onPreview: (resourceId?: string) => void;\n    onStopPreview: () => void;\n}> = ({ action, isPlaying, onUpdate, onRemove, onPreview, onStopPreview }) => {\n    const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({ id: action.id });\n\n    const style = {\n        transform: CSS.Transform.toString(transform),\n        transition,\n        opacity: isDragging ? 0.8 : 1,\n        zIndex: isDragging ? 1 : 'auto',\n    };\n\n    return (\n        <Paper\n            ref={setNodeRef}\n            style={style}\n            elevation={isDragging ? 3 : 1}\n            sx={{\n                p: 2,\n                mb: 1,\n                display: 'flex',\n                alignItems: 'center',\n                gap: 2,\n                userSelect: 'none',\n            }}\n        >\n            <Box {...attributes} {...listeners} sx={{ display: 'flex', alignItems: 'center', cursor: 'grab', touchAction: 'none' }}>\n                <DragIndicatorIcon />\n            </Box>\n            \n            <Box sx={{ flexGrow: 1 }}>\n                <Box sx={{ display: 'flex', flexDirection: 'column', alignItems: 'flex-start', gap: 1.5 }}>\n                    <Typography variant=\"subtitle2\">\n                        {action.type === 'sound' ? '声音' : '震动'}\n                    </Typography>\n                    <TextField\n                        size=\"small\"\n                        type=\"number\"\n                        label=\"持续时间 (ms)\"\n                        value={action.duration}\n                        onChange={(e) => onUpdate(action.id, { duration: parseInt(e.target.value, 10) || 0 })}\n                        sx={{ width: '100%' }}\n                    />\n                    \n                    {action.type === 'sound' && (\n                        <FormControl size=\"small\" sx={{ width: '100%' }}>\n                            <InputLabel>声音类型</InputLabel>\n                            <Select\n                                value={action.resourceId || ''}\n                                label=\"声音类型\"\n                                onChange={(e) => onUpdate(action.id, { resourceId: e.target.value })}\n                                startAdornment={\n                                    <Tooltip title={isPlaying ? \"停止\" : \"试听\"}>\n                                        <IconButton\n                                            size=\"small\"\n                                            onClick={() => isPlaying ? onStopPreview() : onPreview(action.resourceId)}\n                                            sx={{ mr: 1 }}\n                                        >\n                                            {isPlaying ? <Stop fontSize=\"small\" /> : <PlayArrow fontSize=\"small\" />}\n                                        </IconButton>\n                                    </Tooltip>\n                                }\n                            >\n                                {defaultSoundResources.map((sound) => (\n                                    <MenuItem key={sound.id} value={sound.id}>\n                                        {sound.name}\n                                    </MenuItem>\n                                ))}\n                            </Select>\n                        </FormControl>\n                    )}\n                </Box>\n            </Box>\n            \n            <IconButton onClick={() => onRemove(action.id)} size=\"small\" color=\"error\">\n                <Delete />\n            </IconButton>\n        </Paper>\n    );\n};\n\n// 简化版本，去掉外层Paper包装，只保留内容\nconst PreAlarmConfig: React.FC = () => {\n    const [config, setConfig] = useState<PreAlarmConfig | null>(null);\n    const [expanded, setExpanded] = useState(false);\n    const [playingSoundId, setPlayingSoundId] = useState<string | null>(null);\n\n    const debouncedWrite = useCallback(\n        debounce((newConfig: PreAlarmConfig) => {\n            autoJsStoreUtils.write(PRE_ALARM_CONFIG_KEY, newConfig);\n        }, 500),\n        []\n    );\n\n    const sensors = useSensors(\n        useSensor(PointerSensor, {\n            activationConstraint: {\n                distance: 8,\n            },\n        }),\n        useSensor(TouchSensor, {\n            activationConstraint: {\n                delay: 250,\n                tolerance: 5,\n            },\n        }),\n        useSensor(KeyboardSensor, {\n            coordinateGetter: sortableKeyboardCoordinates,\n        })\n    );\n\n    React.useEffect(() => {\n        const loadConfig = async () => {\n            const storedConfig = await autoJsStoreUtils.read<PreAlarmConfig>(PRE_ALARM_CONFIG_KEY);\n            if (storedConfig) {\n                const actionsWithIds = storedConfig.actions.map((action) => ({\n                    ...action,\n                    id: action.id || `action-${Math.random().toString(36).substr(2, 9)}`,\n                }));\n                \n                // 重新计算maxWaitDuration以确保一致性\n                const calculatedDuration = calculateTotalDuration(actionsWithIds);\n                \n                setConfig({\n                    ...storedConfig,\n                    actions: actionsWithIds,\n                    maxWaitDuration: calculatedDuration,\n                });\n            } else {\n                // 创建默认动作：震动8秒 + siren_gentle声音10秒\n                const defaultActions: PreAlarmAction[] = [\n                    {\n                        id: `action-${Date.now()}-vibration`,\n                        type: 'vibration',\n                        duration: 8000, // 震动8秒\n                    },\n                    {\n                        id: `action-${Date.now()}-sound`,\n                        type: 'sound',\n                        duration: 10000, // 播放10秒\n                        resourceId: 'siren_gentle',\n                    }\n                ];\n                \n                const totalDuration = calculateTotalDuration(defaultActions);\n                \n                setConfig({\n                    enabled: true,\n                    actions: defaultActions,\n                    maxWaitDuration: totalDuration, // 自动计算：8000 + 10000 = 18000ms\n                });\n            }\n        };\n        loadConfig();\n    }, []);\n\n    // 计算所有动作的总时长\n    const calculateTotalDuration = (actions: PreAlarmAction[]): number => {\n        return actions.reduce((total, action) => total + action.duration, 0);\n    };\n\n    const updateConfig = useCallback(\n        (updates: Partial<PreAlarmConfig>) => {\n            setConfig((prev) => {\n                if (!prev) return null;\n                const newConfig = { ...prev, ...updates };\n                debouncedWrite(newConfig);\n                return newConfig;\n            });\n        },\n        [debouncedWrite]\n    );\n\n    // 自动计算并更新maxWaitDuration\n    const updateConfigWithCalculatedDuration = useCallback(\n        (updates: Partial<PreAlarmConfig>) => {\n            setConfig((prev) => {\n                if (!prev) return null;\n                \n                const newConfig = { ...prev, ...updates };\n                \n                // 如果动作发生变化，自动计算总时长\n                if (updates.actions) {\n                    newConfig.maxWaitDuration = calculateTotalDuration(updates.actions);\n                }\n                \n                debouncedWrite(newConfig);\n                return newConfig;\n            });\n        },\n        [debouncedWrite]\n    );\n\n    const handleToggleEnabled = (event: React.ChangeEvent<HTMLInputElement>) => {\n        updateConfigWithCalculatedDuration({ enabled: event.target.checked });\n    };\n\n    const handleAddAction = (type: 'sound' | 'vibration') => {\n        const newAction: PreAlarmAction = {\n            id: `action-${Date.now()}`,\n            type,\n            duration: 9000,\n            ...(type === 'sound' && { resourceId: defaultSoundResources[0].id }),\n        };\n        updateConfigWithCalculatedDuration({\n            actions: [...(config?.actions || []), newAction],\n        });\n    };\n\n    const handleUpdateAction = (id: string, updates: Partial<Omit<PreAlarmAction, 'id'>>) => {\n        if (!config) return;\n        updateConfigWithCalculatedDuration({\n            actions: config.actions.map((action) =>\n                action.id === id ? { ...action, ...updates } : action\n            ),\n        });\n    };\n\n    const handleRemoveAction = (id: string) => {\n        if (!config) return;\n        updateConfigWithCalculatedDuration({\n            actions: config.actions.filter((action) => action.id !== id),\n        });\n    };\n\n    const handleDragEnd = (event: DragEndEvent) => {\n        const { active, over } = event;\n        if (!config || !over || active.id === over.id) return;\n\n        const oldIndex = config.actions.findIndex((a) => a.id === active.id);\n        const newIndex = config.actions.findIndex((a) => a.id === over.id);\n\n        if (oldIndex !== -1 && newIndex !== -1) {\n            updateConfigWithCalculatedDuration({\n                actions: arrayMove(config.actions, oldIndex, newIndex),\n            });\n        }\n    };\n\n    const handlePreviewSound = (resourceId?: string) => {\n        if (!resourceId) return;\n        handleStopSound();\n        \n        console.log(`[WebView] Attempting to preview sound. resourceId: ${resourceId}`);\n\n        if ((window as any).SoundManager) {\n            (window as any).SoundManager.previewSound(resourceId);\n            setPlayingSoundId(resourceId);\n        } else {\n            console.warn('SoundManager JavascriptInterface is not available.');\n        }\n    };\n\n    const handleStopSound = () => {\n        if ((window as any).SoundManager) {\n            (window as any).SoundManager.stopPreview();\n        }\n        setPlayingSoundId(null);\n    };\n\n    if (!config) {\n        return <Box sx={{ p: 2, textAlign: 'center' }}>加载中...</Box>;\n    }\n\n    return (\n        <Box>\n            {/* 开关控制 */}\n            <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', mb: 2 }}>\n                <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\n                    <Typography variant=\"h6\">防误触</Typography>\n                    \n                    <FormControlLabel\n                        control={\n                            <Switch\n                                checked={config.enabled}\n                                onChange={handleToggleEnabled}\n                                color=\"primary\"\n                            />\n                        }\n                        label={config.enabled ? '已启用' : '已禁用'}\n                    />\n                </Box>\n                \n                <IconButton\n                    onClick={() => setExpanded(!expanded)}\n                    sx={{\n                        transform: expanded ? 'rotate(180deg)' : 'rotate(0deg)',\n                        transition: 'transform 0.2s ease-in-out'\n                    }}\n                >\n                    <ExpandMore />\n                </IconButton>\n            </Box>\n\n            {/* 展开的设置内容 */}\n            <Collapse in={expanded}>\n                <Paper \n                    elevation={0} \n                    sx={{ \n                        p: 2, \n                        border: '1px solid', \n                        borderColor: 'divider',\n                        borderRadius: 1,\n                    }}\n                >\n                    {/* 隐藏最大等待时间UI，改为显示计算结果 */}\n                    <Box sx={{ mb: 3 }}>\n                        <Typography variant=\"subtitle2\" gutterBottom color=\"text.secondary\">\n                            预警总时长: {config.maxWaitDuration}毫秒 ({(config.maxWaitDuration / 1000).toFixed(1)}秒)\n                        </Typography>\n                        <Typography variant=\"body2\" color=\"text.secondary\" sx={{ fontSize: '0.875rem' }}>\n                            根据所有动作时长自动计算\n                        </Typography>\n                    </Box>\n\n                    <Divider sx={{ my: 2 }} />\n\n                    <Box sx={{ mb: 2 }}>\n                        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n                            <Typography variant=\"subtitle2\">\n                                预警动作 ({config.actions.length})\n                            </Typography>\n                            <Stack direction=\"row\" spacing={1}>\n                                <Button\n                                    variant=\"outlined\"\n                                    size=\"small\"\n                                    startIcon={<VolumeUpIcon />}\n                                    onClick={() => handleAddAction('sound')}\n                                >\n                                    添加声音\n                                </Button>\n                                <Button\n                                    variant=\"outlined\"\n                                    size=\"small\"\n                                    startIcon={<VibrationIcon />}\n                                    onClick={() => handleAddAction('vibration')}\n                                >\n                                    添加震动\n                                </Button>\n                            </Stack>\n                        </Box>\n\n                        {config.actions.length === 0 ? (\n                            <Paper\n                                variant=\"outlined\"\n                                sx={{\n                                    p: 3,\n                                    textAlign: 'center',\n                                    color: 'text.secondary',\n                                }}\n                            >\n                                <Typography>暂无报警动作，请点击上方按钮添加</Typography>\n                            </Paper>\n                        ) : (\n                            <DndContext\n                                sensors={sensors}\n                                collisionDetection={closestCenter}\n                                onDragEnd={handleDragEnd}\n                            >\n                                <SortableContext\n                                    items={config.actions.map((a) => a.id)}\n                                    strategy={verticalListSortingStrategy}\n                                >\n                                    {config.actions.map((action) => (\n                                        <SortableActionItem\n                                            key={action.id}\n                                            action={action}\n                                            isPlaying={playingSoundId === action.resourceId}\n                                            onUpdate={handleUpdateAction}\n                                            onRemove={handleRemoveAction}\n                                            onPreview={handlePreviewSound}\n                                            onStopPreview={handleStopSound}\n                                        />\n                                    ))}\n                                </SortableContext>\n                            </DndContext>\n                        )}\n                    </Box>\n                </Paper>\n            </Collapse>\n        </Box>\n    );\n};\n\nexport default PreAlarmConfig;","import React, { useState } from 'react';\nimport {\n  Box,\n  Typography,\n  Switch,\n  FormControlLabel,\n  Paper,\n  Button,\n  Divider,\n  Alert\n} from '@mui/material';\nimport { VolumeUp, Settings, ExpandLess } from '@mui/icons-material';\nimport { EmergencyTTSSettings as OriginalEmergencyTTSSettings } from '@src/components/emergency-tts-settings';\n\n// 简化版本的紧急呼救语音设置组件\n// 复用原组件的功能，但去掉外层包装\nconst EmergencyTTSSettings: React.FC = () => {\n    const [showOriginal, setShowOriginal] = useState(false);\n\n    return (\n        <Box>\n            {/* 简化的标题和开关 */}\n            <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', mb: 2 }}>\n                <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                    <VolumeUp />\n                    <Typography variant=\"subtitle2\">紧急呼救语音</Typography>\n                </Box>\n                \n                <Button\n                    variant=\"outlined\"\n                    size=\"small\"\n                    startIcon={showOriginal ? <ExpandLess /> : <Settings />}\n                    onClick={() => setShowOriginal(!showOriginal)}\n                >\n                    {showOriginal ? '收起设置' : '设置'}\n                </Button>\n            </Box>\n\n            {/* 说明信息 */}\n            {!showOriginal && (\n                <Alert severity=\"info\" sx={{ mb: 2 }}>\n                    <Typography variant=\"body2\">\n                        配置紧急情况下播放的语音内容，支持文字转语音和自定义音频文件\n                    </Typography>\n                </Alert>\n            )}\n\n            {/* 展开时显示原组件 */}\n            {showOriginal && (\n                <Paper \n                    elevation={0} \n                    sx={{ \n                        border: '1px solid', \n                        borderColor: 'divider',\n                        borderRadius: 1,\n                        overflow: 'hidden'\n                    }}\n                >\n                    <OriginalEmergencyTTSSettings />\n                </Paper>\n            )}\n        </Box>\n    );\n};\n\nexport default EmergencyTTSSettings;","export { default as PreAlarmConfig } from './PreAlarmConfig';\nexport { default as EmergencyTTSSettings } from './EmergencyTTSSettings';","import React, { useState, useEffect, useCallback, useImperativeHandle, forwardRef } from 'react';\nimport {\n    Box,\n    Typography,\n    TextField,\n    Button,\n    Paper,\n    List,\n    ListItem,\n    ListItemText,\n    ListItemSecondaryAction,\n    IconButton,\n    Divider,\n    Slider,\n    FormControlLabel,\n    Switch,\n    Alert,\n    Snackbar,\n    Chip,\n    LinearProgress,\n    Collapse,\n    MenuItem,\n    Select,\n    FormControl,\n    InputLabel,\n    Dialog,\n    DialogTitle,\n    DialogContent,\n    DialogActions,\n    CircularProgress,\n} from '@mui/material';\nimport {\n    PlayArrow,\n    Stop,\n    Save,\n    Share,\n    Delete,\n    Refresh,\n    ExpandMore,\n    MusicNote,\n    VolumeUp,\n    Mic,\n    Star,\n    StarBorder,\n    CloudUpload,\n    InsertDriveFile,\n} from '@mui/icons-material';\nimport { autoWebViewJs, autoJsStoreUtils } from '@droid/android';\n\n// 扩展的紧急TTS设置接口\ninterface EmergencyTTSSettings {\n    enabled: boolean;\n    message: string;\n    repeatInterval: number;\n    voiceSpeed: number;\n    voicePitch: number;\n    lastUpdated: number;\n    // 新增字段\n    useCustomAudio: boolean;        // 是否使用自定义录音\n    medicalEmergencyAudioPath?: string; // 医疗呼救默认音频路径\n}\n\n// 扩展的TTS文件信息接口\ninterface TTSFileInfo {\n    fileName: string;\n    filePath: string;\n    fileSize: number;\n    createTime: number;\n    type: 'general' | 'medical' | 'security' | 'custom'; // 文件类型\n    source: 'recorded' | 'uploaded';  // 新增来源标识\n    isDefault?: boolean; // 是否为该类型的默认音频\n    duration?: number;  // 音频时长（毫秒）\n    format?: string;    // 文件格式\n    mimeType?: string;  // MIME类型\n}\n\n// 文件上传相关接口\ninterface FileUploadResult {\n    success: boolean;\n    filePath: string;\n    message: string;\n    fileInfo?: TTSFileInfo;\n}\n\ninterface SupportedFormats {\n    formats: string[];\n    maxFileSizeMB: number;\n    maxDurationSeconds: number;\n    recommendedDurationSeconds: number;\n}\n\n// 录制结果接口\ninterface TTSRecordResult {\n    success: boolean;\n    filePath: string;\n    message: string;\n}\n\n// 语音呼救配置接口\ninterface VoiceEmergencyConfig {\n    medicalDefault?: string;  // 医疗呼救默认音频路径\n    securityDefault?: string; // 安全呼救默认音频路径\n    lastUpdated: number;\n}\n\n// 默认设置\nconst DEFAULT_TTS_SETTINGS: EmergencyTTSSettings = {\n    enabled: false,\n    message: '请帮我从上衣右边口袋拿出降压药，喂我服下两颗，谢谢。我叫某某某，请帮我拨打我大儿子电话，13911119999，他叫某某。如果您是医生，我的病例可以通过我的蓝牙看到。谢谢您的帮助！',\n    repeatInterval: 3000,\n    voiceSpeed: 1.0,\n    voicePitch: 1.0,\n    lastUpdated: Date.now(),\n    useCustomAudio: false,\n};\n\nconst DEFAULT_VOICE_CONFIG: VoiceEmergencyConfig = {\n    lastUpdated: Date.now(),\n};\n\nconst TTS_SETTINGS_KEY = 'emergencyTTSSettings';\nconst VOICE_CONFIG_KEY = 'voiceEmergencyConfig';\nconst AUDIO_FILE_UPLOAD_SUCCESS_EVENT = 'audioFileUploadSuccess';\n\nexport interface VoiceEmergencySettingsRef {\n    reloadConfig: () => Promise<void>;\n}\n\nconst VoiceEmergencySettings = forwardRef<VoiceEmergencySettingsRef>((props, ref) => {\n    const [settings, setSettings] = useState<EmergencyTTSSettings>(DEFAULT_TTS_SETTINGS);\n    const [voiceConfig, setVoiceConfig] = useState<VoiceEmergencyConfig>(DEFAULT_VOICE_CONFIG);\n    const [fileList, setFileList] = useState<TTSFileInfo[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [expanded, setExpanded] = useState(false);\n    const [isRecording, setIsRecording] = useState(false);\n    const [playingFile, setPlayingFile] = useState<string | null>(null);\n    const [showSuccess, setShowSuccess] = useState(false);\n    const [showError, setShowError] = useState(false);\n    const [errorMessage, setErrorMessage] = useState('');\n    const [successMessage, setSuccessMessage] = useState('');\n    const [ttsAvailable, setTtsAvailable] = useState<boolean | null>(null);\n    \n    // 录制区域状态\n    const [recordText, setRecordText] = useState(DEFAULT_TTS_SETTINGS.message);\n    const [recordSpeed, setRecordSpeed] = useState(1.0);\n    const [recordPitch, setRecordPitch] = useState(1.0);\n    const [showRecordDialog, setShowRecordDialog] = useState(false);\n    \n    // 文件上传相关状态\n    const [isUploading, setIsUploading] = useState(false);\n    const [uploadProgress, setUploadProgress] = useState(0);\n    const [supportedFormats, setSupportedFormats] = useState<SupportedFormats | null>(null);\n\n    // 加载设置和配置\n    const loadData = useCallback(async () => {\n        try {\n            setLoading(true);\n            \n            // 加载TTS设置\n            const savedSettings = await autoJsStoreUtils.read<EmergencyTTSSettings>(\n                TTS_SETTINGS_KEY, \n                DEFAULT_TTS_SETTINGS\n            );\n            setSettings(savedSettings);\n            \n            // 加载语音配置\n            const savedConfig = await autoJsStoreUtils.read<VoiceEmergencyConfig>(\n                VOICE_CONFIG_KEY,\n                DEFAULT_VOICE_CONFIG\n            );\n            setVoiceConfig(savedConfig);\n            \n            // 检查TTS可用性\n            checkTTSAvailability();\n            \n            // 加载文件列表\n            loadFileList();\n            \n            // 加载支持的音频格式\n            loadSupportedFormats();\n        } catch (err) {\n            console.error('加载数据失败:', err);\n            setErrorMessage('加载设置失败');\n            setShowError(true);\n        } finally {\n            setLoading(false);\n        }\n    }, []);\n\n    useEffect(() => {\n        const handleAudioUploadSuccess = (event: CustomEvent) => {\n            console.log('收到音频上传成功事件:', event.detail);\n            // 直接刷新文件列表（内联逻辑避免依赖循环）\n            try {\n                const script = `com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.getFileList()`;\n                const { javaResultString: listJson } = autoWebViewJs.callScript(script);\n                const files = JSON.parse((listJson || \"[]\") as string) as TTSFileInfo[];\n                const filesWithType = files.map(file => ({\n                    ...file,\n                    type: (file as any).type || 'general' as const,\n                    isDefault: (file as any).isDefault || false,\n                    source: (file as any).source || 'recorded' as const,\n                }));\n                setFileList(filesWithType);\n            } catch (error) {\n                console.error('刷新文件列表失败:', error);\n            }\n            // 显示成功消息\n            setSuccessMessage(`音频文件上传成功: ${event.detail.fileName}`);\n            setShowSuccess(true);\n        };\n\n        window.addEventListener(AUDIO_FILE_UPLOAD_SUCCESS_EVENT, handleAudioUploadSuccess as EventListener);\n\n        loadData();\n\n        // 清理函数\n        return () => {\n            window.removeEventListener(AUDIO_FILE_UPLOAD_SUCCESS_EVENT, handleAudioUploadSuccess as EventListener);\n        };\n    }, [loadData]);\n\n    // 暴露重新加载方法给父组件\n    useImperativeHandle(ref, () => ({\n        reloadConfig: loadData,\n    }), [loadData]);\n\n    useEffect(() => {\n        loadData();\n    }, [loadData]);\n\n    // 加载支持的音频格式\n    const loadSupportedFormats = useCallback(() => {\n        try {\n            const script = `com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.getSupportedAudioFormats()`;\n            const { javaResultString } = autoWebViewJs.callScript(script);\n            const formats = JSON.parse(javaResultString || '{}') as SupportedFormats;\n            setSupportedFormats(formats);\n        } catch (error) {\n            console.error('加载支持格式失败:', error);\n            setSupportedFormats({\n                formats: ['mp3', 'wav', 'm4a', 'aac'],\n                maxFileSizeMB: 10,\n                maxDurationSeconds: 60,\n                recommendedDurationSeconds: 30\n            });\n        }\n    }, []);\n\n    // 选择并上传音频文件\n    const handleSelectAndUploadAudioFile = useCallback(async () => {\n        if (isUploading) return;\n        \n        try {\n            setIsUploading(true);\n            setUploadProgress(0);\n            \n            const script = `com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.selectAndUploadAudioFile()`;\n            \n            // 模拟上传进度\n            const progressInterval = setInterval(() => {\n                setUploadProgress(prev => {\n                    if (prev >= 90) {\n                        clearInterval(progressInterval);\n                        return 90;\n                    }\n                    return prev + 10;\n                });\n            }, 300);\n            \n            const { javaResultString } = autoWebViewJs.callScript(script);\n            const result = JSON.parse(javaResultString || '{}') as FileUploadResult;\n            \n            clearInterval(progressInterval);\n            setUploadProgress(100);\n            \n            if (result.success) {\n                setSuccessMessage('音频文件上传成功！');\n                setShowSuccess(true);\n                // 刷新文件列表\n                try {\n                    const script = `com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.getFileList()`;\n                    const { javaResultString: listJson } = autoWebViewJs.callScript(script);\n                    const files = JSON.parse((listJson || \"[]\") as string) as TTSFileInfo[];\n                    const filesWithType = files.map(file => ({\n                        ...file,\n                        type: (file as any).type || 'general' as const,\n                        isDefault: (file as any).isDefault || false,\n                        source: (file as any).source || 'recorded' as const,\n                    }));\n                    setFileList(filesWithType);\n                } catch (error) {\n                    console.error('刷新文件列表失败:', error);\n                }\n            } else {\n                setErrorMessage(result.message || '上传失败');\n                setShowError(true);\n            }\n        } catch (error) {\n            console.error('文件上传失败:', error);\n            setErrorMessage('文件上传异常：' + (error as Error).message);\n            setShowError(true);\n        } finally {\n            setIsUploading(false);\n            setUploadProgress(0);\n        }\n    }, [isUploading]);\n\n    // 检查TTS可用性\n    const checkTTSAvailability = useCallback(() => {\n        try {\n            const script = `com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.isTTSAvailable()`;\n            const { javaResultString } = autoWebViewJs.callScript(script);\n            setTtsAvailable(javaResultString === 'true');\n        } catch (error) {\n            console.error('检查TTS可用性失败:', error);\n            setTtsAvailable(false);\n        }\n    }, []);\n\n    // 加载文件列表\n    const loadFileList = useCallback(() => {\n        try {\n            const script = `com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.getFileList()`;\n            const { javaResultString: listJson } = autoWebViewJs.callScript(script);\n            console.log('加载文件列表:', listJson);\n            const files = JSON.parse((listJson || \"[]\") as string) as TTSFileInfo[];\n            \n            // 为现有文件设置默认类型（兼容性处理）\n            const filesWithType = files.map(file => ({\n                ...file,\n                type: (file as any).type || 'general' as const,\n                isDefault: (file as any).isDefault || false,\n                source: (file as any).source || 'recorded' as const,\n            }));\n            \n            setFileList(filesWithType);\n        } catch (error) {\n            console.error('加载文件列表失败:', error);\n            setFileList([]);\n        }\n    }, []);\n\n    // 保存TTS设置\n    const saveTTSSettings = async (newSettings: EmergencyTTSSettings) => {\n        try {\n            const settingsToSave = {\n                ...newSettings,\n                lastUpdated: Date.now(),\n            };\n            \n            await autoJsStoreUtils.write(TTS_SETTINGS_KEY, settingsToSave);\n            setSettings(settingsToSave);\n            setSuccessMessage('设置保存成功');\n            setShowSuccess(true);\n        } catch (err) {\n            console.error('保存TTS设置失败:', err);\n            setErrorMessage('保存设置失败');\n            setShowError(true);\n        }\n    };\n\n    // 保存语音配置\n    const saveVoiceConfig = async (newConfig: VoiceEmergencyConfig) => {\n        try {\n            const configToSave = {\n                ...newConfig,\n                lastUpdated: Date.now(),\n            };\n            \n            await autoJsStoreUtils.write(VOICE_CONFIG_KEY, configToSave);\n            setVoiceConfig(configToSave);\n        } catch (err) {\n            console.error('保存语音配置失败:', err);\n            setErrorMessage('保存配置失败');\n            setShowError(true);\n        }\n    };\n\n    // 设置为默认音频\n    const setAsDefaultAudio = useCallback(async (filePath: string, type: 'medical' | 'security') => {\n        try {\n            const newConfig = { ...voiceConfig };\n            if (type === 'medical') {\n                newConfig.medicalDefault = filePath;\n            } else {\n                newConfig.securityDefault = filePath;\n            }\n            \n            await saveVoiceConfig(newConfig);\n            \n            // 更新文件列表中的默认标记\n            const updatedFiles = fileList.map(file => ({\n                ...file,\n                isDefault: file.filePath === filePath && file.type === type,\n            }));\n            setFileList(updatedFiles);\n            \n            setSuccessMessage(`已设置为${type === 'medical' ? '医疗' : '安全'}呼救默认音频`);\n            setShowSuccess(true);\n        } catch (error) {\n            setErrorMessage('设置默认音频失败');\n            setShowError(true);\n        }\n    }, [voiceConfig, fileList]);\n\n    // 录制TTS\n    const handleRecord = useCallback(() => {\n        if (!recordText.trim()) {\n            setErrorMessage('请输入要录制的文字');\n            setShowError(true);\n            return;\n        }\n\n        if (!ttsAvailable) {\n            setErrorMessage('当前设备不支持TTS功能');\n            setShowError(true);\n            return;\n        }\n\n        setIsRecording(true);\n        try {\n            const script = `com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.recordTTS(\"${recordText.replace(/\"/g, '\\\\\"')}\", null, ${recordSpeed}, ${recordPitch})`;\n            const { javaResultString: resultJson } = autoWebViewJs.callScript(script);\n            const result = JSON.parse(resultJson as string) as TTSRecordResult;\n            \n            setIsRecording(false);\n            if (result.success) {\n                setSuccessMessage(result.message);\n                setShowSuccess(true);\n                setShowRecordDialog(false);\n                loadFileList();\n            } else {\n                setErrorMessage(result.message);\n                setShowError(true);\n            }\n        } catch (error) {\n            setIsRecording(false);\n            setErrorMessage('录制失败：' + (error as Error).message);\n            setShowError(true);\n        }\n    }, [recordText, recordSpeed, recordPitch, ttsAvailable, loadFileList]);\n\n    // 播放文件\n    const handlePlayFile = useCallback((filePath: string) => {\n        try {\n            const stopScript = `com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.stopPlayback()`;\n            autoWebViewJs.callScript(stopScript);\n            \n            if (playingFile === filePath) {\n                setPlayingFile(null);\n                return;\n            }\n\n            const script = `com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.playFile(\"${filePath.replace(/\"/g, '\\\\\"')}\")`;\n            const { javaResultString: success } = autoWebViewJs.callScript(script);\n            if (success === 'true') {\n                setPlayingFile(filePath);\n                setTimeout(() => setPlayingFile(null), 3000);\n            } else {\n                setErrorMessage('播放失败');\n                setShowError(true);\n            }\n        } catch (error) {\n            setErrorMessage('播放异常：' + (error as Error).message);\n            setShowError(true);\n        }\n    }, [playingFile]);\n\n    // 分享文件\n    const handleShareFile = useCallback((filePath: string) => {\n        try {\n            const script = `com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.shareFile(\"${filePath.replace(/\"/g, '\\\\\"')}\", \"紧急呼救语音\")`;\n            const { javaResultString: success } = autoWebViewJs.callScript(script);\n            if (success !== 'true') {\n                setErrorMessage('分享失败');\n                setShowError(true);\n            }\n        } catch (error) {\n            setErrorMessage('分享异常：' + (error as Error).message);\n            setShowError(true);\n        }\n    }, []);\n\n    // 删除文件\n    const handleDeleteFile = useCallback((filePath: string) => {\n        if (window.confirm('确定要删除这个文件吗？')) {\n            try {\n                const script = `com.fanfanlo.emergencycall.manager.TTSRecorderJSInterface.deleteFile(\"${filePath.replace(/\"/g, '\\\\\"')}\")`;\n                const { javaResultString: success } = autoWebViewJs.callScript(script);\n                if (success === 'true') {\n                    setSuccessMessage('文件删除成功');\n                    setShowSuccess(true);\n                    loadFileList();\n                } else {\n                    setErrorMessage('删除失败');\n                    setShowError(true);\n                }\n            } catch (error) {\n                setErrorMessage('删除异常：' + (error as Error).message);\n                setShowError(true);\n            }\n        }\n    }, [loadFileList]);\n\n    // 设置变更处理\n    const handleSettingChange = (key: keyof EmergencyTTSSettings, value: any) => {\n        const newSettings = { ...settings, [key]: value };\n        if (newSettings.enabled && !newSettings.useCustomAudio && !newSettings.message.trim()) {\n            setErrorMessage('启用TTS功能时，呼救文字不能为空');\n            setShowError(true);\n            return;\n        }\n        setSettings(newSettings);\n        saveTTSSettings(newSettings);\n    };\n\n    // 保存设置\n    const handleSaveSettings = () => {\n        if (settings.enabled && !settings.useCustomAudio && !settings.message.trim()) {\n            setErrorMessage('启用TTS功能时，呼救文字不能为空');\n            setShowError(true);\n            return;\n        }\n        saveTTSSettings(settings);\n    };\n\n    // 格式化文件大小\n    const formatFileSize = (bytes: number): string => {\n        if (bytes < 1024) return `${bytes} B`;\n        if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n        return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n    };\n\n    // 格式化时间\n    const formatTime = (timestamp: number): string => {\n        return new Date(timestamp).toLocaleString();\n    };\n\n    // 格式化时长\n    const formatDuration = (milliseconds: number): string => {\n        if (!milliseconds || milliseconds <= 0) return '';\n        const seconds = Math.floor(milliseconds / 1000);\n        const minutes = Math.floor(seconds / 60);\n        const remainingSeconds = seconds % 60;\n        if (minutes > 0) {\n            return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;\n        }\n        return `${seconds}s`;\n    };\n\n    if (loading) {\n        return (\n            <Box sx={{ p: 2, textAlign: 'center' }}>\n                <Typography>加载中...</Typography>\n            </Box>\n        );\n    }\n\n    return (\n        <Box sx={{ mb: 3 }}>\n            {/* 折叠头部 */}\n            <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', mb: 2 }}>\n                <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\n                    <Typography variant=\"h6\" sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                        {/* <VolumeUp /> */}\n                        语音呼救\n                    </Typography>\n                    <FormControlLabel\n                        control={\n                            <Switch\n                                checked={settings.enabled}\n                                onChange={(e) => handleSettingChange('enabled', e.target.checked)}\n                                color=\"primary\"\n                            />\n                        }\n                        label={settings.enabled ? '已启用' : '已禁用'}\n                    />\n                    \n                    {/* 状态指示器 */}\n                    {/* <Chip \n                        size=\"small\"\n                        icon={ttsAvailable ? <VolumeUp /> : <MusicNote />}\n                        label={ttsAvailable === null ? '检测中...' : (ttsAvailable ? 'TTS可用' : 'TTS不可用')}\n                        color={ttsAvailable === null ? 'default' : (ttsAvailable ? 'success' : 'warning')}\n                        variant=\"outlined\"\n                    /> */}\n                </Box>\n                \n                <IconButton\n                    onClick={() => setExpanded(!expanded)}\n                    sx={{\n                        transform: expanded ? 'rotate(180deg)' : 'rotate(0deg)',\n                        transition: 'transform 0.2s ease-in-out'\n                    }}\n                >\n                    <ExpandMore />\n                </IconButton>\n            </Box>\n\n            {/* 折叠内容 */}\n            <Collapse in={expanded}>\n                <Paper \n                    elevation={0} \n                    sx={{ \n                        p: 2, \n                        border: '1px solid', \n                        borderColor: 'divider',\n                        borderRadius: 1,\n                    }}\n                >\n                    {/* 已有录音列表 */}\n                    <Box sx={{ mb: 3 }}>\n                        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n                            <Typography variant=\"subtitle2\" fontWeight=\"bold\">\n                                已有录音 ({fileList.length})\n                            </Typography>\n                            <Box sx={{ display: 'flex', gap: 1 }}>\n                                {/* <Button\n                                    variant=\"outlined\"\n                                    size=\"small\"\n                                    startIcon={<Mic />}\n                                    onClick={() => setShowRecordDialog(true)}\n                                    disabled={!ttsAvailable}\n                                >\n                                    录制新语音\n                                </Button> */}\n                                <Button\n                                    variant=\"outlined\"\n                                    size=\"small\"\n                                    startIcon={<Refresh />}\n                                    onClick={loadFileList}\n                                >\n                                    {/* 刷新列表 */}\n                                </Button>\n                            </Box>\n                        </Box>\n\n                        {fileList.length === 0 ? (\n                            <Paper\n                                variant=\"outlined\"\n                                sx={{\n                                    p: 3,\n                                    textAlign: 'center',\n                                    color: 'text.secondary',\n                                }}\n                            >\n                                <Typography>暂无录音文件</Typography>\n                                <Typography variant=\"body2\" sx={{ mt: 1 }}>\n                                    点击\"录制新语音\"创建个性化呼救语音\n                                </Typography>\n                            </Paper>\n                        ) : (\n                            <List sx={{ bgcolor: 'background.paper', borderRadius: 1, border: '1px solid', borderColor: 'divider' }}>\n                                {fileList.map((file, index) => (\n                                    <React.Fragment key={file.filePath}>\n                                        <ListItem>\n                                            <ListItemText\n                                                primary={\n                                                    <Box sx={{ width: '100%' }}>\n                                                        {/* 第一行：文件图标 + 文件名（允许多行） */}\n                                                        <Box sx={{ display: 'flex', alignItems: 'flex-start', gap: 1, mb: 1 }}>\n                                                            {file.source === 'uploaded' ? <InsertDriveFile fontSize=\"small\" sx={{ mt: 0.2 }} /> : <MusicNote fontSize=\"small\" sx={{ mt: 0.2 }} />}\n                                                            <Typography \n                                                                variant=\"body1\" \n                                                                sx={{ \n                                                                    flex: 1,\n                                                                    minWidth: 0,\n                                                                    wordBreak: 'break-word',\n                                                                    lineHeight: 1.4\n                                                                }}\n                                                            >\n                                                                {file.fileName}\n                                                            </Typography>\n                                                        </Box>\n                                                        \n                                                        {/* 第二行：状态标签 */}\n                                                        <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, flexWrap: 'wrap', mb: 1 }}>\n                                                            {playingFile === file.filePath && (\n                                                                <Chip size=\"small\" label=\"播放中\" color=\"primary\" />\n                                                            )}\n                                                            {file.isDefault && (\n                                                                <Chip size=\"small\" label=\"默认\" color=\"success\" icon={<Star />} />\n                                                            )}\n                                                            {/* <Chip \n                                                                size=\"small\" \n                                                                label={file.source === 'uploaded' ? '上传' : '录制'} \n                                                                color={file.source === 'uploaded' ? 'secondary' : 'default'}\n                                                                variant=\"outlined\"\n                                                            /> */}\n                                                        </Box>\n                                                        \n                                                        {/* 第三行：操作按钮 */}\n                                                        <Box sx={{ display: 'flex', gap: 1, mt: 1 }}>\n                                                            <IconButton\n                                                                size=\"small\"\n                                                                onClick={() => handlePlayFile(file.filePath)}\n                                                                color={playingFile === file.filePath ? \"primary\" : \"default\"}\n                                                                title=\"播放/停止\"\n                                                                sx={{ \n                                                                    border: '1px solid',\n                                                                    borderColor: 'divider',\n                                                                    '&:hover': { backgroundColor: 'action.hover' }\n                                                                }}\n                                                            >\n                                                                {playingFile === file.filePath ? <Stop /> : <PlayArrow />}\n                                                            </IconButton>\n                                                            \n                                                            <IconButton\n                                                                size=\"small\"\n                                                                onClick={() => setAsDefaultAudio(file.filePath, 'medical')}\n                                                                color={voiceConfig.medicalDefault === file.filePath ? \"warning\" : \"default\"}\n                                                                title=\"设为医疗呼救默认\"\n                                                                sx={{ \n                                                                    border: '1px solid',\n                                                                    borderColor: 'divider',\n                                                                    '&:hover': { backgroundColor: 'action.hover' }\n                                                                }}\n                                                            >\n                                                                {voiceConfig.medicalDefault === file.filePath ? <Star /> : <StarBorder />}\n                                                            </IconButton>\n                                                            \n                                                            <IconButton\n                                                                size=\"small\"\n                                                                onClick={() => handleShareFile(file.filePath)}\n                                                                title=\"分享\"\n                                                                sx={{ \n                                                                    border: '1px solid',\n                                                                    borderColor: 'divider',\n                                                                    '&:hover': { backgroundColor: 'action.hover' }\n                                                                }}\n                                                            >\n                                                                <Share />\n                                                            </IconButton>\n                                                            \n                                                            <IconButton\n                                                                size=\"small\"\n                                                                onClick={() => handleDeleteFile(file.filePath)}\n                                                                color=\"error\"\n                                                                title=\"删除\"\n                                                                sx={{ \n                                                                    border: '1px solid',\n                                                                    borderColor: 'divider',\n                                                                    '&:hover': { backgroundColor: 'action.hover' }\n                                                                }}\n                                                            >\n                                                                <Delete />\n                                                            </IconButton>\n                                                        </Box>\n                                                    </Box>\n                                                }\n                                                secondary={\n                                                    <Box>\n                                                        <Typography variant=\"body2\" color=\"text.secondary\">\n                                                            大小: {formatFileSize(file.fileSize)} | 创建: {formatTime(file.createTime)}\n                                                            {file.duration && file.duration > 0 && ` | ${formatDuration(file.duration)}`}\n                                                        </Typography>\n                                                        {file.mimeType && (\n                                                            <Typography variant=\"caption\" color=\"text.secondary\" sx={{ display: 'block' }}>\n                                                                {file.mimeType}\n                                                            </Typography>\n                                                        )}\n                                                    </Box>\n                                                }\n                                                sx={{ pr: 2 }}\n                                            />\n                                        </ListItem>\n                                        {index < fileList.length - 1 && <Divider />}\n                                    </React.Fragment>\n                                ))}\n                            </List>\n                        )}\n                    </Box>\n\n                    <Divider sx={{ my: 3 }} />\n                    <Box>\n                        \n                                <Button\n                                    variant=\"outlined\"\n                                    size=\"small\"\n                                    startIcon={<Mic />}\n                                    onClick={() => setShowRecordDialog(true)}\n                                    disabled={!ttsAvailable}\n                                >\n                                    文字转语音\n                                </Button>\n                    </Box>\n\n                    <Divider sx={{ my: 3 }} />\n\n                    {/* 上传音频文件区域 */}\n                    <Box sx={{ mb: 3 }}>\n                        <Typography variant=\"subtitle2\" fontWeight=\"bold\" sx={{ mb: 2 }}>\n                            上传音频文件\n                        </Typography>\n                        \n                        <Button\n                            variant=\"outlined\"\n                            startIcon={isUploading ? <CircularProgress size={16} /> : <CloudUpload />}\n                            onClick={handleSelectAndUploadAudioFile}\n                            disabled={isUploading}\n                            sx={{ mb: 2 }}\n                        >\n                            {isUploading ? '上传中...' : '选择并上传音频文件'}\n                        </Button>\n                        \n                        {/* 上传进度 */}\n                        {isUploading && uploadProgress > 0 && (\n                            <Box sx={{ mb: 2 }}>\n                                <LinearProgress \n                                    variant=\"determinate\" \n                                    value={uploadProgress} \n                                    sx={{ mb: 1 }}\n                                />\n                                <Typography variant=\"body2\" color=\"text.secondary\" sx={{ textAlign: 'center' }}>\n                                    上传中... {uploadProgress}%\n                                </Typography>\n                            </Box>\n                        )}\n                        \n                        {supportedFormats && supportedFormats.formats && (\n                            <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 2 }}>\n                                支持格式: {supportedFormats.formats.join(', ').toUpperCase()}<br />\n                                文件大小限制: {supportedFormats.maxFileSizeMB}MB\n                                {/* <br /> */}\n                                {/* 推荐时长: {supportedFormats.recommendedDurationSeconds}秒内 */}\n                            </Typography>\n                        )}\n                        \n                        <Typography variant=\"body2\" color=\"text.secondary\">\n                            • 支持从设备中选择现有的音频文件<br />\n                            • 上传成功后可在文件管理中设置为默认音频<br />\n                            • 上传的文件会显示\"上传\"标签以区分录制文件\n                        </Typography>\n                    </Box>\n\n                    {/* 使用说明 */}\n                    <Box sx={{ p: 2, backgroundColor: 'rgba(0,0,0,0.05)', borderRadius: 1 }}>\n                        <Typography variant=\"body2\" color=\"text.secondary\">\n                            <strong>使用说明:</strong><br />\n                            • 可以录制个性化的呼救语音，或上传现有音频文件<br />\n                            • 点击星标可以设置为医疗呼救的默认音频<br />\n                            • 启用\"优先使用录音文件\"时，会优先播放设置的默认录音<br />\n                            • 录制或上传的文件可以分享给亲友，在他们的设备上播放\n                        </Typography>\n                    </Box>\n                </Paper>\n            </Collapse>\n\n            {/* 录制对话框 */}\n            <Dialog open={showRecordDialog} onClose={() => setShowRecordDialog(false)} maxWidth=\"md\" fullWidth>\n                <DialogTitle>录制新语音</DialogTitle>\n                <DialogContent>\n                    <TextField\n                        fullWidth\n                        multiline\n                        rows={4}\n                        value={recordText}\n                        onChange={(e) => setRecordText(e.target.value)}\n                        placeholder=\"输入要转换为语音的文字...\"\n                        disabled={isRecording}\n                        sx={{ mb: 2, mt: 1 }}\n                        helperText={`当前字数: ${recordText.length} 字符`}\n                    />\n\n                    {/* 录制参数 */}\n                    <Box sx={{ mb: 2 }}>\n                        <Typography variant=\"body2\" sx={{ mb: 1 }}>\n                            语音速度: {recordSpeed}x\n                        </Typography>\n                        <Slider\n                            value={recordSpeed}\n                            onChange={(_, value) => setRecordSpeed(value as number)}\n                            min={0.5}\n                            max={2.0}\n                            step={0.1}\n                            disabled={isRecording}\n                            marks={[\n                                { value: 0.5, label: '0.5x' },\n                                { value: 1.0, label: '1.0x' },\n                                { value: 2.0, label: '2.0x' },\n                            ]}\n                            sx={{ mb: 2 }}\n                        />\n\n                        <Typography variant=\"body2\" sx={{ mb: 1 }}>\n                            语音音调: {recordPitch}x\n                        </Typography>\n                        <Slider\n                            value={recordPitch}\n                            onChange={(_, value) => setRecordPitch(value as number)}\n                            min={0.5}\n                            max={2.0}\n                            step={0.1}\n                            disabled={isRecording}\n                            marks={[\n                                { value: 0.5, label: '低' },\n                                { value: 1.0, label: '标准' },\n                                { value: 2.0, label: '高' },\n                            ]}\n                        />\n                    </Box>\n\n                    {/* 录制进度 */}\n                    {isRecording && (\n                        <Box sx={{ mb: 2 }}>\n                            <LinearProgress />\n                            <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1, textAlign: 'center' }}>\n                                正在录制中，请稍候...\n                            </Typography>\n                        </Box>\n                    )}\n                </DialogContent>\n                <DialogActions>\n                    <Button \n                        onClick={() => setShowRecordDialog(false)} \n                        disabled={isRecording}\n                    >\n                        取消\n                    </Button>\n                    <Button \n                        onClick={handleRecord} \n                        variant=\"contained\"\n                        disabled={!recordText.trim() || isRecording}\n                    >\n                        {isRecording ? '录制中...' : '开始录制'}\n                    </Button>\n                </DialogActions>\n            </Dialog>\n\n            {/* 成功提示 */}\n            <Snackbar\n                open={showSuccess}\n                autoHideDuration={3000}\n                onClose={() => setShowSuccess(false)}\n                anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n            >\n                <Alert onClose={() => setShowSuccess(false)} severity=\"success\">\n                    {successMessage}\n                </Alert>\n            </Snackbar>\n\n            {/* 错误提示 */}\n            <Snackbar\n                open={showError}\n                autoHideDuration={6000}\n                onClose={() => setShowError(false)}\n                anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n            >\n                <Alert onClose={() => setShowError(false)} severity=\"error\">\n                    {errorMessage}\n                </Alert>\n            </Snackbar>\n        </Box>\n    );\n});\n\nexport default VoiceEmergencySettings;","import React, { useState, useEffect, useRef } from 'react';\nimport { \n    Box, \n    TextField, \n    Typography, \n    Paper, \n    Accordion, \n    AccordionSummary, \n    AccordionDetails,\n    Divider\n} from '@mui/material';\nimport { ExpandMore as ExpandMoreIcon } from '@mui/icons-material';\nimport { autoWebViewJs } from '@droid/android';\nimport { PermissionStatusPanel } from './components/PermissionStatusPanel';\nimport { PreAlarmConfig, EmergencyTTSSettings } from './components';\nimport toast from 'react-hot-toast';\nimport VoiceEmergencySettings, { VoiceEmergencySettingsRef } from './components/VoiceEmergencySettings';\n\ninterface FallDetectionSettingsProps {\n    voiceSettingsRef?: React.RefObject<VoiceEmergencySettingsRef>;\n}\n// import { VoiceEmergencySettings } from '@src/components/voice-emergency-settings';\n\nexport const FallDetectionSettings: React.FC<FallDetectionSettingsProps> = ({ voiceSettingsRef }) => {\n    const [threshold, setThreshold] = useState<string>('5.0');\n    const [lastValidThreshold, setLastValidThreshold] = useState<string>('5.0');\n    const debounceTimerRef = useRef<NodeJS.Timeout | null>(null);\n    const localVoiceSettingsRef = useRef<VoiceEmergencySettingsRef>(null);\n    const effectiveVoiceSettingsRef = voiceSettingsRef || localVoiceSettingsRef;\n    \n    // 权限面板展开状态和统计数据\n    const [permissionExpanded, setPermissionExpanded] = useState(false);\n    const [permissionStats, setPermissionStats] = useState({ granted: 0, denied: 0, unknown: 0 });\n\n    // 从Android端获取阈值的函数\n    const fetchThresholdFromAndroid = async (): Promise<string> => {\n        try {\n            const script = `\n            var thresholdValue = com.fanfanlo.emergencycall.manager.SensorManager.getThreshold();\n            thresholdValue;`;\n            const { javaResultString } = autoWebViewJs.callScript(script);\n            const thresholdValue = parseFloat(javaResultString || '5.0');\n            return thresholdValue.toString();\n        } catch (error) {\n            console.error('Error fetching threshold value:', error);\n            return '5.0';\n        }\n    };\n\n    useEffect(() => {\n        const initializeThreshold = async () => {\n            const fetchedThreshold = await fetchThresholdFromAndroid();\n            setThreshold(fetchedThreshold);\n            setLastValidThreshold(fetchedThreshold);\n        };\n        initializeThreshold();\n\n        // 清理函数\n        return () => {\n            if (debounceTimerRef.current) {\n                clearTimeout(debounceTimerRef.current);\n            }\n        };\n    }, []);\n\n\n    // 提交阈值到Android端\n    const submitThreshold = async (thresholdValue: number): Promise<boolean> => {\n        try {\n            const script = `com.fanfanlo.emergencycall.manager.SensorManager.updateThreshold(${thresholdValue});`;\n            autoWebViewJs.callScript(script);\n            console.log(`阈值已设置为: ${thresholdValue}`);\n            toast.success('阈值设置成功');\n            return true;\n        } catch (error) {\n            console.error('Error calling updateThreshold:', error);\n            toast.error('阈值设置失败:' + error);\n            return false;\n        }\n    };\n\n    // 验证阈值是否合法\n    const isValidThreshold = (value: string): boolean => {\n        const numValue = parseFloat(value);\n        return !isNaN(numValue) && numValue > 0;\n    };\n\n    // 显示toast提示\n    const showToast = (message: string) => {\n        // 使用简单的alert作为toast提示，实际项目中可以使用更好的toast库\n        alert(message);\n    };\n\n    // 防抖的onChange处理函数\n    const handleThresholdChange = (newValue: string) => {\n        setThreshold(newValue);\n        \n        // 取消之前的定时器\n        if (debounceTimerRef.current) {\n            clearTimeout(debounceTimerRef.current);\n        }\n        \n        // 设置新的定时器\n        debounceTimerRef.current = setTimeout(async () => {\n            if (isValidThreshold(newValue)) {\n                // 数值合法，提交更改\n                const numValue = parseFloat(newValue);\n                const success = await submitThreshold(numValue);\n                if (success) {\n                    setLastValidThreshold(newValue);\n                } else {\n                    showToast('设置阈值失败，请确保您在安卓应用中');\n                    // 恢复为上次合法值\n                    setThreshold(lastValidThreshold);\n                }\n            } else {\n                // 数值不合法，提示并恢复\n                showToast('请输入一个有效的数字作为阈值');\n                if (lastValidThreshold) {\n                    setThreshold(lastValidThreshold);\n                } else {\n                    // 如果没有存储的合法值，从Android端获取\n                    const fetchedThreshold = await fetchThresholdFromAndroid();\n                    setThreshold(fetchedThreshold);\n                    setLastValidThreshold(fetchedThreshold);\n                }\n            }\n        }, 1500); // 1.5秒延迟\n    };\n\n\n\n\n    return (\n        <Box sx={{ p: 2 }}>\n            {/* 传感器监控控制面板 */}\n            <Paper elevation={1} sx={{ padding: 2, marginBottom: 2 }}>\n                <Typography variant=\"h6\" gutterBottom>\n                    传感器\n                </Typography>\n                <Box sx={{ display: 'flex', alignItems: 'center', gap: 2, marginBottom: 2 }}>\n                    <TextField\n                        label=\"震动阈值\"\n                        variant=\"outlined\"\n                        type=\"number\"\n                        value={threshold}\n                        onChange={(e) => handleThresholdChange(e.target.value)}\n                        size=\"small\"\n                        helperText=\"摔倒、碰撞检测，数值越小越灵敏，一般在3-15之间，手机不同，需您自行测试。\"\n                    />\n                </Box>\n            </Paper>\n\n            {/* 权限状态面板 */}\n            <Accordion \n                sx={{ marginBottom: 2 }}\n                expanded={permissionExpanded}\n                onChange={(event, isExpanded) => setPermissionExpanded(isExpanded)}\n            >\n                <AccordionSummary\n                    expandIcon={<ExpandMoreIcon />}\n                    aria-controls=\"permission-panel-content\"\n                    id=\"permission-panel-header\"\n                >\n                    <Box sx={{ display: 'flex', flexDirection: 'column', width: '100%' }}>\n                        <Typography variant=\"h6\" sx={{ fontWeight: 600 }}>\n                            权限\n                        </Typography>\n                        \n                        {/* 统计子标题 */}\n                        <Box sx={{ display: 'flex', alignItems: 'center', gap: 2, mt: 0.5 }}>\n                            <Box sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}>\n                                <Box \n                                    sx={{ \n                                        width: 8, \n                                        height: 8, \n                                        borderRadius: '50%', \n                                        backgroundColor: 'success.main' \n                                    }} \n                                />\n                                <Typography variant=\"caption\" color=\"success.main\">\n                                    已授权/{permissionStats.granted}\n                                </Typography>\n                            </Box>\n                            \n                            <Box sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}>\n                                <Box \n                                    sx={{ \n                                        width: 8, \n                                        height: 8, \n                                        borderRadius: '50%', \n                                        backgroundColor: 'error.main' \n                                    }} \n                                />\n                                <Typography variant=\"caption\" color=\"error.main\">\n                                    未授权/{permissionStats.denied}\n                                </Typography>\n                            </Box>\n                            \n                            <Box sx={{ display: 'flex', alignItems: 'center', gap: 0.5 }}>\n                                <Box \n                                    sx={{ \n                                        width: 8, \n                                        height: 8, \n                                        borderRadius: '50%', \n                                        backgroundColor: 'warning.main' \n                                    }} \n                                />\n                                <Typography variant=\"caption\" color=\"warning.main\">\n                                    未知/{permissionStats.unknown}\n                                </Typography>\n                            </Box>\n                        </Box>\n                    </Box>\n                </AccordionSummary>\n                <AccordionDetails>\n                    <PermissionStatusPanel \n                        isExpanded={permissionExpanded}\n                        onStatsChange={setPermissionStats}\n                    />\n                </AccordionDetails>\n            </Accordion>\n\n            <Divider sx={{ my: 3 }} />\n\n            {/* 防误触报警设置 */}\n            <Box sx={{ mb: 3 }}>\n                {/* <Typography variant=\"h6\" gutterBottom>\n                    防误触设置\n                </Typography> */}\n                <PreAlarmConfig />\n            </Box>\n\n            <Divider sx={{ my: 3 }} />\n\n            {/* 紧急呼救语音设置 */}\n            <Box sx={{ mb: 3 }}>\n                <VoiceEmergencySettings ref={effectiveVoiceSettingsRef} />\n            </Box>\n\n        </Box>\n    );\n};\n\nexport default FallDetectionSettings;","// 事件常量定义\nexport const SENSOR_MONITORING_STATE_CHANGED = \"sensor_monitoring_state_changed\";","import React, { useState, useEffect, useRef } from 'react';\nimport {\n    Box,\n    Paper,\n    Typography,\n    IconButton,\n    Collapse,\n    Switch,\n    FormControlLabel,\n    useTheme,\n    alpha,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogContentText,\n    DialogTitle,\n    Button\n} from '@mui/material';\nimport FallRescueAnimation from './components/FallRescueAnimation';\nimport {\n    ExpandLess,\n    ExpandMore,\n    Animation as AnimationIcon\n} from '@mui/icons-material';\nimport { autoJsStoreUtils, autoWebViewJs } from '@droid/android';\nimport { authService } from '@src/services/authService';\nimport FallDetectionSettings from './FallDetectionSettings';\nimport { VoiceEmergencySettingsRef } from './components/VoiceEmergencySettings';\nimport { SENSOR_MONITORING_STATE_CHANGED } from './constants';\nimport { PrivacyDialogDisplay } from '@src/components/privacies/PrivacyDialogDisplay';\n\ninterface FallDetectionWrapperProps {\n    title: string;\n    isExpanded: boolean;\n    onToggleExpanded: (expanded: boolean) => void;\n    animationType?: 'fall' | 'shake';\n}\n\n// 配置选项\nconst REQUIRE_LOGIN_FOR_FALL_DETECTION = true; // 默认不启用登录检测\n\nconst FallDetectionWrapper: React.FC<FallDetectionWrapperProps> = ({\n    title,\n    isExpanded,\n    onToggleExpanded,\n    animationType\n}) => {\n    const theme = useTheme();\n\n    // 复制自 SensorMonitor.tsx - 状态管理\n    const [fallThreshold, setFallThreshold] = useState<string>('5.0');\n    const voiceSettingsRef = useRef<VoiceEmergencySettingsRef>(null);\n    \n    // 监听展开状态变化，展开时重新加载VoiceEmergencySettings配置\n    useEffect(() => {\n        if (isExpanded && voiceSettingsRef.current) {\n            voiceSettingsRef.current.reloadConfig();\n        }\n    }, [isExpanded]);\n    \n    const [fallIsMonitoring, setFallIsMonitoring] = useState<boolean>(false);\n    const [fallSensorInfoDialogOpen, setFallSensorInfoDialogOpen] = useState(false);\n    const [fallForegroundServiceDialogOpen, setFallForegroundServiceDialogOpen] = useState(false);\n    \n    // 隐私协议相关状态\n    const [privacyDialogOpen, setPrivacyDialogOpen] = useState(false);\n\n    // 复制自 SensorMonitor.tsx - useRef\n    const fallSensorCallbackRef = useRef<(passed: boolean) => void>();\n    const fallForegroundServiceCallbackRef = useRef<(passed: boolean) => void>();\n    const privacyCallbackRef = useRef<(passed: boolean) => void>();\n\n    // 复制自 SensorMonitor.tsx - 初始化阈值\n    useEffect(() => {\n        try {\n            const script = `\n            var thresholdValue = com.fanfanlo.emergencycall.manager.SensorManager.getThreshold();\n            thresholdValue;`;\n            const { javaResultString } = autoWebViewJs.callScript(script);\n            const thresholdValue = parseFloat(javaResultString || '5.0');\n            setFallThreshold(thresholdValue.toString());\n        } catch (error) {\n            console.error('Error fetching initial threshold value:', error);\n        }\n    }, []);\n\n    // 复制自 SensorMonitor.tsx - 读取监控状态\n    function readFallIsMonitoring() {\n        try {\n            const script = `\n            var isMonitoring = com.fanfanlo.emergencycall.manager.SensorManager.isMonitoring();\n            isMonitoring;`;\n            const { javaResultString } = autoWebViewJs.callScript(script);\n            const isMonitoring = javaResultString === \"true\";\n            setFallIsMonitoring(isMonitoring);\n        } catch (error) {\n            console.error('Error fetching initial monitoring state:', error);\n        }\n    }\n\n    // 复制自 SensorMonitor.tsx - 初始化监控状态\n    useEffect(() => {\n        readFallIsMonitoring();\n        \n        // 监听Android端发送的监控状态变化事件\n        const handleMonitoringStateChange = (event: any) => {\n            const { isMonitoring: newState } = event.detail || {};\n            if (typeof newState === 'boolean') {\n                setFallIsMonitoring(newState);\n            }\n        };\n\n        window.addEventListener(SENSOR_MONITORING_STATE_CHANGED, handleMonitoringStateChange);\n        return () => window.removeEventListener(SENSOR_MONITORING_STATE_CHANGED, handleMonitoringStateChange);\n    }, []);\n\n    // 复制自 SensorMonitor.tsx - 权限检查函数\n    function checkShowFallSensorInfo(callback: (passed: boolean) => void) {\n        interface Info {\n            passed: boolean;\n        }\n        const info = autoJsStoreUtils.read<Info>('showSensorInfo', { passed: false });\n        if (!info || !info.passed) {\n            fallSensorCallbackRef.current = callback;\n            setFallSensorInfoDialogOpen(true);\n        } else {\n            callback(true);\n        }\n    }\n\n    function checkShowFallInfo(callback: (passed: boolean) => void) {\n        checkShowFallSensorInfo(passed => {\n            if (!passed) {\n                callback(false);\n                return;\n            }\n            checkShowFallForegroundServiceInfo(callback);\n        })\n    }\n\n    function checkShowFallForegroundServiceInfo(callback: (passed: boolean) => void) {\n        interface Info {\n            passed: boolean;\n        }\n        const info = autoJsStoreUtils.read<Info>('showForegroundServiceInfo', { passed: false });\n        if (!info || !info.passed) {\n            fallForegroundServiceCallbackRef.current = callback;\n            setFallForegroundServiceDialogOpen(true);\n        } else {\n            callback(true);\n        }\n    }\n\n    // 复制自 SensorMonitor.tsx - 对话框处理函数\n    const handleFallSensorDialog = (passed: boolean) => {\n        autoJsStoreUtils.write('showSensorInfo', { passed });\n        setFallSensorInfoDialogOpen(false);\n        if (fallSensorCallbackRef.current) {\n            fallSensorCallbackRef.current(passed);\n        }\n    };\n\n    const handleFallForegroundServiceDialog = (passed: boolean) => {\n        autoJsStoreUtils.write('showForegroundServiceInfo', { passed });\n        setFallForegroundServiceDialogOpen(false);\n        if (fallForegroundServiceCallbackRef.current) {\n            fallForegroundServiceCallbackRef.current(passed);\n        }\n    };\n\n    // 检查隐私协议是否已同意\n    function checkPrivacyAgreement(callback: (passed: boolean) => void): boolean {\n        interface IPrivacyInfo {\n            agree: boolean;\n            disagreeTime: number;\n        }\n        \n        const def: IPrivacyInfo = { agree: false, disagreeTime: 0 };\n        const res = autoJsStoreUtils.read<IPrivacyInfo>(`privacy_main`, def);\n        const value: IPrivacyInfo = res && 'agree' in res ? res : def;\n        \n        // 已经同意了\n        if (value.agree) {\n            callback(true);\n            return true;\n        }\n        \n        // 需要弹出隐私协议（去掉冷却期逻辑）\n        privacyCallbackRef.current = callback;\n        setPrivacyDialogOpen(true);\n        return false;\n    }\n\n    // 处理隐私协议弹窗关闭\n    const handlePrivacyDialogClose = (agreed?: boolean) => {\n        setPrivacyDialogOpen(false);\n        if (privacyCallbackRef.current) {\n            privacyCallbackRef.current(agreed === true);\n        }\n    };\n\n    // 复制自 SensorMonitor.tsx - 主要的开关处理函数\n    async function handleToggleFallMonitoring(enabled: boolean) {\n        if (enabled) {\n            // 1. 先检查隐私协议\n            const privacyPassed = checkPrivacyAgreement(passed => {\n                if (!passed) return;\n                \n                // 2. 条件性检查登录状态\n                if (REQUIRE_LOGIN_FOR_FALL_DETECTION) {\n                    authService.showLoginDialog().then(appLoggedIn => {\n                        if (!appLoggedIn) {\n                            alert(\"未登录无法使用该功能\");\n                            return;\n                        }\n                        \n                        // 3. 检查权限，然后启动\n                        checkShowFallInfo(permissionPassed => {\n                            if (!permissionPassed) return;\n                            try {\n                                const script = `com.fanfanlo.emergencycall.manager.SensorManager.startMonitoring();`;\n                                autoWebViewJs.callScript(script);\n                            } catch (error) {\n                                console.error('Error starting monitoring:', error);\n                                alert('开始监控失败。');\n                            }\n                        });\n                    });\n                } else {\n                    // 跳过登录检测，直接进入权限检测\n                    checkShowFallInfo(permissionPassed => {\n                        if (!permissionPassed) return;\n                        try {\n                            const script = `com.fanfanlo.emergencycall.manager.SensorManager.startMonitoring();`;\n                            autoWebViewJs.callScript(script);\n                        } catch (error) {\n                            console.error('Error starting monitoring:', error);\n                            alert('开始监控失败。');\n                        }\n                    });\n                }\n            });\n            \n            // 如果隐私协议已通过，直接继续执行\n            if (privacyPassed) {\n                // 2. 条件性检查登录状态\n                if (REQUIRE_LOGIN_FOR_FALL_DETECTION) {\n                    const appLoggedIn = await authService.showLoginDialog();\n                    if (!appLoggedIn) {\n                        alert(\"未登录无法使用该功能\");\n                        return;\n                    }\n                }\n                \n                // 3. 检查权限，然后启动\n                checkShowFallInfo(passed => {\n                    if (!passed) return;\n                    try {\n                        const script = `com.fanfanlo.emergencycall.manager.SensorManager.startMonitoring();`;\n                        autoWebViewJs.callScript(script);\n                    } catch (error) {\n                        console.error('Error starting monitoring:', error);\n                        alert('开始监控失败。');\n                    }\n                });\n            }\n        } else {\n            // 直接停止，不进行检查\n            try {\n                const script = `com.fanfanlo.emergencycall.manager.SensorManager.stopMonitoring();`;\n                autoWebViewJs.callScript(script);\n            } catch (error) {\n                console.error('Error stopping monitoring:', error);\n                alert('停止监控失败。');\n            }\n        }\n    }\n\n    // 复制自 SensorMonitor.tsx - 定时检查监控状态\n    useEffect(() => {\n        const id = setInterval(() => {\n            readFallIsMonitoring();\n        }, 3000); // 每3秒检查一次监控状态\n        return () => clearInterval(id);\n    }, []);\n\n    // 动画占位组件\n    const AnimationPlaceholder: React.FC<{ type?: 'fall' | 'shake' }> = ({ type }) => {\n        const getAnimationContent = () => {\n            switch (type) {\n                case 'fall':\n                    return {\n                        icon: '🚶‍♂️',\n                        title: '摔倒检测',\n                        description: '检测到意外跌倒时自动触发紧急呼救',\n                        color: theme.palette.error.main\n                    };\n                case 'shake':\n                    return {\n                        icon: '📱',\n                        title: '摇一摇报警',\n                        description: '快速摇动手机触发紧急呼救',\n                        color: theme.palette.warning.main\n                    };\n                default:\n                    return {\n                        icon: '🚨',\n                        title: '紧急呼救',\n                        description: '紧急情况下的自动求助功能',\n                        color: theme.palette.primary.main\n                    };\n            }\n        };\n\n        const content = getAnimationContent();\n\n        return (\n            <Box sx={{ \n                textAlign: 'center',\n                color: 'text.secondary',\n                px: 4\n            }}>\n                <Box sx={{ \n                    fontSize: 72, \n                    mb: 2,\n                    animation: 'pulse 2s infinite',\n                    '@keyframes pulse': {\n                        '0%': { transform: 'scale(1)' },\n                        '50%': { transform: 'scale(1.1)' },\n                        '100%': { transform: 'scale(1)' }\n                    }\n                }}>\n                    {content.icon}\n                </Box>\n                <Typography \n                    variant=\"h5\" \n                    sx={{ \n                        mb: 1, \n                        fontWeight: 600,\n                        color: content.color\n                    }}\n                >\n                    {content.title}\n                </Typography>\n                <Typography \n                    variant=\"body1\" \n                    sx={{ \n                        color: 'text.secondary',\n                        lineHeight: 1.6\n                    }}\n                >\n                    {content.description}\n                </Typography>\n                <Box sx={{\n                    mt: 3,\n                    display: 'flex',\n                    justifyContent: 'center',\n                    alignItems: 'center',\n                    gap: 1,\n                    color: 'text.disabled'\n                }}>\n                    <AnimationIcon sx={{ fontSize: 20 }} />\n                    <Typography variant=\"caption\">\n                        点击展开设置\n                    </Typography>\n                </Box>\n            </Box>\n        );\n    };\n\n    return (\n        <Paper \n            sx={{ \n                mb: 2, \n                overflow: 'hidden',\n                border: `1px solid ${alpha(theme.palette.primary.main, 0.2)}`,\n                '&:hover': {\n                    boxShadow: theme.shadows[4]\n                }\n            }}\n        >\n            {/* 标题栏 */}\n            <Box \n                sx={{ \n                    p: 2, \n                    display: 'flex', \n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    backgroundColor: alpha(theme.palette.primary.main, 0.05),\n                    '&:hover': {\n                        backgroundColor: alpha(theme.palette.primary.main, 0.1)\n                    }\n                }}\n            >\n                {/* 左侧：标题和开关 */}\n                <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\n                    <Typography \n                        variant=\"h6\" \n                        sx={{ \n                            fontWeight: 600,\n                            color: theme.palette.primary.main\n                        }}\n                    >\n                        {title}\n                    </Typography>\n                    \n                    {/* 启用/禁用开关 */}\n                    <FormControlLabel\n                        control={\n                            <Switch\n                                checked={fallIsMonitoring}\n                                onChange={(e) => handleToggleFallMonitoring(e.target.checked)}\n                                size=\"small\"\n                                color=\"primary\"\n                            />\n                        }\n                        label={\n                            <Typography variant=\"body2\" color=\"text.secondary\">\n                                {fallIsMonitoring ? '已启用' : '未启用'}\n                            </Typography>\n                        }\n                        onClick={(e) => e.stopPropagation()}\n                        sx={{ margin: 0 }}\n                    />\n                </Box>\n\n                {/* 右侧：展开/收起按钮 */}\n                <IconButton \n                    size=\"small\"\n                    onClick={() => onToggleExpanded(!isExpanded)}\n                    sx={{ \n                        color: theme.palette.primary.main,\n                        transform: isExpanded ? 'rotate(180deg)' : 'rotate(0deg)',\n                        transition: 'transform 0.2s ease-in-out'\n                    }}\n                >\n                    <ExpandMore />\n                </IconButton>\n            </Box>\n            \n            {/* 内容区 */}\n            <Box>\n                {/* 动画区域 - 折叠时显示 */}\n                <Collapse in={!isExpanded}>\n                    <Box sx={{ \n                        height: 300,\n                        width: '100%',\n                        display: 'flex', \n                        alignItems: 'center', \n                        justifyContent: 'center',\n                        backgroundColor: alpha(theme.palette.background.paper, 0.8),\n                        borderTop: `1px solid ${theme.palette.divider}`,\n                        position: 'relative',\n                        overflow: 'hidden'\n                    }}>\n                        <FallRescueAnimation type={animationType} />\n                    </Box>\n                </Collapse>\n                \n                {/* 设置区域 - 展开时显示 */}\n                <Collapse in={isExpanded}>\n                    <Box sx={{ \n                        borderTop: `1px solid ${theme.palette.divider}`,\n                        backgroundColor: theme.palette.background.paper\n                    }}>\n                        <FallDetectionSettings voiceSettingsRef={voiceSettingsRef} />\n                    </Box>\n                </Collapse>\n            </Box>\n\n            {/* 复制自 SensorMonitor.tsx - 传感器权限说明对话框 */}\n            <Dialog\n                open={fallSensorInfoDialogOpen}\n                onClose={() => handleFallSensorDialog(false)}\n                aria-labelledby=\"fall-sensor-dialog-title\"\n                aria-describedby=\"fall-sensor-dialog-description\"\n            >\n                <DialogTitle id=\"fall-sensor-dialog-title\">\n                    {\"传感器使用授权\"}\n                </DialogTitle>\n                <DialogContent>\n                    <DialogContentText id=\"fall-sensor-dialog-description\">\n                        我们需要获取您的身体传感器（如加速度计）权限，以实现跌倒检测功能。这对于在紧急情况下自动触发呼叫至关重要。您是否同意？\n                    </DialogContentText>\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={() => handleFallSensorDialog(false)}>不同意</Button>\n                    <Button onClick={() => handleFallSensorDialog(true)} autoFocus>\n                        同意\n                    </Button>\n                </DialogActions>\n            </Dialog>\n\n            {/* 复制自 SensorMonitor.tsx - 前台服务通知对话框 */}\n            <Dialog\n                open={fallForegroundServiceDialogOpen}\n                onClose={() => handleFallForegroundServiceDialog(false)}\n                aria-labelledby=\"fall-foreground-dialog-title\"\n                aria-describedby=\"fall-foreground-dialog-description\"\n            >\n                <DialogTitle id=\"fall-foreground-dialog-title\">\n                    {\"启用前台服务通知\"}\n                </DialogTitle>\n                <DialogContent>\n                    <DialogContentText id=\"fall-foreground-dialog-description\">\n                        为了在应用退到后台后仍能持续监控传感器数据，我们需要启用一个前台服务。这会在您的设备通知栏显示一个持续的通知。您是否同意？\n                    </DialogContentText>\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={() => handleFallForegroundServiceDialog(false)}>不同意</Button>\n                    <Button onClick={() => handleFallForegroundServiceDialog(true)} autoFocus>\n                        同意\n                    </Button>\n                </DialogActions>\n            </Dialog>\n\n            {/* 隐私协议弹窗 */}\n            <PrivacyDialogDisplay\n                open={privacyDialogOpen}\n                onClose={handlePrivacyDialogClose}\n                type=\"main\"\n                area=\"zh-cn\"\n            />\n        </Paper>\n    );\n};\n\nexport default FallDetectionWrapper;","import React, { useState, useEffect } from 'react';\nimport {\n    Box,\n    Container,\n    Typography,\n    Paper,\n    Alert,\n    Divider\n} from '@mui/material';\nimport { useProxyWatch } from '@fanfanlo';\nimport { user } from '@app/model';\nimport { autoWebViewJs } from '@droid/android';\n\nimport FallDetectionWrapper from './FallDetectionWrapper';\nimport ShakeDetectionWrapper from './ShakeDetectionWrapper';\nimport { SENSOR_MONITORING_STATE_CHANGED } from './constants';\n\nconst EmergencyCallSettings: React.FC = () => {\n    // UI展开状态管理\n    const [fallExpanded, setFallExpanded] = useState(false);\n    const [shakeExpanded, setShakeExpanded] = useState(false);\n    \n    // 状态管理现在由各自的Wrapper组件内部处理，这里只需要UI展开状态\n\n    // 监听用户登录状态\n    const [userToken] = useProxyWatch(user, 'data.storeData.user_token', user.data.storeData.user_token);\n    const isLoggedIn = !!userToken;\n\n    // 确保同一时间只有一个功能展开\n    const handleToggleExpanded = (\n        type: 'fall' | 'shake', \n        expanded: boolean\n    ) => {\n        if (expanded) {\n            // 如果要展开，先收起其他的\n            setFallExpanded(type === 'fall');\n            setShakeExpanded(type === 'shake');\n        } else {\n            // 如果要收起，只收起当前的\n            switch (type) {\n                case 'fall':\n                    setFallExpanded(false);\n                    break;\n                case 'shake':\n                    setShakeExpanded(false);\n                    break;\n            }\n        }\n    };\n\n    // 状态管理和事件监听现在由各自的Wrapper组件内部处理\n\n    return (\n        <Container maxWidth=\"md\" sx={{ py: 3 }}>\n            {/* 页面标题 */}\n            {/* <Paper sx={{ p: 3, mb: 3, textAlign: 'center' }}>\n                <Typography \n                    variant=\"h4\" \n                    component=\"h1\" \n                    sx={{ \n                        mb: 1, \n                        fontWeight: 700,\n                        background: 'linear-gradient(45deg, #ff6b6b, #4ecdc4)',\n                        backgroundClip: 'text',\n                        WebkitBackgroundClip: 'text',\n                        WebkitTextFillColor: 'transparent'\n                    }}\n                >\n                    🚨 紧急呼救设置\n                </Typography>\n                <Typography \n                    variant=\"body1\" \n                    color=\"text.secondary\"\n                    sx={{ mb: 2 }}\n                >\n                    配置您的紧急求助功能，确保关键时刻能及时获得帮助\n                </Typography>\n                \n                {!isLoggedIn && (\n                    <Alert severity=\"info\" sx={{ mt: 2 }}>\n                        <Typography variant=\"body2\">\n                            部分功能需要登录后才能使用，建议先完成登录\n                        </Typography>\n                    </Alert>\n                )}\n            </Paper> */}\n\n            {/* 功能模块 */}\n            <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\n                {/* 摔倒检测 */}\n                <FallDetectionWrapper\n                    title=\"📱 摔倒呼救\"\n                    isExpanded={fallExpanded}\n                    onToggleExpanded={(expanded) => handleToggleExpanded('fall', expanded)}\n                    animationType=\"fall\"\n                />\n\n                {/* 摇一摇检测 */}\n                {/* <ShakeDetectionWrapper\n                    title=\"🤳 摇一摇呼救\"\n                    isExpanded={shakeExpanded}\n                    onToggleExpanded={(expanded) => handleToggleExpanded('shake', expanded)}\n                    animationType=\"shake\"\n                /> */}\n            </Box>\n\n            {/* 使用说明 */}\n            {/* <Paper sx={{ p: 3, mt: 4, backgroundColor: 'rgba(0,0,0,0.02)' }}>\n                <Typography variant=\"h6\" gutterBottom sx={{ fontWeight: 600 }}>\n                    💡 使用说明\n                </Typography>\n                <Divider sx={{ mb: 2 }} />\n                <Box component=\"ul\" sx={{ pl: 2, m: 0 }}>\n                    <Typography component=\"li\" variant=\"body2\" sx={{ mb: 1, lineHeight: 1.6 }}>\n                        <strong>摔倒呼救</strong>：通过手机传感器检测意外跌倒，自动触发紧急呼救，包含防误触设置和语音配置\n                    </Typography>\n                    <Typography component=\"li\" variant=\"body2\" sx={{ mb: 1, lineHeight: 1.6 }}>\n                        <strong>摇一摇呼救</strong>：快速摇动手机触发紧急求助，支持自定义检测参数和语音设置\n                    </Typography>\n                </Box>\n                <Alert severity=\"warning\" sx={{ mt: 2 }}>\n                    <Typography variant=\"body2\">\n                        <strong>重要提醒</strong>：请在非紧急情况下测试各功能，确保在真正需要时能正常工作\n                    </Typography>\n                </Alert>\n            </Paper> */}\n        </Container>\n    );\n};\n\nexport default EmergencyCallSettings;","import React, { useState } from 'react';\nimport {\n    Box,\n    Paper,\n    Typography,\n    IconButton,\n    Collapse,\n    Switch,\n    FormControlLabel,\n    useTheme,\n    alpha\n} from '@mui/material';\nimport {\n    ExpandLess,\n    ExpandMore,\n    Animation as AnimationIcon\n} from '@mui/icons-material';\n\ninterface FunctionWrapperProps {\n    title: string;\n    isExpanded: boolean;\n    onToggleExpanded: (expanded: boolean) => void;\n    animationType?: 'fall' | 'shake';\n    enabled?: boolean;\n    onToggleEnabled?: (enabled: boolean) => void;\n    children: React.ReactNode;\n}\n\nconst FunctionWrapper: React.FC<FunctionWrapperProps> = ({\n    title,\n    isExpanded,\n    onToggleExpanded,\n    animationType,\n    enabled,\n    onToggleEnabled,\n    children\n}) => {\n    const theme = useTheme();\n\n    return (\n        <Paper \n            sx={{ \n                mb: 2, \n                overflow: 'hidden',\n                border: `1px solid ${alpha(theme.palette.primary.main, 0.2)}`,\n                '&:hover': {\n                    boxShadow: theme.shadows[4]\n                }\n            }}\n        >\n            {/* 标题栏 */}\n            <Box \n                sx={{ \n                    p: 2, \n                    display: 'flex', \n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    backgroundColor: alpha(theme.palette.primary.main, 0.05),\n                    '&:hover': {\n                        backgroundColor: alpha(theme.palette.primary.main, 0.1)\n                    }\n                }}\n            >\n                {/* 左侧：标题和开关 */}\n                <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\n                    <Typography \n                        variant=\"h6\" \n                        sx={{ \n                            fontWeight: 600,\n                            color: theme.palette.primary.main\n                        }}\n                    >\n                        {title}\n                    </Typography>\n                    \n                    {/* 启用/禁用开关 */}\n                    {onToggleEnabled !== undefined && (\n                        <FormControlLabel\n                            control={\n                                <Switch\n                                    checked={enabled || false}\n                                    onChange={(e) => onToggleEnabled(e.target.checked)}\n                                    size=\"small\"\n                                    color=\"primary\"\n                                />\n                            }\n                            label={\n                                <Typography variant=\"body2\" color=\"text.secondary\">\n                                    {enabled ? '已启用' : '未启用'}\n                                </Typography>\n                            }\n                            onClick={(e) => e.stopPropagation()}\n                            sx={{ margin: 0 }}\n                        />\n                    )}\n                </Box>\n\n                {/* 右侧：展开/收起按钮 */}\n                <IconButton \n                    size=\"small\"\n                    onClick={() => onToggleExpanded(!isExpanded)}\n                    sx={{ \n                        color: theme.palette.primary.main,\n                        transform: isExpanded ? 'rotate(180deg)' : 'rotate(0deg)',\n                        transition: 'transform 0.2s ease-in-out'\n                    }}\n                >\n                    <ExpandMore />\n                </IconButton>\n            </Box>\n            \n            {/* 内容区 */}\n            <Box>\n                {/* 动画区域 - 折叠时显示 */}\n                <Collapse in={!isExpanded}>\n                    <Box sx={{ \n                        height: 300,\n                        width: '100%',\n                        display: 'flex', \n                        alignItems: 'center', \n                        justifyContent: 'center',\n                        backgroundColor: alpha(theme.palette.background.paper, 0.8),\n                        borderTop: `1px solid ${theme.palette.divider}`,\n                        position: 'relative',\n                        overflow: 'hidden'\n                    }}>\n                        <AnimationPlaceholder type={animationType} />\n                    </Box>\n                </Collapse>\n                \n                {/* 设置区域 - 展开时显示 */}\n                <Collapse in={isExpanded}>\n                    <Box sx={{ \n                        borderTop: `1px solid ${theme.palette.divider}`,\n                        backgroundColor: theme.palette.background.paper\n                    }}>\n                        {children}\n                    </Box>\n                </Collapse>\n            </Box>\n        </Paper>\n    );\n};\n\n// 动画占位组件\nconst AnimationPlaceholder: React.FC<{ type?: 'fall' | 'shake' }> = ({ type }) => {\n    const theme = useTheme();\n    \n    const getAnimationContent = () => {\n        switch (type) {\n            case 'fall':\n                return {\n                    icon: '🚶‍♂️',\n                    title: '摔倒检测',\n                    description: '检测到意外跌倒时自动触发紧急呼救',\n                    color: theme.palette.error.main\n                };\n            case 'shake':\n                return {\n                    icon: '📱',\n                    title: '摇一摇报警',\n                    description: '快速摇动手机触发紧急呼救',\n                    color: theme.palette.warning.main\n                };\n            default:\n                return {\n                    icon: '🚨',\n                    title: '紧急呼救',\n                    description: '紧急情况下的自动求助功能',\n                    color: theme.palette.primary.main\n                };\n        }\n    };\n\n    const content = getAnimationContent();\n\n    return (\n        <Box sx={{ \n            textAlign: 'center',\n            color: 'text.secondary',\n            px: 4\n        }}>\n            <Box sx={{ \n                fontSize: 72, \n                mb: 2,\n                animation: 'pulse 2s infinite',\n                '@keyframes pulse': {\n                    '0%': { transform: 'scale(1)' },\n                    '50%': { transform: 'scale(1.1)' },\n                    '100%': { transform: 'scale(1)' }\n                }\n            }}>\n                {content.icon}\n            </Box>\n            <Typography \n                variant=\"h5\" \n                sx={{ \n                    mb: 1, \n                    fontWeight: 600,\n                    color: content.color\n                }}\n            >\n                {content.title}\n            </Typography>\n            <Typography \n                variant=\"body1\" \n                sx={{ \n                    color: 'text.secondary',\n                    lineHeight: 1.6\n                }}\n            >\n                {content.description}\n            </Typography>\n            <Box sx={{\n                mt: 3,\n                display: 'flex',\n                justifyContent: 'center',\n                alignItems: 'center',\n                gap: 1,\n                color: 'text.disabled'\n            }}>\n                <AnimationIcon sx={{ fontSize: 20 }} />\n                <Typography variant=\"caption\">\n                    点击展开设置\n                </Typography>\n            </Box>\n        </Box>\n    );\n};\n\nexport default FunctionWrapper;","import React, { useState, useEffect, useCallback, useRef, useMemo } from 'react';\nimport {\n    Box,\n    Paper,\n    Typography,\n    Switch,\n    FormControlLabel,\n    TextField,\n    Select,\n    MenuItem,\n    FormControl,\n    InputLabel,\n    Chip,\n    Alert,\n    Grid,\n    Divider,\n    Button,\n    Tooltip,\n    Collapse,\n    IconButton\n} from '@mui/material';\nimport { \n    VolumeUp as VolumeUpIcon,\n    Vibration as VibrationIcon,\n    PlayArrow,\n    Stop,\n    Delete,\n    DragIndicator as DragIndicatorIcon\n} from '@mui/icons-material';\nimport { autoJsStoreUtils, autoWebViewJs } from '@droid/android';\nimport { useProxyWatch } from '@fanfanlo';\nimport { user } from '@app/model';\nimport _ from 'lodash';\nimport { DndContext, closestCenter, KeyboardSensor, PointerSensor, TouchSensor, useSensor, useSensors, DragEndEvent } from '@dnd-kit/core';\nimport { arrayMove, SortableContext, sortableKeyboardCoordinates, useSortable, verticalListSortingStrategy } from '@dnd-kit/sortable';\nimport { CSS } from '@dnd-kit/utilities';\nimport { EmergencyTTSSettings } from './components';\nimport { VoiceEmergencySettingsRef } from './components/VoiceEmergencySettings';\nimport toast from 'react-hot-toast';\n\nimport VoiceEmergencySettings from './components/VoiceEmergencySettings';\n\nconst SHAKE_CONFIG_KEY = \"shake_emergency_config\";\n\n// 阈值范围常量\nconst THRESHOLD_MIN = 7;\nconst THRESHOLD_MAX = 15;\nconst THRESHOLD_DEFAULT = 9;\n\n// 预报警动作接口\ninterface PreAlarmAction {\n    id: string;\n    type: 'sound' | 'vibration';\n    duration: number;\n    resourceId?: string;\n}\n\n// 摇一摇配置接口定义\ninterface ShakeConfig {\n    enabled: boolean;\n    shakeCount: number;\n    timeWindowMs: number;\n    emergencyType: string;\n    threshold: number;\n    // 新增参数\n    baseMotionThreshold: number;\n    directionChangeThreshold: number;\n    minMotionInterval: number;\n    cooldownDuration: number;\n    vibrationFeedback: boolean;\n    soundFeedback: boolean;\n    actions: PreAlarmAction[];\n    maxWaitDuration: number;\n    version: number;\n}\n\ninterface ShakeDetectionSettingsProps {\n    voiceSettingsRef?: React.RefObject<VoiceEmergencySettingsRef>;\n    config:ShakeConfig\n}\n// 默认配置\nconst defaultConfig: ShakeConfig = {\n    enabled: false,\n    shakeCount: 3,\n    timeWindowMs: 2000,\n    emergencyType: \"medical\",\n    threshold: THRESHOLD_DEFAULT,\n    // 新增默认值\n    baseMotionThreshold: 3.5,\n    directionChangeThreshold: 0.2,\n    minMotionInterval: 200,\n    cooldownDuration: 6000,\n    vibrationFeedback: true,\n    soundFeedback: false,\n    actions: [],\n    maxWaitDuration: 10000,\n    version: 1\n};\n\n// 配置选项定义\nconst emergencyTypeOptions = [\n    { value: \"medical\", label: \"医疗报警\" },\n    { value: \"security\", label: \"安全报警\" }\n];\n\n// 默认声音资源\nconst defaultSoundResources = [\n    { id: 'siren_gentle', name: '缓和警报' },\n    { id: 'beep_short', name: '短提示音' },\n    { id: 'alarm_clock', name: '闹钟' },\n];\n\nfunction loadConfig(): ShakeConfig {\n    const conf = autoJsStoreUtils.read(SHAKE_CONFIG_KEY, {});\n    const config = _.merge(defaultConfig, conf);\n    return config;\n}\n\nconst ShakeDetectionSettings: React.FC<ShakeDetectionSettingsProps> = ({ config: conf, voiceSettingsRef }) => {\n    const [config, setConfig] = useState<ShakeConfig>(defaultConfig);\n    const [isLoading, setIsLoading] = useState(true);\n    const [lastSaveTime, setLastSaveTime] = useState<string>('');\n    const [playingSoundId, setPlayingSoundId] = useState<string | null>(null);\n    \n    // 拖拽传感器配置\n    const sensors = useSensors(\n        useSensor(PointerSensor, {\n            activationConstraint: {\n                distance: 8,\n            },\n        }),\n        useSensor(TouchSensor, {\n            activationConstraint: {\n                delay: 250,\n                tolerance: 5,\n            },\n        }),\n        useSensor(KeyboardSensor, {\n            coordinateGetter: sortableKeyboardCoordinates,\n        })\n    );\n    \n    // 检测用户登录状态\n    const [userToken] = useProxyWatch(user, 'data.storeData.user_token', user.data.storeData.user_token);\n    const isLoggedIn = !!userToken;\n    \n    // 临时输入值状态，用于处理输入验证\n    const [tempValues, setTempValues] = useState<{\n        shakeCount?: string;\n        timeWindowMs?: string;\n        threshold?: string;\n        baseMotionThreshold?: string;\n        directionChangeThreshold?: string;\n        minMotionInterval?: string;\n        cooldownDuration?: string;\n    }>({});\n    \n    const localVoiceSettingsRef = useRef<VoiceEmergencySettingsRef>(null);\n    const effectiveVoiceSettingsRef = voiceSettingsRef || localVoiceSettingsRef;\n\n    /**\n     * 从Android端读取当前配置\n     */\n    const loadConfigFromAndroid = useCallback(() => {\n        console.log('尝试从Android端读取摇一摇配置...');\n        const conf = loadConfig();\n        console.log(SHAKE_CONFIG_KEY, 'string', JSON.stringify(conf));\n        setConfig(conf);\n        setIsLoading(false);\n    }, []);\n\n    /**\n     * 验证配置参数的有效性\n     */\n    const validateConfig = (config: ShakeConfig): boolean => {\n        return (\n            config.shakeCount >= 1 && config.shakeCount <= 10 &&\n            config.timeWindowMs > 0 && config.timeWindowMs <= 10000 &&\n            ['medical', 'security'].includes(config.emergencyType) &&\n            typeof config.threshold === 'number' &&\n            config.threshold >= 0 &&\n            // 新增验证\n            typeof config.baseMotionThreshold === 'number' && config.baseMotionThreshold >= 0.1 &&\n            typeof config.directionChangeThreshold === 'number' && \n            config.directionChangeThreshold >= -1.0 && config.directionChangeThreshold <= 1.0 &&\n            typeof config.minMotionInterval === 'number' && config.minMotionInterval >= 50 &&\n            typeof config.cooldownDuration === 'number' && config.cooldownDuration >= 1000 &&\n            config.version > 0\n        );\n    };\n\n    /**\n     * 保存配置到Android端\n     */\n    const saveConfigToAndroid = useCallback((newConfig: ShakeConfig) => {\n        try {\n            console.log('保存摇一摇配置到Android端:', newConfig);\n            \n            // 验证配置有效性\n            if (!validateConfig(newConfig)) {\n                console.error('配置参数无效，不进行保存');\n                return;\n            }\n\n            const config = loadConfig();\n            newConfig.enabled = config.enabled;\n            // 在这里计算一下 maxWaitDuration\n            newConfig.maxWaitDuration = newConfig.actions.reduce((sum, action) => sum + action.duration, 0);\n            // 构建配置JSON\n            const configJson = JSON.stringify(newConfig);\n            \n            // 编码为Base64\n            const base64Config = btoa(unescape(encodeURIComponent(configJson)));\n            \n            // 通过Rhino调用Android方法\n            const script = `\n                var result = com.fanfanlo.emergencycall.controller.ShakeManager.updateShakeConfig(\"${base64Config}\");\n                result;\n            `;\n            autoWebViewJs.callScript(script);\n            setLastSaveTime(new Date().toLocaleTimeString());\n            \n        } catch (error) {\n            console.error('保存摇一摇配置失败:', error);\n        }\n    }, []);\n\n    /**\n     * 处理配置更新\n     */\n    const updateConfig = useCallback((updates: Partial<ShakeConfig>) => {\n        const newConfig = { ...config, ...updates };\n        setConfig(newConfig);\n        \n        // 如果配置有效，自动保存\n        if (validateConfig(newConfig)) {\n            saveConfigToAndroid(newConfig);\n        }\n    }, [config, saveConfigToAndroid]);\n\n    /**\n     * 处理数字输入框变更，带延迟验证\n     */\n    const handleNumberInput = useCallback((field: 'shakeCount' | 'timeWindowMs' | 'threshold' | 'baseMotionThreshold' | 'directionChangeThreshold' | 'minMotionInterval' | 'cooldownDuration', value: string) => {\n        // 更新临时值\n        setTempValues(prev => ({ ...prev, [field]: value }));\n        \n        // 清除之前的定时器\n        const timerId = setTimeout(() => {\n            if (field === 'threshold' || field === 'baseMotionThreshold' || field === 'directionChangeThreshold') {\n                // 处理浮点数输入\n                const numValue = parseFloat(value);\n                if (!isNaN(numValue) && numValue >= 0) {\n                    updateConfig({ [field]: numValue });\n                    setTempValues(prev => ({ ...prev, [field]: undefined }));\n                } else if (value === '') {\n                    // 空值，等待用户继续输入\n                    setTimeout(() => {\n                        if (tempValues[field] === '') {\n                            setTempValues(prev => ({ ...prev, [field]: undefined }));\n                        }\n                    }, 2000);\n                } else {\n                    // 无效值，恢复原值\n                    setTimeout(() => {\n                        setTempValues(prev => ({ ...prev, [field]: undefined }));\n                    }, 2000);\n                }\n            } else {\n                // 原有的整数处理逻辑保持不变\n                const numValue = parseInt(value);\n                if (!isNaN(numValue) && numValue > 0) {\n                    if (field === 'shakeCount' && numValue >= 1 && numValue <= 10) {\n                        updateConfig({ [field]: numValue });\n                        setTempValues(prev => ({ ...prev, [field]: undefined }));\n                    } else if (field === 'timeWindowMs' && numValue >= 1000 && numValue <= 10000) {\n                        updateConfig({ [field]: numValue });\n                        setTempValues(prev => ({ ...prev, [field]: undefined }));\n                    } else if (field === 'minMotionInterval' && numValue >= 50 && numValue <= 2000) {\n                        updateConfig({ [field]: numValue });\n                        setTempValues(prev => ({ ...prev, [field]: undefined }));\n                    } else if (field === 'cooldownDuration' && numValue >= 1000 && numValue <= 60000) {\n                        updateConfig({ [field]: numValue });\n                        setTempValues(prev => ({ ...prev, [field]: undefined }));\n                    } else {\n                        setTimeout(() => {\n                            setTempValues(prev => ({ ...prev, [field]: undefined }));\n                        }, 2000);\n                    }\n                } else if (value === '') {\n                    setTimeout(() => {\n                        if (tempValues[field] === '') {\n                            setTempValues(prev => ({ ...prev, [field]: undefined }));\n                        }\n                    }, 2000);\n                } else {\n                    setTimeout(() => {\n                        setTempValues(prev => ({ ...prev, [field]: undefined }));\n                    }, 2000);\n                }\n            }\n        }, 500); // 500ms延迟\n\n        return () => clearTimeout(timerId);\n    }, [updateConfig, tempValues]);\n\n    /**\n     * 预报警动作管理函数\n     */\n    const handleAddPreAlarmAction = useCallback((type: 'sound' | 'vibration') => {\n        const newAction: PreAlarmAction = {\n            id: `action-${Date.now()}`,\n            type,\n            duration: type === 'vibration' ? 1000 : 2000,\n            ...(type === 'sound' && { resourceId: defaultSoundResources[0].id }),\n        };\n        updateConfig({\n            actions: [...config.actions, newAction],\n        });\n    }, [config.actions, updateConfig]);\n\n    const handleUpdatePreAlarmAction = useCallback((id: string, updates: Partial<Omit<PreAlarmAction, 'id'>>) => {\n        updateConfig({\n            actions: config.actions.map((action) =>\n                action.id === id ? { ...action, ...updates } : action\n            ),\n        });\n    }, [config.actions, updateConfig]);\n\n    const handleRemovePreAlarmAction = useCallback((id: string) => {\n        updateConfig({\n            actions: config.actions.filter((action) => action.id !== id),\n        });\n    }, [config.actions, updateConfig]);\n\n    const handlePreviewSound = useCallback((resourceId?: string) => {\n        if (!resourceId) return;\n        handleStopSound();\n        \n        console.log(`[ShakeConfig] Previewing sound: ${resourceId}`);\n        \n        if ((window as any).SoundManager) {\n            (window as any).SoundManager.previewSound(resourceId);\n            setPlayingSoundId(resourceId);\n        } else {\n            console.warn('SoundManager not available');\n        }\n    }, []);\n\n    const handleStopSound = useCallback(() => {\n        if ((window as any).SoundManager) {\n            (window as any).SoundManager.stopPreview();\n        }\n        setPlayingSoundId(null);\n    }, []);\n\n    /**\n     * 拖拽结束处理\n     */\n    const handleDragEnd = useCallback((event: DragEndEvent) => {\n        const { active, over } = event;\n        if (!over || active.id === over.id) return;\n\n        const oldIndex = config.actions.findIndex((a) => a.id === active.id);\n        const newIndex = config.actions.findIndex((a) => a.id === over.id);\n\n        if (oldIndex !== -1 && newIndex !== -1) {\n            updateConfig({\n                actions: arrayMove(config.actions, oldIndex, newIndex),\n            });\n        }\n    }, [config.actions, updateConfig]);\n\n    /**\n     * 可拖拽的预报警动作项组件\n     */\n    const SortablePreAlarmActionItem: React.FC<{\n        action: PreAlarmAction;\n        isPlaying: boolean;\n        onUpdate: (id: string, updates: Partial<Omit<PreAlarmAction, 'id'>>) => void;\n        onRemove: (id: string) => void;\n        onPreview: (resourceId?: string) => void;\n        onStopPreview: () => void;\n        disabled: boolean;\n    }> = ({ action, isPlaying, onUpdate, onRemove, onPreview, onStopPreview, disabled }) => {\n        const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({ id: action.id });\n        \n        // 添加本地状态来存储输入值\n        const [localDuration, setLocalDuration] = useState(action.duration);\n        \n        // 创建防抖函数来更新配置\n        const debouncedUpdate = useMemo(\n            () => _.debounce((id: string, updates: Partial<Omit<PreAlarmAction, 'id'>>) => {\n                onUpdate(id, updates);\n                toast.success('修改配置成功');\n            }, 1000), // 1秒延迟\n            [onUpdate]\n        );\n        \n        // 处理输入变化\n        const handleDurationChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n            const value = parseInt(e.target.value, 10) || 0;\n            setLocalDuration(value); // 立即更新本地状态\n            debouncedUpdate(action.id, { duration: value }); // 防抖更新配置\n        }, [action.id, debouncedUpdate]);\n        \n        // 当 action.duration 从外部更新时，同步本地状态\n        useEffect(() => {\n            setLocalDuration(action.duration);\n        }, [action.duration]);\n        \n        // 组件卸载时清理防抖函数\n        useEffect(() => {\n            return () => {\n                debouncedUpdate.cancel();\n            };\n        }, [debouncedUpdate]);\n\n        const style = {\n            transform: CSS.Transform.toString(transform),\n            transition,\n            opacity: isDragging ? 0.8 : 1,\n            zIndex: isDragging ? 1 : 'auto',\n        };\n\n        return (\n            <Paper\n                ref={setNodeRef}\n                style={style}\n                elevation={isDragging ? 3 : 1}\n                sx={{\n                    p: 2,\n                    mb: 1,\n                    display: 'flex',\n                    alignItems: 'center',\n                    gap: 2,\n                    userSelect: 'none',\n                    opacity: disabled ? 0.6 : 1\n                }}\n            >\n                <Box {...attributes} {...listeners} sx={{ display: 'flex', alignItems: 'center', cursor: 'grab', touchAction: 'none' }}>\n                    <DragIndicatorIcon />\n                </Box>\n                \n                <Box sx={{ flexGrow: 1 }}>\n                    <Box sx={{ display: 'flex', flexDirection: 'column', alignItems: 'flex-start', gap: 1.5 }}>\n                        <Typography variant=\"subtitle2\">\n                            {action.type === 'sound' ? '声音' : '震动'}\n                        </Typography>\n                        \n                        <TextField\n                            size=\"small\"\n                            type=\"number\"\n                            label=\"持续时间 (ms)\"\n                            value={localDuration}\n                            onChange={handleDurationChange}\n                            disabled={disabled}\n                            sx={{ width: '100%' }}\n                        />\n                        \n                        {action.type === 'sound' && (\n                            <FormControl size=\"small\" sx={{ width: '100%' }}>\n                                <InputLabel>声音类型</InputLabel>\n                                <Select\n                                    value={action.resourceId || ''}\n                                    label=\"声音类型\"\n                                    onChange={(e) => onUpdate(action.id, { resourceId: e.target.value })}\n                                    disabled={disabled}\n                                    startAdornment={\n                                        <Tooltip title={isPlaying ? \"停止\" : \"试听\"}>\n                                            <IconButton\n                                                size=\"small\"\n                                                onClick={() => isPlaying ? onStopPreview() : onPreview(action.resourceId)}\n                                                sx={{ mr: 1 }}\n                                                disabled={disabled}\n                                            >\n                                                {isPlaying ? <Stop fontSize=\"small\" /> : <PlayArrow fontSize=\"small\" />}\n                                            </IconButton>\n                                        </Tooltip>\n                                    }\n                                >\n                                    {defaultSoundResources.map((sound) => (\n                                        <MenuItem key={sound.id} value={sound.id}>\n                                            {sound.name}\n                                        </MenuItem>\n                                    ))}\n                                </Select>\n                            </FormControl>\n                        )}\n                    </Box>\n                </Box>\n                \n                <IconButton onClick={() => onRemove(action.id)} size=\"small\" color=\"error\" disabled={disabled}>\n                    <Delete />\n                </IconButton>\n            </Paper>\n        );\n    };\n\n    // 组件挂载时加载配置\n    useEffect(() => {\n        loadConfigFromAndroid();\n    }, [loadConfigFromAndroid]);\n\n    // 渲染加载状态\n    if (isLoading) {\n        return (\n            <Paper sx={{ p: 2 }}>\n                <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                    <Typography variant=\"body2\" color=\"text.secondary\">\n                        加载摇一摇配置...\n                    </Typography>\n                </Box>\n            </Paper>\n        );\n    }\n\n    return (\n        <Box sx={{ p: 2 }}>\n            {/* 开关控制 */}\n            <Box sx={{ display: 'flex', alignItems: 'center', gap: 2, mb: 2 }}>\n                {/* <FormControlLabel\n                    control={\n                        <Switch\n                            checked={config.enabled}\n                            onChange={(e) => updateConfig({ enabled: e.target.checked })}\n                            size=\"small\"\n                            disabled={!isLoggedIn}\n                        />\n                    }\n                    label={config.enabled ? '已启用' : '已禁用'}\n                />\n                {lastSaveTime && (\n                    <Typography variant=\"caption\" color=\"text.secondary\">\n                        已保存 {lastSaveTime}\n                    </Typography>\n                )} */}\n            </Box>\n\n            {/* 未登录提示 */}\n            {!isLoggedIn && (\n                <Alert severity=\"warning\" sx={{ mb: 2 }}>\n                    <Typography variant=\"body2\">\n                        请先登录后再使用摇一摇功能\n                    </Typography>\n                </Alert>\n            )}\n\n            {/* 基础设置 */}\n            <Grid container spacing={2} sx={{ mb: 3 }}>\n                {/* 报警类型 */}\n                <Grid item xs={12} sm={6}>\n                    <FormControl fullWidth disabled={ !isLoggedIn}>\n                        <InputLabel>报警类型</InputLabel>\n                        <Select\n                            value={config.emergencyType}\n                            label=\"报警类型\"\n                            onChange={(e) => updateConfig({ emergencyType: e.target.value })}\n                        >\n                            {emergencyTypeOptions.map(option => (\n                                <MenuItem key={option.value} value={option.value}>\n                                    {option.label}\n                                </MenuItem>\n                            ))}\n                        </Select>\n                    </FormControl>\n                </Grid>\n            </Grid>\n\n            {/* 检测参数 */}\n            <Typography variant=\"h6\" gutterBottom>检测参数</Typography>\n            <Grid container spacing={2} sx={{ mb: 3 }}>\n                {/* 摇动次数 */}\n                <Grid item xs={12} sm={4}>\n                    <TextField\n                        fullWidth\n                        label=\"摇动次数\"\n                        type=\"number\"\n                        inputProps={{ min: 1, max: 10 }}\n                        value={tempValues.shakeCount !== undefined ? tempValues.shakeCount : config.shakeCount}\n                        onChange={(e) => handleNumberInput('shakeCount', e.target.value)}\n                        disabled={ !isLoggedIn}\n                        helperText=\"1-10次\"\n                        error={tempValues.shakeCount !== undefined && (tempValues.shakeCount === '' || parseInt(tempValues.shakeCount) < 1 || parseInt(tempValues.shakeCount) > 10)}\n                    />\n                </Grid>\n\n                {/* 时间窗口 */}\n                <Grid item xs={12} sm={4}>\n                    <TextField\n                        fullWidth\n                        label=\"时间窗口(毫秒)\"\n                        type=\"number\"\n                        inputProps={{ min: 1000, max: 10000, step: 500 }}\n                        value={tempValues.timeWindowMs !== undefined ? tempValues.timeWindowMs : config.timeWindowMs}\n                        onChange={(e) => handleNumberInput('timeWindowMs', e.target.value)}\n                        disabled={ !isLoggedIn}\n                        helperText=\"1000-10000ms\"\n                        error={tempValues.timeWindowMs !== undefined && (tempValues.timeWindowMs === '' || parseInt(tempValues.timeWindowMs) < 1000 || parseInt(tempValues.timeWindowMs) > 10000)}\n                    />\n                </Grid>\n\n                {/* 检测阈值 */}\n                <Grid item xs={12} sm={4}>\n                    <TextField\n                        fullWidth\n                        label=\"检测阈值\"\n                        type=\"number\"\n                        inputProps={{ min: 0, step: 0.1 }}\n                        value={tempValues.threshold !== undefined ? tempValues.threshold : config.threshold}\n                        onChange={(e) => handleNumberInput('threshold', e.target.value)}\n                        disabled={ !isLoggedIn}\n                        helperText={`数值越小越敏感，一般范围为${THRESHOLD_MIN}-${THRESHOLD_MAX}，根据手机不同会有差异`}\n                        error={tempValues.threshold !== undefined && (tempValues.threshold === '' || parseFloat(tempValues.threshold) < 0)}\n                    />\n                </Grid>\n            </Grid>\n\n            {/* 高级检测参数 */}\n            <Typography variant=\"h6\" gutterBottom sx={{ mt: 3 }}>高级参数</Typography>\n            <Grid container spacing={2} sx={{ mb: 3 }}>\n                {/* 基础运动阈值 */}\n                <Grid item xs={12} sm={6}>\n                    <TextField\n                        fullWidth\n                        label=\"基础运动阈值\"\n                        type=\"number\"\n                        inputProps={{ min: 0.1, step: 0.1 }}\n                        value={tempValues.baseMotionThreshold !== undefined ? tempValues.baseMotionThreshold : config.baseMotionThreshold}\n                        onChange={(e) => handleNumberInput('baseMotionThreshold', e.target.value)}\n                        disabled={!isLoggedIn}\n                        helperText=\"推荐范围: 2.0-8.0。数值越大越不容易误触发\"\n                        error={tempValues.baseMotionThreshold !== undefined && (tempValues.baseMotionThreshold === '' || parseFloat(tempValues.baseMotionThreshold) < 0.1)}\n                    />\n                </Grid>\n\n                {/* 方向变化阈值 */}\n                <Grid item xs={12} sm={6}>\n                    <TextField\n                        fullWidth\n                        label=\"方向变化阈值\"\n                        type=\"number\"\n                        inputProps={{ min: -1.0, max: 1.0, step: 0.01 }}\n                        value={tempValues.directionChangeThreshold !== undefined ? tempValues.directionChangeThreshold : config.directionChangeThreshold}\n                        onChange={(e) => handleNumberInput('directionChangeThreshold', e.target.value)}\n                        disabled={!isLoggedIn}\n                        helperText=\"推荐范围: -0.5到0.5。数值越小越敏感\"\n                        error={tempValues.directionChangeThreshold !== undefined && (tempValues.directionChangeThreshold === '' || parseFloat(tempValues.directionChangeThreshold) < -1.0 || parseFloat(tempValues.directionChangeThreshold) > 1.0)}\n                    />\n                </Grid>\n\n                {/* 运动间隔 */}\n                <Grid item xs={12} sm={6}>\n                    <TextField\n                        fullWidth\n                        label=\"运动间隔 (毫秒)\"\n                        type=\"number\"\n                        inputProps={{ min: 50, max: 2000, step: 10 }}\n                        value={tempValues.minMotionInterval !== undefined ? tempValues.minMotionInterval : config.minMotionInterval}\n                        onChange={(e) => handleNumberInput('minMotionInterval', e.target.value)}\n                        disabled={!isLoggedIn}\n                        helperText=\"推荐范围: 200-800ms。防止重复计数的最小间隔\"\n                        error={tempValues.minMotionInterval !== undefined && (tempValues.minMotionInterval === '' || parseInt(tempValues.minMotionInterval) < 50 || parseInt(tempValues.minMotionInterval) > 2000)}\n                    />\n                </Grid>\n\n                {/* 冷却期 */}\n                <Grid item xs={12} sm={6}>\n                    <TextField\n                        fullWidth\n                        label=\"冷却期 (毫秒)\"\n                        type=\"number\"\n                        inputProps={{ min: 1000, max: 60000, step: 100 }}\n                        value={tempValues.cooldownDuration !== undefined ? tempValues.cooldownDuration : config.cooldownDuration}\n                        onChange={(e) => handleNumberInput('cooldownDuration', e.target.value)}\n                        disabled={!isLoggedIn}\n                        helperText=\"推荐范围: 3000-15000ms。触发后等待时间\"\n                        error={tempValues.cooldownDuration !== undefined && (tempValues.cooldownDuration === '' || parseInt(tempValues.cooldownDuration) < 1000 || parseInt(tempValues.cooldownDuration) > 60000)}\n                    />\n                </Grid>\n            </Grid>\n\n            <Divider sx={{ my: 3 }} />\n\n            {/* 预警设置 */}\n            <Typography variant=\"h6\" gutterBottom>预警设置</Typography>\n            <Box sx={{ mb: 3 }}>\n                {/* 预报警详细配置 */}\n                <Collapse in={config.actions.length > 0 || true}>\n                    <Box sx={{ mt: 2, pl: 4, borderLeft: '2px solid', borderColor: 'primary.main' }}>\n                        {/* <Grid container spacing={2} sx={{ mb: 2 }}>\n                            <Grid item xs={12} sm={6}>\n                                <TextField\n                                    fullWidth\n                                    size=\"small\"\n                                    type=\"number\"\n                                    label=\"预警最大等待时间(ms)\"\n                                    value={config.maxWaitDuration}\n                                    onChange={(e) => updateConfig({ maxWaitDuration: parseInt(e.target.value, 10) || 0 })}\n                                    disabled={ !isLoggedIn}\n                                    helperText=\"用户可在此时间内确认或取消\"\n                                />\n                            </Grid>\n                        </Grid> */}\n                        \n                        <Box sx={{ mb: 2 }}>\n                            <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 1 }}>\n                                <Typography variant=\"body2\" fontWeight=\"medium\">\n                                    预警动作序列 ({config.actions.length})\n                                </Typography>\n                                <Box sx={{ display: 'flex', gap: 1 }}>\n                                    <Button\n                                        variant=\"outlined\"\n                                        size=\"small\"\n                                        startIcon={<VolumeUpIcon />}\n                                        onClick={() => handleAddPreAlarmAction('sound')}\n                                        disabled={ !isLoggedIn}\n                                    >\n                                        添加声音\n                                    </Button>\n                                    <Button\n                                        variant=\"outlined\"\n                                        size=\"small\"\n                                        startIcon={<VibrationIcon />}\n                                        onClick={() => handleAddPreAlarmAction('vibration')}\n                                        disabled={ !isLoggedIn}\n                                    >\n                                        添加震动\n                                    </Button>\n                                </Box>\n                            </Box>\n                            \n                            {config.actions.length === 0 ? (\n                                <Box sx={{ \n                                    p: 2, \n                                    border: '1px dashed', \n                                    borderColor: 'divider', \n                                    borderRadius: 1, \n                                    textAlign: 'center',\n                                    color: 'text.secondary'\n                                }}>\n                                    <Typography variant=\"body2\">暂无预警动作，点击上方按钮添加</Typography>\n                                </Box>\n                            ) : (\n                                <DndContext\n                                    sensors={sensors}\n                                    collisionDetection={closestCenter}\n                                    onDragEnd={handleDragEnd}\n                                >\n                                    <SortableContext\n                                        items={config.actions.map((a) => a.id)}\n                                        strategy={verticalListSortingStrategy}\n                                    >\n                                        {config.actions.map((action) => (\n                                            <SortablePreAlarmActionItem\n                                                key={action.id}\n                                                action={action}\n                                                isPlaying={playingSoundId === action.resourceId}\n                                                onUpdate={handleUpdatePreAlarmAction}\n                                                onRemove={handleRemovePreAlarmAction}\n                                                onPreview={handlePreviewSound}\n                                                onStopPreview={handleStopSound}\n                                                disabled={ !isLoggedIn}\n                                            />\n                                        ))}\n                                    </SortableContext>\n                                </DndContext>\n                            )}\n                        </Box>\n                    </Box>\n                </Collapse>\n                \n                {/* 基础反馈设置 */}\n                <FormControlLabel\n                    control={\n                        <Switch\n                            checked={config.vibrationFeedback}\n                            onChange={(e) => updateConfig({ vibrationFeedback: e.target.checked })}\n                            disabled={!isLoggedIn}\n                        />\n                    }\n                    label=\"震动反馈\"\n                />\n                \n                <FormControlLabel\n                    control={\n                        <Switch\n                            checked={config.soundFeedback}\n                            onChange={(e) => updateConfig({ soundFeedback: e.target.checked })}\n                            disabled={!isLoggedIn}\n                        />\n                    }\n                    label=\"声音反馈\"\n                />\n            </Box>\n\n            <Divider sx={{ my: 3 }} />\n\n            <Box sx={{ mb: 3 }}>\n                <VoiceEmergencySettings ref={effectiveVoiceSettingsRef} />\n            </Box>\n            {/* 紧急呼救语音设置 */}\n            {/* <Box sx={{ mb: 3 }}>\n                <Typography variant=\"h6\" gutterBottom>\n                    呼救语音设置\n                </Typography>\n                <EmergencyTTSSettings />\n            </Box> */}\n\n            {/* 配置说明 */}\n            <Alert severity=\"info\" sx={{ mt: 2 }}>\n                <Typography variant=\"body2\" component=\"div\">\n                    <strong>配置说明</strong>\n                    <ul style={{ margin: '8px 0', paddingLeft: '20px' }}>\n                        <li>在{config.timeWindowMs}毫秒内连续摇动{config.shakeCount}次将触发报警</li>\n                        <li>{config.emergencyType === 'medical' ? '医疗报警适合健康紧急情况' : '安全报警适合人身安全威胁'}</li>\n                        <li>阈值{config.threshold}：数值越小检测越敏感，一般范围为{THRESHOLD_MIN}-{THRESHOLD_MAX}，根据手机不同会有差异</li>\n                        <li>{config.actions.length > 0 ? `启用预警将在${config.maxWaitDuration}毫秒内执行${config.actions.length}个预警动作，用户可确认或取消` : '无预警动作配置，将直接触发报警'}</li>\n                    </ul>\n                </Typography>\n            </Alert>\n        </Box>\n    );\n};\n\nexport default ShakeDetectionSettings;","import React, { useState, useEffect } from 'react';\nimport { Button, Alert, Box, Typography, Dialog, DialogTitle, DialogContent, DialogActions } from '@mui/material';\nimport AddToHomeScreenIcon from '@mui/icons-material/AddToHomeScreen';\nimport SettingsIcon from '@mui/icons-material/Settings';\nimport { autoWebViewJs } from '@droid/android';\n\n\ninterface AddWidgetButtonProps {\n  onSuccess?: () => void;\n  onError?: (error: string) => void;\n}\n\nconst AddWidgetButton: React.FC<AddWidgetButtonProps> = ({ \n  onSuccess, \n  onError \n}) => {\n  const [isAdding, setIsAdding] = useState(false);\n  const [message, setMessage] = useState<string>('');\n  const [messageType, setMessageType] = useState<'success' | 'error' | 'info'>('info');\n  const [deviceManufacturer, setDeviceManufacturer] = useState<string>('');\n  const [showPermissionGuide, setShowPermissionGuide] = useState(false);\n\n  // 获取设备厂商信息\n  useEffect(() => {\n    try {\n      const manufacturerScript = `\nvar manufacturer = com.fanfanlo.emergencycall.utils.WidgetUtils.getDeviceManufacturerName();\nmanufacturer;`;\n      \n      const { javaResultString } = autoWebViewJs.callScript(manufacturerScript);\n      setDeviceManufacturer(javaResultString || '通用设备');\n    } catch (error) {\n      console.warn('获取设备厂商信息失败:', error);\n      setDeviceManufacturer('通用设备');\n    }\n  }, []);\n\n  const handleOpenSettings = async () => {\n    try {\n      console.log('VERSION_AWARE_WIDGET尝试打开权限设置');\n      \n      const settingsScript = `\nvar success = com.fanfanlo.emergencycall.utils.WidgetUtils.openPermissionSettings();\nsuccess;`;\n      \n      const { javaResultString } = autoWebViewJs.callScript(settingsScript);\n      const success = javaResultString === \"true\";\n      \n      if (success) {\n        console.log('VERSION_AWARE_WIDGET权限设置页面已打开');\n      } else {\n        console.warn('VERSION_AWARE_WIDGET无法打开权限设置页面');\n      }\n    } catch (error) {\n      console.error('VERSION_AWARE_WIDGET打开权限设置失败:', error);\n    }\n  };\n\n  const executeAddWidget = async () => {\n    try {\n      setMessage('正在添加桌面快捷方式...');\n      setMessageType('info');\n      \n      const addScript = `\nvar success = com.fanfanlo.emergencycall.utils.WidgetUtils.requestAddMedicalWidget();\nsuccess;`;\n      \n      const { javaResultString: addResult } = autoWebViewJs.callScript(addScript);\n      const addSuccess = addResult === \"true\";\n      \n      if (addSuccess) {\n        setMessage('选择界面已打开，请选择默认样式或自定义设置');\n        setMessageType('success');\n        onSuccess?.();\n      } else {\n        throw new Error('启动选择界面失败');\n      }\n    } catch (error) {\n      const errorMsg = error instanceof Error ? error.message : '添加桌面快捷方式失败';\n      setMessage(errorMsg);\n      setMessageType('error');\n      onError?.(errorMsg);\n    }\n  };\n\n  const handleAddWidget = async () => {\n    try {\n      setIsAdding(true);\n      setMessage('正在检查设备权限需求...');\n      setMessageType('info');\n\n      // 使用新接口检查设备权限信息\n      const permissionScript = `\nvar permissionInfo = com.fanfanlo.emergencycall.utils.WidgetUtils.getDevicePermissionInfo();\npermissionInfo;`;\n      \n      const { javaResultString: permissionResult } = autoWebViewJs.callScript(permissionScript);\n      const permissionInfo = JSON.parse(permissionResult || '{}');\n      \n      if (permissionInfo.needsPermission) {\n        // 需要权限的设备，显示弹窗\n//         const stepsScript = `\n// var steps = com.fanfanlo.emergencycall.utils.WidgetUtils.getManualAddSteps();\n// steps;`;\n        \n//         const { javaResultString: stepsResult } = autoWebViewJs.callScript(stepsScript);\n        \n        setMessage(`您的手机需要打开设置页面，找到 \"桌面快捷方式\" 的权限，并进行授权`);\n        setMessageType('info');\n        setShowPermissionGuide(true);\n      } else {\n        // 不需要权限的设备，直接添加\n        await executeAddWidget();\n      }\n      \n    } catch (error) {\n      const errorMsg = error instanceof Error ? error.message : '检查设备权限失败';\n      setMessage(errorMsg);\n      setMessageType('error');\n      onError?.(errorMsg);\n    } finally {\n      setIsAdding(false);\n    }\n  };\n\n  return (\n    <Box sx={{ my: 2 }}>\n      <Button\n        variant=\"outlined\"\n        color=\"primary\"\n        size=\"large\"\n        fullWidth\n        startIcon={<AddToHomeScreenIcon />}\n        onClick={handleAddWidget}\n        disabled={isAdding}\n        sx={{\n          py: 1.5,\n          borderColor: '#DC2626',\n          color: '#DC2626',\n          '&:hover': {\n            borderColor: '#B91C1C',\n            backgroundColor: 'rgba(220, 38, 38, 0.04)',\n          },\n          '&.Mui-disabled': {\n            opacity: 0.6,\n          },\n        }}\n      >\n        {isAdding ? '正在添加...' : '🚑 添加桌面医疗呼救'}\n      </Button>\n      \n      {message && (\n        <Alert \n          severity={messageType} \n          sx={{ mt: 1 }}\n          onClose={() => setMessage('')}\n        >\n          <Typography variant=\"body2\" style={{ whiteSpace: 'pre-line' }}>\n            {message}\n          </Typography>\n        </Alert>\n      )}\n      \n      {/* 权限引导弹窗 */}\n      <Dialog \n        open={showPermissionGuide}\n        onClose={() => setShowPermissionGuide(false)}\n        fullWidth\n        maxWidth=\"sm\"\n      >\n        <DialogTitle>\n          需要权限设置\n        </DialogTitle>\n        <DialogContent>\n          <Typography variant=\"body1\" sx={{ mb: 2 }}>\n            检测到 {deviceManufacturer}，需要手动开启桌面快捷方式权限才能添加小部件。\n          </Typography>\n        </DialogContent>\n        <DialogActions sx={{ px: 3, pb: 2 }}>\n          <Button\n            onClick={async () => {\n              setShowPermissionGuide(false);\n              // 关闭弹窗后执行添加功能\n              await executeAddWidget();\n            }}\n            color=\"inherit\"\n          >\n            已设置\n          </Button>\n          <Button\n            variant=\"contained\"\n            startIcon={<SettingsIcon />}\n            onClick={handleOpenSettings}\n            sx={{\n              backgroundColor: '#DC2626',\n              '&:hover': {\n                backgroundColor: '#B91C1C',\n              },\n            }}\n          >\n            去设置\n          </Button>\n        </DialogActions>\n      </Dialog>\n      \n      {!message && !showPermissionGuide && deviceManufacturer && (\n        <Typography \n          variant=\"caption\" \n          color=\"text.secondary\" \n          sx={{ display: 'block', mt: 1, textAlign: 'center' }}\n        >\n          当前设备：{deviceManufacturer} • 可选择默认样式或自定义设置\n        </Typography>\n      )}\n    </Box>\n  );\n};\n\nexport default AddWidgetButton;","import React, { useState, useEffect } from 'react';\nimport { Button, Alert, Box, Typography, Dialog, DialogTitle, DialogContent, DialogActions } from '@mui/material';\nimport SecurityIcon from '@mui/icons-material/Security';\nimport { autoWebViewJs } from '@droid/android';\n\ninterface AddSecurityWidgetButtonProps {\n  onSuccess?: () => void;\n  onError?: (error: string) => void;\n}\n\nconst AddSecurityWidgetButton: React.FC<AddSecurityWidgetButtonProps> = ({ \n  onSuccess, \n  onError \n}) => {\n  const [isAdding, setIsAdding] = useState(false);\n  const [message, setMessage] = useState<string>('');\n  const [messageType, setMessageType] = useState<'success' | 'error' | 'info'>('info');\n  const [deviceManufacturer, setDeviceManufacturer] = useState<string>('');\n  const [showPermissionGuide, setShowPermissionGuide] = useState(false);\n\n  // 获取设备厂商信息\n  useEffect(() => {\n    try {\n      const manufacturerScript = `\nvar manufacturer = com.fanfanlo.emergencycall.utils.WidgetUtils.getDeviceManufacturerName();\nmanufacturer;`;\n      \n      const { javaResultString } = autoWebViewJs.callScript(manufacturerScript);\n      setDeviceManufacturer(javaResultString || '通用设备');\n    } catch (error) {\n      console.warn('获取设备厂商信息失败:', error);\n      setDeviceManufacturer('通用设备');\n    }\n  }, []);\n\n  const executeAddWidget = async () => {\n    const addScript = `\nvar success = com.fanfanlo.emergencycall.utils.WidgetUtils.requestAddSecurityWidget();\nsuccess;`;\n\n    const { javaResultString: addResult } = autoWebViewJs.callScript(addScript);\n    const addSuccess = addResult === \"true\";\n\n    if (addSuccess) {\n      setMessage('选择界面已打开，请选择默认样式或自定义设置');\n      setMessageType('success');\n      onSuccess?.();\n    } else {\n      throw new Error('启动选择界面失败');\n    }\n  };\n\n  const handleAddWidget = async () => {\n    try {\n      setIsAdding(true);\n      setMessage('正在检查设备支持...');\n      setMessageType('info');\n\n      // 先检查设备权限需求\n      const permissionScript = `\nvar permissionInfo = com.fanfanlo.emergencycall.utils.WidgetUtils.getDevicePermissionInfo();\npermissionInfo;`;\n      \n      const { javaResultString: permissionResult } = autoWebViewJs.callScript(permissionScript);\n      const permissionInfo = JSON.parse(permissionResult || '{}');\n      \n      if (permissionInfo.needsPermission) {\n        // 需要权限的设备，显示弹窗\n        setMessage(`您的手机需要打开设置页面，找到 \"桌面快捷方式\" 的权限，并进行授权`);\n        setMessageType('info');\n        setShowPermissionGuide(true);\n      } else {\n        // 不需要权限的设备，直接添加\n        await executeAddWidget();\n      }\n      \n    } catch (error) {\n      const errorMsg = error instanceof Error ? error.message : '添加桌面安全呼救失败';\n      setMessage(errorMsg);\n      setMessageType('error');\n      onError?.(errorMsg);\n    } finally {\n      setIsAdding(false);\n    }\n  };\n\n  const handleOpenSettings = async () => {\n    try {\n      const openSettingsScript = `\nvar success = com.fanfanlo.emergencycall.utils.WidgetUtils.openPermissionSettings();\nsuccess;`;\n      \n      autoWebViewJs.callScript(openSettingsScript);\n    } catch (error) {\n      console.error('打开权限设置失败:', error);\n    }\n  };\n\n  return (\n    <Box sx={{ my: 2 }}>\n      <Button\n        variant=\"outlined\"\n        color=\"secondary\"\n        size=\"large\"\n        fullWidth\n        startIcon={<SecurityIcon />}\n        onClick={handleAddWidget}\n        disabled={isAdding}\n        sx={{\n          py: 1.5,\n          borderColor: '#9333EA',\n          color: '#9333EA',\n          '&:hover': {\n            borderColor: '#7C2D92',\n            backgroundColor: 'rgba(147, 51, 234, 0.04)',\n          },\n          '&.Mui-disabled': {\n            opacity: 0.6,\n          },\n        }}\n      >\n        {isAdding ? '正在添加...' : '👮‍♂️ 添加桌面安全呼救'}\n      </Button>\n      \n      {message && (\n        <Alert \n          severity={messageType} \n          sx={{ mt: 1 }}\n          onClose={() => setMessage('')}\n        >\n          <Typography variant=\"body2\" style={{ whiteSpace: 'pre-line' }}>\n            {message}\n          </Typography>\n        </Alert>\n      )}\n      \n      {!message && deviceManufacturer && (\n        <Typography \n          variant=\"caption\" \n          color=\"text.secondary\" \n          sx={{ display: 'block', mt: 1, textAlign: 'center' }}\n        >\n          当前设备：{deviceManufacturer} • 可选择默认样式或自定义设置\n        </Typography>\n      )}\n\n      {/* 权限引导弹窗 */}\n      <Dialog \n        open={showPermissionGuide} \n        onClose={() => setShowPermissionGuide(false)}\n        maxWidth=\"sm\"\n        fullWidth\n      >\n        <DialogTitle>\n          需要权限设置\n        </DialogTitle>\n        <DialogContent>\n          <Typography variant=\"body1\" sx={{ mb: 2 }}>\n            检测到 {deviceManufacturer}，需要手动开启桌面快捷方式权限才能添加安全呼救小部件。\n          </Typography>\n        </DialogContent>\n        <DialogActions sx={{ px: 3, pb: 2 }}>\n          <Button\n            onClick={async () => {\n              setShowPermissionGuide(false);\n              // 关闭弹窗后执行添加功能\n              await executeAddWidget();\n            }}\n            variant=\"outlined\"\n          >\n            已设置\n          </Button>\n          <Button\n            onClick={() => {\n              handleOpenSettings();\n            }}\n            variant=\"contained\"\n          >\n            去设置\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </Box>\n  );\n};\n\nexport default AddSecurityWidgetButton;","export { default as EmergencyCallSettings } from './EmergencyCallSettings';\nexport { default as FunctionWrapper } from './FunctionWrapper';\nexport { default as FallDetectionSettings } from './FallDetectionSettings';\nexport { default as ShakeDetectionSettings } from './ShakeDetectionSettings';\nexport { default as AddWidgetButton } from './components/AddWidgetButton';\nexport { default as AddSecurityWidgetButton } from './components/AddSecurityWidgetButton';","import { IRequestOptions } from \"../IRequestOptions\";\nimport { tms } from \"../tms\";\nimport { request } from \"@fanfanlo\";\n\n/**\n * 获取未处理被邀请信息的请求参数\n */\nexport interface IParamsListPendingReceivedInvitations {\n  // 可以添加分页等参数\n  page?: number;\n  page_size?: number;\n}\n\n/**\n * 未处理的被邀请信息\n */\nexport interface IPendingInvitationInfo {\n  invitation_id: string;\n  user_info: {\n    user_id: string;\n    display_name: string;\n    avatar_url?: string;\n  };\n  status: 'pending';\n  message: string;\n  created_at: number;\n  expires_at: number;\n}\n\n/**\n * 获取未处理被邀请信息的响应结果\n */\nexport interface IResultListPendingReceivedInvitations {\n  is_ok: boolean;\n  msg?: string;\n  invitations: IPendingInvitationInfo[];\n}\n\n/**\n * 获取未处理的被邀请信息\n */\nexport async function tmsEmergencyCallListPendingReceivedInvitations(\n  opts: IRequestOptions<IParamsListPendingReceivedInvitations>\n) {\n  return request<IResultListPendingReceivedInvitations, IParamsListPendingReceivedInvitations>(\n    tms.TEmc,\n    tms.MEmcListPendingReceivedInvitations,\n    opts.params,\n    opts.gateway,\n    opts.handler\n  );\n}\n\n// 导出服务\nexport const emergencyCallPendingInvitationService = {\n  listPendingReceivedInvitations: tmsEmergencyCallListPendingReceivedInvitations,\n};\n\nexport default emergencyCallPendingInvitationService;","import React, { useState, useEffect, useCallback } from 'react';\nimport {\n  Box,\n  Typography,\n  Button,\n  Card,\n  CardContent,\n  CardActions,\n  CircularProgress,\n  Avatar,\n  Chip,\n  Alert,\n  Stack,\n} from '@mui/material';\nimport {\n  Check as CheckIcon,\n  Close as CloseIcon,\n  AccessTime as AccessTimeIcon,\n  Person as PersonIcon,\n  Notifications as NotificationsIcon,\n} from '@mui/icons-material';\nimport { formatDistanceToNow } from 'date-fns';\nimport { zhCN } from 'date-fns/locale';\nimport { \n  emergencyCallPendingInvitationService,\n  emergencyCallInvitationService,\n  IPendingInvitationInfo,\n  user,\n  AppModelEvent,\n  appModel\n} from '@app/model';\nimport { useProxyWatch } from '@fanfanlo';\nimport { matrixClient } from '@im/matrix';\n\n// 邀请卡片组件\nfunction PendingInvitationCard({ \n  invitation,\n  onRespond,\n  isProcessing = false,\n}: { \n  invitation: IPendingInvitationInfo;\n  onRespond?: (action: 'accept' | 'decline') => Promise<void>;\n  isProcessing?: boolean;\n}) {\n  const [isProcessingAction, setIsProcessingAction] = useState(false);\n\n  const handleRespond = async (action: 'accept' | 'decline') => {\n    if (!onRespond) return;\n    \n    try {\n      setIsProcessingAction(true);\n      await onRespond(action);\n    } finally {\n      setIsProcessingAction(false);\n    }\n  };\n\n  const isExpired = new Date(invitation.expires_at * 1000) < new Date();\n\n  return (\n    <Card variant=\"outlined\" sx={{ mb: 2, opacity: isProcessing ? 0.7 : 1 }}>\n      <CardContent>\n        <Box display=\"flex\" alignItems=\"center\" mb={2}>\n          <Avatar \n            src={invitation.user_info.avatar_url} \n            alt={invitation.user_info.display_name}\n            sx={{ width: 50, height: 50, mr: 2 }}\n          >\n            {invitation.user_info.display_name?.[0]?.toUpperCase() || '?'}\n          </Avatar>\n          <Box flexGrow={1}>\n            <Typography variant=\"h6\">\n              {invitation.user_info.display_name || '未知用户'}\n            </Typography>\n            {/* <Typography variant=\"body2\" color=\"text.secondary\">\n              ID: {invitation.user_info.user_id}\n            </Typography> */}\n            <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 0.5 }}>\n              {formatDistanceToNow(invitation.created_at * 1000, { \n                addSuffix: true, \n                locale: zhCN \n              })}\n            </Typography>\n          </Box>\n          <Box textAlign=\"right\">\n            <Chip \n              size=\"small\"\n              icon={<AccessTimeIcon fontSize=\"small\" />}\n              label={isExpired ? '已过期' : `${formatDistanceToNow(invitation.expires_at * 1000, { \n                addSuffix: true, \n                locale: zhCN \n              })}`}\n              color={isExpired ? 'error' : 'primary'}\n              variant=\"outlined\"\n            />\n          </Box>\n        </Box>\n        \n        {invitation.message && (\n          <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1, mb: 1 }}>\n            邀请信息: {invitation.message}\n          </Typography>\n        )}\n\n        <Typography variant=\"body2\" color=\"primary\" sx={{ fontWeight: 'medium' }}>\n          邀请您成为紧急联系人\n        </Typography>\n      </CardContent>\n      \n      {!isExpired && (\n        <CardActions sx={{ justifyContent: 'flex-end', pt: 0 }}>\n          <Button \n            size=\"small\" \n            color=\"error\"\n            startIcon={<CloseIcon />}\n            onClick={() => handleRespond('decline')}\n            disabled={isProcessing || isProcessingAction}\n          >\n            拒绝\n          </Button>\n          <Button \n            size=\"small\" \n            color=\"primary\"\n            variant=\"contained\"\n            startIcon={<CheckIcon />}\n            onClick={() => handleRespond('accept')}\n            disabled={isProcessing || isProcessingAction}\n          >\n            接受\n          </Button>\n        </CardActions>\n      )}\n    </Card>\n  );\n}\n\nconst PendingInvitationsList: React.FC = () => {\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n  const [error, setError] = useState<string | null>(null);\n  const [invitations, setInvitations] = useState<IPendingInvitationInfo[]>([]);\n  const [isProcessing, setIsProcessing] = useState<boolean>(false);\n\n  // 监听用户登录状态\n  const [userToken] = useProxyWatch(user, 'data.storeData.user_token', user.data.storeData.user_token);\n\n  // 加载未处理的被邀请信息\n  const loadPendingInvitations = useCallback(async () => {\n    if (!userToken) {\n      setInvitations([]);\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      const res = await emergencyCallPendingInvitationService.listPendingReceivedInvitations({\n        params: {},\n      } as any);\n      \n      if (res.shellIsOk && res.dataIsOk && res.data?.is_ok) {\n        setInvitations(res.data.invitations || []);\n      } else {\n        setError(res.data?.msg || '加载邀请列表失败');\n      }\n    } catch (err) {\n      console.error('加载未处理邀请列表异常:', err);\n      setError('发生未知错误');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [userToken]); // 现在可以安全地依赖userToken了\n\n  // 响应邀请\n  const handleRespondToInvite = useCallback(async (invitationId: string, action: 'accept' | 'decline'): Promise<void> => {\n    try {\n      setIsProcessing(true);\n\n      const res = await emergencyCallInvitationService.respondToInvite({\n        params: { invitation_id: invitationId, action },\n      } as any);\n\n      if (!res.shellIsOk || !res.dataIsOk || !res.data?.is_ok) {\n        throw new Error(res.data?.msg || '操作失败');\n      }\n      \n      // 从列表中移除已处理的邀请\n      setInvitations(prev => prev.filter(invite => invite.invitation_id !== invitationId));\n      \n      // 发送邀请列表更新事件\n      appModel.dispatcher.emit(AppModelEvent.InviteListUpdated);\n      \n    } catch (err) {\n      console.error('处理邀请失败:', err);\n      setError(err instanceof Error ? err.message : '操作失败，请重试');\n    } finally {\n      setIsProcessing(false);\n    }\n  }, []);\n\n  // 监听用户登录状态变化\n  useEffect(() => {\n    if (userToken) {\n      // 有登录用户了，刷新邀请列表\n      loadPendingInvitations();\n    } else {\n      // 清空邀请信息列表\n      setInvitations([]);\n    }\n  }, [userToken]); // 只依赖userToken\n\n  // 监听邀请列表更新事件\n  useEffect(() => {\n    const unsubscribe = appModel.dispatcher.addListener(AppModelEvent.InviteListUpdated, () => {\n      console.log('AppModelEvent.InviteListUpdated - 刷新未处理邀请列表');\n      loadPendingInvitations();\n    });\n\n    return unsubscribe;\n  }, [loadPendingInvitations]); // 依赖loadPendingInvitations函数\n\n  useEffect(()=>{\n    const unsub = matrixClient.imDispatcher.addListener(matrixClient.ImDispatcherEventTypes.INVITE, ()=>{\n      if(!userToken)return;\n      loadPendingInvitations();\n    });\n    return unsub;\n  }, [])\n  // 如果没有登录用户，不显示任何内容\n  if (!userToken) {\n    return null;\n  }\n\n  if (isLoading) {\n    return (\n      <Box display=\"flex\" flexDirection=\"column\" alignItems=\"center\" p={2}>\n        {/* <CircularProgress size={24} />\n        <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1 }}>\n          加载中...\n        </Typography> */}\n      </Box>\n    );\n  }\n\n  if (error) {\n    return (\n      <Box p={2}>\n        <Alert severity=\"error\">\n          {error}\n        </Alert>\n      </Box>\n    );\n  }\n\n  if (invitations.length === 0) {\n    return (\n      <Box \n        display=\"flex\" \n        flexDirection=\"column\" \n        alignItems=\"center\" \n        p={2}\n        textAlign=\"center\"\n      >\n        {/* <NotificationsIcon color=\"disabled\" sx={{ fontSize: 48, mb: 1 }} />\n        <Typography variant=\"body2\" color=\"textSecondary\">\n          暂无未处理的邀请\n        </Typography> */}\n      </Box>\n    );\n  }\n\n  return (\n    <Box p={2}>\n      <Box display=\"flex\" alignItems=\"center\" mb={2}>\n        <NotificationsIcon color=\"primary\" sx={{ mr: 1 }} />\n        <Typography variant=\"h6\" color=\"primary\">\n          未处理的邀请 ({invitations.length})\n        </Typography>\n      </Box>\n\n      <Stack spacing={2}>\n        {invitations.map((invitation) => (\n          <PendingInvitationCard\n            key={invitation.invitation_id}\n            invitation={invitation}\n            onRespond={(action) => handleRespondToInvite(invitation.invitation_id, action)}\n            isProcessing={isProcessing}\n          />\n        ))}\n      </Stack>\n    </Box>\n  );\n};\n\nexport default PendingInvitationsList;","import React, { useState, useCallback } from 'react';\nimport {\n    Box,\n    Switch,\n    Button,\n    Typography,\n    Paper,\n    Collapse,\n    Divider,\n    IconButton,\n    TextField,\n    FormControlLabel,\n    Tooltip,\n    Stack,\n    FormControl,\n    MenuItem,\n    InputLabel,\n    Select,\n} from '@mui/material';\nimport {\n    DragIndicator as DragIndicatorIcon,\n    ExpandLess,\n    Settings,\n    Delete,\n    PlayArrow,\n    Stop,\n    VolumeUp as VolumeUpIcon,\n    Vibration as VibrationIcon\n} from '@mui/icons-material';\nimport { DndContext, closestCenter, KeyboardSensor, PointerSensor, TouchSensor, useSensor, useSensors, DragEndEvent } from '@dnd-kit/core';\nimport { arrayMove, SortableContext, sortableKeyboardCoordinates, useSortable, verticalListSortingStrategy } from '@dnd-kit/sortable';\nimport { CSS } from '@dnd-kit/utilities';\nimport { debounce } from 'lodash';\nimport { autoJsStoreUtils } from '@droid/android';\n\nconst PRE_ALARM_CONFIG_KEY = 'PRE_ALARM_ACTIONS_CONFIG';\n\ninterface PreAlarmAction {\n    id: string;\n    type: 'sound' | 'vibration';\n    duration: number;\n    resourceId?: string;\n}\n\ninterface PreAlarmConfig {\n    enabled: boolean;\n    actions: PreAlarmAction[];\n    maxWaitDuration: number;\n}\n\nconst defaultSoundResources = [\n    { id: 'siren_gentle', name: '缓和警报' },\n    { id: 'beep_short', name: '短提示音' },\n    { id: 'alarm_clock', name: '闹钟' },\n];\n\nconst SortableActionItem: React.FC<{\n    action: PreAlarmAction;\n    isPlaying: boolean;\n    onUpdate: (id: string, updates: Partial<Omit<PreAlarmAction, 'id'>>) => void;\n    onRemove: (id: string) => void;\n    onPreview: (resourceId?: string) => void;\n    onStopPreview: () => void;\n}> = ({ action, isPlaying, onUpdate, onRemove, onPreview, onStopPreview }) => {\n    const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({ id: action.id });\n\n    const style = {\n        transform: CSS.Transform.toString(transform),\n        transition,\n        opacity: isDragging ? 0.8 : 1,\n        zIndex: isDragging ? 1 : 'auto',\n    };\n\n    return (\n        <Paper\n            ref={setNodeRef}\n            style={style}\n            elevation={isDragging ? 3 : 1}\n            sx={{\n                p: 2,\n                mb: 1,\n                display: 'flex',\n                alignItems: 'center',\n                gap: 2,\n                userSelect: 'none',\n            }}\n        >\n            <Box {...attributes} {...listeners} sx={{ display: 'flex', alignItems: 'center', cursor: 'grab', touchAction: 'none' }}>\n                <DragIndicatorIcon />\n            </Box>\n            \n            <Box sx={{ flexGrow: 1 }}>\n                <Box sx={{ display: 'flex', flexDirection: 'column', alignItems: 'flex-start', gap: 1.5 }}>\n                    <Typography variant=\"subtitle2\">\n                        {action.type === 'sound' ? '声音' : '震动'}\n                    </Typography>\n                    <TextField\n                        size=\"small\"\n                        type=\"number\"\n                        label=\"持续时间 (ms)\"\n                        value={action.duration}\n                        onChange={(e) => onUpdate(action.id, { duration: parseInt(e.target.value, 10) || 0 })}\n                        sx={{ width: '100%' }}\n                    />\n                    \n                    {action.type === 'sound' && (\n                        <FormControl size=\"small\" sx={{ width: '100%' }}>\n                            <InputLabel>声音类型</InputLabel>\n                            <Select\n                                value={action.resourceId || ''}\n                                label=\"声音类型\"\n                                onChange={(e) => onUpdate(action.id, { resourceId: e.target.value })}\n                                startAdornment={\n                                    <Tooltip title={isPlaying ? \"停止\" : \"试听\"}>\n                                        <IconButton\n                                            size=\"small\"\n                                            onClick={() => isPlaying ? onStopPreview() : onPreview(action.resourceId)}\n                                            sx={{ mr: 1 }}\n                                        >\n                                            {isPlaying ? <Stop fontSize=\"small\" /> : <PlayArrow fontSize=\"small\" />}\n                                        </IconButton>\n                                    </Tooltip>\n                                }\n                            >\n                                {defaultSoundResources.map((sound) => (\n                                    <MenuItem key={sound.id} value={sound.id}>\n                                        {sound.name}\n                                    </MenuItem>\n                                ))}\n                            </Select>\n                        </FormControl>\n                    )}\n                </Box>\n            </Box>\n            \n            <IconButton onClick={() => onRemove(action.id)} size=\"small\" color=\"error\">\n                <Delete />\n            </IconButton>\n        </Paper>\n    );\n};\n\nconst PreAlarmConfig2: React.FC = () => {\n    const [config, setConfig] = useState<PreAlarmConfig | null>(null);\n    const [expanded, setExpanded] = useState(false);\n    const [playingSoundId, setPlayingSoundId] = useState<string | null>(null);\n\n    const debouncedWrite = useCallback(\n        debounce((newConfig: PreAlarmConfig) => {\n            autoJsStoreUtils.write(PRE_ALARM_CONFIG_KEY, newConfig);\n        }, 500),\n        []\n    );\n\n    const sensors = useSensors(\n        useSensor(PointerSensor, {\n            activationConstraint: {\n                distance: 8,\n            },\n        }),\n        useSensor(TouchSensor, {\n            activationConstraint: {\n                delay: 250,\n                tolerance: 5,\n            },\n        }),\n        useSensor(KeyboardSensor, {\n            coordinateGetter: sortableKeyboardCoordinates,\n        })\n    );\n\n    React.useEffect(() => {\n        const loadConfig = async () => {\n            const storedConfig = await autoJsStoreUtils.read<PreAlarmConfig>(PRE_ALARM_CONFIG_KEY);\n            if (storedConfig) {\n                const actionsWithIds = storedConfig.actions.map((action) => ({\n                    ...action,\n                    id: action.id || `action-${Math.random().toString(36).substr(2, 9)}`,\n                }));\n                setConfig({\n                    ...storedConfig,\n                    actions: actionsWithIds,\n                });\n            } else {\n                setConfig({\n                    enabled: true,\n                    actions: [],\n                    maxWaitDuration: 30000,\n                });\n            }\n        };\n        loadConfig();\n    }, []);\n\n    const updateConfig = useCallback(\n        (updates: Partial<PreAlarmConfig>) => {\n            setConfig((prev) => {\n                if (!prev) return null;\n                const newConfig = { ...prev, ...updates };\n                debouncedWrite(newConfig);\n                return newConfig;\n            });\n        },\n        [debouncedWrite]\n    );\n\n    const handleToggleEnabled = (event: React.ChangeEvent<HTMLInputElement>) => {\n        updateConfig({ enabled: event.target.checked });\n    };\n\n    const handleAddAction = (type: 'sound' | 'vibration') => {\n        const newAction: PreAlarmAction = {\n            id: `action-${Date.now()}`,\n            type,\n            duration: 8000,\n            ...(type === 'sound' && { resourceId: defaultSoundResources[0].id }),\n        };\n        updateConfig({\n            actions: [...(config?.actions || []), newAction],\n        });\n    };\n\n    const handleUpdateAction = (id: string, updates: Partial<Omit<PreAlarmAction, 'id'>>) => {\n        if (!config) return;\n        updateConfig({\n            actions: config.actions.map((action) =>\n                action.id === id ? { ...action, ...updates } : action\n            ),\n        });\n    };\n\n    const handleRemoveAction = (id: string) => {\n        if (!config) return;\n        updateConfig({\n            actions: config.actions.filter((action) => action.id !== id),\n        });\n    };\n\n    const handleDragEnd = (event: DragEndEvent) => {\n        const { active, over } = event;\n        if (!config || !over || active.id === over.id) return;\n\n        const oldIndex = config.actions.findIndex((a) => a.id === active.id);\n        const newIndex = config.actions.findIndex((a) => a.id === over.id);\n\n        if (oldIndex !== -1 && newIndex !== -1) {\n            updateConfig({\n                actions: arrayMove(config.actions, oldIndex, newIndex),\n            });\n        }\n    };\n\n    const handlePreviewSound = (resourceId?: string) => {\n        if (!resourceId) return;\n        handleStopSound();\n        \n        console.log(`[WebView] Attempting to preview sound. resourceId: ${resourceId}`);\n\n        if ((window as any).SoundManager) {\n            (window as any).SoundManager.previewSound(resourceId);\n            setPlayingSoundId(resourceId);\n        } else {\n            console.warn('SoundManager JavascriptInterface is not available.');\n        }\n    };\n\n    const handleStopSound = () => {\n        if ((window as any).SoundManager) {\n            (window as any).SoundManager.stopPreview();\n        }\n        setPlayingSoundId(null);\n    };\n\n    if (!config) {\n        return <Box sx={{ p: 2, textAlign: 'center' }}>加载中...</Box>;\n    }\n\n    return (\n        <Box sx={{ mb: 3 }}>\n            <Paper \n                elevation={1} \n                sx={{ \n                    p: 2, \n                    display: 'flex', \n                    alignItems: 'center',\n                    justifyContent: 'space-between',\n                    borderRadius: 1,\n                }}\n            >\n                <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\n                    <Typography variant=\"subtitle1\">防误触报警设置</Typography>\n                    <FormControlLabel\n                        control={\n                            <Switch\n                                checked={config.enabled}\n                                onChange={handleToggleEnabled}\n                                color=\"primary\"\n                            />\n                        }\n                        label={config.enabled ? '已启用' : '已禁用'}\n                    />\n                </Box>\n                \n                <Button\n                    variant=\"outlined\"\n                    size=\"small\"\n                    startIcon={expanded ? <ExpandLess /> : <Settings />}\n                    onClick={() => setExpanded(!expanded)}\n                >\n                    {expanded ? '收起设置' : '设置'}\n                </Button>\n            </Paper>\n\n            <Collapse in={expanded}>\n                <Paper \n                    elevation={0} \n                    sx={{ \n                        mt: 1, \n                        p: 2, \n                        border: '1px solid', \n                        borderColor: 'divider',\n                        borderRadius: 1,\n                    }}\n                >\n                    <Box sx={{ mb: 3 }}>\n                        <Typography variant=\"subtitle2\" gutterBottom>\n                            最大等待时间 (毫秒)\n                        </Typography>\n                        <TextField\n                            fullWidth\n                            type=\"number\"\n                            value={config.maxWaitDuration}\n                            onChange={(e) =>\n                                updateConfig({ maxWaitDuration: parseInt(e.target.value, 10) || 0 })\n                            }\n                            size=\"small\"\n                            InputProps={{\n                                endAdornment: (\n                                    <Typography variant=\"body2\" sx={{ ml: 1 }}>\n                                        毫秒\n                                    </Typography>\n                                ),\n                            }}\n                        />\n                    </Box>\n\n                    <Divider sx={{ my: 2 }} />\n\n                    <Box sx={{ mb: 2 }}>\n                        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n                            <Typography variant=\"subtitle2\">\n                                预警动作 ({config.actions.length})\n                            </Typography>\n                            <Stack direction=\"row\" spacing={1}>\n                                <Button\n                                    variant=\"outlined\"\n                                    size=\"small\"\n                                    startIcon={<VolumeUpIcon />}\n                                    onClick={() => handleAddAction('sound')}\n                                >\n                                    添加声音\n                                </Button>\n                                <Button\n                                    variant=\"outlined\"\n                                    size=\"small\"\n                                    startIcon={<VibrationIcon />}\n                                    onClick={() => handleAddAction('vibration')}\n                                >\n                                    添加震动\n                                </Button>\n                            </Stack>\n                        </Box>\n\n                        {config.actions.length === 0 ? (\n                            <Paper\n                                variant=\"outlined\"\n                                sx={{\n                                    p: 3,\n                                    textAlign: 'center',\n                                    color: 'text.secondary',\n                                }}\n                            >\n                                <Typography>暂无报警动作，请点击上方按钮添加</Typography>\n                            </Paper>\n                        ) : (\n                            <DndContext\n                                sensors={sensors}\n                                collisionDetection={closestCenter}\n                                onDragEnd={handleDragEnd}\n                            >\n                                <SortableContext\n                                    items={config.actions.map((a) => a.id)}\n                                    strategy={verticalListSortingStrategy}\n                                >\n                                    {config.actions.map((action) => (\n                                        <SortableActionItem\n                                            key={action.id}\n                                            action={action}\n                                            isPlaying={playingSoundId === action.resourceId}\n                                            onUpdate={handleUpdateAction}\n                                            onRemove={handleRemoveAction}\n                                            onPreview={handlePreviewSound}\n                                            onStopPreview={handleStopSound}\n                                        />\n                                    ))}\n                                </SortableContext>\n                            </DndContext>\n                        )}\n                    </Box>\n                </Paper>\n            </Collapse>\n        </Box>\n    );\n};\n\nexport default PreAlarmConfig2;\n","import { useEffect } from 'react';\nimport { autoJsStoreUtils, isRealInAndroid } from '@droid/android';\nimport { PrivacyDialogDisplay } from './PrivacyDialogDisplay';\nimport { useState } from 'react';\n\ninterface PrivacyDialogAutoProps {\n  type: string;\n  area: string;\n}\n\ninterface IPrivacyInfo {\n  agree: boolean;\n  disagreeTime: number;\n}\n\nlet autoOpened = false; // 用于标记是否已经自动弹出过隐私协议\n/**\n * 自动逻辑组件 - 负责处理隐私协议的自动弹出逻辑\n * 包含原有的35-49行逻辑：检查用户是否已同意、是否在冷却期等\n */\nexport function PrivacyDialogAuto({ type, area }: PrivacyDialogAutoProps) {\n  const [open, setOpen] = useState(false);\n  // const [autoOpened, setAutoOpened] = useState(false);\n\n  const handleClose = () => {\n    autoOpened = true; // 设置为已自动弹出\n    setOpen(false);\n    // setAutoOpened(true);\n  };\n\n  // 原有的自动弹出逻辑 (35-49行)\n  useEffect(() => {\n    const def: IPrivacyInfo = { agree: false, disagreeTime: 0 };\n    const res = autoJsStoreUtils.read<IPrivacyInfo>(`privacy_${type}`, def);\n    const value: IPrivacyInfo = res && 'agree' in res ? res : def;\n    if(autoOpened){\n      //自动检测已经弹出过了就不再弹了\n      return;\n    }\n    // 不在Android环境中不弹出\n    if (!isRealInAndroid) {\n      return;\n    }\n    \n    // 已经同意了，不弹出\n    if (value.agree) {\n      return;\n    }\n    \n    // 在冷却期内（拒绝后3天内），不弹出\n    if (value.disagreeTime && value.disagreeTime != 0 && value.disagreeTime + 3 * 24 * 60 * 60 * 1000 > Date.now()) {\n      return;\n    }\n    \n    // 满足条件，弹出隐私协议\n    setOpen(true);\n  }, [type]);\n\n  return (\n    <PrivacyDialogDisplay\n      open={open }\n      onClose={handleClose}\n      type={type}\n      area={area}\n    />\n  );\n}","import { useEffect, useState } from \"react\";\r\nimport { PrivacyDialogAuto } from \"./PrivacyDialogAuto\";\r\nimport { autoJsStoreUtils } from \"@droid/android\";\r\n\r\n\r\nexport function ListenShowPrivacyContent({type}:{type:string}){\r\n\r\n    const [open, setOpen] = useState(false);\r\n    function onClose() {\r\n        setOpen(false);\r\n    }\r\n\r\n    useEffect(()=>{\r\n        const value = autoJsStoreUtils.read(`privacy_${type}`, false)\r\n    }, [])\r\n    return(\r\n        <PrivacyDialogAuto type={type} area=\"zh-cn\" />\r\n    )\r\n}","import React, { useState, useEffect } from 'react';\nimport {\n  Box,\n  Typography,\n  Paper,\n  List,\n  ListItem,\n  Button,\n  Chip,\n  Alert,\n  IconButton,\n  Tooltip,\n  CircularProgress,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n  Divider\n} from '@mui/material';\nimport {\n  CheckCircle as CheckCircleIcon,\n  Error as ErrorIcon,\n  Help as HelpIcon,\n  Settings as SettingsIcon,\n  Refresh as RefreshIcon,\n  Security as SecurityIcon,\n  Info as InfoIcon\n} from '@mui/icons-material';\nimport { autoWebViewJs, isRealInAndroid } from '@droid/android';\nimport { trackingPrint } from '@app/model';\n\ninterface Permission {\n  id: string;\n  name: string;\n  type: 'runtime' | 'special' | 'vendor';\n  status: 'granted' | 'denied' | 'unknown';\n  canDetect: boolean;\n  description: string;\n  settingsAction: string;\n}\n\ninterface PermissionsData {\n  permissions: Permission[];\n  timestamp: number;\n  deviceBrand: string;\n  apiLevel: number;\n  error?: string;\n}\n\nexport const PermissionStatusPanel: React.FC = () => {\n  const [permissionsData, setPermissionsData] = useState<PermissionsData | null>(null);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [infoDialogOpen, setInfoDialogOpen] = useState(false);\n  const [selectedPermission, setSelectedPermission] = useState<Permission | null>(null);\n\n  const fetchPermissions = async () => {\n    try {\n      if(!isRealInAndroid) return;\n      setLoading(true);\n      setError(null);\n      \n      // 权限刷新埋点\n      trackingPrint({params:{\n        type:\"用户操作\",\n        title:\"权限检查\",\n        subtitle:\"权限刷新-开始\",\n        extra:{\n          timestamp: Date.now(),\n          isAndroid: isRealInAndroid\n        }\n      }});\n      \n      const script = `\n        var info = com.fanfanlo.emergencycall.manager.PermissionJSInterface.getAllPermissionsStatus();\n        info;\n      `;\n      \n      const { javaResultString } = autoWebViewJs.callScript(script);\n      \n      if (!javaResultString) {\n        throw new Error('No response from permission interface');\n      }\n      \n      const data = JSON.parse(javaResultString) as PermissionsData;\n      \n      if (data.error) {\n        throw new Error(data.error);\n      }\n      \n      setPermissionsData(data);\n      console.log('Permissions data loaded:', data);\n      \n      // 权限加载成功埋点\n      trackingPrint({params:{\n        type:\"系统事件\",\n        title:\"权限检查\",\n        subtitle:\"权限加载-成功\",\n        extra:{\n          timestamp: Date.now(),\n          permissionsCount: data.permissions.length,\n          grantedCount: data.permissions.filter(p => p.status === 'granted').length,\n          deniedCount: data.permissions.filter(p => p.status === 'denied').length,\n          unknownCount: data.permissions.filter(p => p.status === 'unknown').length,\n          deviceBrand: data.deviceBrand,\n          apiLevel: data.apiLevel\n        }\n      }});\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Unknown error';\n      setError(errorMessage);\n      console.error('Error fetching permissions:', err);\n      \n      // 权限加载失败埋点\n      trackingPrint({params:{\n        type:\"系统异常\",\n        title:\"权限检查\",\n        subtitle:\"权限加载-失败\",\n        extra:{\n          timestamp: Date.now(),\n          error: errorMessage,\n          isAndroid: isRealInAndroid\n        }\n      }});\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchPermissions();\n  }, []);\n\n  const handleOpenSettings = (permission: Permission) => {\n    try {\n      // 权限设置按钮点击埋点\n      trackingPrint({params:{\n        type:\"用户操作\",\n        title:\"权限设置\",\n        subtitle:\"设置按钮-点击\",\n        extra:{\n          timestamp: Date.now(),\n          permissionId: permission.id,\n          permissionName: permission.name,\n          permissionType: permission.type,\n          currentStatus: permission.status,\n          canDetect: permission.canDetect\n        }\n      }});\n      \n      const script = `\n        com.fanfanlo.emergencycall.manager.PermissionJSInterface.openPermissionSettings(\"${permission.id}\");\n      `;\n      autoWebViewJs.callScript(script);\n      console.log(`Opening settings for permission: ${permission.id}`);\n      \n      // 如果是消息推送权限，用户从设置页面返回后自动检查JPush状态\n      if (permission.id === 'notification') {\n        // 延迟执行，给用户时间完成权限设置\n        setTimeout(() => {\n          try {\n            const jpushScript = `\n              com.fanfanlo.emergencycall.jpush.JpushManager.checkAndReinitializeIfNeeded();\n            `;\n            autoWebViewJs.callScript(jpushScript);\n            console.log('JPush reinitialization check triggered');\n            \n            // 刷新权限状态\n            setTimeout(() => fetchPermissions(), 1000);\n          } catch (jpushErr) {\n            console.error('Error checking JPush status:', jpushErr);\n            \n            // JPush重新初始化失败埋点\n            trackingPrint({params:{\n              type:\"系统异常\",\n              title:\"JPush重初始化\",\n              subtitle:\"JPush-重初始化失败\",\n              extra:{\n                timestamp: Date.now(),\n                error: jpushErr instanceof Error ? jpushErr.message : String(jpushErr)\n              }\n            }});\n          }\n        }, 3000); // 3秒后检查\n      }\n    } catch (err) {\n      console.error('Error opening permission settings:', err);\n      \n      // 权限设置打开失败埋点\n      trackingPrint({params:{\n        type:\"系统异常\",\n        title:\"权限设置\",\n        subtitle:\"设置打开-失败\",\n        extra:{\n          timestamp: Date.now(),\n          permissionId: permission.id,\n          error: err instanceof Error ? err.message : String(err)\n        }\n      }});\n    }\n  };\n\n  // const handleConfirmLockScreenPermission = () => {\n  //   try {\n  //     // 锁屏权限确认埋点\n  //     trackingPrint({params:{\n  //       type:\"用户操作\",\n  //       title:\"锁屏权限\",\n  //       subtitle:\"权限确认-点击\",\n  //       extra:{\n  //         timestamp: Date.now()\n  //       }\n  //     }});\n      \n  //     const script = `\n  //       com.fanfanlo.emergencycall.manager.PermissionJSInterface.confirmLockScreenPermission();\n  //     `;\n  //     autoWebViewJs.callScript(script);\n  //     console.log('Confirmed lock screen permission');\n      \n  //     // 刷新权限状态\n  //     setTimeout(() => fetchPermissions(), 500);\n  //   } catch (err) {\n  //     console.error('Error confirming lock screen permission:', err);\n      \n  //     // 锁屏权限确认失败埋点\n  //     trackingPrint({params:{\n  //       type:\"系统异常\",\n  //       title:\"锁屏权限\",\n  //       subtitle:\"权限确认-失败\",\n  //       extra:{\n  //         timestamp: Date.now(),\n  //         error: err instanceof Error ? err.message : String(err)\n  //       }\n  //     }});\n  //   }\n  // };\n\n  const handleShowPermissionInfo = (permission: Permission) => {\n    // 权限信息查看埋点\n    trackingPrint({params:{\n      type:\"用户操作\",\n      title:\"权限信息\",\n      subtitle:\"信息按钮-点击\",\n      extra:{\n        timestamp: Date.now(),\n        permissionId: permission.id,\n        permissionName: permission.name,\n        permissionStatus: permission.status\n      }\n    }});\n    \n    setSelectedPermission(permission);\n    setInfoDialogOpen(true);\n  };\n\n  const handleCloseInfoDialog = () => {\n    // 权限信息对话框关闭埋点\n    trackingPrint({params:{\n      type:\"模态框操作\",\n      title:\"权限信息\",\n      subtitle:\"信息对话框-关闭\",\n      extra:{\n        timestamp: Date.now(),\n        permissionId: selectedPermission?.id\n      }\n    }});\n    \n    setInfoDialogOpen(false);\n    setSelectedPermission(null);\n  };\n\n  const getPermissionReason = (permission: Permission): string => {\n    const reasonMap: Record<string, string> = {\n      'android.permission.ACCESS_FINE_LOCATION': '精确定位权限用于在紧急情况下获取您的准确位置信息，以便救援人员能够快速找到您。这对于户外活动、老人独居等场景下的紧急救助至关重要。',\n      'android.permission.ACCESS_COARSE_LOCATION': '大概位置权限作为精确定位的备用选择，在精确定位不可用时仍能提供基本的位置信息，确保紧急情况下不会完全失去位置服务。',\n      'android.permission.BODY_SENSORS': '身体传感器权限用于访问手机的加速度计、陀螺仪等传感器，实现跌倒检测功能。当检测到您可能发生跌倒时，系统会自动触发紧急呼叫，对老人和高危工作者尤为重要。',\n      'android.permission.CAMERA': '相机权限用于在紧急情况下自动拍摄现场照片，为救援人员和家属提供重要的环境信息，帮助判断紧急情况的严重程度和选择合适的救援方案。',\n      'android.permission.RECORD_AUDIO': '录音权限用于记录紧急情况发生时的环境声音，可以为救援人员提供重要线索，同时支持语音紧急呼叫功能，让您在无法操作手机时也能求救。',\n      'android.permission.ACTIVITY_RECOGNITION': '身体活动识别权限用于识别您当前的活动状态(如走路、跑步、静止等)，结合传感器数据提高跌倒检测的准确性，减少误报的同时确保真正的紧急情况不会被遗漏。',\n      'overlay': '悬浮窗权限允许应用在任何界面上显示紧急呼叫窗口，确保即使您在使用其他应用时，紧急呼叫功能也能立即激活，不会被其他应用界面阻挡。',\n      'lock_screen_popup': '后台弹出界面权限确保应用在后台运行时仍能在检测到紧急情况时立即弹出呼叫界面，即使手机处于息屏或锁定状态也不会影响紧急功能的响应速度。',\n      'lock_screen_display': '锁屏显示权限允许应用在手机锁屏状态下显示紧急信息和呼叫界面，确保紧急情况发生时不会因为屏幕锁定而延误救援时机。这对于意外昏迷等无法解锁手机的情况尤为重要。',\n      'desktop_shortcut': '桌面快捷方式权限允许应用在桌面创建一键紧急呼叫的快捷图标，让您在紧急情况下能够更快速地启动求救功能，特别适合老年用户或紧急情况下的快速操作。',\n      'notification': '消息推送权限用于接收紧急呼叫、跌倒检测警报、系统通知等重要消息。这是确保您能及时收到紧急信息和家人求救通知的关键权限，对于紧急救援场景至关重要。'\n    };\n    return reasonMap[permission.id] || '该权限对于应用的正常运行是必要的，请根据您的需要进行授权。';\n  };\n\n  const getPermissionImpact = (permission: Permission): string => {\n    const impactMap: Record<string, string> = {\n      'android.permission.ACCESS_FINE_LOCATION': '🚨 高影响：没有位置权限将无法在紧急情况下提供准确的位置信息给救援人员',\n      'android.permission.ACCESS_COARSE_LOCATION': '⚠️ 中影响：作为位置服务的备用选择，建议配合精确位置一起授权',\n      'android.permission.BODY_SENSORS': '🚨 高影响：没有此权限将无法实现自动跌倒检测功能',\n      'android.permission.CAMERA': '⚠️ 中影响：无法自动拍摄现场照片，但不影响基本呼叫功能',\n      'android.permission.RECORD_AUDIO': '⚠️ 中影响：无法录制环境音或使用语音功能，但不影响基本呼叫功能',\n      'android.permission.ACTIVITY_RECOGNITION': '⚠️ 中影响：跌倒检测准确性可能降低，增加误报或漏报风险',\n      'overlay': '🚨 高影响：无法在其他应用界面上显示紧急呼叫，可能错过紧急救援时机',\n      'lock_screen_popup': '🚨 高影响：手机锁屏时无法自动弹出紧急呼叫界面',\n      'lock_screen_display': '🚨 高影响：锁屏状态下无法显示紧急信息，可能延误救援',\n      'desktop_shortcut': '💡 低影响：无法创建桌面快捷方式，但不影响应用内的紧急呼叫功能',\n      'notification': '🚨 高影响：无法接收紧急推送消息，可能错过家人求救信号或重要安全警报'\n    };\n    return impactMap[permission.id] || '该权限的具体影响取决于您的使用场景。';\n  };\n\n  const getStatusIcon = (permission: Permission) => {\n    const iconProps = { fontSize: 18 };\n    switch (permission.status) {\n      case 'granted':\n        return <CheckCircleIcon sx={{ color: 'success.main', ...iconProps }} />;\n      case 'denied':\n        return <ErrorIcon sx={{ color: 'error.main', ...iconProps }} />;\n      case 'unknown':\n        return <HelpIcon sx={{ color: 'warning.main', ...iconProps }} />;\n      default:\n        return <HelpIcon sx={{ color: 'grey.500', ...iconProps }} />;\n    }\n  };\n\n  const getStatusChip = (permission: Permission) => {\n    const statusConfig = {\n      granted: { label: '✓', color: 'success' as const },\n      denied: { label: '✗', color: 'error' as const },\n      unknown: { label: '?', color: 'warning' as const }\n    };\n\n    const config = statusConfig[permission.status];\n    return (\n      <Chip \n        label={config.label} \n        color={config.color} \n        size=\"small\"\n        sx={{ \n          minWidth: 24,\n          height: 20,\n          fontSize: '0.7rem',\n          '& .MuiChip-label': { px: 0.5 }\n        }}\n      />\n    );\n  };\n\n  const getTypeLabel = (type: string) => {\n    const typeLabels = {\n      runtime: '运行时',\n      special: '特殊',\n      vendor: '厂商'\n    };\n    return typeLabels[type as keyof typeof typeLabels] || type;\n  };\n\n  if (loading) {\n    return (\n      <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\" minHeight=\"120px\">\n        <CircularProgress size={20} />\n        <Typography variant=\"caption\" sx={{ ml: 1 }}>加载中...</Typography>\n      </Box>\n    );\n  }\n\n  if (error) {\n    return (\n      <Alert severity=\"error\" sx={{ py: 1 }}>\n        <Typography variant=\"body2\">权限检查失败: {error}</Typography>\n        <Button \n          onClick={() => {\n            // 重试按钮点击埋点\n            trackingPrint({params:{\n              type:\"用户操作\",\n              title:\"权限检查\",\n              subtitle:\"重试按钮-点击\",\n              extra:{\n                timestamp: Date.now(),\n                previousError: error\n              }\n            }});\n            fetchPermissions();\n          }} \n          size=\"small\" \n          sx={{ mt: 0.5 }}\n        >\n          重试\n        </Button>\n      </Alert>\n    );\n  }\n\n  if (!permissionsData) {\n    return (\n      <Alert severity=\"info\" sx={{ py: 1 }}>\n        <Typography variant=\"body2\">无权限数据，请重新加载</Typography>\n      </Alert>\n    );\n  }\n\n  const { permissions, deviceBrand, apiLevel } = permissionsData;\n\n  return (\n    <Paper elevation={1} sx={{ p: 1 }}>\n      {/* 标题栏 */}\n      <Box display=\"flex\" alignItems=\"center\" justifyContent=\"space-between\" mb={1}>\n        <Box display=\"flex\" alignItems=\"center\">\n          <SecurityIcon sx={{ mr: 0.5, color: 'primary.main', fontSize: 18 }} />\n          <Typography variant=\"body2\" fontWeight=\"medium\">权限状态</Typography>\n        </Box>\n        <Tooltip title=\"刷新\">\n          <IconButton \n            onClick={() => {\n              // 刷新按钮点击埋点\n              trackingPrint({params:{\n                type:\"用户操作\",\n                title:\"权限检查\",\n                subtitle:\"刷新按钮-点击\",\n                extra:{\n                  timestamp: Date.now(),\n                  currentPermissionsCount: permissionsData?.permissions.length || 0\n                }\n              }});\n              fetchPermissions();\n            }} \n            size=\"small\" \n            sx={{ p: 0.5 }}\n          >\n            <RefreshIcon fontSize=\"small\" />\n          </IconButton>\n        </Tooltip>\n      </Box>\n\n      {/* 说明 */}\n      <Alert severity=\"info\" sx={{ mb: 1, py: 0.5 }}>\n        <Typography variant=\"caption\" display=\"block\">\n          🟢已授权 🔴未授权 🟡无法检测\n        </Typography>\n        <Typography variant=\"caption\" color=\"textSecondary\">\n          {deviceBrand} • API{apiLevel}\n        </Typography>\n      </Alert>\n\n      {/* 权限列表 */}\n      <List sx={{ py: 0 }}>\n        {permissions.map((permission) => (\n          <ListItem\n            key={permission.id}\n            sx={{\n              borderLeft: 2,\n              borderLeftColor: \n                permission.status === 'granted' ? 'success.main' :\n                permission.status === 'denied' ? 'error.main' : 'warning.main',\n              mb: 0.5,\n              py: 0.5,\n              px: 0.5,\n              borderRadius: 0.5,\n              bgcolor: 'grey.50',\n              display: 'block' // 改为block布局\n            }}\n          >\n            {/* 第一行：图标 + 名称 + 状态 + 信息按钮 */}\n            <Box display=\"flex\" alignItems=\"center\" mb={0.5}>\n              <Box sx={{ mr: 0.5 }}>\n                {getStatusIcon(permission)}\n              </Box>\n              <Typography \n                variant=\"body2\" \n                fontWeight=\"medium\" \n                sx={{ flex: 1, minWidth: 0 }}\n              >\n                {permission.name}\n              </Typography>\n              <Tooltip title=\"查看权限说明\">\n                <IconButton\n                  size=\"small\"\n                  onClick={() => handleShowPermissionInfo(permission)}\n                  sx={{ mr: 0.5, p: 0.25 }}\n                >\n                  <InfoIcon sx={{ fontSize: 16, color: 'primary.main' }} />\n                </IconButton>\n              </Tooltip>\n              {getStatusChip(permission)}\n            </Box>\n            \n            {/* 第二行：类型标签 + 确认信息 */}  \n            <Box display=\"flex\" alignItems=\"center\" justifyContent=\"space-between\" mb={0.5}>\n              <Box display=\"flex\" alignItems=\"center\" gap={0.5}>\n                <Chip \n                  label={getTypeLabel(permission.type)} \n                  variant=\"outlined\" \n                  size=\"small\"\n                  sx={{ \n                    fontSize: '0.65rem',\n                    height: 18,\n                    '& .MuiChip-label': { px: 0.5, py: 0 }\n                  }}\n                />\n                {!permission.canDetect && (\n                  <Typography variant=\"caption\" color=\"textSecondary\" sx={{ fontSize: '0.65rem' }}>\n                    需确认\n                  </Typography>\n                )}\n              </Box>\n            </Box>\n            \n            {/* 第三行：操作按钮 */}\n            <Box display=\"flex\" gap={0.5}>\n              {/* {(permission.id === 'lock_screen' || permission.id === 'lock_screen_popup' || permission.id === 'lock_screen_display') && permission.status === 'unknown' && (\n                <Button\n                  variant=\"outlined\"\n                  size=\"small\" \n                  color=\"success\"\n                  onClick={handleConfirmLockScreenPermission}\n                  sx={{ \n                    fontSize: '0.65rem',\n                    minWidth: 'auto',\n                    px: 0.5,\n                    py: 0.25,\n                    height: 24\n                  }}\n                >\n                  已授权\n                </Button>\n              )} */}\n              <Button\n                variant=\"outlined\"\n                size=\"small\"\n                startIcon={<SettingsIcon sx={{ fontSize: 12 }} />}\n                onClick={() => handleOpenSettings(permission)}\n                sx={{ \n                  fontSize: '0.65rem',\n                  minWidth: 'auto',\n                  px: 0.5,\n                  py: 0.25,\n                  height: 24\n                }}\n              >\n                设置\n              </Button>\n            </Box>\n          </ListItem>\n        ))}\n      </List>\n\n      {/* 底部时间戳 */}\n      <Box mt={0.5} py={0.25} px={0.5} bgcolor=\"grey.100\" borderRadius={0.25}>\n        <Typography variant=\"caption\" color=\"textSecondary\" sx={{ fontSize: '0.6rem' }}>\n          更新: {new Date(permissionsData.timestamp).toLocaleTimeString()}\n        </Typography>\n      </Box>\n\n      {/* 权限说明对话框 */}\n      <Dialog\n        open={infoDialogOpen}\n        onClose={handleCloseInfoDialog}\n        maxWidth=\"sm\"\n        fullWidth\n        PaperProps={{\n          sx: { mx: 1 } // 移动端适配\n        }}\n      >\n        <DialogTitle sx={{ pb: 1 }}>\n          <Box display=\"flex\" alignItems=\"center\">\n            <SecurityIcon sx={{ mr: 1, color: 'primary.main' }} />\n            <Box>\n              <Typography variant=\"h6\" component=\"div\">\n                {selectedPermission?.name}\n              </Typography>\n              <Typography variant=\"caption\" color=\"textSecondary\">\n                {selectedPermission && getTypeLabel(selectedPermission.type)}权限\n              </Typography>\n            </Box>\n          </Box>\n        </DialogTitle>\n        \n        <DialogContent sx={{ pt: 0 }}>\n          {selectedPermission && (\n            <Box>\n              {/* 权限状态 */}\n              <Box display=\"flex\" alignItems=\"center\" mb={2}>\n                <Typography variant=\"subtitle2\" sx={{ mr: 1 }}>当前状态:</Typography>\n                <Box display=\"flex\" alignItems=\"center\">\n                  {getStatusIcon(selectedPermission)}\n                  <Typography variant=\"body2\" sx={{ ml: 0.5 }}>\n                    {selectedPermission.status === 'granted' ? '已授权' : \n                     selectedPermission.status === 'denied' ? '未授权' : '待确认'}\n                  </Typography>\n                </Box>\n              </Box>\n              \n              <Divider sx={{ mb: 2 }} />\n              \n              {/* 权限用途说明 */}\n              <Box mb={2}>\n                <Typography variant=\"subtitle2\" gutterBottom color=\"primary.main\">\n                  🎯 为什么需要这个权限？\n                </Typography>\n                <Typography variant=\"body2\" color=\"textSecondary\" lineHeight={1.6}>\n                  {getPermissionReason(selectedPermission)}\n                </Typography>\n              </Box>\n              \n              <Divider sx={{ mb: 2 }} />\n              \n              {/* 影响说明 */}\n              <Box mb={1}>\n                <Typography variant=\"subtitle2\" gutterBottom color=\"warning.main\">\n                  ⚡ 不授权的影响\n                </Typography>\n                <Typography variant=\"body2\" color=\"textSecondary\" lineHeight={1.6}>\n                  {getPermissionImpact(selectedPermission)}\n                </Typography>\n              </Box>\n            </Box>\n          )}\n        </DialogContent>\n        \n        <DialogActions sx={{ px: 3, pb: 2 }}>\n          <Button \n            onClick={() => {\n              // 权限信息\"我知道了\"按钮埋点\n              trackingPrint({params:{\n                type:\"用户操作\",\n                title:\"权限信息\",\n                subtitle:\"我知道了-点击\",\n                extra:{\n                  timestamp: Date.now(),\n                  permissionId: selectedPermission?.id,\n                  permissionStatus: selectedPermission?.status\n                }\n              }});\n              handleCloseInfoDialog();\n            }} \n            color=\"primary\"\n          >\n            我知道了\n          </Button>\n          {selectedPermission && (\n            <Button\n              variant=\"contained\"\n              onClick={() => {\n                // 权限信息\"去设置\"按钮埋点\n                trackingPrint({params:{\n                  type:\"用户操作\",\n                  title:\"权限设置\",\n                  subtitle:\"去设置-对话框点击\",\n                  extra:{\n                    timestamp: Date.now(),\n                    permissionId: selectedPermission.id,\n                    permissionName: selectedPermission.name,\n                    currentStatus: selectedPermission.status,\n                    fromDialog: true\n                  }\n                }});\n                \n                handleOpenSettings(selectedPermission);\n                handleCloseInfoDialog();\n              }}\n              color=\"primary\"\n            >\n              去设置\n            </Button>\n          )}\n        </DialogActions>\n      </Dialog>\n    </Paper>\n  );\n};","export { PermissionStatusPanel } from './PermissionStatusPanel';","import React, { useState, useEffect, useRef } from 'react';\r\nimport { Box, TextField, Button, Typography, Paper, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle, Accordion, AccordionSummary, AccordionDetails } from '@mui/material';\r\nimport { ExpandMore as ExpandMoreIcon } from '@mui/icons-material';\r\nimport { autoJsStoreUtils, autoWebViewJs } from '@droid/android';\r\nimport { PermissionStatusPanel } from '../permission-status';\r\nimport { authService } from '@src/services/authService';\r\n\r\nexport const SensorMonitor: React.FC = () => {\r\n  const [threshold, setThreshold] = useState<string>('5.0');\r\n  const [isMonitoring, setIsMonitoring] = useState<boolean>(false);\r\n\r\n  // 为每个对话框创建独立的状态\r\n  const [isSensorInfoDialogOpen, setSensorInfoDialogOpen] = useState(false);\r\n  const [isForegroundServiceDialogOpen, setForegroundServiceDialogOpen] = useState(false);\r\n\r\n  // 使用useRef来保存回调函数，避免在re-render中丢失\r\n  const sensorCallbackRef = useRef<(passed: boolean) => void>();\r\n  const foregroundServiceCallbackRef = useRef<(passed: boolean) => void>();\r\n\r\n\r\n  useEffect(() => {\r\n    try {\r\n      const script = `\r\n      var thresholdValue = com.fanfanlo.emergencycall.manager.SensorManager.getThreshold();\r\n      thresholdValue;`;\r\n      const { javaResultString } = autoWebViewJs.callScript(script);\r\n      const thresholdValue = parseFloat(javaResultString || '5.0');\r\n      // console.log(\"script get threshold=\", thresholdValue, javaResultString);\r\n      setThreshold(thresholdValue.toString());\r\n    } catch (error) {\r\n      console.error('Error fetching initial threshold value:', error);\r\n    }\r\n  }, []);\r\n\r\n  function readIsMonitoring() {\r\n    try {\r\n      const script = `\r\n      var isMonitoring = com.fanfanlo.emergencycall.manager.SensorManager.isMonitoring();\r\n      isMonitoring;`;\r\n      const { javaResultString } = autoWebViewJs.callScript(script);\r\n      const isMonitoring = javaResultString === \"true\";\r\n      // console.log(\"script get isMonitoring=\", isMonitoring, javaResultString);\r\n      setIsMonitoring(isMonitoring);\r\n    } catch (error) {\r\n      console.error('Error fetching initial monitoring state:', error);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    readIsMonitoring();\r\n  }, []);\r\n\r\n  const handleSetThreshold = () => {\r\n    const thresholdValue = parseFloat(threshold);\r\n    if (isNaN(thresholdValue)) {\r\n      alert('请输入一个有效的数字作为阈值。');\r\n      return;\r\n    }\r\n    try {\r\n      const script = `com.fanfanlo.emergencycall.manager.SensorManager.updateThreshold(${thresholdValue});`;\r\n      autoWebViewJs.callScript(script);\r\n      alert(`阈值已设置为: ${thresholdValue}`);\r\n    } catch (error) {\r\n      console.error('Error calling updateThreshold:', error);\r\n      alert('设置阈值失败。请确保您在安卓应用中。');\r\n    }\r\n  };\r\n\r\n  async function handleToggleMonitoring () {\r\n    if (isMonitoring) {\r\n      // 如果当前正在监控，则直接停止，不进行检查\r\n      try {\r\n        const script = `com.fanfanlo.emergencycall.manager.SensorManager.stopMonitoring();`;\r\n        autoWebViewJs.callScript(script);\r\n        readIsMonitoring();\r\n      } catch (error) {\r\n        console.error('Error stopping monitoring:', error);\r\n        alert('停止监控失败。');\r\n      }\r\n    } else {\r\n\r\n\r\n      const appLoggedIn = await authService.showLoginDialog();\r\n      if(!appLoggedIn){\r\n        alert(\"未登录无法使用该功能\")\r\n        return\r\n      }\r\n      // 如果当前未监控，则检查权限，然后启动\r\n      checkShowInfo(passed => {\r\n        if (!passed) return; // 用户不同意，则不执行任何操作\r\n        try {\r\n          const script = `com.fanfanlo.emergencycall.manager.SensorManager.startMonitoring();`;\r\n          // const script = `com.fanfanlo.emergencycall.manager.SensorManagerShell.startMonitoring();`;\r\n          // const script = `com.fanfanlo.emergencycall.manager.SensorManagerShell.xx();`;\r\n          autoWebViewJs.callScript(script);\r\n          readIsMonitoring();\r\n        } catch (error) {\r\n          console.error('Error starting monitoring:', error);\r\n          alert('开始监控失败。');\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  useEffect(()=>{\r\n    const id = setInterval(() => {\r\n      readIsMonitoring();\r\n    }, 3000); // 每5秒检查一次监控状态\r\n    return () => clearInterval(id);\r\n  }, [])\r\n  function checkShowSensorInfo(callback: (passed: boolean) => void) {\r\n    interface Info {\r\n      passed: boolean;\r\n    }\r\n    const info = autoJsStoreUtils.read<Info>('showSensorInfo', { passed: false });\r\n    if (!info || !info.passed) {\r\n      // 保存回调，并在Dialog操作后调用\r\n      sensorCallbackRef.current = callback;\r\n      // 打开传感器权限对话框\r\n      setSensorInfoDialogOpen(true);\r\n    } else {\r\n      callback(true);\r\n    }\r\n  }\r\n\r\n  function checkShowInfo(callback:(passed:boolean)=>void){\r\n    checkShowSensorInfo(passed=>{\r\n      if(!passed) {\r\n        callback(false);\r\n        return;\r\n      };\r\n      checkShowForegroundServiceInfo(callback);\r\n    })\r\n  }\r\n\r\n  function checkShowForegroundServiceInfo(callback: (passed: boolean) => void) {\r\n    interface Info {\r\n      passed: boolean;\r\n    }\r\n    const info = autoJsStoreUtils.read<Info>('showForegroundServiceInfo', { passed: false });\r\n    if (!info || !info.passed) {\r\n      // 保存回调，并在Dialog操作后调用\r\n      foregroundServiceCallbackRef.current = callback;\r\n      // 打开前台服务对话框\r\n      setForegroundServiceDialogOpen(true);\r\n    } else {\r\n      callback(true);\r\n    }\r\n  }\r\n\r\n  // 传感器对话框的处理器\r\n  const handleSensorDialog = (passed: boolean) => {\r\n    autoJsStoreUtils.write('showSensorInfo', { passed });\r\n    setSensorInfoDialogOpen(false);\r\n    if (sensorCallbackRef.current) {\r\n      sensorCallbackRef.current(passed);\r\n    }\r\n  };\r\n\r\n  // 前台服务对话框的处理器\r\n  const handleForegroundServiceDialog = (passed: boolean) => {\r\n    autoJsStoreUtils.write('showForegroundServiceInfo', { passed });\r\n    setForegroundServiceDialogOpen(false);\r\n    if (foregroundServiceCallbackRef.current) {\r\n      foregroundServiceCallbackRef.current(passed);\r\n    }\r\n  };\r\n\r\n\r\n  return (\r\n    <Box>\r\n      {/* 传感器监控控制面板 */}\r\n      <Paper elevation={3} sx={{ padding: 2, marginBottom: 2 }}>\r\n        <Typography variant=\"h6\" gutterBottom>\r\n          传感器监控控制\r\n        </Typography>\r\n        <Box sx={{ display: 'flex', alignItems: 'center', gap: 2, marginBottom: 2 }}>\r\n          <TextField\r\n            label=\"震动阈值\"\r\n            variant=\"outlined\"\r\n            type=\"number\"\r\n            value={threshold}\r\n            onChange={(e) => setThreshold(e.target.value)}\r\n            size=\"small\"\r\n          />\r\n          <Button variant=\"contained\" onClick={handleSetThreshold}>\r\n            设置\r\n          </Button>\r\n        </Box>\r\n        <Button\r\n          variant=\"contained\"\r\n          color={isMonitoring ? 'error' : 'primary'}\r\n          onClick={handleToggleMonitoring}\r\n          fullWidth\r\n        >\r\n          {isMonitoring ? '停止监控' : '开始监控'}\r\n        </Button>\r\n      </Paper>\r\n\r\n      {/* 权限状态面板 */}\r\n      <Accordion >\r\n        <AccordionSummary\r\n          expandIcon={<ExpandMoreIcon />}\r\n          aria-controls=\"permission-panel-content\"\r\n          id=\"permission-panel-header\"\r\n        >\r\n          <Typography variant=\"h6\">权限状态检查</Typography>\r\n        </AccordionSummary>\r\n        <AccordionDetails>\r\n          <PermissionStatusPanel />\r\n        </AccordionDetails>\r\n      </Accordion>\r\n\r\n      {/* 传感器权限说明对话框 */}\r\n      <Dialog\r\n        open={isSensorInfoDialogOpen}\r\n        onClose={() => handleSensorDialog(false)}\r\n        aria-labelledby=\"sensor-dialog-title\"\r\n        aria-describedby=\"sensor-dialog-description\"\r\n      >\r\n        <DialogTitle id=\"sensor-dialog-title\">\r\n          {\"传感器使用授权\"}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <DialogContentText id=\"sensor-dialog-description\">\r\n            我们需要获取您的身体传感器（如加速度计）权限，以实现跌倒检测功能。这对于在紧急情况下自动触发呼叫至关重要。您是否同意？\r\n          </DialogContentText>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => handleSensorDialog(false)}>不同意</Button>\r\n          <Button onClick={() => handleSensorDialog(true)} autoFocus>\r\n            同意\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      {/* 前台服务通知对话框 */}\r\n      <Dialog\r\n        open={isForegroundServiceDialogOpen}\r\n        onClose={() => handleForegroundServiceDialog(false)}\r\n        aria-labelledby=\"foreground-dialog-title\"\r\n        aria-describedby=\"foreground-dialog-description\"\r\n      >\r\n        <DialogTitle id=\"foreground-dialog-title\">\r\n          {\"启用前台服务通知\"}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <DialogContentText id=\"foreground-dialog-description\">\r\n            为了在应用退到后台后仍能持续监控传感器数据，我们需要启用一个前台服务。这会在您的设备通知栏显示一个持续的通知。您是否同意？\r\n          </DialogContentText>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => handleForegroundServiceDialog(false)}>不同意</Button>\r\n          <Button onClick={() => handleForegroundServiceDialog(true)} autoFocus>\r\n            同意\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default SensorMonitor;\r\n\r\n\r\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n  Box,\r\n  Paper,\r\n  Typography,\r\n  Switch,\r\n  FormControlLabel,\r\n  TextField,\r\n  Select,\r\n  MenuItem,\r\n  FormControl,\r\n  InputLabel,\r\n  Collapse,\r\n  IconButton,\r\n  Chip,\r\n  Alert,\r\n  Grid,\r\n  Divider,\r\n  Button,\r\n  Tooltip\r\n} from '@mui/material';\r\nimport { \r\n  ExpandLess, \r\n  ExpandMore,\r\n  VolumeUp as VolumeUpIcon,\r\n  Vibration as VibrationIcon,\r\n  PlayArrow,\r\n  Stop,\r\n  Delete,\r\n  DragIndicator as DragIndicatorIcon\r\n} from '@mui/icons-material';\r\nimport { autoJsStoreUtils, autoWebViewJs } from '@droid/android';\r\nimport { useProxyWatch } from '@fanfanlo';\r\nimport {user} from '@app/model';\r\nimport _ from 'lodash';\r\nimport { DndContext, closestCenter, KeyboardSensor, PointerSensor, TouchSensor, useSensor, useSensors, DragEndEvent } from '@dnd-kit/core';\r\nimport { arrayMove, SortableContext, sortableKeyboardCoordinates, useSortable, verticalListSortingStrategy } from '@dnd-kit/sortable';\r\nimport { CSS } from '@dnd-kit/utilities';\r\n\r\nconst SHAKE_CONFIG_KEY = \"shake_emergency_config\"\r\n\r\n// 阈值范围常量\r\nconst THRESHOLD_MIN = 7;\r\nconst THRESHOLD_MAX = 15;\r\nconst THRESHOLD_DEFAULT = 9;\r\n// 预报警动作接口\r\ninterface PreAlarmAction {\r\n  id: string;\r\n  type: 'sound' | 'vibration';\r\n  duration: number;\r\n  resourceId?: string;\r\n}\r\n\r\n// 摇一摇配置接口定义\r\ninterface ShakeConfig {\r\n  enabled: boolean;\r\n  shakeCount: number;\r\n  timeWindowMs: number;\r\n  emergencyType: string;\r\n  threshold: number;\r\n  vibrationFeedback: boolean;\r\n  soundFeedback: boolean;\r\n  actions: PreAlarmAction[];\r\n  maxWaitDuration: number;\r\n  version: number;\r\n}\r\n\r\n// 默认配置\r\nconst defaultConfig: ShakeConfig = {\r\n  enabled: false,\r\n  shakeCount: 3,\r\n  timeWindowMs: 2000,\r\n  emergencyType: \"medical\",\r\n  threshold: THRESHOLD_DEFAULT,\r\n  vibrationFeedback: true,\r\n  soundFeedback: false,\r\n  actions: [],\r\n  maxWaitDuration: 10000,\r\n  version: 1\r\n};\r\n\r\n// 配置选项定义\r\nconst emergencyTypeOptions = [\r\n  { value: \"medical\", label: \"医疗报警\" },\r\n  { value: \"security\", label: \"安全报警\" }\r\n];\r\n\r\n// 默认声音资源\r\nconst defaultSoundResources = [\r\n  { id: 'siren_gentle', name: '缓和警报' },\r\n  { id: 'beep_short', name: '短提示音' },\r\n  { id: 'alarm_clock', name: '闹钟' },\r\n];\r\n\r\n\r\nfunction loadConfig():ShakeConfig{\r\n  const conf = autoJsStoreUtils.read(SHAKE_CONFIG_KEY,{})\r\n  const config = _.merge(defaultConfig, conf)\r\n  return config;\r\n}\r\nconst ShakeConfigUI: React.FC = () => {\r\n  const [isExpanded, setIsExpanded] = useState(false);\r\n  const [config, setConfig] = useState<ShakeConfig>(defaultConfig);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [lastSaveTime, setLastSaveTime] = useState<string>('');\r\n  const [playingSoundId, setPlayingSoundId] = useState<string | null>(null);\r\n  \r\n  // 拖拽传感器配置\r\n  const sensors = useSensors(\r\n    useSensor(PointerSensor, {\r\n      activationConstraint: {\r\n        distance: 8,\r\n      },\r\n    }),\r\n    useSensor(TouchSensor, {\r\n      activationConstraint: {\r\n        delay: 250,\r\n        tolerance: 5,\r\n      },\r\n    }),\r\n    useSensor(KeyboardSensor, {\r\n      coordinateGetter: sortableKeyboardCoordinates,\r\n    })\r\n  );\r\n  \r\n  // 检测用户登录状态\r\n  const [userToken] = useProxyWatch(user, 'data.storeData.user_token', user.data.storeData.user_token);\r\n  const isLoggedIn = !!userToken;\r\n  \r\n  // 临时输入值状态，用于处理输入验证\r\n  const [tempValues, setTempValues] = useState<{\r\n    shakeCount?: string;\r\n    timeWindowMs?: string;\r\n    threshold?: string;\r\n  }>({});\r\n\r\n  /**\r\n   * 从Android端读取当前配置\r\n   */\r\n  const loadConfigFromAndroid = useCallback(() => {\r\n    console.log('尝试从Android端读取摇一摇配置...');\r\n    const conf = loadConfig();\r\n    console.log(SHAKE_CONFIG_KEY, 'string', JSON.stringify(conf))\r\n    setConfig(conf)\r\n      setIsLoading(false);\r\n  }, []);\r\n\r\n  /**\r\n   * 验证配置参数的有效性\r\n   */\r\n  const validateConfig = (config: ShakeConfig): boolean => {\r\n    return (\r\n      config.shakeCount >= 1 && config.shakeCount <= 10 &&\r\n      config.timeWindowMs > 0 && config.timeWindowMs <= 10000 &&\r\n      ['medical', 'security'].includes(config.emergencyType) &&\r\n      typeof config.threshold === 'number' &&\r\n      config.threshold >= 0 &&\r\n      config.version > 0\r\n    );\r\n  };\r\n\r\n  /**\r\n   * 保存配置到Android端\r\n   */\r\n  const saveConfigToAndroid = useCallback((newConfig: ShakeConfig) => {\r\n    try {\r\n      console.log('保存摇一摇配置到Android端:', newConfig);\r\n      \r\n      // 验证配置有效性\r\n      if (!validateConfig(newConfig)) {\r\n        console.error('配置参数无效，不进行保存');\r\n        return;\r\n      }\r\n\r\n      // 构建配置JSON\r\n      const configJson = JSON.stringify(newConfig);\r\n      \r\n      // 编码为Base64\r\n      const base64Config = btoa(unescape(encodeURIComponent(configJson)));\r\n      \r\n      // 通过Rhino调用Android方法\r\n      const script = `\r\n        \r\n          var result = com.fanfanlo.emergencycall.controller.ShakeManager.updateShakeConfig(\"${base64Config}\");\r\n          result;\r\n      `;\r\n      autoWebViewJs.callScript(script);\r\n      setLastSaveTime(new Date().toLocaleTimeString());\r\n      \r\n    } catch (error) {\r\n      console.error('保存摇一摇配置失败:', error);\r\n    }\r\n  }, []);\r\n\r\n  /**\r\n   * 处理配置更新\r\n   */\r\n  const updateConfig = useCallback((updates: Partial<ShakeConfig>) => {\r\n    const newConfig = { ...config, ...updates };\r\n    setConfig(newConfig);\r\n    \r\n    // 如果配置有效，自动保存\r\n    if (validateConfig(newConfig)) {\r\n      saveConfigToAndroid(newConfig);\r\n    }\r\n  }, [config, saveConfigToAndroid]);\r\n\r\n  /**\r\n   * 处理数字输入框变更，带延迟验证\r\n   */\r\n  const handleNumberInput = useCallback((field: 'shakeCount' | 'timeWindowMs' | 'threshold', value: string) => {\r\n    // 更新临时值\r\n    setTempValues(prev => ({ ...prev, [field]: value }));\r\n    \r\n    // 清除之前的定时器\r\n    const timerId = setTimeout(() => {\r\n      if (field === 'threshold') {\r\n        // 处理阈值输入\r\n        const numValue = parseFloat(value);\r\n        if (!isNaN(numValue) && numValue >= 0) {\r\n          updateConfig({ [field]: numValue });\r\n          setTempValues(prev => ({ ...prev, [field]: undefined }));\r\n        } else if (value === '') {\r\n          // 空值，等待用户继续输入\r\n          setTimeout(() => {\r\n            if (tempValues[field] === '') {\r\n              setTempValues(prev => ({ ...prev, [field]: undefined }));\r\n            }\r\n          }, 2000);\r\n        } else {\r\n          // 无效值，恢复原值\r\n          setTimeout(() => {\r\n            setTempValues(prev => ({ ...prev, [field]: undefined }));\r\n          }, 2000);\r\n        }\r\n      } else {\r\n        // 原有的整数处理逻辑保持不变\r\n        const numValue = parseInt(value);\r\n        if (!isNaN(numValue) && numValue > 0) {\r\n          if (field === 'shakeCount' && numValue >= 1 && numValue <= 10) {\r\n            updateConfig({ [field]: numValue });\r\n            setTempValues(prev => ({ ...prev, [field]: undefined }));\r\n          } else if (field === 'timeWindowMs' && numValue >= 1000 && numValue <= 10000) {\r\n            updateConfig({ [field]: numValue });\r\n            setTempValues(prev => ({ ...prev, [field]: undefined }));\r\n          } else {\r\n            setTimeout(() => {\r\n              setTempValues(prev => ({ ...prev, [field]: undefined }));\r\n            }, 2000);\r\n          }\r\n        } else if (value === '') {\r\n          setTimeout(() => {\r\n            if (tempValues[field] === '') {\r\n              setTempValues(prev => ({ ...prev, [field]: undefined }));\r\n            }\r\n          }, 2000);\r\n        } else {\r\n          setTimeout(() => {\r\n            setTempValues(prev => ({ ...prev, [field]: undefined }));\r\n          }, 2000);\r\n        }\r\n      }\r\n    }, 500); // 500ms延迟\r\n\r\n    return () => clearTimeout(timerId);\r\n  }, [updateConfig, tempValues]);\r\n\r\n  /**\r\n   * 预报警动作管理函数\r\n   */\r\n  const handleAddPreAlarmAction = useCallback((type: 'sound' | 'vibration') => {\r\n    const newAction: PreAlarmAction = {\r\n      id: `action-${Date.now()}`,\r\n      type,\r\n      duration: type === 'vibration' ? 1000 : 2000,\r\n      ...(type === 'sound' && { resourceId: defaultSoundResources[0].id }),\r\n    };\r\n    updateConfig({\r\n      actions: [...config.actions, newAction],\r\n    });\r\n  }, [config.actions, updateConfig]);\r\n\r\n  const handleUpdatePreAlarmAction = useCallback((id: string, updates: Partial<Omit<PreAlarmAction, 'id'>>) => {\r\n    updateConfig({\r\n      actions: config.actions.map((action) =>\r\n        action.id === id ? { ...action, ...updates } : action\r\n      ),\r\n    });\r\n  }, [config.actions, updateConfig]);\r\n\r\n  const handleRemovePreAlarmAction = useCallback((id: string) => {\r\n    updateConfig({\r\n      actions: config.actions.filter((action) => action.id !== id),\r\n    });\r\n  }, [config.actions, updateConfig]);\r\n\r\n  const handlePreviewSound = useCallback((resourceId?: string) => {\r\n    if (!resourceId) return;\r\n    handleStopSound();\r\n    \r\n    console.log(`[ShakeConfig] Previewing sound: ${resourceId}`);\r\n    \r\n    if ((window as any).SoundManager) {\r\n      (window as any).SoundManager.previewSound(resourceId);\r\n      setPlayingSoundId(resourceId);\r\n    } else {\r\n      console.warn('SoundManager not available');\r\n    }\r\n  }, []);\r\n\r\n  const handleStopSound = useCallback(() => {\r\n    if ((window as any).SoundManager) {\r\n      (window as any).SoundManager.stopPreview();\r\n    }\r\n    setPlayingSoundId(null);\r\n  }, []);\r\n\r\n  /**\r\n   * 拖拽结束处理\r\n   */\r\n  const handleDragEnd = useCallback((event: DragEndEvent) => {\r\n    const { active, over } = event;\r\n    if (!over || active.id === over.id) return;\r\n\r\n    const oldIndex = config.actions.findIndex((a) => a.id === active.id);\r\n    const newIndex = config.actions.findIndex((a) => a.id === over.id);\r\n\r\n    if (oldIndex !== -1 && newIndex !== -1) {\r\n      updateConfig({\r\n        actions: arrayMove(config.actions, oldIndex, newIndex),\r\n      });\r\n    }\r\n  }, [config.actions, updateConfig]);\r\n\r\n  /**\r\n   * 可拖拽的预报警动作项组件\r\n   */\r\n  const SortablePreAlarmActionItem: React.FC<{\r\n    action: PreAlarmAction;\r\n    isPlaying: boolean;\r\n    onUpdate: (id: string, updates: Partial<Omit<PreAlarmAction, 'id'>>) => void;\r\n    onRemove: (id: string) => void;\r\n    onPreview: (resourceId?: string) => void;\r\n    onStopPreview: () => void;\r\n    disabled: boolean;\r\n  }> = ({ action, isPlaying, onUpdate, onRemove, onPreview, onStopPreview, disabled }) => {\r\n    const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({ id: action.id });\r\n\r\n    const style = {\r\n      transform: CSS.Transform.toString(transform),\r\n      transition,\r\n      opacity: isDragging ? 0.8 : 1,\r\n      zIndex: isDragging ? 1 : 'auto',\r\n    };\r\n\r\n    return (\r\n      <Paper\r\n        ref={setNodeRef}\r\n        style={style}\r\n        elevation={isDragging ? 3 : 1}\r\n        sx={{\r\n          p: 2,\r\n          mb: 1,\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: 2,\r\n          userSelect: 'none',\r\n          opacity: disabled ? 0.6 : 1\r\n        }}\r\n      >\r\n        <Box {...attributes} {...listeners} sx={{ display: 'flex', alignItems: 'center', cursor: 'grab', touchAction: 'none' }}>\r\n          <DragIndicatorIcon />\r\n        </Box>\r\n        \r\n        <Box sx={{ flexGrow: 1 }}>\r\n          <Box sx={{ display: 'flex', flexDirection: 'column', alignItems: 'flex-start', gap: 1.5 }}>\r\n            <Typography variant=\"subtitle2\">\r\n              {action.type === 'sound' ? '声音' : '震动'}\r\n            </Typography>\r\n            \r\n            <TextField\r\n              size=\"small\"\r\n              type=\"number\"\r\n              label=\"持续时间 (ms)\"\r\n              value={action.duration}\r\n              onChange={(e) => onUpdate(action.id, { duration: parseInt(e.target.value, 10) || 0 })}\r\n              disabled={disabled}\r\n              sx={{ width: '100%' }}\r\n            />\r\n            \r\n            {action.type === 'sound' && (\r\n              <FormControl size=\"small\" sx={{ width: '100%' }}>\r\n                <InputLabel>声音类型</InputLabel>\r\n                <Select\r\n                  value={action.resourceId || ''}\r\n                  label=\"声音类型\"\r\n                  onChange={(e) => onUpdate(action.id, { resourceId: e.target.value })}\r\n                  disabled={disabled}\r\n                  startAdornment={\r\n                    <Tooltip title={isPlaying ? \"停止\" : \"试听\"}>\r\n                      <IconButton\r\n                        size=\"small\"\r\n                        onClick={() => isPlaying ? onStopPreview() : onPreview(action.resourceId)}\r\n                        sx={{ mr: 1 }}\r\n                        disabled={disabled}\r\n                      >\r\n                        {isPlaying ? <Stop fontSize=\"small\" /> : <PlayArrow fontSize=\"small\" />}\r\n                      </IconButton>\r\n                    </Tooltip>\r\n                  }\r\n                >\r\n                  {defaultSoundResources.map((sound) => (\r\n                    <MenuItem key={sound.id} value={sound.id}>\r\n                      {sound.name}\r\n                    </MenuItem>\r\n                  ))}\r\n                </Select>\r\n              </FormControl>\r\n            )}\r\n          </Box>\r\n        </Box>\r\n        \r\n        <IconButton onClick={() => onRemove(action.id)} size=\"small\" color=\"error\" disabled={disabled}>\r\n          <Delete />\r\n        </IconButton>\r\n      </Paper>\r\n    );\r\n  };\r\n\r\n  /**\r\n   * 监听console.log消息以接收Android端的响应\r\n   */\r\n  useEffect(() => {\r\n    const originalConsoleLog = console.log;\r\n    \r\n    console.log = (...args) => {\r\n      const message = args.join(' ');\r\n      \r\n      // 处理配置加载响应\r\n      if (message.startsWith('SHAKE_CONFIG_LOADED:')) {\r\n        const configData = message.replace('SHAKE_CONFIG_LOADED:', '');\r\n        if (configData === 'null') {\r\n          console.log('未找到摇一摇配置，使用默认配置');\r\n          setConfig(defaultConfig);\r\n        } else {\r\n          try {\r\n            const loadedConfig = JSON.parse(configData);\r\n            setConfig(loadedConfig);\r\n            console.log('摇一摇配置加载成功:', loadedConfig);\r\n          } catch (error) {\r\n            console.error('解析配置失败:', error);\r\n            setConfig(defaultConfig);\r\n          }\r\n        }\r\n        setIsLoading(false);\r\n      }\r\n      \r\n      // 处理保存结果响应\r\n      else if (message.startsWith('SHAKE_CONFIG_SAVE_RESULT:')) {\r\n        const result = message.replace('SHAKE_CONFIG_SAVE_RESULT:', '');\r\n        console.log('配置保存结果:', result === 'true' ? '成功' : '失败');\r\n      }\r\n      \r\n      // 处理错误响应\r\n      else if (message.startsWith('SHAKE_CONFIG_ERROR:') || message.startsWith('SHAKE_CONFIG_SAVE_ERROR:')) {\r\n        console.error('摇一摇配置操作失败:', message);\r\n        setIsLoading(false);\r\n      }\r\n      \r\n      // 调用原始的console.log\r\n      originalConsoleLog.apply(console, args);\r\n    };\r\n\r\n    // 组件挂载时加载配置\r\n    loadConfigFromAndroid();\r\n\r\n    // 清理函数\r\n    return () => {\r\n      console.log = originalConsoleLog;\r\n    };\r\n  }, [loadConfigFromAndroid]);\r\n\r\n  // 渲染加载状态\r\n  if (isLoading) {\r\n    return (\r\n      <Paper sx={{ p: 2 }}>\r\n        <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n          <Typography variant=\"body2\" color=\"text.secondary\">\r\n            加载摇一摇配置...\r\n          </Typography>\r\n        </Box>\r\n      </Paper>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Paper sx={{ overflow: 'hidden' }}>\r\n      {/* 折叠标题栏 */}\r\n      <Box\r\n        sx={{\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'space-between',\r\n          p: 2,\r\n          cursor: 'pointer',\r\n          opacity: !isLoggedIn ? 0.5 : 1,\r\n          '&:hover': {\r\n            bgcolor: 'action.hover'\r\n          }\r\n        }}\r\n        onClick={() => setIsExpanded(!isExpanded)}\r\n      >\r\n        <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\r\n          <Typography variant=\"subtitle1\" fontWeight=\"medium\">\r\n            摇一摇\r\n          </Typography>\r\n          <FormControlLabel\r\n            control={\r\n              <Switch\r\n                checked={config.enabled}\r\n                onChange={(e) => updateConfig({ enabled: e.target.checked })}\r\n                size=\"small\"\r\n                disabled={!isLoggedIn}\r\n              />\r\n            }\r\n            label={config.enabled ? '已启用' : '已禁用'}\r\n            onClick={(e) => e.stopPropagation()} // 防止点击开关时触发展开/折叠\r\n          />\r\n        </Box>\r\n        \r\n        <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n          {lastSaveTime && (\r\n            <Typography variant=\"caption\" color=\"text.secondary\">\r\n              已保存 {lastSaveTime}\r\n            </Typography>\r\n          )}\r\n          <IconButton size=\"small\">\r\n            {isExpanded ? <ExpandLess /> : <ExpandMore />}\r\n          </IconButton>\r\n        </Box>\r\n      </Box>\r\n\r\n      {/* 展开的配置界面 */}\r\n      <Collapse in={isExpanded}>\r\n        <Divider />\r\n        <Box sx={{ p: 2, opacity: !isLoggedIn ? 0.6 : 1, pointerEvents: !isLoggedIn ? 'none' : 'auto' }}>\r\n          {/* 未登录提示 */}\r\n          {/* {!isLoggedIn && (\r\n            <Alert severity=\"warning\" sx={{ mb: 2 }}>\r\n              <Typography variant=\"body2\">\r\n                请先登录后再使用摇一摇功能\r\n              </Typography>\r\n            </Alert>\r\n          )} */}\r\n          {/* 基础设置 */}\r\n          <Grid container spacing={2} sx={{ mb: 3 }}>\r\n            {/* 报警类型 */}\r\n            <Grid item xs={12} sm={6}>\r\n              <FormControl fullWidth disabled={!config.enabled || !isLoggedIn}>\r\n                <InputLabel>报警类型</InputLabel>\r\n                <Select\r\n                  value={config.emergencyType}\r\n                  label=\"报警类型\"\r\n                  onChange={(e) => updateConfig({ emergencyType: e.target.value })}\r\n                >\r\n                  {emergencyTypeOptions.map(option => (\r\n                    <MenuItem key={option.value} value={option.value}>\r\n                      {option.label}\r\n                    </MenuItem>\r\n                  ))}\r\n                </Select>\r\n              </FormControl>\r\n            </Grid>\r\n          </Grid>\r\n\r\n          {/* 检测参数 */}\r\n          <Typography variant=\"h6\" gutterBottom>检测参数</Typography>\r\n          <Grid container spacing={2} sx={{ mb: 3 }}>\r\n            {/* 摇动次数 */}\r\n            <Grid item xs={12} sm={4}>\r\n              <TextField\r\n                fullWidth\r\n                label=\"摇动次数\"\r\n                type=\"number\"\r\n                inputProps={{ min: 1, max: 10 }}\r\n                value={tempValues.shakeCount !== undefined ? tempValues.shakeCount : config.shakeCount}\r\n                onChange={(e) => handleNumberInput('shakeCount', e.target.value)}\r\n                disabled={!config.enabled || !isLoggedIn}\r\n                helperText=\"1-10次\"\r\n                error={tempValues.shakeCount !== undefined && (tempValues.shakeCount === '' || parseInt(tempValues.shakeCount) < 1 || parseInt(tempValues.shakeCount) > 10)}\r\n              />\r\n            </Grid>\r\n\r\n            {/* 时间窗口 */}\r\n            <Grid item xs={12} sm={4}>\r\n              <TextField\r\n                fullWidth\r\n                label=\"时间窗口(毫秒)\"\r\n                type=\"number\"\r\n                inputProps={{ min: 1000, max: 10000, step: 500 }}\r\n                value={tempValues.timeWindowMs !== undefined ? tempValues.timeWindowMs : config.timeWindowMs}\r\n                onChange={(e) => handleNumberInput('timeWindowMs', e.target.value)}\r\n                disabled={!config.enabled || !isLoggedIn}\r\n                helperText=\"1000-10000ms\"\r\n                error={tempValues.timeWindowMs !== undefined && (tempValues.timeWindowMs === '' || parseInt(tempValues.timeWindowMs) < 1000 || parseInt(tempValues.timeWindowMs) > 10000)}\r\n              />\r\n            </Grid>\r\n\r\n            {/* 检测阈值 */}\r\n            <Grid item xs={12} sm={4}>\r\n              <TextField\r\n                fullWidth\r\n                label=\"检测阈值\"\r\n                type=\"number\"\r\n                inputProps={{ min: 0, step: 0.1 }}\r\n                value={tempValues.threshold !== undefined ? tempValues.threshold : config.threshold}\r\n                onChange={(e) => handleNumberInput('threshold', e.target.value)}\r\n                disabled={!config.enabled || !isLoggedIn}\r\n                helperText={`数值越小越敏感，一般范围为${THRESHOLD_MIN}-${THRESHOLD_MAX}，根据手机不同会有差异`}\r\n                error={tempValues.threshold !== undefined && (tempValues.threshold === '' || parseFloat(tempValues.threshold) < 0)}\r\n              />\r\n            </Grid>\r\n          </Grid>\r\n\r\n          {/* 预警设置 */}\r\n          <Typography variant=\"h6\" gutterBottom>预警设置</Typography>\r\n          <Box sx={{ mb: 3 }}>\r\n            {/* 预报警详细配置 */}\r\n            <Collapse in={config.actions.length > 0 || true}>\r\n              <Box sx={{ mt: 2, pl: 4, borderLeft: '2px solid', borderColor: 'primary.main' }}>\r\n                <Grid container spacing={2} sx={{ mb: 2 }}>\r\n                  <Grid item xs={12} sm={6}>\r\n                    <TextField\r\n                      fullWidth\r\n                      size=\"small\"\r\n                      type=\"number\"\r\n                      label=\"预警最大等待时间(ms)\"\r\n                      value={config.maxWaitDuration}\r\n                      onChange={(e) => updateConfig({ maxWaitDuration: parseInt(e.target.value, 10) || 0 })}\r\n                      disabled={!config.enabled || !isLoggedIn}\r\n                      helperText=\"用户可在此时间内确认或取消\"\r\n                    />\r\n                  </Grid>\r\n                </Grid>\r\n                \r\n                <Box sx={{ mb: 2 }}>\r\n                  <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 1 }}>\r\n                    <Typography variant=\"body2\" fontWeight=\"medium\">\r\n                      预警动作序列 ({config.actions.length})\r\n                    </Typography>\r\n                    <Box sx={{ display: 'flex', gap: 1 }}>\r\n                      <Button\r\n                        variant=\"outlined\"\r\n                        size=\"small\"\r\n                        startIcon={<VolumeUpIcon />}\r\n                        onClick={() => handleAddPreAlarmAction('sound')}\r\n                        disabled={!config.enabled || !isLoggedIn}\r\n                      >\r\n                        添加声音\r\n                      </Button>\r\n                      <Button\r\n                        variant=\"outlined\"\r\n                        size=\"small\"\r\n                        startIcon={<VibrationIcon />}\r\n                        onClick={() => handleAddPreAlarmAction('vibration')}\r\n                        disabled={!config.enabled || !isLoggedIn}\r\n                      >\r\n                        添加震动\r\n                      </Button>\r\n                    </Box>\r\n                  </Box>\r\n                  \r\n                  {config.actions.length === 0 ? (\r\n                    <Box sx={{ \r\n                      p: 2, \r\n                      border: '1px dashed', \r\n                      borderColor: 'divider', \r\n                      borderRadius: 1, \r\n                      textAlign: 'center',\r\n                      color: 'text.secondary'\r\n                    }}>\r\n                      <Typography variant=\"body2\">暂无预警动作，点击上方按钮添加</Typography>\r\n                    </Box>\r\n                  ) : (\r\n                    <DndContext\r\n                      sensors={sensors}\r\n                      collisionDetection={closestCenter}\r\n                      onDragEnd={handleDragEnd}\r\n                    >\r\n                      <SortableContext\r\n                        items={config.actions.map((a) => a.id)}\r\n                        strategy={verticalListSortingStrategy}\r\n                      >\r\n                        {config.actions.map((action) => (\r\n                          <SortablePreAlarmActionItem\r\n                            key={action.id}\r\n                            action={action}\r\n                            isPlaying={playingSoundId === action.resourceId}\r\n                            onUpdate={handleUpdatePreAlarmAction}\r\n                            onRemove={handleRemovePreAlarmAction}\r\n                            onPreview={handlePreviewSound}\r\n                            onStopPreview={handleStopSound}\r\n                            disabled={!config.enabled || !isLoggedIn}\r\n                          />\r\n                        ))}\r\n                      </SortableContext>\r\n                    </DndContext>\r\n                  )}\r\n                </Box>\r\n              </Box>\r\n            </Collapse>\r\n            \r\n            {/* 基础反馈设置 */}\r\n            <FormControlLabel\r\n              control={\r\n                <Switch\r\n                  checked={config.vibrationFeedback}\r\n                  onChange={(e) => updateConfig({ vibrationFeedback: e.target.checked })}\r\n                  disabled={!config.enabled || !isLoggedIn}\r\n                />\r\n              }\r\n              label=\"震动反馈\"\r\n            />\r\n            \r\n            <FormControlLabel\r\n              control={\r\n                <Switch\r\n                  checked={config.soundFeedback}\r\n                  onChange={(e) => updateConfig({ soundFeedback: e.target.checked })}\r\n                  disabled={!config.enabled || !isLoggedIn}\r\n                />\r\n              }\r\n              label=\"声音反馈\"\r\n            />\r\n          </Box>\r\n\r\n          {/* 配置说明 */}\r\n          <Alert severity=\"info\" sx={{ mt: 2 }}>\r\n            <Typography variant=\"body2\" component=\"div\">\r\n              <strong>配置说明</strong>\r\n              <ul style={{ margin: '8px 0', paddingLeft: '20px' }}>\r\n                <li>在{config.timeWindowMs}毫秒内连续摇动{config.shakeCount}次将触发报警</li>\r\n                <li>{config.emergencyType === 'medical' ? '医疗报警适合健康紧急情况' : '安全报警适合人身安全威胁'}</li>\r\n                <li>阈值{config.threshold}：数值越小检测越敏感，一般范围为{THRESHOLD_MIN}-{THRESHOLD_MAX}，根据手机不同会有差异</li>\r\n                <li>{config.actions.length > 0 ? `启用预警将在${config.maxWaitDuration}毫秒内执行${config.actions.length}个预警动作，用户可确认或取消` : '无预警动作配置，将直接触发报警'}</li>\r\n              </ul>\r\n            </Typography>\r\n          </Alert>\r\n        </Box>\r\n      </Collapse>\r\n    </Paper>\r\n  );\r\n};\r\n\r\nexport default ShakeConfigUI;","import { autoWebViewJs, autoJsStoreUtils } from \"@droid/android\";\r\nimport { Box, Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle, Grid2 } from \"@mui/material\";\r\nimport { trackingPrint } from \"@app/model\";\r\nimport { authService } from \"@src/services/authService\";\r\nimport { PrivacyDialogDisplay } from '@src/components/privacies/PrivacyDialogDisplay';\r\nimport { useState, useRef } from 'react';\r\nimport toast from 'react-hot-toast';\r\n\r\n// 配置选项 - 与 FallDetectionWrapper 保持一致\r\nconst REQUIRE_LOGIN_FOR_FALL_DETECTION = false;\r\n\r\nexport function TestEmergencyCall() {\r\n    // 权限检查相关状态\r\n    const [fallSensorInfoDialogOpen, setFallSensorInfoDialogOpen] = useState(false);\r\n    const [fallForegroundServiceDialogOpen, setFallForegroundServiceDialogOpen] = useState(false);\r\n    const [privacyDialogOpen, setPrivacyDialogOpen] = useState(false);\r\n    \r\n    // 回调引用\r\n    const fallSensorCallbackRef = useRef<(passed: boolean) => void>();\r\n    const fallForegroundServiceCallbackRef = useRef<(passed: boolean) => void>();\r\n    const privacyCallbackRef = useRef<(passed: boolean) => void>();\r\n\r\n    // 复制自 FallDetectionWrapper - 权限检查函数\r\n    function checkShowFallSensorInfo(callback: (passed: boolean) => void) {\r\n        interface Info {\r\n            passed: boolean;\r\n        }\r\n        const info = autoJsStoreUtils.read<Info>('showSensorInfo', { passed: false });\r\n        if (!info || !info.passed) {\r\n            fallSensorCallbackRef.current = callback;\r\n            setFallSensorInfoDialogOpen(true);\r\n        } else {\r\n            callback(true);\r\n        }\r\n    }\r\n\r\n    function checkShowFallInfo(callback: (passed: boolean) => void) {\r\n        checkShowFallSensorInfo(passed => {\r\n            if (!passed) {\r\n                callback(false);\r\n                return;\r\n            }\r\n            checkShowFallForegroundServiceInfo(callback);\r\n        })\r\n    }\r\n\r\n    function checkShowFallForegroundServiceInfo(callback: (passed: boolean) => void) {\r\n        interface Info {\r\n            passed: boolean;\r\n        }\r\n        const info = autoJsStoreUtils.read<Info>('showForegroundServiceInfo', { passed: false });\r\n        if (!info || !info.passed) {\r\n            fallForegroundServiceCallbackRef.current = callback;\r\n            setFallForegroundServiceDialogOpen(true);\r\n        } else {\r\n            callback(true);\r\n        }\r\n    }\r\n\r\n    // 复制自 FallDetectionWrapper - 对话框处理函数\r\n    const handleFallSensorDialog = (passed: boolean) => {\r\n        autoJsStoreUtils.write('showSensorInfo', { passed });\r\n        setFallSensorInfoDialogOpen(false);\r\n        if (fallSensorCallbackRef.current) {\r\n            fallSensorCallbackRef.current(passed);\r\n        }\r\n    };\r\n\r\n    const handleFallForegroundServiceDialog = (passed: boolean) => {\r\n        autoJsStoreUtils.write('showForegroundServiceInfo', { passed });\r\n        setFallForegroundServiceDialogOpen(false);\r\n        if (fallForegroundServiceCallbackRef.current) {\r\n            fallForegroundServiceCallbackRef.current(passed);\r\n        }\r\n    };\r\n\r\n    // 检查隐私协议是否已同意\r\n    function checkPrivacyAgreement(callback: (passed: boolean) => void): boolean {\r\n        interface IPrivacyInfo {\r\n            agree: boolean;\r\n            disagreeTime: number;\r\n        }\r\n        \r\n        const def: IPrivacyInfo = { agree: false, disagreeTime: 0 };\r\n        const res = autoJsStoreUtils.read<IPrivacyInfo>(`privacy_main`, def);\r\n        const value: IPrivacyInfo = res && 'agree' in res ? res : def;\r\n        \r\n        // 已经同意了\r\n        if (value.agree) {\r\n            callback(true);\r\n            return true;\r\n        }\r\n        \r\n        // 需要弹出隐私协议\r\n        privacyCallbackRef.current = callback;\r\n        setPrivacyDialogOpen(true);\r\n        return false;\r\n    }\r\n\r\n    // 处理隐私协议弹窗关闭\r\n    const handlePrivacyDialogClose = (agreed?: boolean) => {\r\n        setPrivacyDialogOpen(false);\r\n        if (privacyCallbackRef.current) {\r\n            privacyCallbackRef.current(agreed === true);\r\n        }\r\n    };\r\n\r\n    // 执行实际的跌倒检测呼救\r\n    function executeEmergencyCall() {\r\n        try {\r\n            const script = `\r\n            com.fanfanlo.emergencycall.manager.EmergencyCallJSInterface.startMedicalEmergencyCall()`;\r\n            const res = autoWebViewJs.callScript(script);\r\n            console.log(\"TestEmergencyCall res=\", res);\r\n            \r\n            // 测试呼救执行成功埋点\r\n            trackingPrint({params:{\r\n                type:\"系统事件\",\r\n                title:\"测试功能\",\r\n                subtitle:\"测试呼救-执行成功\",\r\n                extra:{\r\n                    timestamp: Date.now(),\r\n                    scriptResult: res\r\n                }\r\n            }});\r\n            \r\n            toast.success('跌倒检测呼救已启动');\r\n        } catch (error) {\r\n            console.error('TestEmergencyCall error:', error);\r\n            \r\n            // 测试呼救执行异常埋点\r\n            trackingPrint({params:{\r\n                type:\"系统异常\",\r\n                title:\"测试功能\",\r\n                subtitle:\"测试呼救-执行异常\",\r\n                extra:{\r\n                    timestamp: Date.now(),\r\n                    error: error instanceof Error ? error.message : String(error),\r\n                    stack: error instanceof Error ? error.stack : undefined\r\n                }\r\n            }});\r\n            \r\n            toast.error('跌倒检测呼救启动失败');\r\n        }\r\n    }\r\n\r\n    // 执行安全呼救\r\n    function executeSecurityEmergencyCall() {\r\n        try {\r\n            const script = `\r\n            com.fanfanlo.emergencycall.manager.EmergencyCallJSInterface.startSecurityEmergencyCall()`;\r\n            const res = autoWebViewJs.callScript(script);\r\n            console.log(\"TestSecurityEmergencyCall res=\", res);\r\n            \r\n            // 测试安全呼救执行成功埋点\r\n            trackingPrint({params:{\r\n                type:\"系统事件\",\r\n                title:\"测试功能\",\r\n                subtitle:\"测试安全呼救-执行成功\",\r\n                extra:{\r\n                    timestamp: Date.now(),\r\n                    scriptResult: res\r\n                }\r\n            }});\r\n            \r\n            toast.success('安全呼救已启动');\r\n        } catch (error) {\r\n            console.error('TestSecurityEmergencyCall error:', error);\r\n            \r\n            // 测试安全呼救执行异常埋点\r\n            trackingPrint({params:{\r\n                type:\"系统异常\",\r\n                title:\"测试功能\",\r\n                subtitle:\"测试安全呼救-执行异常\",\r\n                extra:{\r\n                    timestamp: Date.now(),\r\n                    error: error instanceof Error ? error.message : String(error),\r\n                    stack: error instanceof Error ? error.stack : undefined\r\n                }\r\n            }});\r\n            \r\n            toast.error('安全呼救启动失败');\r\n        }\r\n    }\r\n\r\n    // 安全呼救按钮点击处理函数\r\n    async function onSecurityClick() {\r\n        // 测试安全呼救按钮点击埋点\r\n        trackingPrint({params:{\r\n            type:\"用户操作\",\r\n            title:\"测试功能\", \r\n            subtitle:\"测试安全呼救-按钮点击\",\r\n            extra:{\r\n                timestamp: Date.now(),\r\n                isWebView: !!(autoWebViewJs && typeof autoWebViewJs.callScript === 'function')\r\n            }\r\n        }});\r\n        \r\n        // 1. 先检查隐私协议\r\n        const privacyPassed = checkPrivacyAgreement(passed => {\r\n            if (!passed) {\r\n                toast.error('需要同意隐私协议才能使用该功能');\r\n                return;\r\n            }\r\n            \r\n            // 2. 条件性检查登录状态\r\n            if (REQUIRE_LOGIN_FOR_FALL_DETECTION) {\r\n                authService.showLoginDialog().then(appLoggedIn => {\r\n                    if (!appLoggedIn) {\r\n                        toast.error(\"未登录无法使用该功能\");\r\n                        return;\r\n                    }\r\n                    \r\n                    // 3. 检查权限，然后执行安全呼救\r\n                    checkShowFallInfo(permissionPassed => {\r\n                        if (!permissionPassed) {\r\n                            toast.error('需要完成权限授权才能使用该功能');\r\n                            return;\r\n                        }\r\n                        executeSecurityEmergencyCall();\r\n                    });\r\n                });\r\n            } else {\r\n                // 跳过登录检测，直接进入权限检测\r\n                checkShowFallInfo(permissionPassed => {\r\n                    if (!permissionPassed) {\r\n                        toast.error('需要完成权限授权才能使用该功能');\r\n                        return;\r\n                    }\r\n                    executeSecurityEmergencyCall();\r\n                });\r\n            }\r\n        });\r\n        \r\n        // 如果隐私协议已通过，直接继续执行\r\n        if (privacyPassed) {\r\n            // 2. 条件性检查登录状态\r\n            if (REQUIRE_LOGIN_FOR_FALL_DETECTION) {\r\n                const appLoggedIn = await authService.showLoginDialog();\r\n                if (!appLoggedIn) {\r\n                    toast.error(\"未登录无法使用该功能\");\r\n                    return;\r\n                }\r\n            }\r\n            \r\n            // 3. 检查权限，然后执行安全呼救\r\n            checkShowFallInfo(permissionPassed => {\r\n                if (!permissionPassed) {\r\n                    toast.error('需要完成权限授权才能使用该功能');\r\n                    return;\r\n                }\r\n                executeSecurityEmergencyCall();\r\n            });\r\n        }\r\n    }\r\n\r\n    // 主要的点击处理函数 - 添加权限检查流程\r\n    async function onClick() {\r\n        // 测试呼救按钮点击埋点\r\n        trackingPrint({params:{\r\n            type:\"用户操作\",\r\n            title:\"测试功能\", \r\n            subtitle:\"测试呼救-按钮点击\",\r\n            extra:{\r\n                timestamp: Date.now(),\r\n                isWebView: !!(autoWebViewJs && typeof autoWebViewJs.callScript === 'function')\r\n            }\r\n        }});\r\n        \r\n        // 1. 先检查隐私协议\r\n        const privacyPassed = checkPrivacyAgreement(passed => {\r\n            if (!passed) {\r\n                toast.error('需要同意隐私协议才能使用该功能');\r\n                return;\r\n            }\r\n            \r\n            // 2. 条件性检查登录状态\r\n            if (REQUIRE_LOGIN_FOR_FALL_DETECTION) {\r\n                authService.showLoginDialog().then(appLoggedIn => {\r\n                    if (!appLoggedIn) {\r\n                        toast.error(\"未登录无法使用该功能\");\r\n                        return;\r\n                    }\r\n                    \r\n                    // 3. 检查权限，然后执行呼救\r\n                    checkShowFallInfo(permissionPassed => {\r\n                        if (!permissionPassed) {\r\n                            toast.error('需要完成权限授权才能使用该功能');\r\n                            return;\r\n                        }\r\n                        executeEmergencyCall();\r\n                    });\r\n                });\r\n            } else {\r\n                // 跳过登录检测，直接进入权限检测\r\n                checkShowFallInfo(permissionPassed => {\r\n                    if (!permissionPassed) {\r\n                        toast.error('需要完成权限授权才能使用该功能');\r\n                        return;\r\n                    }\r\n                    executeEmergencyCall();\r\n                });\r\n            }\r\n        });\r\n        \r\n        // 如果隐私协议已通过，直接继续执行\r\n        if (privacyPassed) {\r\n            // 2. 条件性检查登录状态\r\n            if (REQUIRE_LOGIN_FOR_FALL_DETECTION) {\r\n                const appLoggedIn = await authService.showLoginDialog();\r\n                if (!appLoggedIn) {\r\n                    toast.error(\"未登录无法使用该功能\");\r\n                    return;\r\n                }\r\n            }\r\n            \r\n            // 3. 检查权限，然后执行呼救\r\n            checkShowFallInfo(permissionPassed => {\r\n                if (!permissionPassed) {\r\n                    toast.error('需要完成权限授权才能使用该功能');\r\n                    return;\r\n                }\r\n                executeEmergencyCall();\r\n            });\r\n        }\r\n    }\r\n    return(\r\n        <Box id='aaaaaaaaaaaaaaaaa' sx={{ p: 2 }}>\r\n            <Grid2 id='ffffffffffffffffffff' container spacing={2} sx={{ width: '100%' }}>\r\n                {/* 医疗呼救按钮 */}\r\n                <Grid2 size={6}>\r\n                    <Button  \r\n                        variant=\"contained\" \r\n                        onClick={onClick}\r\n                        fullWidth\r\n                        sx={{\r\n                            backgroundColor: '#FF5722',\r\n                            color: 'white',\r\n                            fontSize: '18px',\r\n                            fontWeight: 'bold',\r\n                            minHeight: '64px',\r\n                            borderRadius: '32px',\r\n                            boxShadow: '0 8px 24px rgba(255, 87, 34, 0.3)',\r\n                            textTransform: 'none',\r\n                            position: 'relative',\r\n                            overflow: 'hidden',\r\n                            '&:hover': {\r\n                                backgroundColor: '#E64A19',\r\n                                transform: 'translateY(-2px)',\r\n                                boxShadow: '0 12px 32px rgba(255, 87, 34, 0.4)',\r\n                            },\r\n                            '&:active': {\r\n                                transform: 'translateY(0px)',\r\n                                boxShadow: '0 4px 16px rgba(255, 87, 34, 0.3)',\r\n                            },\r\n                            '&::before': {\r\n                                content: '\"\"',\r\n                                position: 'absolute',\r\n                                top: '50%',\r\n                                left: '50%',\r\n                                width: '0',\r\n                                height: '0',\r\n                                borderRadius: '50%',\r\n                                backgroundColor: 'rgba(255, 255, 255, 0.3)',\r\n                                transform: 'translate(-50%, -50%)',\r\n                                transition: 'width 0.3s, height 0.3s',\r\n                            },\r\n                            '&:hover::before': {\r\n                                width: '100%',\r\n                                height: '100%',\r\n                            }\r\n                        }}\r\n                        startIcon={\r\n                            <Box sx={{ \r\n                                fontSize: '24px',\r\n                                animation: 'pulse 2s infinite',\r\n                                '@keyframes pulse': {\r\n                                    '0%': { transform: 'scale(1)' },\r\n                                    '50%': { transform: 'scale(1.1)' },\r\n                                    '100%': { transform: 'scale(1)' }\r\n                                }\r\n                            }}>\r\n                                🚨\r\n                            </Box>\r\n                        }\r\n                    >\r\n                        医疗呼救\r\n                    </Button>\r\n                </Grid2>\r\n\r\n                {/* 安全呼救按钮 */}\r\n                <Grid2 size={6}>\r\n                    <Button  \r\n                        variant=\"contained\" \r\n                        onClick={onSecurityClick}\r\n                        fullWidth\r\n                        sx={{\r\n                            backgroundColor: '#9C27B0',\r\n                            color: 'white',\r\n                            fontSize: '18px',\r\n                            fontWeight: 'bold',\r\n                            minHeight: '64px',\r\n                            borderRadius: '32px',\r\n                            boxShadow: '0 8px 24px rgba(156, 39, 176, 0.3)',\r\n                            textTransform: 'none',\r\n                            position: 'relative',\r\n                            overflow: 'hidden',\r\n                            '&:hover': {\r\n                                backgroundColor: '#7B1FA2',\r\n                                transform: 'translateY(-2px)',\r\n                                boxShadow: '0 12px 32px rgba(156, 39, 176, 0.4)',\r\n                            },\r\n                            '&:active': {\r\n                                transform: 'translateY(0px)',\r\n                                boxShadow: '0 4px 16px rgba(156, 39, 176, 0.3)',\r\n                            },\r\n                            '&::before': {\r\n                                content: '\"\"',\r\n                                position: 'absolute',\r\n                                top: '50%',\r\n                                left: '50%',\r\n                                width: '0',\r\n                                height: '0',\r\n                                borderRadius: '50%',\r\n                                backgroundColor: 'rgba(255, 255, 255, 0.3)',\r\n                                transform: 'translate(-50%, -50%)',\r\n                                transition: 'width 0.3s, height 0.3s',\r\n                            },\r\n                            '&:hover::before': {\r\n                                width: '100%',\r\n                                height: '100%',\r\n                            }\r\n                        }}\r\n                        startIcon={\r\n                            <Box sx={{ \r\n                                fontSize: '24px',\r\n                                animation: 'pulse 2s infinite',\r\n                                '@keyframes pulse': {\r\n                                    '0%': { transform: 'scale(1)' },\r\n                                    '50%': { transform: 'scale(1.1)' },\r\n                                    '100%': { transform: 'scale(1)' }\r\n                                }\r\n                            }}>\r\n                                🔒\r\n                            </Box>\r\n                        }\r\n                    >\r\n                        安全呼救\r\n                    </Button>\r\n                </Grid2>\r\n            </Grid2>\r\n\r\n            {/* 传感器信息对话框 */}\r\n            <Dialog open={fallSensorInfoDialogOpen} onClose={() => handleFallSensorDialog(false)}>\r\n                <DialogTitle>传感器监控说明</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        此功能会使用设备的传感器来检测跌倒等紧急情况。\r\n                        启用后，应用将在后台持续监控设备的运动状态，\r\n                        当检测到异常震动或跌倒时会自动触发紧急呼救。\r\n                    </DialogContentText>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => handleFallSensorDialog(false)}>取消</Button>\r\n                    <Button onClick={() => handleFallSensorDialog(true)} autoFocus>\r\n                        同意\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n            {/* 前台服务信息对话框 */}\r\n            <Dialog open={fallForegroundServiceDialogOpen} onClose={() => handleFallForegroundServiceDialog(false)}>\r\n                <DialogTitle>后台服务说明</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        为了确保紧急呼救功能能够正常工作，应用需要在后台运行。\r\n                        您可能会在通知栏看到一个持续的通知，这是正常现象，\r\n                        用于保持紧急监控服务的运行。\r\n                    </DialogContentText>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => handleFallForegroundServiceDialog(false)}>取消</Button>\r\n                    <Button onClick={() => handleFallForegroundServiceDialog(true)} autoFocus>\r\n                        同意\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n            {/* 隐私协议对话框 */}\r\n            <PrivacyDialogDisplay \r\n                isVisible={privacyDialogOpen}\r\n                onVisibilityChange={handlePrivacyDialogClose}\r\n            />\r\n        </Box>\r\n    )\r\n}","import { trackingPrint } from '@app/model';\r\nimport { AppShell, TabbarContainer } from '@app/ui';\r\nimport { autoWebViewJs } from '@droid/android';\r\nimport { nextPreload } from '@fanfanlo';\r\nimport { Box, Button, Grid2, Link } from '@mui/material';\r\nimport { InviteContactDialog } from '@src/components/dialogs/InviteContactDialog';\r\nimport EmergencyStopButton from '@src/components/emergency-audio-control/EmergencyStopButton';\r\nimport { EmergencyTTSSettings } from '@src/components/emergency-tts-settings';\r\nimport { ErrorDisplay } from '@src/components/error-display/ErrorDisplay';\r\nimport MeetingList from '@src/components/meeting-list/MeetingList';\r\nimport { NavBar } from '@src/components/navbar/NavBar';\r\nimport { EmergencyCallSettings } from '@src/components/pages/home';\r\nimport AddWidgetButton from '@src/components/pages/home/components/AddWidgetButton';\r\nimport AddSecurityWidgetButton from '@src/components/pages/home/components/AddSecurityWidgetButton';\r\nimport PendingInvitationsList from '@src/components/PendingInvitationsList/PendingInvitationsList';\r\nimport PreAlarmConfig2 from '@src/components/pre-alarm-config2';\r\nimport { ListenShowPrivacyContent } from '@src/components/privacies/ListenShowPrivacyContent';\r\nimport SensorMonitor from '@src/components/sensor-monitor/SensorMonitor';\r\nimport ShakeConfigUI from '@src/components/shakeconfig/ShakeConfigUI';\r\nimport { TestEmergencyCall } from '@src/components/test/TestEmergencyCall';\r\nimport { useRouter } from 'next/router';\r\nimport React, { useState } from 'react';\r\n\r\nfunction Content() {\r\n  const [openInviteDialog, setOpenInviteDialog] = useState(false);\r\n\r\n  const router = useRouter();\r\n\r\n  React.useEffect(() => {\r\n    nextPreload(router, '/intro');\r\n    nextPreload(router, '/how-to-use');\r\n  }, []);\r\n\r\n  return (\r\n    <Box sx={{ my: 2, p: 2 }}>\r\n      <ErrorDisplay />\r\n      {/* 紧急停止按钮 - 置顶显示 */}\r\n      <EmergencyStopButton fullWidth size=\"large\" />\r\n\r\n      <Box>\r\n        <Link href=\"/how-to-use\" style={{ textDecoration: 'none' }}>\r\n          如何使用</Link>\r\n      </Box>\r\n      <ListenShowPrivacyContent type=\"main\" />\r\n      {/* <InvitationManager /> */}\r\n      {/* <MeetingList maxItemLength={3} /> */}\r\n      <PendingInvitationsList />\r\n\r\n      <Grid2 container spacing={2} sx={{ m: 2 }}>\r\n        <Grid2 size={6}>\r\n          <Button variant=\"contained\" onClick={() => router.push('/intro')}>\r\n            产品介绍\r\n          </Button>\r\n        </Grid2>\r\n        <Grid2 size={6}>\r\n          <Box sx={{ display: 'flex', justifyContent: 'flex-end' }}>\r\n            <Button\r\n              // fullWidth\r\n              variant=\"contained\"\r\n              onClick={() => {\r\n                router.push('/how-to-use');\r\n              }}>\r\n              使用说明\r\n            </Button>\r\n          </Box>\r\n        </Grid2>\r\n      </Grid2>\r\n      <PreAlarmConfig2 />\r\n      <EmergencyTTSSettings />\r\n      {/* <PreAlarmConfigComponent /> */}\r\n\r\n      {/* <JpushIsInitialized /> */}\r\n\r\n      <Grid2 container sx={{ mt: 2, mb: 2 }}>\r\n        <Grid2 size={6}>\r\n          <TestEmergencyCall />\r\n        </Grid2>\r\n        <Grid2 size={6}>\r\n          <Box sx={{ display: 'flex', justifyContent: 'flex-end' }}>\r\n            <EmergencyStopButton variant=\"button\" />\r\n          </Box>\r\n        </Grid2>\r\n      </Grid2>\r\n      \r\n      {/* 添加桌面小部件按钮 */}\r\n      <AddWidgetButton \r\n        onSuccess={() => {\r\n          console.log('医疗小部件添加成功');\r\n        }}\r\n        onError={(error) => {\r\n          console.error('医疗小部件添加失败:', error);\r\n        }}\r\n      />\r\n      \r\n      \r\n      {/* gemini做的权限管理，不好，先不启用 */}\r\n      {/* <SensorPermissions /> */}\r\n{/* 摇一摇 */}\r\n      <ShakeConfigUI />\r\n\r\n      <SensorMonitor />\r\n      {/* 二合一的前台服务 */}\r\n      {/* <UnifiedMonitoringControl /> */}\r\n\r\n      {/*  统一监控控制 - 集成传感器监控和权限监控 */}\r\n\r\n      <Grid2 container spacing={2} sx={{ m: 2 }}>\r\n        <Grid2 size={6}>\r\n          <Button \r\n            variant=\"contained\" \r\n            onClick={() => {\r\n              // 邀请紧急联系人按钮点击埋点\r\n              trackingPrint({params:{\r\n                type:\"用户操作\",\r\n                title:\"联系人管理\",\r\n                subtitle:\"邀请联系人-按钮点击\",\r\n                extra:{\r\n                  timestamp: Date.now(),\r\n                  page: \"home\"\r\n                }\r\n              }});\r\n              setOpenInviteDialog(true);\r\n            }}\r\n          >\r\n            邀请紧急联系人\r\n          </Button>\r\n        </Grid2>\r\n        <Grid2 size={6}>\r\n          <Box sx={{ display: 'flex', justifyContent: 'flex-end' }}>\r\n            <Button\r\n              fullWidth\r\n              variant=\"contained\"\r\n              onClick={() => {\r\n                router.push('/contacts');\r\n              }}>\r\n              联系人管理\r\n            </Button>\r\n          </Box>\r\n        </Grid2>\r\n      </Grid2>\r\n      {openInviteDialog && <InviteContactDialog \r\n        open={openInviteDialog} \r\n        onClose={() => {\r\n          // 邀请联系人对话框关闭埋点\r\n          trackingPrint({params:{\r\n            type:\"模态框操作\",\r\n            title:\"联系人管理\",\r\n            subtitle:\"邀请对话框-关闭\",\r\n            extra:{\r\n              timestamp: Date.now(),\r\n              page: \"home\"\r\n            }\r\n          }});\r\n          setOpenInviteDialog(false);\r\n        }} \r\n      />}\r\n\r\n      {/* <MeetingRoom5\r\n        roomName=\"test-room\"\r\n        userName={`user-${Math.random().toString(36).substring(2, 8)}`}\r\n        livekitConfig={mainModel.appConfig.livekit}\r\n        // role=\"initiator\" // Add role for testing\r\n      />\r\n       */}\r\n\r\n      {/* TTS录制与分享 */}\r\n      {/* <TTSRecorder /> */}\r\n      {/* 桌面快捷方式 */}\r\n      {/* <ShortcutConfig /> */}\r\n\r\n      <Box sx={{ mt: 2, mb: 2 }}>\r\n        <Button\r\n          fullWidth\r\n          variant=\"contained\"\r\n          onClick={() => {\r\n            router.push('/shortcut');\r\n          }}>\r\n          桌面快捷方式\r\n          {/* <Link href={\"/shortcut\"}>桌面快捷方式</Link> */}\r\n        </Button>\r\n      </Box>\r\n      {/* <EmergencyAudioControl /> */}\r\n      {/* 浮动紧急停止按钮 */}\r\n      {/* <EmergencyStopButton variant=\"fab\" /> */}\r\n\r\n      {/* <Box>\r\n      <Link href={\"/logs\"}>日志</Link>\r\n      <IMOpenPageLink />\r\n</Box> */}\r\n\r\n      <Box sx={{ mt: '2rem' }}></Box>\r\n    </Box>\r\n  );\r\n}\r\n\r\n\r\nfunction Content2(){\r\n  const router = useRouter();\r\n  const [openInviteDialog, setOpenInviteDialog] = useState(false);\r\n  return (\r\n    <Box>\r\n      \r\n      <ListenShowPrivacyContent type=\"main\" />\r\n      <ErrorDisplay />\r\n      <PendingInvitationsList />\r\n    <EmergencyCallSettings />\r\n    \r\n          <TestEmergencyCall />\r\n      <Grid2 container spacing={3} sx={{ mt: 2, px: 2 }}>\r\n        {/* 邀请紧急联系人按钮 */}\r\n        <Grid2 size={6}>\r\n          <Button \r\n            variant=\"contained\" \r\n            fullWidth\r\n            onClick={() => {\r\n              // 邀请紧急联系人按钮点击埋点\r\n              trackingPrint({params:{\r\n                type:\"用户操作\",\r\n                title:\"联系人管理\",\r\n                subtitle:\"邀请联系人-按钮点击\",\r\n                extra:{\r\n                  timestamp: Date.now(),\r\n                  page: \"home\"\r\n                }\r\n              }});\r\n              setOpenInviteDialog(true);\r\n            }}\r\n            sx={{\r\n              backgroundColor: '#4CAF50',\r\n              color: 'white',\r\n              fontSize: '16px',\r\n              fontWeight: 'bold',\r\n              minHeight: '48px',\r\n              borderRadius: '24px',\r\n              boxShadow: '0 4px 16px rgba(76, 175, 80, 0.3)',\r\n              textTransform: 'none',\r\n              position: 'relative',\r\n              overflow: 'hidden',\r\n              '&:hover': {\r\n                backgroundColor: '#45a049',\r\n                transform: 'translateY(-1px)',\r\n                boxShadow: '0 6px 20px rgba(76, 175, 80, 0.4)',\r\n              },\r\n              '&:active': {\r\n                transform: 'translateY(0px)',\r\n                boxShadow: '0 2px 8px rgba(76, 175, 80, 0.3)',\r\n              },\r\n              '&::before': {\r\n                content: '\"\"',\r\n                position: 'absolute',\r\n                top: '50%',\r\n                left: '50%',\r\n                width: '0',\r\n                height: '0',\r\n                borderRadius: '50%',\r\n                backgroundColor: 'rgba(255, 255, 255, 0.2)',\r\n                transform: 'translate(-50%, -50%)',\r\n                transition: 'width 0.3s, height 0.3s',\r\n              },\r\n              '&:hover::before': {\r\n                width: '100%',\r\n                height: '100%',\r\n              }\r\n            }}\r\n            startIcon={\r\n              <Box sx={{ \r\n                fontSize: '20px'\r\n              }}>\r\n                👥\r\n              </Box>\r\n            }\r\n          >\r\n            添加联系人\r\n          </Button>\r\n        </Grid2>\r\n\r\n        {/* 联系人管理按钮 */}\r\n        <Grid2 size={6}>\r\n          <Button\r\n            fullWidth\r\n            variant=\"contained\"\r\n            onClick={() => {\r\n              router.push('/contacts');\r\n            }}\r\n            sx={{\r\n              backgroundColor: '#2196F3',\r\n              color: 'white',\r\n              fontSize: '16px',\r\n              fontWeight: 'bold',\r\n              minHeight: '48px',\r\n              borderRadius: '24px',\r\n              boxShadow: '0 4px 16px rgba(33, 150, 243, 0.3)',\r\n              textTransform: 'none',\r\n              position: 'relative',\r\n              overflow: 'hidden',\r\n              '&:hover': {\r\n                backgroundColor: '#1976d2',\r\n                transform: 'translateY(-1px)',\r\n                boxShadow: '0 6px 20px rgba(33, 150, 243, 0.4)',\r\n              },\r\n              '&:active': {\r\n                transform: 'translateY(0px)',\r\n                boxShadow: '0 2px 8px rgba(33, 150, 243, 0.3)',\r\n              },\r\n              '&::before': {\r\n                content: '\"\"',\r\n                position: 'absolute',\r\n                top: '50%',\r\n                left: '50%',\r\n                width: '0',\r\n                height: '0',\r\n                borderRadius: '50%',\r\n                backgroundColor: 'rgba(255, 255, 255, 0.2)',\r\n                transform: 'translate(-50%, -50%)',\r\n                transition: 'width 0.3s, height 0.3s',\r\n              },\r\n              '&:hover::before': {\r\n                width: '100%',\r\n                height: '100%',\r\n              }\r\n            }}\r\n            startIcon={\r\n              <Box sx={{ \r\n                fontSize: '20px'\r\n              }}>\r\n                ⚙️\r\n              </Box>\r\n            }\r\n          >\r\n            联系人管理\r\n          </Button>\r\n        </Grid2>\r\n      </Grid2>\r\n      {openInviteDialog && <InviteContactDialog \r\n        open={openInviteDialog} \r\n        onClose={() => {\r\n          // 邀请联系人对话框关闭埋点\r\n          trackingPrint({params:{\r\n            type:\"模态框操作\",\r\n            title:\"联系人管理\",\r\n            subtitle:\"邀请对话框-关闭\",\r\n            extra:{\r\n              timestamp: Date.now(),\r\n              page: \"home\"\r\n            }\r\n          }});\r\n          setOpenInviteDialog(false);\r\n        }} \r\n      />}\r\n      \r\n      <AddWidgetButton \r\n        onSuccess={() => {\r\n          console.log('小部件添加成功');\r\n        }}\r\n        onError={(error) => {\r\n          console.error('小部件添加失败:', error);\r\n        }}\r\n      />\r\n      {/* 添加安全呼救桌面小部件按钮 */}\r\n      <AddSecurityWidgetButton \r\n        onSuccess={() => {\r\n          console.log('安全小部件添加成功');\r\n        }}\r\n        onError={(error) => {\r\n          console.error('安全小部件添加失败:', error);\r\n        }}\r\n      />\r\n      <Box sx={{ mt: 2, mb: 2 }}>\r\n        <Button\r\n          fullWidth\r\n          variant=\"contained\"\r\n          onClick={() => {\r\n            router.push('/shortcut');\r\n          }}>\r\n          桌面快捷方式\r\n          {/* <Link href={\"/shortcut\"}>桌面快捷方式</Link> */}\r\n        </Button>\r\n      </Box>\r\n      <MeetingList maxItemLength={3} />\r\n    </Box>\r\n  )\r\n}\r\nexport default function Home() {\r\n  return (\r\n    <AppShell>\r\n      <TabbarContainer titleConf={{ ns: 'emergency-call/pages/home/content', key: 'home.title' }} navBar={<NavBar />}>\r\n        <Content2 />\r\n      </TabbarContainer>\r\n    </AppShell>\r\n  );\r\n}\r\n","import { useRouter } from \"next/router\";\r\nimport { nextPreload, useTranslation } from \"@fanfanlo\";\r\n\r\nimport HomeIcon from '@mui/icons-material/Home';\r\nimport SettingsIcon from '@mui/icons-material/Settings';\r\nimport ListIcon from '@mui/icons-material/List';\r\nimport { BottomNavigation, BottomNavigationAction } from \"@mui/material\";\r\nimport React from \"react\";\r\ninterface TabInfoType {\r\n  label: string;\r\n  value: string;\r\n  icon: React.ReactNode;\r\n}\r\n\r\nexport function NavBar() {\r\n  const router = useRouter();\r\n  const { pathname } = router;\r\n  const { t } = useTranslation('emergency-call/components/navbar/content');\r\n  const tabInfoList: TabInfoType[] = [\r\n    { label: t('NavBar.home'), value: '/', icon: <HomeIcon /> },\r\n    // { label: t('NavBar.logs'), value: '/logs', icon: <ListIcon /> },\r\n    // { label: t('content.create'), value: '/script-creator', icon: <CreateIcon /> },\r\n    // { label: t('content.market'), value: '/market', icon: <StorefrontIcon /> },\r\n    { label: t('NavBar.settings'), value: '/settings', icon: <SettingsIcon /> },\r\n  ];\r\n  \r\n        React.useEffect(()=>{\r\n          nextPreload(router, '/settings')\r\n          nextPreload(router, '/')\r\n        },[])\r\n  \r\n  return (\r\n\r\n    <BottomNavigation showLabels value={pathname}>\r\n      {tabInfoList.map(e => (\r\n        <BottomNavigationAction\r\n          key={e.value}\r\n          label={e.label}\r\n          icon={e.icon}\r\n          data-id={`tabbar-${e.value}`}\r\n          className={pathname === e.value ? 'Mui-selected' : ''}\r\n          onClick={() => {\r\n            if (pathname === e.value) return;\r\n            router.push(e.value);\r\n          }}\r\n        />\r\n      ))}\r\n    </BottomNavigation>\r\n  );\r\n}","import { IRequestOptions } from \"../IRequestOptions\";\nimport { tms } from \"../tms\";\nimport { IRequestHandler, request } from \"@fanfanlo\";\n\n/**\n * 获取所有邀请的请求参数\n */\nexport interface IParamsListAllInvitations {\n  // 可以添加分页等参数\n  page?: number;\n  page_size?: number;\n}\n\n/**\n * 用户信息\n */\nexport interface IInvitationUserInfo {\n  user_id: string;\n  display_name: string;\n  avatar_url?: string;\n}\n\n// 邀请状态类型\nexport type InviteStatus = 'pending' | 'accepted' | 'declined' | 'expired' | 'cancelled';\n\n// 邀请记录详情\nexport interface IInvitationDetails {\n  invitation_id: string;\n  user_info: {\n    user_id: string;\n    display_name: string;\n    avatar_url?: string;\n  };\n  status: InviteStatus;\n  message: string;\n  created_at: number;\n  expires_at: number;\n}\n\n/**\n * 获取所有邀请的响应结果\n */\nexport interface IResultListAllInvitations {\n  is_ok: boolean;\n  msg?: string;\n  sent_invitations: IInvitationDetails[];\n  received_invitations: IInvitationDetails[];\n}\n\n/**\n * 响应邀请的请求参数\n */\nexport interface IParamsRespondToInvite {\n  invitation_id: string;\n  action: 'accept' | 'decline' | 'cancel' | 'remove';\n}\n\n/**\n * 获取所有邀请（发送和接收的）\n */\nexport async function tmsEmergencyCallListAllInvitations(\n  opts: IRequestOptions<IParamsListAllInvitations>\n) {\n  return request<IResultListAllInvitations, IParamsListAllInvitations>(\n    tms.TEmc,\n    tms.MEmcListAllInvitations,\n    opts.params,\n    opts.gateway,\n    opts.handler\n  );\n}\n\n/**\n * 取消或删除邀请\n * @param invitationId 邀请ID\n * @param isReceived 是否是接收的邀请\n * @returns Promise\n */\nexport async function cancelOrRemoveInvitation(\n  invitationId: string,\n  isReceived: boolean\n) {\n  const action = isReceived ? 'remove' : 'cancel';\n  return emergencyCallInvitationService.respondToInvite({\n    params: {\n      invitation_id: invitationId,\n      action\n    }\n  } as any);\n}\n\n/**\n * 响应邀请\n */\nexport async function tmsEmergencyCallRespondToInvite(\n  opts: IRequestOptions<IParamsRespondToInvite>\n) {\n  return request<{ is_ok: boolean; msg?: string }, IParamsRespondToInvite>(\n    tms.TEmc,\n    tms.MEmcRespondToInvite,\n    opts.params,\n    opts.gateway,\n    opts.handler\n  );\n}\n\n// 导出所有接口\nexport const emergencyCallInvitationService = {\n  listAllInvitations: tmsEmergencyCallListAllInvitations,\n  respondToInvite: tmsEmergencyCallRespondToInvite,\n};\n\nexport default emergencyCallInvitationService;\n","'use client';\r\nimport { Box, CssBaseline, Paper, Stack } from '@mui/material';\r\n\r\nimport React, { PropsWithChildren } from 'react';\r\nimport { ITitleI18nConf } from '../page';\r\nimport AndroidPageContent from '../page/AndroidPageContent';\r\n\r\nfunction BottomBar({navBar}:{navBar?:React.ReactNode}) {\r\n  return <Paper\r\n    id=\"bottom-navigation\"\r\n    sx={{ position: 'fixed', bottom: 0, left: 0, right: 0 }}\r\n    elevation={3}>\r\n    {navBar}\r\n  </Paper>;\r\n}\r\nexport function TabbarContainer({ children, titleConf, navBar }: {titleConf?:ITitleI18nConf, navBar:React.ReactNode} & PropsWithChildren)  {\r\n  return (\r\n    <Box sx={{ \r\n      minHeight: '100vh',\r\n      paddingBottom: '72px' // 为固定在底部的tabbar留出空间\r\n    }}>\r\n      <CssBaseline />\r\n      <AndroidPageContent titleConf={titleConf}>\r\n        {children}\r\n      </AndroidPageContent>\r\n      <BottomBar navBar={navBar} />\r\n    </Box>\r\n  );\r\n}\r\n\r\n"],"names":["React","useState","Button","AddCommentIcon","trackingPrint","ReportSubmitModal","ReportButton","buttonText","rest","modalOpen","setModalOpen","handleSuccess","console","log","params","type","title","subtitle","extra","timestamp","Date","now","handleClick","variant","startIcon","onClick","open","onClose","onSuccess","request","tms","submitReport","TReport","MReportSubmit","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","TextField","CircularProgress","Box","mobile","setMobile","reason","setReason","error","setError","loading","setLoading","handleClose","handleSubmit","result","reported_mobile","report_type","shellIsOk","err","message","e","autoFocus","margin","id","label","fullWidth","value","onChange","target","disabled","multiline","rows","sx","color","mt","size","tmsEmcInviteContacts","opts","res","TEmc","MEmcInviteContacts","gateway","handler","tmsEmcGetContactTypes","MEmcGetContactTypes","Autocomplete","useCallback","useEffect","useRef","user","toast","matrixUser","authService","Log","useProxyWatch","fileLogger","isValidIdentity","text","test","is11DigitNumber","InviteContactDialog","onInviteSent","uiLogger","sub","contacts","setContacts","remark","setRemark","callType","setCallType","availableCallTypes","setAvailableCallTypes","setMessage","isLoading","setIsLoading","isTypesLoading","setIsTypesLoading","pendingParams","setPendingParams","executionLock","accessToken","userData","userInfo","loginResponse","access_token","isUserLoggedIn","data","sessionData","global_user_info","userToken","storeData","user_token","current","finalParams","matrix_access_token","executeApiCall","responseData","printLog","dataIsOk","errorMessage","results","msg","successResults","filter","r","result_code","infoResults","errorResults","length","success","infoMessages","map","Boolean","join","errorMessages","fetchCallTypes","logger","JSON","stringify","types","formattedTypes","uuid","name","is_system","defaultType","warn","handleSendInvitation","contactInputs","split","c","trim","contactIdentities","input","push","identity","identityType","appLoggedIn","showLoginDialog","currentAccessToken","apiParams","maxWidth","component","placeholder","freeSolo","options","option","event","newValue","inputValue","onInputChange","newInputValue","disablePortal","disableClearable","forcePopupIcon","mb","width","renderInput","InputProps","endAdornment","ListboxProps","style","maxHeight","overflow","autoWebViewJs","fileLog","stopAllHandler","stopEmergencyMethods","script","callScript","methodError","Snackbar","Alert","Fab","Tooltip","Stop","StopIcon","VolumeOff","VolumeOffIcon","EmergencyStopButton","isAndroidWebView","handleStopAllEmergencyAudio","buttonType","bl","Error","String","stack","undefined","handleCloseMessage","placement","position","bottom","right","zIndex","autoHideDuration","anchorOrigin","vertical","horizontal","severity","Typography","Switch","Paper","FormControlLabel","Slider","Divider","Collapse","List","ListItem","ListItemText","ListItemSecondaryAction","IconButton","Chip","LinearProgress","Tabs","Tab","PlayArrow","VolumeUp","Settings","ExpandLess","Mic","Share","Delete","Refresh","Star","StarBorder","CloudUpload","InsertDriveFile","autoJsStoreUtils","DEFAULT_SETTINGS","enabled","repeatInterval","voiceSpeed","voicePitch","useCustomAudio","lastUpdated","DEFAULT_VOICE_CONFIG","TTS_SETTINGS_KEY","VOICE_CONFIG_KEY","EmergencyTTSSettings","settings","setSettings","voiceConfig","setVoiceConfig","fileList","setFileList","testing","setTesting","showSuccess","setShowSuccess","successMessage","setSuccessMessage","expanded","setExpanded","activeTab","setActiveTab","isRecording","setIsRecording","playingFile","setPlayingFile","recordText","setRecordText","recordSpeed","setRecordSpeed","recordPitch","setRecordPitch","showRecordDialog","setShowRecordDialog","ttsAvailable","setTtsAvailable","isUploading","setIsUploading","selectedFile","setSelectedFile","uploadProgress","setUploadProgress","supportedFormats","setSupportedFormats","onRecordClick","loadData","savedSettings","read","savedConfig","checkTTSAvailability","loadFileList","loadSupportedFormats","javaResultString","formats","parse","maxFileSizeMB","maxDurationSeconds","recommendedDurationSeconds","listJson","files","filesWithType","file","isDefault","handleSelectAndUploadAudioFile","progressInterval","setInterval","prev","clearInterval","saveSettings","newSettings","settingsToSave","write","saveVoiceConfig","newConfig","configToSave","handleRecord","getFullYear","toString","getMonth","padStart","getDate","getHours","getMinutes","getSeconds","fileName","replace","setTimeout","resultJson","handlePlayFile","filePath","handleShareFile","handleDeleteFile","window","confirm","setAsDefaultAudio","medicalDefault","updatedSettings","medicalEmergencyAudioPath","securityDefault","updatedFiles","formatFileSize","bytes","toFixed","formatTime","toLocaleString","formatDuration","milliseconds","seconds","Math","floor","minutes","remainingSeconds","testTTS","Promise","resolve","stopTest","handleSettingChange","key","handleSave","p","textAlign","elevation","display","alignItems","justifyContent","borderRadius","gap","xs","sm","flexWrap","flex","minWidth","fontSize","flexShrink","control","checked","padding","in","border","borderColor","_","fontWeight","helperText","lineHeight","my","min","max","step","marks","valueLabelDisplay","valueLabelFormat","br","toUpperCase","py","dense","index","Fragment","pl","primary","source","format","secondary","fileSize","createTime","duration","mimeType","backgroundColor","strong","gutterBottom","ErrorDisplay","errors","setErrors","isVisible","setIsVisible","loadErrors","parsed","clearErrors","handleErrorEvent","handleErrorClearedEvent","handleFocus","handleCustomError","handleCustomErrorCleared","addEventListener","removeEventListener","getSeverityColor","getSeverityText","getErrorTypeText","div","className","h3","span","button","slice","errorType","context","Object","keys","entries","stackTrace","details","summary","pre","useTheme","AnimationPhase","FallRescueAnimation","onAnimationComplete","theme","currentPhase","setCurrentPhase","isFalling","setIsFalling","showPhone","setShowPhone","showTextDisplay","setShowTextDisplay","currentTextIndex","setCurrentTextIndex","currentCharIndex","setCurrentCharIndex","isLooping","setIsLooping","loopCount","setLoopCount","runAnimationSequence","textLines","totalTime","lineIndex","charIndex","typeChar","getPhaseContent","person","tip","phaseContent","height","perspective","left","transform","transition","transformOrigin","transformStyle","animation","top","px","boxShadow","minHeight","flexDirection","marginBottom","md","substring","marginLeft","opacity","CheckCircle","CheckCircleIcon","ErrorIcon","Help","HelpIcon","SettingsIcon","Security","SecurityIcon","Info","InfoIcon","isRealInAndroid","FALL_DETECTION_EXCLUDED_PERMISSIONS","PermissionStatusPanel","isExpanded","onStatsChange","permissionsData","setPermissionsData","infoDialogOpen","setInfoDialogOpen","selectedPermission","setSelectedPermission","fetchPermissions","isAndroid","permissionsCount","permissions","grantedCount","status","deniedCount","unknownCount","deviceBrand","apiLevel","filterRelevantPermissions","permission","includes","updateStats","relevantPermissions","granted","denied","unknown","intervalId","handleOpenSettings","permissionId","permissionName","permissionType","currentStatus","canDetect","jpushScript","jpushErr","handleShowPermissionInfo","permissionStatus","handleCloseInfoDialog","getPermissionReason","reasonMap","getPermissionImpact","impactMap","getStatusIcon","iconProps","getStatusChip","statusConfig","config","getTypeLabel","typeLabels","runtime","special","vendor","ml","previousError","borderLeft","borderLeftColor","bgcolor","mr","PaperProps","mx","pb","pt","fromDialog","Stack","FormControl","MenuItem","InputLabel","Select","DragIndicator","DragIndicatorIcon","ExpandMore","VolumeUpIcon","Vibration","VibrationIcon","DndContext","closestCenter","KeyboardSensor","PointerSensor","TouchSensor","useSensor","useSensors","arrayMove","SortableContext","sortableKeyboardCoordinates","useSortable","verticalListSortingStrategy","CSS","debounce","PRE_ALARM_CONFIG_KEY","defaultSoundResources","SortableActionItem","action","isPlaying","onUpdate","onRemove","onPreview","onStopPreview","attributes","listeners","setNodeRef","isDragging","Transform","ref","userSelect","cursor","touchAction","flexGrow","parseInt","resourceId","startAdornment","sound","PreAlarmConfig","setConfig","playingSoundId","setPlayingSoundId","debouncedWrite","sensors","activationConstraint","distance","delay","tolerance","coordinateGetter","loadConfig","storedConfig","actionsWithIds","actions","random","substr","calculatedDuration","calculateTotalDuration","maxWaitDuration","defaultActions","totalDuration","reduce","total","updateConfig","updates","updateConfigWithCalculatedDuration","handleToggleEnabled","handleAddAction","newAction","handleUpdateAction","handleRemoveAction","handleDragEnd","active","over","oldIndex","findIndex","a","newIndex","handlePreviewSound","handleStopSound","SoundManager","previewSound","stopPreview","direction","spacing","collisionDetection","onDragEnd","items","strategy","OriginalEmergencyTTSSettings","showOriginal","setShowOriginal","default","useImperativeHandle","forwardRef","MusicNote","DEFAULT_TTS_SETTINGS","AUDIO_FILE_UPLOAD_SUCCESS_EVENT","VoiceEmergencySettings","props","showError","setShowError","setErrorMessage","handleAudioUploadSuccess","detail","reloadConfig","saveTTSSettings","stopScript","handleSaveSettings","wordBreak","icon","pr","Accordion","AccordionSummary","AccordionDetails","ExpandMoreIcon","FallDetectionSettings","voiceSettingsRef","threshold","setThreshold","lastValidThreshold","setLastValidThreshold","debounceTimerRef","localVoiceSettingsRef","effectiveVoiceSettingsRef","permissionExpanded","setPermissionExpanded","permissionStats","setPermissionStats","fetchThresholdFromAndroid","thresholdValue","parseFloat","initializeThreshold","fetchedThreshold","clearTimeout","submitThreshold","isValidThreshold","numValue","isNaN","showToast","alert","handleThresholdChange","expandIcon","aria-controls","SENSOR_MONITORING_STATE_CHANGED","alpha","Animation","AnimationIcon","PrivacyDialogDisplay","REQUIRE_LOGIN_FOR_FALL_DETECTION","FallDetectionWrapper","onToggleExpanded","animationType","fallThreshold","setFallThreshold","fallIsMonitoring","setFallIsMonitoring","fallSensorInfoDialogOpen","setFallSensorInfoDialogOpen","fallForegroundServiceDialogOpen","setFallForegroundServiceDialogOpen","privacyDialogOpen","setPrivacyDialogOpen","fallSensorCallbackRef","fallForegroundServiceCallbackRef","privacyCallbackRef","readFallIsMonitoring","isMonitoring","handleMonitoringStateChange","newState","checkShowFallSensorInfo","callback","info","passed","checkShowFallInfo","checkShowFallForegroundServiceInfo","handleFallSensorDialog","handleFallForegroundServiceDialog","checkPrivacyAgreement","def","agree","disagreeTime","handlePrivacyDialogClose","agreed","handleToggleFallMonitoring","privacyPassed","then","permissionPassed","AnimationPlaceholder","getAnimationContent","description","palette","main","warning","content","shadows","stopPropagation","background","paper","borderTop","divider","aria-labelledby","aria-describedby","area","Container","EmergencyCallSettings","fallExpanded","setFallExpanded","shakeExpanded","setShakeExpanded","isLoggedIn","handleToggleExpanded","FunctionWrapper","onToggleEnabled","children","useMemo","Grid","SHAKE_CONFIG_KEY","THRESHOLD_MIN","THRESHOLD_MAX","THRESHOLD_DEFAULT","defaultConfig","shakeCount","timeWindowMs","emergencyType","baseMotionThreshold","directionChangeThreshold","minMotionInterval","cooldownDuration","vibrationFeedback","soundFeedback","version","emergencyTypeOptions","conf","merge","ShakeDetectionSettings","lastSaveTime","setLastSaveTime","tempValues","setTempValues","loadConfigFromAndroid","validateConfig","saveConfigToAndroid","sum","configJson","base64Config","btoa","unescape","encodeURIComponent","toLocaleTimeString","handleNumberInput","field","timerId","handleAddPreAlarmAction","handleUpdatePreAlarmAction","handleRemovePreAlarmAction","SortablePreAlarmActionItem","localDuration","setLocalDuration","debouncedUpdate","handleDurationChange","cancel","container","item","inputProps","ul","paddingLeft","li","AddToHomeScreenIcon","AddWidgetButton","onError","isAdding","setIsAdding","messageType","setMessageType","deviceManufacturer","setDeviceManufacturer","showPermissionGuide","setShowPermissionGuide","manufacturerScript","settingsScript","executeAddWidget","addScript","addResult","addSuccess","errorMsg","handleAddWidget","permissionScript","permissionResult","permissionInfo","needsPermission","whiteSpace","AddSecurityWidgetButton","openSettingsScript","tmsEmergencyCallListPendingReceivedInvitations","MEmcListPendingReceivedInvitations","emergencyCallPendingInvitationService","listPendingReceivedInvitations","Card","CardContent","CardActions","Avatar","Check","CheckIcon","Close","CloseIcon","AccessTime","AccessTimeIcon","Notifications","NotificationsIcon","formatDistanceToNow","zhCN","emergencyCallInvitationService","AppModelEvent","appModel","matrixClient","PendingInvitationCard","invitation","onRespond","isProcessing","isProcessingAction","setIsProcessingAction","handleRespond","isExpired","expires_at","src","user_info","avatar_url","alt","display_name","created_at","addSuffix","locale","PendingInvitationsList","invitations","setInvitations","setIsProcessing","loadPendingInvitations","is_ok","handleRespondToInvite","invitationId","respondToInvite","invitation_id","invite","dispatcher","emit","InviteListUpdated","unsubscribe","addListener","unsub","imDispatcher","ImDispatcherEventTypes","INVITE","PreAlarmConfig2","autoOpened","PrivacyDialogAuto","setOpen","ListenShowPrivacyContent","RefreshIcon","currentPermissionsCount","SensorMonitor","setIsMonitoring","isSensorInfoDialogOpen","setSensorInfoDialogOpen","isForegroundServiceDialogOpen","setForegroundServiceDialogOpen","sensorCallbackRef","foregroundServiceCallbackRef","readIsMonitoring","handleSetThreshold","handleToggleMonitoring","checkShowInfo","checkShowSensorInfo","checkShowForegroundServiceInfo","handleSensorDialog","handleForegroundServiceDialog","ShakeConfigUI","setIsExpanded","originalConsoleLog","args","startsWith","configData","loadedConfig","apply","pointerEvents","Grid2","TestEmergencyCall","executeEmergencyCall","scriptResult","executeSecurityEmergencyCall","onSecurityClick","isWebView","textTransform","onVisibilityChange","AppShell","TabbarContainer","nextPreload","Link","MeetingList","NavBar","useRouter","Content","openInviteDialog","setOpenInviteDialog","router","href","textDecoration","m","page","Content2","maxItemLength","Home","titleConf","ns","navBar","useTranslation","HomeIcon","BottomNavigation","BottomNavigationAction","pathname","t","tabInfoList","showLabels","data-id","tmsEmergencyCallListAllInvitations","MEmcListAllInvitations","cancelOrRemoveInvitation","isReceived","tmsEmergencyCallRespondToInvite","MEmcRespondToInvite","listAllInvitations","CssBaseline","AndroidPageContent","BottomBar","paddingBottom"],"sourceRoot":"","ignoreList":[13]}