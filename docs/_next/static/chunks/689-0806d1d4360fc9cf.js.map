{"version":3,"file":"static/chunks/689-0806d1d4360fc9cf.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOe;AAiBS;AAWD;AACe;AAiBT;AACG;AAIhC,QAAQ;AACR,MAAMyC,SAAS,IAAID,eAAGA,CAAC,OAAO;AAC9B,MAAME,WAAWD,OAAOE,GAAG,CAAC,OAAO;AAEnC,OAAO;AACP,MAAMC,eAAkC;IACpCC,OAAO;IACPC,QAAQ;IACR,uDAAuD;IACvDC,WAAW;IACXC,YAAY,OAAO;AACvB;AAEA,+BAA+B;AAG/B,wCAAwC;AACxC,gDAAgD;AAChD,qEAAqE;AACrE,QAAQ;AACR,yDAAyD;AACzD,IAAI;AACJ,QAAQ;AACR,SAASC,qBACL,KAUmB,EACnBC,GAAiC;QAXjC,EACIC,aAAa,EACbC,QAAQ,EACRC,QAAQ,EACRC,YAAY,EACZC,OAAO,EACPC,YAAY,EAAE,EACdC,KAAK,EACLC,EAAE,EACFC,WAAW,KAAK,EACD,GAVnB;IAaA,YAAY;IACZ,MAAM,CAACC,kBAAkBC,oBAAoB,GAAGzD,kBAAQA,CAGrD;QACC0D,gBAAgB;QAChBC,gBAAgB;IACpB;IAEA,cAAc;IACd,MAAM,CAACC,kBAAkBC,oBAAoB,GAAG7D,kBAAQA,CAAC;QACrD8D,mBAAmB;QACnBC,mBAAmB;IACvB;IAEA,eAAe;IACf,MAAMC,oBAAoBnE,qBAAWA,CAAC;QAClC,MAAMoE,WAAW,CAACL,iBAAiBE,iBAAiB;QACpDzB,OAAO6B,GAAG,CAAC,0CAA0CD;QAErD,OAAO;QACPJ,oBAAoBM,CAAAA;YAChB9B,OAAO6B,GAAG,CAAC,4CAA4C;gBACnDE,MAAMD,KAAKL,iBAAiB;gBAC5BO,IAAIJ;YACR;YACA,OAAO;gBACH,GAAGE,IAAI;gBACPL,mBAAmBG;YACvB;QACJ;QAEA,mBAAmB;QACnB,IAAIK,QAAQC,OAAO,EAAE;YACjB,MAAMC,mBAAmBF,QAAQC,OAAO,CAACE,kBAAkB,CAACC,IAAI;YAChErC,OAAO6B,GAAG,CAAC,mCAAoD,OAAjBM,kBAAiB;YAE/DF,QAAQC,OAAO,CAACE,kBAAkB,CAACE,OAAO,CAAC,CAACC,aAAaC;gBACrD,IAAIC,kBAAkB;gBACtBF,YAAYG,iBAAiB,CAACJ,OAAO,CAACK,CAAAA;oBAClC,IAAIA,YAAYC,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACC,KAAK,EAAE;wBACvCL;wBACAzC,OAAO6B,GAAG,CAAC,kCAAiDD,OAAfY,UAAS,QAAe,OAATZ,WAAY;4BACpEmB,UAAUJ,YAAYI,QAAQ;4BAC9BC,cAAcL,YAAYK,YAAY;wBAC1C;wBACAL,YAAYM,aAAa,CAACrB;oBAC9B;gBACJ;gBACA5B,OAAO6B,GAAG,CAAC,aAA8DW,OAAjDC,iBAAgB,mCAA0C,OAATD;YAC7E;QACJ;IACJ,GAAG;QAACjB,iBAAiBE,iBAAiB;KAAC;IAEvC,eAAe;IACf,MAAMyB,oBAAoB1F,qBAAWA,CAAC;QAClC,MAAMoE,WAAW,CAACL,iBAAiBG,iBAAiB;QACpD1B,OAAO6B,GAAG,CAAC,0CAA0CD;QAErD,OAAO;QACPJ,oBAAoBM,CAAAA;YAChB9B,OAAO6B,GAAG,CAAC,4CAA4C;gBACnDE,MAAMD,KAAKJ,iBAAiB;gBAC5BM,IAAIJ;YACR;YACA,OAAO;gBACH,GAAGE,IAAI;gBACPJ,mBAAmBE;YACvB;QACJ;QAEA,mBAAmB;QACnB,IAAIK,QAAQC,OAAO,EAAE;YACjB,MAAMC,mBAAmBF,QAAQC,OAAO,CAACE,kBAAkB,CAACC,IAAI;YAChErC,OAAO6B,GAAG,CAAC,mCAAoD,OAAjBM,kBAAiB;YAE/DF,QAAQC,OAAO,CAACE,kBAAkB,CAACE,OAAO,CAAC,CAACC,aAAaC;gBACrD,IAAIW,kBAAkB;gBACtBZ,YAAYG,iBAAiB,CAACJ,OAAO,CAACK,CAAAA;oBAClC,IAAIA,YAAYC,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACO,KAAK,EAAE;wBACvCD;wBACAnD,OAAO6B,GAAG,CAAC,kCAAiDD,OAAfY,UAAS,QAAe,OAATZ,WAAY;4BACpEmB,UAAUJ,YAAYI,QAAQ;4BAC9BC,cAAcL,YAAYK,YAAY;wBAC1C;wBACAL,YAAYM,aAAa,CAACrB;oBAC9B;gBACJ;gBACA5B,OAAO6B,GAAG,CAAC,aAA8DW,OAAjDW,iBAAgB,mCAA0C,OAATX;YAC7E;QACJ;IACJ,GAAG;QAACjB,iBAAiBG,iBAAiB;KAAC;IAEvC,UAAU;IACV,MAAM2B,6BAA6B7F,qBAAWA,CAAC,CAAC+E;QAC5CvC,OAAO6B,GAAG,CAAC,0BAA0BU,YAAYC,QAAQ,EAAE;YACvDc,iBAAiB/B,iBAAiBE,iBAAiB;YACnD8B,iBAAiBhC,iBAAiBG,iBAAiB;QACvD;QAEA,cAAc;QACd,IAAI8B,uBAAuB;QAC3B,IAAIC,uBAAuB;QAE3BlB,YAAYG,iBAAiB,CAACJ,OAAO,CAACK,CAAAA;YAClC,IAAIA,YAAYC,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACC,KAAK,IAAIH,YAAYC,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACO,KAAK,EAAE;gBAChF,MAAMM,UAAUf,YAAYC,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACC,KAAK;gBACrD,MAAMa,kBAAkBD,UACpBnC,iBAAiBE,iBAAiB,GAClCF,iBAAiBG,iBAAiB;gBAEtC1B,OAAO6B,GAAG,CAAC,WAA2EU,OAAhEmB,UAAU,UAAU,SAAQ,sCAA+DC,OAA3BpB,YAAYC,QAAQ,EAAC,QAAsB,OAAhBmB,kBAAmB;oBAChIZ,UAAUJ,YAAYI,QAAQ;oBAC9BC,cAAcL,YAAYK,YAAY;gBAC1C;gBAEAL,YAAYM,aAAa,CAACU;gBAE1B,IAAID,SAASF;qBACRC;YACT;QACJ;QAEAzD,OAAO6B,GAAG,CAAC,wCAA6D,OAArBU,YAAYC,QAAQ,EAAC,MAAI;YACxEoB,aAAaJ;YACbK,aAAaJ;QACjB;QAEA,WAAW;QACXK,gBAAgBhC,CAAAA;YACZ,MAAMiC,SAASjC,KAAKkC,IAAI,CAACC,CAAAA,IAAKA,EAAEzB,QAAQ,KAAKD,YAAYC,QAAQ;YACjE,IAAI,CAACuB,QAAQ;gBACT/D,OAAO6B,GAAG,CAAC,gCAAgCU,YAAYC,QAAQ;gBAC/D,OAAO;uBAAIV;oBAAMS;iBAAY;YACjC;YACAvC,OAAO6B,GAAG,CAAC,mDAAmDU,YAAYC,QAAQ;YAClF,OAAOV;QACX;IACJ,GAAG;QAACP;KAAiB;IAErB,OAAO;IACP,MAAMU,UAAUvE,gBAAMA,CAAc;IACpC,MAAMwG,iBAAiBxG,gBAAMA,CAAe,EAAE;IAC9C,MAAMyG,gBAAgBzG,gBAAMA,CAAmC,CAAC;IAChE,MAAM0G,gBAAgB1G,gBAAMA,CAAmC,CAAC;IAChE,MAAM,CAAC2G,mBAAmBC,qBAAqB,GAAG3G,kBAAQA,CAA2C,CAAC;IACtG,MAAM4G,iBAAiB7G,gBAAMA,CAAC;IAE9B,QAAQ;IACR,MAAM,CAAC8G,cAAcC,gBAAgB,GAAG9G,kBAAQA,CAAC;IACjD,MAAM,CAAC+G,cAAcC,gBAAgB,GAAGhH,kBAAQA,CAAC;IACjD,MAAM,CAACiH,OAAOC,SAAS,GAAGlH,kBAAQA,CAAgB;IAClD,MAAM,CAACmH,SAASC,WAAW,GAAGpH,kBAAQA,CAAC;IACvC,MAAM,CAAC2D,gBAAgB0D,kBAAkB,GAAGrH,kBAAQA,CAAC;IACrD,MAAM,CAACsH,cAAcnB,gBAAgB,GAAGnG,kBAAQA,CAAsB,EAAE;IAExE,WAAW;IACX,MAAMuH,aAAa1H,qBAAWA,CAAC,OAAOmD,UAAkB6B;QACpD,IAAI;YACA,MAAM2C,WAAW,MAAMC,MAAM,GAAqB,OAAlB1E,cAAc2E,GAAG,EAAC,WAAS;gBACvDC,QAAQ;gBACRC,SAAS;oBACL,gBAAgB;gBACpB;gBACAC,MAAMC,KAAKC,SAAS,CAAC;oBACjBC,WAAWhF;oBACX6B;gBACJ;YACJ;YAEA,IAAI,CAAC2C,SAASS,EAAE,EAAE;gBACd,MAAM,IAAIC,MAAM;YACpB;YAEA,MAAMC,OAAO,MAAMX,SAASY,IAAI;YAChC,OAAOD,KAAKE,KAAK;QACrB,EAAE,OAAOpB,OAAO;YACZ3E,SAAS2E,KAAK,CAAC,gBAAgBA;YAC/B,MAAMA;QACV;IACJ,GAAG,EAAE;IAEL,QAAQ;IACR,MAAMqB,gBAAgBzI,qBAAWA,CAAC;QAC9B,IAAIgH,gBAAgBE,cAAc;QAElCD,gBAAgB;QAChBI,SAAS;QAET,IAAI;YACA,cAAc;YACd,MAAMmB,QAAQ,MAAMd,WAAWvE,UAAUC;YACzCX,SAAS4B,GAAG,CAAC,UAAUmE;YAEvB,YAAY;YACZ,MAAM,EAAEE,UAAU,EAAEC,UAAU,EAAE,GAAG,MAAMC;YACzClC,eAAehC,OAAO,GAAG;gBAACgE;gBAAYC;aAAW;YACjDlG,SAAS4B,GAAG,CAAC,eAAeqE;YAC5BjG,SAAS4B,GAAG,CAAC,eAAesE;YAC5B,YAAY;YACZ,MAAME,OAAO,IAAIxI,+BAAIA,CAAC;gBAClByI,gBAAgB;gBAChBC,UAAU;gBACVC,sBAAsB;oBAClBC,YAAYtG;gBAChB;gBACA,iDAAiD;gBACjDuG,iBAAiB;oBACbC,KAAK;oBACLC,KAAK;oBACLC,aAAa;oBACbC,WAAW;gBACf;YACJ;YACA7G,SAAS4B,GAAG,CAAC,SAASwE;YACtB,YAAY;YACZU,mBAAmBV;YAEnB,WAAW;YACX,MAAMA,KAAKW,OAAO,CACdtG,cAAcuG,KAAK,EACnBjB,OACA;gBACIkB,eAAe;YACnB;YAEJjH,SAAS4B,GAAG,CAAC;YACb,YAAY;YACZ,IAAI;gBACA,MAAMsF,QAAQC,GAAG,CAAC;oBACdf,KAAKgB,gBAAgB,CAACC,YAAY,CAACpB;oBACnCG,KAAKgB,gBAAgB,CAACC,YAAY,CAACnB;iBACtC;YACL,EAAE,OAAOoB,cAAc;gBACnBtH,SAAS2E,KAAK,CAAC,WAAW2C;YAC1B,iCAAiC;YACrC;YAEA,aAAa;YACbtF,QAAQC,OAAO,GAAGmE;YAClB1B,gBAAgB;YAEhB,kBAAkB;YAClB,MAAMvC,qBAAqBoF,MAAMzF,IAAI,CAACsE,KAAKjE,kBAAkB,CAACqF,MAAM;YACpE3D,gBAAgB1B;YAEhB,eAAe;YACfsF,uBAAuBrB,KAAKgB,gBAAgB,CAAC7E,QAAQ,EAAE;gBACnDnB,gBAAgB;gBAChBC,gBAAgB;gBAChB4E;gBACAC;YACJ;YAEA,mBAAmB;YACnB/D,mBAAmBE,OAAO,CAACC,CAAAA;gBACvB,aAAa;gBACboF,qBAAqBpF;gBACrBtC,SAAS4B,GAAG,CAAC,gBAAgBU,YAAYC,QAAQ;gBAEjD,mCAAmC;gBACnCD,YAAYqF,oBAAoB,GAAGtF,OAAO,CAACK,CAAAA;oBACvC,IAAIA,YAAYkF,KAAK,IAAIlF,YAAYkF,KAAK,YAAY7J,sCAAWA,EAAE;wBAC/D8J,sBAAsBnF,YAAYkF,KAAK,EAAElF,aAAaJ;oBAC1D;gBACJ;YACJ;YAEA,aAAa;YACb,IAAI8D,KAAKgB,gBAAgB,EAAE;gBACvBM,qBAAqBtB,KAAKgB,gBAAgB;gBAC1CpH,SAAS4B,GAAG,CAAC,gBAAgBwE,KAAKgB,gBAAgB,CAAC7E,QAAQ;YAC/D;YAEAvC,SAAS4B,GAAG,CAAC;QAEjB,EAAE,OAAO+C,OAAO;YACZ3E,SAAS2E,KAAK,CAAC,YAAYA;YAC3BC,SAAS;YACT,YAAY;YACZkD,cAAc7D,eAAehC,OAAO;YACpCgC,eAAehC,OAAO,GAAG,EAAE;YAE3B,IAAID,QAAQC,OAAO,EAAE;gBACjB,IAAI;oBACA,MAAMD,QAAQC,OAAO,CAAC8F,UAAU;gBACpC,EAAE,OAAOC,GAAG;oBACRhI,SAAS2E,KAAK,CAAC,YAAYqD;gBAC/B;gBACAhG,QAAQC,OAAO,GAAG;YACtB;QACJ,SAAU;YACNuC,gBAAgB;QACpB;IACJ,GAAG;QAAC9D;QAAUC;QAAU4D;QAAcE;QAAcQ;KAAW;IAE/D,YAAY;IACZ,MAAMkB,oBAAoB5I,qBAAWA,CAAC;QAClC,IAAI;YACA,MAAM,CAAC0I,YAAYC,WAAW,GAAG,MAAMgB,QAAQC,GAAG,CAAC;gBAC/ClJ,oDAAqBA,CAAC;oBAClBgK,kBAAkB;oBAClBC,kBAAkB;oBAClBC,iBAAiB;gBACrB;gBACAjK,oDAAqBA,CAAC;oBAClBsI,YAAY;wBACRrG,OAAO;wBACPC,QAAQ;wBACRC,WAAW;oBACf;gBACJ;aACH;YACD,OAAO;gBAAE4F;gBAAYC;YAAW;QACpC,EAAE,OAAOvB,OAAO;YACZ3E,SAAS2E,KAAK,CAAC,aAAaA;YAC5B,MAAMA;QACV;IACJ,GAAG,EAAE;IAEL,OAAO;IACP,MAAMmD,gBAAgBvK,qBAAWA,CAAC,CAAC6K;QAC/BA,OAAO/F,OAAO,CAACuF,CAAAA;YACXA,MAAMS,IAAI;YACVT,MAAMU,MAAM;QAChB;IACJ,GAAG,EAAE;IAEL,aAAa;IACb,MAAMC,mBAAmB9K,gBAAMA,CAA0B,CAAC;IAC1D,MAAM+K,mBAAmB/K,gBAAMA,CAAmC,CAAC;IACnE,MAAMgL,mBAAmBhL,gBAAMA,CAAmC,CAAC;IAEnE,UAAU;IACV,MAAMgK,yBAAyBlK,qBAAWA,CAAC,CAACgF,UAAkBmG;QAC1DrE,qBAAqBxC,CAAAA,OAAS;gBAC1B,GAAGA,IAAI;gBACP,CAACU,SAAS,EAAE;oBACR,GAAIV,IAAI,CAACU,SAAS,IAAI;wBAClBnB,gBAAgB;wBAChBC,gBAAgB;wBAChBsH,sBAAsB;wBACtBC,sBAAsB;oBAC1B,CAAC;oBACD,GAAGF,KAAK;gBACZ;YACJ;IACJ,GAAG,EAAE;IACL,SAAS;IACT,MAAMb,wBAAwBtK,qBAAWA,CAAC,CACtCqK,OACAlF,aACAJ;QAEA,IAAI,CAACsF,OAAO,OAAO,KAAQ;QAE3B,MAAM,EAAErF,QAAQ,EAAE,GAAGD;QACrB,MAAMuG,eAAejB,MAAMjF,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACO,KAAK;QAEpDnD,SAAS4B,GAAG,CAAC,MAAiB,OAAXgG,MAAMjF,IAAI,EAAC,WAASJ,UAAUqF;QAEjD,YAAY;QACZ,MAAMkB,mBAAmB;YACrB,MAAMjE,UAAU+C,MAAM/C,OAAO;YAC7B,MAAMkE,cAAyC,CAAC;YAEhD,IAAInB,MAAMjF,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACC,KAAK,EAAE;gBACjCkG,YAAY3H,cAAc,GAAG,CAACyD;YAClC,OAAO,IAAI+C,MAAMjF,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACO,KAAK,EAAE;gBACxC4F,YAAY1H,cAAc,GAAG,CAACwD;YAClC;YAEA4C,uBAAuBlF,UAAUwG;YAEjC,oCAAoC;YACpC,IAAIF,cAAc;gBACdhF,gBAAgBhC,CAAAA,OAAQ;2BAAIA;qBAAK;YACrC;QACJ;QAEA,gBAAgB;QAChB+F,MAAMoB,EAAE,CAAC,SAASF;QAClBlB,MAAMoB,EAAE,CAAC,WAAWF;QAEpB,SAAS;QACTA;QAEA,mBAAmB;QACnB,0BAA0B;QAC1BjF,gBAAgBhC,CAAAA;YACZ,MAAMoH,oBAAoBpH,KAAKkC,IAAI,CAACC,CAAAA,IAAKA,EAAEzB,QAAQ,KAAKA;YACxD,IAAI,CAAC0G,mBAAmB;gBACpB,OAAO;uBAAIpH;oBAAMS;iBAAiC;YACtD;YACA,OAAO;mBAAIT;aAAK;QACpB;QAGA,OAAO;QACP,OAAO;YACH+F,MAAMsB,GAAG,CAAC,SAASJ;YACnBlB,MAAMsB,GAAG,CAAC,WAAWJ;QACzB;IACJ,GAAG;QAACrB;KAAuB;IAE3B,WAAW;IACX,MAAMX,qBAAqBvJ,qBAAWA,CAAC,CAAC6I;QAGpC,MAAM+C,gBAA8C;YAChD,YAAY;YACZC,sBAAsB,CAAC9G;gBACnB,IAAI,CAAEA,CAAAA,uBAAuBxE,4CAAgB,GAAI;gBAEjDkC,SAAS4B,GAAG,CAAC,aAAaU,YAAYC,QAAQ;gBAE9C,4BAA4B;gBAC5BsB,gBAAgBhC,CAAAA;oBACZ,oBAAoB;oBACpB,IAAIA,KAAKkC,IAAI,CAACC,CAAAA,IAAKA,EAAEzB,QAAQ,KAAKD,YAAYC,QAAQ,GAAG;wBACrD,OAAOV;oBACX;oBACA,OAAO;2BAAIA;wBAAMS;qBAAY;gBACjC;gBAEA,aAAa;gBACb,MAAM+G,uBAAuB,CAAC3G;oBAC1B1C,SAAS4B,GAAG,CAAC,cAAcc,YAAYC,IAAI,EAAEL,YAAYC,QAAQ;oBACjE,IAAIG,YAAYkF,KAAK,EAAE;wBACnBC,sBAAsBnF,YAAYkF,KAAK,EAAiBlF,aAAaJ;oBACzE,OAAO;wBACHI,YAAY4G,IAAI,CAAC,cAAc,CAAC1B;4BAC5BC,sBAAsBD,OAAOlF,aAAaJ;wBAC9C;oBACJ;gBACJ;gBAEA,WAAW;gBACXA,YAAY0G,EAAE,CAAC,kBAAkBK;gBAEjC,YAAY;gBACZ/G,YAAYG,iBAAiB,CAACJ,OAAO,CAACK,CAAAA;oBAClC,IAAIA,YAAYkF,KAAK,EAAE;wBACnBC,sBAAsBnF,YAAYkF,KAAK,EAAiBlF,aAAaJ;oBACzE;gBACJ;gBAEA,SAAS;gBACT,OAAO;oBACHA,YAAY4G,GAAG,CAAC,kBAAkBG;gBACtC;YACJ;YAEA,YAAY;YACZE,yBAAyB,CAACjH;gBACtBtC,SAAS4B,GAAG,CAAC,eAAeU,YAAYC,QAAQ;gBAChDsB,gBAAgBhC,CAAAA;oBACZ,MAAM2H,kBAAkB3H,KAAK4H,MAAM,CAACzF,CAAAA,IAAKA,EAAEzB,QAAQ,KAAKD,YAAYC,QAAQ;oBAC5EvC,SAAS4B,GAAG,CAAC,cAAc4H,gBAAgBE,GAAG,CAAC1F,CAAAA,IAAKA,EAAEzB,QAAQ;oBAC9D,OAAOiH;gBACX;YACJ;YAEA,SAAS;YACTG,iBAAiB,CAAC/B,OAAoBlF,aAA+BJ;gBACjE,IAAI,CAACsF,OAAO;gBACZ5H,SAAS4B,GAAG,CAAC,WAAWgG,MAAMjF,IAAI,EAAEL,YAAYC,QAAQ;gBACxD,WAAW;gBACXsF,sBAAsBD,OAAOlF,aAAaJ;YAC9C;YAEAsH,cAAc,CAACC;oBACOA;gBAAlB,MAAMC,YAAYD,CAAAA,mBAAAA,8BAAAA,mBAAAA,OAAQE,QAAQ,cAAhBF,uCAAAA,sBAAAA,YAAwB;gBAC1C7J,SAAS4B,GAAG,CAAC,gBAAgBkI;gBAC7B,yCAAyC;gBACzCpF,gBAAgB;gBAChBb,gBAAgB,EAAE;gBAClBe,SAAS;YACb;YAEAoF,cAAc;gBACVhK,SAAS4B,GAAG,CAAC;gBACbgD,SAAS;YACb;YAEAqF,aAAa;gBACTjK,SAAS4B,GAAG,CAAC;gBACbgD,SAAS;YACb;QACJ;QAEA,SAAS;QACTwB,KACK4C,EAAE,CAACnL,oCAASA,CAACqM,YAAY,EAAEf,cAAcS,YAAY,EACrDZ,EAAE,CAACnL,oCAASA,CAACsM,YAAY,EAAEhB,cAAca,YAAY,EACrDhB,EAAE,CAACnL,oCAASA,CAACuM,WAAW,EAAEjB,cAAcc,WAAW,EACnDjB,EAAE,CAACnL,oCAASA,CAACwM,oBAAoB,EAAEjH,4BAA4B,WAAW;SAC1E4F,EAAE,CAACnL,oCAASA,CAACyM,uBAAuB,EAAEnB,cAAcI,uBAAuB,EAC3EP,EAAE,CAACnL,oCAASA,CAAC0M,eAAe,EAAEpB,cAAcQ,eAAe;QAEhE,SAAS;QACT,OAAO;YACH,IAAI,CAACvD,MAAM;YACXA,KACK8C,GAAG,CAACrL,oCAASA,CAACqM,YAAY,EAAEf,cAAcS,YAAY,EACtDV,GAAG,CAACrL,oCAASA,CAACsM,YAAY,EAAEhB,cAAca,YAAY,EACtDd,GAAG,CAACrL,oCAASA,CAACuM,WAAW,EAAEjB,cAAcc,WAAW,EACpDf,GAAG,CAACrL,oCAASA,CAACwM,oBAAoB,EAAElB,cAAcC,oBAAoB,EACtEF,GAAG,CAACrL,oCAASA,CAACyM,uBAAuB,EAAEnB,cAAcI,uBAAuB,EAC5EL,GAAG,CAACrL,oCAASA,CAAC0M,eAAe,EAAEpB,cAAcQ,eAAe;YAEjE,YAAY;YACZ,OAAOa;QACX;IACJ,GAAG;QAAC3C;KAAsB;IAE1B,OAAO;IACP,MAAM4C,eAAelN,qBAAWA,CAAC;QAC7ByC,SAAS4B,GAAG,CAAC;QACb,IAAI;YACA,WAAW;YACXkG,cAAc7D,eAAehC,OAAO;YAEpC,SAAS;YACT,IAAID,QAAQC,OAAO,EAAE;gBACjB,MAAMD,QAAQC,OAAO,CAAC8F,UAAU;gBAChC/F,QAAQC,OAAO,GAAG;YACtB;YAEA,OAAO;YACPyC,gBAAgB;YAChBb,gBAAgB,EAAE;YAClBe,SAAS;YAET,WAAW;YACX8F,OAAOlD,MAAM,CAACtD,cAAcjC,OAAO,EAAEI,OAAO,CAACsI,CAAAA,KAAMA,MAAMA,GAAGC,MAAM;YAClEF,OAAOlD,MAAM,CAACrD,cAAclC,OAAO,EAAEI,OAAO,CAACsI,CAAAA,KAAMA,MAAMA,GAAGC,MAAM;YAClE1G,cAAcjC,OAAO,GAAG,CAAC;YACzBkC,cAAclC,OAAO,GAAG,CAAC;YAEzB,WAAW;YACX,IAAIrB,cAAc;gBACdA;YACJ;YAEAZ,SAAS4B,GAAG,CAAC;QACjB,EAAE,OAAO+C,OAAO;YACZ3E,SAAS2E,KAAK,CAAC,YAAYA;YAC3BC,SAAS;QACb;IACJ,GAAG;QAAChE;KAAa;IAEjB,OAAO;IACP,MAAMiK,UAAUtN,qBAAWA,CAAC;YAAOuN,gFAAe;QAC9C,iBAAiB;QACjB,IAAIA,cAAc;YACdxG,eAAerC,OAAO,GAAG;QAC7B;QAEAjC,SAAS4B,GAAG,CAAC;QACb,IAAI,CAACI,QAAQC,OAAO,EAAE;QAEtB,MAAMmF,mBAAmBpF,QAAQC,OAAO,CAACmF,gBAAgB;QACzD,MAAMnB,aAAahC,eAAehC,OAAO,CAAC8I,IAAI,CAC1CC,CAAAA,IAAKA,EAAErI,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACC,KAAK;QAEpC,MAAMqD,aAAajC,eAAehC,OAAO,CAAC8I,IAAI,CAC1CC,CAAAA,IAAKA,EAAErI,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACO,KAAK;QAGpC,IAAI;YACA,IAAI8C,YAAY;gBACZ,MAAMA,WAAWoC,IAAI;YACzB;YACA,IAAInC,YAAY;gBACZ,MAAMA,WAAWmC,IAAI;YACzB;QACJ,EAAE,OAAO1D,OAAO;YACZ3E,SAAS2E,KAAK,CAAC,WAAWA;QAC9B;QAEA,OAAO;QACPmD,cAAc7D,eAAehC,OAAO;QACpCgC,eAAehC,OAAO,GAAG,EAAE;QAE3B,OAAO;QACP,IAAID,QAAQC,OAAO,EAAE;YACjBD,QAAQC,OAAO,CAAC8F,UAAU;YAC1B/F,QAAQC,OAAO,GAAG;QACtB;QAEA,OAAO;QACPyC,gBAAgB;QAChBb,gBAAgB,EAAE;QAClBQ,qBAAqB,CAAC;IAC1B,GAAG,EAAE;IAEL,WAAW;IACX,MAAM4G,yBAAyB1N,qBAAWA,CAAC,CAAC2N,cAAuBC;QAC/DhK,oBAAoBU,CAAAA,OAAS;gBACzB,GAAGA,IAAI;gBACPT,gBAAgB8J;gBAChB7J,gBAAgB8J;YACpB;IACJ,GAAG,EAAE;IAEL,eAAe;IACf,MAAMC,aAAa7N,qBAAWA,CAAC;QAC3B,IAAI,CAACyE,QAAQC,OAAO,EAAE;QAEtB,MAAMmF,mBAAmBpF,QAAQC,OAAO,CAACmF,gBAAgB;QACzD,MAAMnB,aAAahC,eAAehC,OAAO,CAAC8I,IAAI,CAC1CC,CAAAA,IAAKA,EAAErI,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACC,KAAK;QAGpC,IAAI,CAACoD,YAAY;QAEjB,IAAI;YACA,iBAAiB;YACjB,MAAMoF,sBAAsB,CAACnK,iBAAiBE,cAAc;YAE5D,iBAAiB;YACjB,IAAIiK,qBAAqB;gBACrB,MAAMpF,WAAWqF,MAAM;YAC3B,OAAO;gBACH,MAAMrF,WAAWsF,IAAI;YACzB;YAEA,WAAW;YACXzG,WAAW,CAACuG;YACZ5D,uBAAuBL,iBAAiB7E,QAAQ,EAAE;gBAAEnB,gBAAgBiK;YAAoB;YAExF,0BAA0B;YAC1BJ,uBAAuBI,qBAAqBnK,iBAAiBG,cAAc;QAC/E,EAAE,OAAOsD,OAAO;YACZ3E,SAAS2E,KAAK,CAAC,aAAaA;YAC5BC,SAAS;QACb;IACJ,GAAG;QAAC1D;QAAkBuG;QAAwBwD;KAAuB;IAErE,eAAe;IACf,MAAMO,cAAcjO,qBAAWA,CAAC;QAC5B,IAAI,CAACyE,QAAQC,OAAO,EAAE;QAEtB,MAAMmF,mBAAmBpF,QAAQC,OAAO,CAACmF,gBAAgB;QACzD,MAAMlB,aAAajC,eAAehC,OAAO,CAAC8I,IAAI,CAC1CC,CAAAA,IAAKA,EAAErI,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACO,KAAK;QAGpC,IAAI,CAAC+C,YAAY;QAEjB,IAAI;YACA,iBAAiB;YACjB,MAAMuF,sBAAsB,CAACvK,iBAAiBG,cAAc;YAE5D,iBAAiB;YACjB,IAAIoK,qBAAqB;gBACrB,MAAMvF,WAAWoF,MAAM;YAC3B,OAAO;gBACH,MAAMpF,WAAWqF,IAAI;YACzB;YAEA,WAAW;YACXxG,kBAAkB0G;YAClBhE,uBAAuBL,iBAAiB7E,QAAQ,EAAE;gBAAElB,gBAAgBoK;YAAoB;YAExF,0BAA0B;YAC1BR,uBAAuB/J,iBAAiBE,cAAc,EAAEqK;QAC5D,EAAE,OAAO9G,OAAO;YACZ3E,SAAS2E,KAAK,CAAC,aAAaA;YAC5BC,SAAS;QACb;IACJ,GAAG;QAAC1D;QAAkBuG;QAAwBwD;KAAuB;IAErE,oBAAoB;IACpB,MAAMS,wBAAwBnO,qBAAWA,CAAC;QACtC,IAAI,CAACyE,QAAQC,OAAO,EAAE;QAEtB,MAAMmF,mBAAmBpF,QAAQC,OAAO,CAACmF,gBAAgB;QACzD,MAAMnB,aAAahC,eAAehC,OAAO,CAAC8I,IAAI,CAC1CC,CAAAA,IAAKA,EAAErI,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACC,KAAK;QAGpC,IAAI,CAACoD,YAAY;QAEjB,IAAI;YACA,MAAM0F,gBAAgB,CAAC9G;YACvB,IAAI8G,eAAe;gBACf,MAAM1F,WAAWsF,IAAI;YACzB,OAAO;gBACH,MAAMtF,WAAWqF,MAAM;YAC3B;YAEAxG,WAAW6G;YACXlE,uBAAuBL,iBAAiB7E,QAAQ,EAAE;gBAAEnB,gBAAgB,CAACuK;YAAc;QACvF,EAAE,OAAOhH,OAAO;YACZ3E,SAAS2E,KAAK,CAAC,eAAeA;YAC9BC,SAAS;QACb;IACJ,GAAG;QAACC;QAAS4C;KAAuB;IAEpC,oBAAoB;IACpB,MAAMmE,yBAAyBrO,qBAAWA,CAAC;QACvC,IAAI,CAACyE,QAAQC,OAAO,EAAE;QAEtB,MAAMmF,mBAAmBpF,QAAQC,OAAO,CAACmF,gBAAgB;QACzD,MAAMlB,aAAajC,eAAehC,OAAO,CAAC8I,IAAI,CAC1CC,CAAAA,IAAKA,EAAErI,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACO,KAAK;QAGpC,IAAI,CAAC+C,YAAY;QAEjB,IAAI;YACA,MAAM2F,gBAAgB,CAACxK;YACvB,IAAIwK,eAAe;gBACf,MAAM3F,WAAWoF,MAAM;YAC3B,OAAO;gBACH,MAAMpF,WAAWqF,IAAI;YACzB;YAEAxG,kBAAkB8G;YAClBpE,uBAAuBL,iBAAiB7E,QAAQ,EAAE;gBAAElB,gBAAgBwK;YAAc;QACtF,EAAE,OAAOlH,OAAO;YACZ3E,SAAS2E,KAAK,CAAC,eAAeA;YAC9BC,SAAS;QACb;IACJ,GAAG;QAACvD;QAAgBoG;KAAuB;IAE3C,YAAY;IACZjK,mBAASA,CAAC;QACN,OAAO;YACH,OAAO;YACPqN,QAAQ;QACZ;IACJ,GAAG,EAAE;IAEL,UAAU;IACV,MAAMiB,sBAAsBvO,qBAAWA,CAAC,CAACgF;QACrC,OAAO6B,iBAAiB,CAAC7B,SAAS,IAAI;YAClCnB,gBAAgB;YAChBC,gBAAgB;YAChBsH,sBAAsB;YACtBC,sBAAsB;QAC1B;IACJ,GAAG;QAACxE;KAAkB;IAEtB,WAAW;IACX,MAAMsD,uBAAuBnK,qBAAWA,CAAC,CAAC+E;YAInBA,wCAKAA;QARnB,MAAMoG,QAAQoD,oBAAoBxJ,YAAYC,QAAQ;QAEtD,SAAS;QACT,MAAM0D,cAAa3D,yCAAAA,YAAYqF,oBAAoB,GAAGoD,IAAI,CACtDgB,CAAAA,MAAOA,IAAIpJ,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACC,KAAK,eADrBP,6DAAAA,uCAEhBsF,KAAK;QAER,SAAS;QACT,MAAM1B,cAAa5D,0CAAAA,YAAYqF,oBAAoB,GAAGoD,IAAI,CACtDgB,CAAAA,MAAOA,IAAIpJ,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACO,KAAK,eADrBb,8DAAAA,wCAEhBsF,KAAK;QAERH,uBAAuBnF,YAAYC,QAAQ,EAAE;YACzC,GAAGmG,KAAK;YACRtH,gBAAgB6E,aAAa,CAACA,WAAWpB,OAAO,GAAG;YACnDxD,gBAAgB6E,aAAa,CAACA,WAAWrB,OAAO,GAAG;QACvD;IACJ,GAAG;QAACiH;QAAqBrE;KAAuB;IAEhD,aAAa;IACb,MAAMuE,oBAAoBzO,qBAAWA,CAAC,CAAC+E;QACnC,MAAM2J,eAAe7H,iBAAiB,CAAC9B,YAAYC,QAAQ,CAAC,IAAI;YAC5DnB,gBAAgB;YAChBC,gBAAgB;YAChBsH,sBAAsB;YACtBC,sBAAsB;QAC1B;QAEAnB,uBAAuBnF,YAAYC,QAAQ,EAAE;YACzC,GAAG0J,YAAY;YACf7K,gBAAgB,CAAC6K,aAAa7K,cAAc;QAChD;IACJ,GAAG;QAACgD;QAAmBqD;KAAuB;IAE9C,aAAa;IACb,MAAMyE,oBAAoB3O,qBAAWA,CAAC,CAAC+E;QACnC,MAAM2J,eAAe7H,iBAAiB,CAAC9B,YAAYC,QAAQ,CAAC,IAAI;YAC5DnB,gBAAgB;YAChBC,gBAAgB;YAChBsH,sBAAsB;YACtBC,sBAAsB;QAC1B;QAEAnB,uBAAuBnF,YAAYC,QAAQ,EAAE;YACzC,GAAG0J,YAAY;YACf5K,gBAAgB,CAAC4K,aAAa5K,cAAc;QAChD;IACJ,GAAG;QAAC+C;QAAmBqD;KAAuB;IAE9C,uBAAuB;IACvB,MAAM0E,yBAAyB5O,qBAAWA,CAAC,CAAC6O;QACxC,MAAM1D,QAAQtE,iBAAiB,CAACgI,cAAc;QAC9C,IAAI,CAAC1D,OAAO,OAAO;YAAEtH,gBAAgB;YAAMC,gBAAgB;QAAK;QAEhE,OAAO;YACHD,gBAAgBF,iBAAiBE,cAAc,GAAGsH,MAAMtH,cAAc,GAAG;YACzEC,gBAAgBH,iBAAiBG,cAAc,GAAGqH,MAAMrH,cAAc,GAAG;QAC7E;IACJ,GAAG;QAACH;QAAkBkD;KAAkB;IAExC,UAAU;IACV,MAAMiI,iCAAmB/O,UAAU,CAAC;YAAC,EACjCgF,WAAW,EACXiK,OAAO,EACPlL,cAAc,EAKjB;QACG,MAAMmL,WAAW/O,gBAAMA,CAAmB;QAC1C,MAAM,CAACyI,YAAYuG,cAAc,GAAG/O,kBAAQA,CAA+C;QAE3F,WAAW;QACXF,mBAASA,CAAC;YACN,IAAI,CAAC8E,aAAa;YAElB,cAAc;YACd,MAAMoK,mBAAmBnF,MAAMzF,IAAI,CAACQ,YAAYG,iBAAiB,CAAC+E,MAAM,IACnEuD,IAAI,CAACgB,CAAAA,MAAOA,IAAIpJ,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACO,KAAK;YAE9C,gBAAgB;YAChB,IAAIuJ,oBAAoBA,iBAAiB9E,KAAK,EAAE;gBAC5C6E,cAAcC,iBAAiB9E,KAAK;YACxC;YAEA,WAAW;YACX,MAAMC,wBAAwB,CAACD;gBAC3B,IAAIA,MAAMjF,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACO,KAAK,EAAE;oBACjCsJ,cAAc7E;gBAClB;YACJ;YAEA,aAAa;YACb,MAAM+E,0BAA0B,CAAC/E;gBAC7B,IAAIA,MAAMjF,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACO,KAAK,EAAE;oBACjCsJ,cAAc;gBAClB;YACJ;YAEA,SAAS;YACTnK,YAAY0G,EAAE,CAACnL,oCAASA,CAAC0M,eAAe,EAAE1C;YAC1CvF,YAAY0G,EAAE,CAACnL,oCAASA,CAAC+O,iBAAiB,EAAED;YAE5C,OAAO;YACP,OAAO;gBACHrK,YAAY4G,GAAG,CAACrL,oCAASA,CAAC0M,eAAe,EAAE1C;gBAC3CvF,YAAY4G,GAAG,CAACrL,oCAASA,CAAC+O,iBAAiB,EAAED;YACjD;QACJ,GAAG;YAACrK;SAAY;QAEhB,cAAc;QACd9E,mBAASA,CAAC;YACN,MAAMqP,eAAeL,SAASvK,OAAO;YACrC,IAAI,CAAC4K,gBAAgB,CAAC3G,YAAY;YAElC,UAAU;YACV,MAAO2G,aAAaC,UAAU,CAAE;gBAC5BD,aAAaE,WAAW,CAACF,aAAaC,UAAU;YACpD;YAEA,SAAS;YACT,IAAIzL,gBAAgB;gBAChB6E,WAAW8G,MAAM,CAACH;YACtB;YAEA,OAAO;gBACH,IAAI3G,YAAY;oBACZA,WAAWoC,MAAM,CAACuE;gBACtB;YACJ;QACJ,GAAG;YAAC3G;YAAY7E;SAAe;QAE/B,qBACI,qBAAClD,kBAAGA;YACA6C,IAAI;gBACAb,OAAO;gBACP8M,aAAa;gBACbC,SAAS;gBACTC,SAAS;gBACTC,YAAY;gBACZC,gBAAgB;gBAChBC,UAAU;YACd;;8BAEA,oBAACC;oBACG/M,KAAKgM;oBACLgB,QAAQ;oBACRC,WAAW;oBACXC,OAAOnB;oBACPxL,OAAO;wBACHZ,OAAO;wBACPC,QAAQ;wBACRuN,WAAW;wBACXR,SAAS9L,iBAAiB,UAAU;oBACxC;;gBAEH,CAACA,gCACE,oBAAClD,kBAAGA;oBACA6C,IAAI;wBACAsM,UAAU;wBACVM,KAAK;wBACLC,MAAM;wBACNC,OAAO;wBACPC,QAAQ;wBACRZ,SAAS;wBACTC,YAAY;wBACZC,gBAAgB;wBAChBH,SAAS;oBACb;8BAEA,kCAAC/O,kBAAGA;wBACA6C,IAAI;4BACAb,OAAO;4BACPC,QAAQ;4BACR4N,cAAc;4BACdb,SAAS;4BACTC,YAAY;4BACZC,gBAAgB;4BAChBH,SAAS;4BACTe,OAAO;4BACPC,UAAU;4BACVC,YAAY;wBAChB;kCAEC7L,YAAYC,QAAQ,CAAC6L,MAAM,CAAC,GAAGC,WAAW;;;;;IAMnE;IAEA,UAAU;IACV,MAAMC,iCAAmBhR,UAAU,CAAC;YAAC,EACjCgF,WAAW,EACXuC,OAAO,EAIV;QACG,MAAM0J,WAAW9Q,gBAAMA,CAAmB;QAC1C,MAAM,CAACwI,YAAYuI,cAAc,GAAG9Q,kBAAQA,CAA+C;QAE3FF,mBAASA,CAAC;YACN,IAAI,CAAC8E,aAAa;YAElB,MAAMuF,wBAAwB,CAACD;gBAC3B,IAAIA,MAAMjF,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACC,KAAK,EAAE;oBACjC2L,cAAc5G;gBAClB;YACJ;YAEA,MAAM+E,0BAA0B,CAAC/E;gBAC7B,IAAIA,MAAMjF,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACC,KAAK,EAAE;oBACjC2L,cAAc;gBAClB;YACJ;YAEA,YAAY;YACZ,MAAMC,mBAAmBlH,MAAMzF,IAAI,CAACQ,YAAYG,iBAAiB,CAAC+E,MAAM,IACnEuD,IAAI,CAACgB,CAAAA,MAAOA,IAAIpJ,IAAI,KAAK3E,gCAAKA,CAAC4E,IAAI,CAACC,KAAK;YAE9C,IAAI4L,oBAAoBA,iBAAiB7G,KAAK,EAAE;gBAC5C4G,cAAcC,iBAAiB7G,KAAK;YACxC;YAEAtF,YAAY0G,EAAE,CAACnL,oCAASA,CAAC0M,eAAe,EAAE1C;YAC1CvF,YAAY0G,EAAE,CAACnL,oCAASA,CAAC+O,iBAAiB,EAAED;YAE5C,OAAO;gBACHrK,YAAY4G,GAAG,CAACrL,oCAASA,CAAC0M,eAAe,EAAE1C;gBAC3CvF,YAAY4G,GAAG,CAACrL,oCAASA,CAAC+O,iBAAiB,EAAED;YACjD;QACJ,GAAG;YAACrK;SAAY;QAEhB9E,mBAASA,CAAC;YACN,MAAMkR,eAAeH,SAAStM,OAAO;YACrC,IAAIyM,gBAAgBzI,YAAY;gBAC5BA,WAAW+G,MAAM,CAAC0B;gBAClB,oBAAoB;gBACpBA,aAAahB,KAAK,GAAG7I;gBACrB,OAAO;oBACHoB,WAAWqC,MAAM,CAACoG;gBACtB;YACJ;QACJ,GAAG;YAACzI;YAAYpB;SAAQ;QAExB,qBAAO,oBAAC8J;YAAMnO,KAAK+N;YAAUf,QAAQ;YAACC,WAAW;;IACrD;IAEA,QAAQ;IACR,MAAMmB,oBAAoBrR,qBAAWA,CAAC,CAAC+E,aAA0BiK;QAC7D,MAAMsC,iBAAiB1C,uBAAuB7J,YAAYC,QAAQ;QAElE,qBACI,qBAACpE,kBAAGA;YAEA6C,IAAI;gBACAsM,UAAU;gBACVU,cAAc;gBACdc,UAAU;gBACV5B,SAAS;gBACT6B,WAAW;YACf;;8BAGA,oBAAC1C;oBACG/J,aAAaA;oBACbiK,SAASA;oBACTlL,gBAAgBwN,eAAexN,cAAc;;gBAIhD,CAACkL,yBACE,oBAAC+B;oBACGhM,aAAaA;oBACbuC,SAAS,CAACgK,eAAezN,cAAc;;8BAK/C,qBAAC3C,oBAAIA;oBAACuQ,SAAS;oBACXhO,IAAI;wBACAsM,UAAU;wBACVS,QAAQ;wBACRF,MAAM;wBACNC,OAAO;wBACP9J,GAAG;wBACHkJ,SAAS;wBACTG,gBAAgB;wBAChB4B,KAAK;oBACT;;sCAEA,oBAACxQ,oBAAIA;4BAACyQ,IAAI;sCACN,kCAAC3Q,yBAAUA;gCACP6D,MAAK;gCACL6L,OAAOY,eAAezN,cAAc,GAAG,YAAY;gCACnD+N,SAAS,IAAMnD,kBAAkB1J;0CAEhCuM,eAAezN,cAAc,iBAAG,oBAAC/B,uBAAYA,sBAAM,oBAACE,wBAAaA;;;sCAG1E,oBAACd,oBAAIA;4BAACyQ,IAAI;sCACN,kCAAC3Q,yBAAUA;gCACP6D,MAAK;gCACL6L,OAAOY,eAAexN,cAAc,GAAG,YAAY;gCACnD8N,SAAS,IAAMjD,kBAAkB5J;0CAEhCuM,eAAexN,cAAc,iBAAG,oBAAC1B,yBAAcA,sBAAM,oBAACE,4BAAiBA;;;sCAGhF,oBAACpB,oBAAIA;4BAACyQ,IAAI;sCACN,mCAAC7Q,yBAAUA;gCAAC+Q,SAAQ;gCAAUnB,OAAM;;oCAC/B3L,YAAYC,QAAQ;oCAAC;oCAAEgK,WAAW;;;;wBAK1CA,yBACG,oBAAC9N,oBAAIA;4BAACyQ,IAAI;sCACN,kCAAC3Q,yBAAUA;gCACP6D,MAAK;gCACL+M,SAASzD;gCACTuC,OAAOpJ,UAAU,UAAU;gCAC3B7D,IAAI;oCAAEiN,OAAO;gCAAQ;gCACrBoB,OAAOxK,UAAU,SAAS;0CAEzBA,wBAAU,oBAAChG,qBAAUA,sBAAM,oBAACF,kBAAOA;;;wBAM/C4N,yBACG,oBAAC9N,oBAAIA;4BAACyQ,IAAI;sCACN,kCAAC3Q,yBAAUA;gCACP6D,MAAK;gCACL+M,SAASvD;gCACTqC,OAAO5M,iBAAiB,YAAY;gCACpCL,IAAI;oCAAEiN,OAAO;gCAAQ;gCACrBoB,OAAOhO,iBAAiB,UAAU;0CAEjCA,+BAAiB,oBAACtC,uBAASA,sBAAM,oBAACE,0BAAYA;;;;;;WAtF1DqD,YAAYC,QAAQ;IA6FrC,GAAG;QAACsC;QAASxD;QAAgB8K;QAAwBH;QAAmBE;QAAmBR;QAAuBE;KAAuB;IAEzI,SAAS;IACT,SAAS0D;QACL,qBACI,qBAACnR,kBAAGA;YAAC6C,IAAI;gBAAEmM,SAAS;gBAAQ8B,KAAK;gBAAGjL,GAAG;gBAAGkJ,SAAS;YAAmB;;8BAElE,oBAAC3O,yBAAUA;oBACP0P,OAAOpJ,UAAU,UAAU;oBAC3BsK,SAAS/D;oBACTiE,OAAOxK,UAAU,SAAS;8BAEzBA,wBAAU,oBAAChG,qBAAUA,sBAAM,oBAACF,kBAAOA;;8BAIxC,oBAACJ,yBAAUA;oBACP0P,OAAO5M,iBAAiB,YAAY;oBACpC8N,SAAS3D;oBACT6D,OAAOhO,iBAAiB,UAAU;8BAEjCA,+BAAiB,oBAACtC,uBAASA,sBAAM,oBAACE,0BAAYA;;8BAInD,oBAACV,yBAAUA;oBACP0P,OAAO3M,iBAAiBE,iBAAiB,GAAG,YAAY;oBACxD2N,SAASzN;oBACT2N,OAAO/N,iBAAiBE,iBAAiB,GAAG,aAAa;8BAExDF,iBAAiBE,iBAAiB,iBAAG,oBAACnC,uBAAYA,sBAAM,oBAACE,wBAAaA;;8BAI3E,oBAAChB,yBAAUA;oBACP0P,OAAO3M,iBAAiBG,iBAAiB,GAAG,YAAY;oBACxD0N,SAASlM;oBACToM,OAAO/N,iBAAiBG,iBAAiB,GAAG,aAAa;8BAExDH,iBAAiBG,iBAAiB,iBAAG,oBAAC9B,yBAAcA,sBAAM,oBAACE,4BAAiBA;;8BAIjF,oBAACtB,yBAAUA;oBACP0P,OAAM;oBACNkB,SAAS1E;oBACT4E,OAAM;8BAEN,kCAAClQ,sBAAWA;;;;IAI5B;IAEA,QAAQ;IACR,SAASoQ;QACL,gBAAgB;QAChB,IAAI9K,gBAAgBzC,QAAQC,OAAO,EAAE;YACjC,qBACI,qBAAC9D,kBAAGA;gBAAC2C,WAAWA;gBAAWE,IAAI;oBAAEZ,QAAQ;oBAAQ+M,SAAS;oBAAQqC,eAAe;gBAAS;;kCACtF,oBAACrR,kBAAGA;wBAAC6C,IAAI;4BAAEyO,MAAM;4BAAGX,UAAU;4BAAQ9K,GAAG;wBAAE;kCACvC,mCAACvF,oBAAIA;4BAACuQ,SAAS;4BAACU,SAAS;;8CACrB,oBAACjR,oBAAIA;oCAACyQ,IAAI;oCAACS,IAAI;oCAAIC,IAAI5K,aAAa6K,MAAM,KAAK,IAAI,KAAK;8CACnDjB,kBAAkB5M,QAAQC,OAAO,CAACmF,gBAAgB,EAAE;;gCAExDpC,aAAa0E,GAAG,CAAC,SAAUpH,WAAW;oCACnC,qBACI,oBAAC7D,oBAAIA;wCAACyQ,IAAI;wCAACS,IAAI;wCAAIC,IAAI;kDAClBhB,kBAAkBtM,aAAa;uCADLA,YAAYC,QAAQ;gCAI3D;;;;kCAIR,oBAACpE,kBAAGA;wBAAC6C,IAAI;4BAAEgD,GAAG;4BAAG8L,WAAW;4BAAaC,aAAa;wBAAU;kCAC3DT;;;;QAIjB;QAEA,aAAa;QACb,qBACI,qBAACnR,kBAAGA;YAAC2C,WAAWA;YAAWE,IAAI;gBAC3BZ,QAAQ;gBACR+M,SAAS;gBACTqC,eAAe;gBACfpC,YAAY;gBACZC,gBAAgB;gBAChBrJ,GAAG;YACP;;8BACI,oBAAC3F,yBAAUA;oBAAC+Q,SAAQ;oBAAKY,YAAY;8BAAC;;8BAGtC,qBAAC5R,qBAAMA;oBACHgR,SAAQ;oBACRnB,OAAM;oBACNkB,SAASnJ;oBACTiK,UAAU1L;oBACV2L,yBAAW,oBAACnR,uBAASA;oBACrBiC,IAAI;wBAAEmP,IAAI;oBAAE;;wBACf;wBAEI5L,8BACG,oBAAC/F,+BAAgBA;4BACb4D,MAAM;4BACNpB,IAAI;gCACAiN,OAAO;gCACPmC,IAAI;4BACR;;;;;;IAMxB;IAEA,oCAAoC;IACpC,IAAIC;IACJ,IAAI9L,cAAc;QACd8L,wBACI,qBAAClS,kBAAGA;YAAC6C,IAAI;gBACLmM,SAAS;gBACTqC,eAAe;gBACfpC,YAAY;gBACZC,gBAAgB;gBAChBjN,QAAQ;gBACR4D,GAAG;YACP;;8BACI,oBAACxF,+BAAgBA;8BACjB,oBAACH,yBAAUA;oBAAC+Q,SAAQ;oBAAQpO,IAAI;wBAAEmP,IAAI;oBAAE;8BAAG;;;;IAGvD,OAAO,IAAIxL,OAAO;QACd0L,wBACI,qBAAC/R,oBAAKA;YAACgS,UAAS;YAAQtP,IAAI;gBAAEuP,GAAG;YAAE;;8BAC/B,oBAAClS,yBAAUA;oBAAC+Q,SAAQ;8BAASzK;;8BAC7B,oBAACvG,qBAAMA;oBACHgR,SAAQ;oBACRnB,OAAM;oBACNkB,SAASnJ;oBACTkK,yBAAW,oBAACzQ,sBAAWA;oBACvBuB,IAAI;wBAAEmP,IAAI;oBAAE;8BACf;;;;IAKb,OAAO;QACHE,UAAUd;IACd;IAEA/R,mBAASA,CAAC;QACN,IAAGyD,UAAS;YACR+E;QACJ;IACJ,GAAG;QAAC/E;KAAS;IACb,OAAO;IACP,qBACI,oBAAC9C,kBAAGA;QAACqC,KAAKA;QAAKQ,IAAIA;QAAID,OAAOA;kBACzBsP;;AAGb;AAEA,qBAAqB;AACrB,MAAMG,6BAAe7S,oBAAUA,CAAC4C;AAChCiQ,aAAaC,WAAW,GAAG;AAEH;;;;;;;;;;;;;;;;;;;;;;;;;ACn1C4C;AACvC;AAqD7B;;;CAGC,GACM,eAAeG,qBAAqBC,IAA+C;IACtF,MAAMC,MAAM,MAAMJ,2BAAOA,CAA2BC,cAAGA,CAACI,IAAI,EAAEJ,cAAGA,CAACK,kBAAkB,EAAEH,KAAKI,MAAM,EAAEJ,KAAKK,OAAO,EAAEL,KAAKM,OAAO;IAC7H,OAAOL;AACX;;;AC7DoE;AACvC;AAgC7B;;;CAGC,GACM,eAAeM,sBAAsBP,IAAgD;IACxF,MAAMC,MAAM,MAAMJ,2BAAOA,CAA4BC,cAAGA,CAACI,IAAI,EAAEJ,cAAGA,CAACU,mBAAmB,EAAER,KAAKI,MAAM,EAAEJ,KAAKK,OAAO,EAAEL,KAAKM,OAAO;IAC/H,OAAOL;AACX;;;;;;;;;;AC9BuB;AAC0D;AAU7D;AACgB;AACI;AACgB;AAElB;AACtC,MAAMmB,aAAa,IAAInS,eAAGA,CAAC,OAAO;AAElC,MAAMoS,kBAAkB,CAACC,OAAiB,iCAAiCC,IAAI,CAACD;AAChF,MAAME,kBAAkB,CAACF,OAAiB,WAAWC,IAAI,CAACD;AAQnD,SAASG,oBAAoB,KAAyD;QAAzD,EAAEC,IAAI,EAAEC,OAAO,EAAEC,YAAY,EAA4B,GAAzD;QAuBgEX;IAtBhG,MAAM9R,WAAWiS,WAAWhS,GAAG,CAAC,OAAO;IAEvC,MAAM,CAACyS,UAAUC,YAAY,GAAGjV,kBAAQA,CAAC;IACzC,MAAM,CAACkV,QAAQC,UAAU,GAAGnV,kBAAQA,CAAC;IACrC,MAAM,CAACoV,UAAUC,YAAY,GAAGrV,kBAAQA,CAAgB;IACxD,MAAM,CAACsV,oBAAoBC,sBAAsB,GAAGvV,kBAAQA,CAAiC,EAAE;IAE/F,iDAAiD;IACjDF,mBAASA,CAAC;QACN0V,QAAQtR,GAAG,CAAC,+BAA+BoR;IAC/C,GAAG;QAACA;KAAmB;IAEvB,uCAAuC;IACvCxV,mBAASA,CAAC;QACN0V,QAAQtR,GAAG,CAAC,qBAAqBkR;IACrC,GAAG;QAACA;KAAS;IACb,MAAM,CAACK,SAASC,WAAW,GAAG1V,kBAAQA,CAAC;IACvC,MAAM,CAAC2V,WAAWC,aAAa,GAAG5V,kBAAQA,CAAC;IAC3C,MAAM,CAAC6V,gBAAgBC,kBAAkB,GAAG9V,kBAAQA,CAAC;IAErD,MAAM,CAAC+V,eAAeC,iBAAiB,GAAGhW,kBAAQA,CAA+D;IACjH,MAAMiW,gBAAgBlW,gBAAMA,CAAC;IAC7B,MAAM,CAACmW,YAAY,GAAG5B,sCAAaA,CAACF,sBAAUA,CAAC+B,QAAQ,CAACC,QAAQ,EAAE,+BAA8BhC,8CAAAA,sBAAUA,CAAC+B,QAAQ,CAACC,QAAQ,CAACC,aAAa,cAA1CjC,kEAAAA,4CAA4CkC,YAAY;IACxJ,MAAM,CAACC,eAAe,GAAGjC,sCAAaA,CAACJ,gBAAIA,CAAC/L,IAAI,CAACqO,WAAW,EAAE,oBAAoB,CAAC,CAACtC,gBAAIA,CAAC/L,IAAI,CAACqO,WAAW,CAACC,gBAAgB;IAC1H,MAAM,CAACC,UAAU,GAAGpC,sCAAaA,CAACJ,gBAAIA,EAAE,6BAA6BA,gBAAIA,CAAC/L,IAAI,CAACwO,SAAS,CAACC,UAAU;IACnG9W,mBAASA,CAAC;QACN,IAAIoW,eAAeH,iBAAiB,CAACE,cAAc1R,OAAO,EAAE;YACxD0R,cAAc1R,OAAO,GAAG;YACxB,MAAMsS,cAAwC;gBAC1C,GAAGd,aAAa;gBAChBe,qBAAqBZ;gBACrBlB,UAAUe,CAAAA,0BAAAA,oCAAAA,cAAef,QAAQ,KAAI,EAAE;gBACvC+B,MAAMhB,CAAAA,0BAAAA,oCAAAA,cAAegB,IAAI,KAAI;YACjC;YACAC,eAAeH;QACnB;IACJ,GAAG;QAACX;QAAaH;KAAc;IAE/B,MAAMiB,iBAAiBnX,qBAAWA,CAAC,OAAO0T;QACtC,IAAI,CAACA,OAAOyB,QAAQ,IAAI,CAACzB,OAAOwD,IAAI,EAAE;YAClC5C,oBAAKA,CAAClN,KAAK,CAAC;YACZ;QACJ;QAEA2O,aAAa;QAEb,IAAI;gBAiBKqB;YAhBL,MAAM7D,MAAM,MAAMF,oBAAoBA,CAAC;gBACnCK;gBACAE,SAAS;oBAAEyD,UAAU;gBAAK;YAC9B;YAEA1B,QAAQtR,GAAG,CAAC,oBAAoBkP;YAEhC,SAAS;YACT,IAAIA,IAAI+D,GAAG,IAAI,CAAC/D,IAAIgE,SAAS,IAAI,CAAChE,IAAIiE,QAAQ,EAAE;oBACvBjE;gBAArB,MAAMkE,eAAelE,EAAAA,WAAAA,IAAI+D,GAAG,cAAP/D,+BAAAA,SAASqC,OAAO,KAAI;gBACzCtB,oBAAKA,CAAClN,KAAK,CAACqQ;gBACZ;YACJ;YAEA,YAAY;YACZ,MAAML,eAAe7D,IAAIjL,IAAI;YAC7B,IAAI,EAAC8O,yBAAAA,oCAAAA,qBAAAA,aAAc9O,IAAI,cAAlB8O,yCAAAA,mBAAoBM,OAAO,GAAE;oBACTN,qBAA2B7D;gBAAhD,MAAMkE,eAAeL,CAAAA,yBAAAA,oCAAAA,sBAAAA,aAAc9O,IAAI,cAAlB8O,0CAAAA,oBAAoBO,GAAG,OAAIpE,YAAAA,IAAIjL,IAAI,cAARiL,gCAAAA,UAAUoE,GAAG,KAAI;gBACjErD,oBAAKA,CAAClN,KAAK,CAACqQ;gBACZ;YACJ;YAEA,MAAMC,UAAkCN,aAAa9O,IAAI,CAACoP,OAAO;YAEjE,aAAa;YACb,MAAME,iBAAiBF,QAAQxL,MAAM,CAAC2L,CAAAA,IAAKA,EAAEC,WAAW,KAAK;YAC7D,MAAMC,cAAcL,QAAQxL,MAAM,CAAC2L,CAAAA,IAAKA,EAAEC,WAAW,KAAK,yBAAyBD,EAAEC,WAAW,KAAK;YACrG,MAAME,eAAeN,QAAQxL,MAAM,CAAC2L,CAAAA,IAAKA,EAAEC,WAAW,KAAK,aAAaD,EAAEC,WAAW,KAAK,yBAAyBD,EAAEC,WAAW,KAAK;YAErI,IAAIF,eAAetF,MAAM,GAAG,GAAG;gBAC3BgC,oBAAKA,CAAC2D,OAAO,CAAC,QAA8B,OAAtBL,eAAetF,MAAM,EAAC;gBAC5C4C,yBAAAA,mCAAAA;YACJ;YAEA,IAAI6C,YAAYzF,MAAM,GAAG,GAAG;gBACxB,MAAM4F,eAAeH,YAAY5L,GAAG,CAAC0L,CAAAA,IAAKA,EAAEF,GAAG,EAAEzL,MAAM,CAACiM,SAASC,IAAI,CAAC;gBACtE,IAAIF,cAAc;oBACd,4BAA4B;oBAC5B5D,wBAAKA,CAAC4D;gBACV;YACJ;YAEA,IAAIF,aAAa1F,MAAM,GAAG,GAAG;gBACzB,MAAM+F,gBAAgBL,aAAa7L,GAAG,CAAC0L,CAAAA,IAAKA,EAAEF,GAAG,EAAEzL,MAAM,CAACiM,SAASC,IAAI,CAAC;gBACxE,IAAIC,eAAe;oBACf/D,oBAAKA,CAAClN,KAAK,CAAC,YAA0B,OAAdiR;gBAC5B;YACJ;QACJ,EAAE,OAAOjR,OAAO;YACZuO,QAAQvO,KAAK,CAAC,4BAA4BA;YAC1CkN,oBAAKA,CAAClN,KAAK,CAAC;QAChB,SAAU;YACN2O,aAAa;QACjB;IACJ,GAAG;QAACb;KAAa;IAEjB,MAAMoD,iBAAiBtY,qBAAWA,CAAC;QAC/B,MAAMwC,SAASC,SAASC,GAAG,CAAC,OAAO;QACnCF,OAAO6B,GAAG,CAAC;QACX4R,kBAAkB;QAClB,MAAM1C,MAAsD,MAAMM,qBAAqBA,CAAC;YAAEH,QAAQ,CAAC;YAAGE,SAAS;gBAAEyD,UAAU;YAAK;QAAE;QAClI7U,OAAO6B,GAAG,CAAC,wBAAwB4D,KAAKC,SAAS,CAACqL;QAClD0C,kBAAkB;QAElB,IAAI1C,IAAI+D,GAAG,IAAI,CAAC/D,IAAIgE,SAAS,IAAI,CAAChE,IAAIiE,QAAQ,EAAE;gBACvBjE;YAArB,MAAMkE,eAAelE,EAAAA,WAAAA,IAAI+D,GAAG,cAAP/D,+BAAAA,SAASqC,OAAO,KAAI;YACzCtB,oBAAKA,CAAClN,KAAK,CAACqQ;YACZ/B,sBAAsB,EAAE;YACxBlT,OAAO4E,KAAK,CAAC,8BAA8BqQ;QAC/C,OAAO;gBAEWlE,gBAAAA;YADd,6BAA6B;YAC7B,MAAMgF,QAAQhF,EAAAA,YAAAA,IAAIjL,IAAI,cAARiL,iCAAAA,iBAAAA,UAAUjL,IAAI,cAAdiL,qCAAAA,eAAgBgF,KAAK,KAAI,EAAE;YACzC/V,OAAO6B,GAAG,CAAC,+BAA+B4D,KAAKC,SAAS,CAACqQ;YAEzD,+BAA+B;YAC/B,MAAMC,iBAAiBD,MAAMpM,GAAG,CAAC+K,CAAAA,OAAS;oBACtCuB,IAAIvB,KAAKwB,IAAI;oBACbC,MAAMzB,KAAKyB,IAAI;oBACfC,WAAW1B,KAAK0B,SAAS;gBAC7B;YAEAlD,sBAAsB8C;YAEtB,uBAAuB;YACvB,IAAIA,eAAelG,MAAM,GAAG,KAAK,CAACiD,UAAU;gBACxC,MAAMsD,cAAcL,cAAc,CAAC,EAAE,CAACG,IAAI;gBAC1CnW,OAAO6B,GAAG,CAAC,8BAA8BwU;gBACzCrD,YAAYqD;YAChB,OAAO,IAAIL,eAAelG,MAAM,KAAK,GAAG;gBACpC9P,OAAOsW,IAAI,CAAC;YAChB;QACJ;IACJ,GAAG,EAAE,GAAG,kBAAkB;IAE1B7Y,mBAASA,CAAC;QACN,IAAI+U,MAAM;YACNsD;QACJ,OAAO;YACHlD,YAAY;YACZE,UAAU;YACVE,YAAY;YACZE,sBAAsB,EAAE;YACxBG,WAAW;YACXE,aAAa;YACbI,iBAAiB;YACjBC,cAAc1R,OAAO,GAAG;QAC5B;IACJ,GAAG;QAACsQ;QAAMsD;KAAe;IAEzB,MAAMS,uBAAuB/Y,qBAAWA,CAAC;YAiCVuU;QAhC3B,MAAMyE,gBAAgB7D,SAAS8D,KAAK,CAAC,MAAM9M,GAAG,CAAC+M,CAAAA,IAAKA,EAAEC,IAAI,IAAIjN,MAAM,CAACgN,CAAAA,IAAKA;QAC1E,IAAIF,cAAc1G,MAAM,KAAK,GAAG;YAC5BgC,oBAAKA,CAAClN,KAAK,CAAC;YACZ;QACJ;QAEA,MAAMgS,oBAA2C,EAAE;QACnD,KAAK,MAAMC,SAASL,cAAe;YAC/B,IAAIrE,gBAAgB0E,QAAQ;gBACxB,MAAMnC,OAAOpC,gBAAgBuE,SAAS,WAAW;gBACjDD,kBAAkBE,IAAI,CAAC;oBAAEtU,UAAUqU;oBAAOE,cAAcrC;gBAAK;YACjE,OAAO;gBACH5C,oBAAKA,CAAClN,KAAK,CAAC,YAAkB,OAANiS,OAAM;gBAC9B;YACJ;QACJ;QAEA,IAAI,CAAC9D,YAAYA,SAAS4D,IAAI,OAAO,IAAI;YACrC7E,oBAAKA,CAAClN,KAAK,CAAC;YACZ;QACJ;QAEA2O,aAAa;QAEb,IAAI,CAACc,WAAW;YACZ,MAAM2C,cAAc,MAAMhF,8BAAWA,CAACiF,eAAe;YACrD,IAAI,CAACD,aAAa;gBACdzD,aAAa;gBACb;YACJ;QACJ;QAEA,MAAM2D,sBAAqBnF,8CAAAA,sBAAUA,CAAC+B,QAAQ,CAACC,QAAQ,CAACC,aAAa,cAA1CjC,kEAAAA,4CAA4CkC,YAAY;QACnF,MAAM/C,SAAgE;YAClEyB,UAAUiE;YACVlC,MAAM3B,SAAS4D,IAAI;YACnB9D,QAAQA,OAAO8D,IAAI;YACnBvD,SAASA,QAAQuD,IAAI;QACzB;QAEA,IAAIO,oBAAoB;YACpBtD,cAAc1R,OAAO,GAAG;YACxB,MAAMiV,YAAsC;gBACxC,GAAGjG,MAAM;gBACTuD,qBAAqByC;gBACrBvE,UAAUzB,OAAOyB,QAAQ,IAAI,EAAE;gBAC/B+B,MAAMxD,OAAOwD,IAAI,IAAI;YACzB;YACAC,eAAewC;QACnB,OAAO;YACHrF,wBAAKA,CAAC;YACN6B,iBAAiBzC;QACrB;IAEJ,GAAG;QAACyB;QAAUE;QAAQE;QAAUK;QAASuB;QAAgBT;KAAe;IAExE,qBACI,qBAAC3C,qBAAMA;QAACiB,MAAMA;QAAMC,SAAS,IAAMA;QAAW2E,UAAS;QAAKC,SAAS;;0BACjE,oBAAC3F,0BAAWA;0BAAC;;0BACb,oBAACD,4BAAaA;0BACV,mCAACrT,kBAAGA;oBAACkZ,WAAU;oBAAOrW,IAAI;wBAAEmP,IAAI;oBAAE;;sCAC9B,oBAACuB,wBAASA;4BACN4F,SAAS;4BACTC,QAAO;4BACPvB,IAAG;4BACHwB,OAAM;4BACN/C,MAAK;4BACL2C,SAAS;4BACTK,SAAS;4BACTC,MAAM;4BACNtI,SAAQ;4BACRuI,aAAY;4BACZC,OAAOlF;4BACPmF,UAAU,CAAC7P,IAAM2K,YAAY3K,EAAE8P,MAAM,CAACF,KAAK;4BAC3C3H,UAAUoD;;sCAEd,oBAAC3B,wBAASA;4BACN6F,QAAO;4BACPvB,IAAG;4BACHwB,OAAM;4BACN/C,MAAK;4BACL2C,SAAS;4BACThI,SAAQ;4BACRwI,OAAOhF;4BACPiF,UAAU,CAAC7P,IAAM6K,UAAU7K,EAAE8P,MAAM,CAACF,KAAK;4BACzC3H,UAAUoD;;sCAEd,oBAAC1B,2BAAYA;4BACToG,QAAQ;4BACR/B,IAAG;4BACHgC,SAAShF,mBAAmBtJ,GAAG,CAAC,CAACuO,SAAWA,OAAO/B,IAAI;4BACvD0B,OAAO9E,YAAY;4BACnB+E,UAAU,CAACK,OAAuBC;gCAC9BjF,QAAQtR,GAAG,CAAC,yBAAyBuW;gCACrCpF,YAAYoF;4BAChB;4BACAC,YAAYtF,YAAY;4BACxBuF,eAAe,CAACH,OAAOI,eAAezO;gCAClC,sEAAsE;gCACtE,IAAIA,WAAW,SAAS;oCACpBqJ,QAAQtR,GAAG,CAAC,2BAA2B0W;oCACvCvF,YAAYuF;gCAChB;4BACJ;4BACAC,aAAa;4BACbC,gBAAgB;4BAChBC,gBAAgB,CAAClF;4BACjBvS,IAAI;gCAAEmP,IAAI;gCAAGuI,IAAI;gCAAGvY,OAAO;4BAAO;4BAClCwY,aAAa,CAAC1H,uBACV,oBAACS,wBAASA;oCACL,GAAGT,MAAM;oCACVuG,OAAM;oCACNpI,SAAQ;oCACRgI,SAAS;oCACTwB,YAAY;wCACR,GAAG3H,OAAO2H,UAAU;wCACpBC,4BACI;;gDACKtF,+BAAiB,oBAAC/U,+BAAgBA;oDAACyP,OAAM;oDAAU7L,MAAM;qDAAS;gDAClE6O,OAAO2H,UAAU,CAACC,YAAY;;;oCAG3C;;4BAGRC,cAAc;gCACV/X,OAAO;oCACHgY,WAAW;oCACXjK,UAAU;gCACd;4BACJ;;sCAEJ,oBAAC4C,wBAASA;4BACN6F,QAAO;4BACPvB,IAAG;4BACHwB,OAAM;4BACN/C,MAAK;4BACL2C,SAAS;4BACTK,SAAS;4BACTC,MAAM;4BACNtI,SAAQ;4BACRuI,aAAY;4BACZC,OAAOzE;4BACP0E,UAAU,CAAC7P,IAAMoL,WAAWpL,EAAE8P,MAAM,CAACF,KAAK;4BAC1C3H,UAAUoD;;;;;0BAItB,qBAAC9B,4BAAaA;;kCACV,oBAACnT,qBAAMA;wBAAC+Q,SAAS,IAAMqD;wBAAWvC,UAAUoD;kCAAW;;kCACvD,oBAACjV,qBAAMA;wBAAC+Q,SAASmH;wBAAsBlH,SAAQ;wBAAYa,UAAUoD;kCAChEA,0BAAY,oBAAC7U,+BAAgBA;4BAAC4D,MAAM;6BAAS;;;;;;AAKlE;;;;;;AChW+C;AACH;AACA;AAGrC,SAAS6W;IACZ,MAAM,CAACC,eAAeC,iBAAiB,GAAGzb,kBAAQA,CAAC;IACnD,SAAS0b;QACL,MAAMC,SAAU;QAEhB,MAAM,EAACC,cAAc,EAAC,GAAGN,mCAAaA,CAACO,UAAU,CAAUF;QAC3DF,iBAAiB,OAAOG,kBAAkB,cAAc,QAAQA;IACpE;IACA9b,mBAASA,CAAC;QACN4b;IACJ,GAAG,EAAE;IAEL,qBACI,qBAACjb,kBAAGA;;0BACA,oBAACqb;0BAAK;;0BAAc,oBAACA;0BAAMN,gBAAgB,MAAM;;0BACjD,oBAACM;0BAAK,kCAACpb,qBAAMA;oBAAC+Q,SAASiK;8BAAS;;;;;AAG5C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtB6B;AACO;AAoCpC;;CAEC,GACM,eAAeK,+CACpB5I,IAA4D;IAE5D,OAAOH,2BAAOA,CACZC,cAAGA,CAACI,IAAI,EACRJ,cAAGA,CAAC+I,kCAAkC,EACtC7I,KAAKI,MAAM,EACXJ,KAAKK,OAAO,EACZL,KAAKM,OAAO;AAEhB;AAEA,OAAO;AACA,MAAMwI,wCAAwC;IACnDC,gCAAgCH;AAClC,EAAE;AAEF,wEAAeE,gDAAAA,qCAAqCA,EAAAA,EAAC;;;;;;;;AC1DW;AAazC;AAOM;AACkB;AACR;AAQnB;AACsB;AAE1C,SAAS;AACT,SAASqB,sBAAsB,KAQ9B;QAR8B,EAC7BC,UAAU,EACVC,SAAS,EACTC,eAAe,KAAK,EAKrB,GAR8B;QAiClBF,qCAAAA;IAxBX,MAAM,CAACG,oBAAoBC,sBAAsB,GAAG3d,kBAAQA,CAAC;IAE7D,MAAM4d,gBAAgB,OAAOC;QAC3B,IAAI,CAACL,WAAW;QAEhB,IAAI;YACFG,sBAAsB;YACtB,MAAMH,UAAUK;QAClB,SAAU;YACRF,sBAAsB;QACxB;IACF;IAEA,MAAMG,YAAY,IAAIC,KAAKR,WAAWS,UAAU,GAAG,QAAQ,IAAID;IAE/D,qBACE,qBAAC5B,mBAAIA;QAACzK,SAAQ;QAAWpO,IAAI;YAAE0X,IAAI;YAAGiD,SAASR,eAAe,MAAM;QAAE;;0BACpE,qBAACrB,0BAAWA;;kCACV,qBAAC3b,kBAAGA;wBAACgP,SAAQ;wBAAOC,YAAW;wBAASsL,IAAI;;0CAC1C,oBAACsB,qBAAMA;gCACL4B,KAAKX,WAAWY,SAAS,CAACC,UAAU;gCACpCC,KAAKd,WAAWY,SAAS,CAACG,YAAY;gCACtChb,IAAI;oCAAEb,OAAO;oCAAIC,QAAQ;oCAAI6b,IAAI;gCAAE;0CAElChB,EAAAA,qCAAAA,WAAWY,SAAS,CAACG,YAAY,cAAjCf,0DAAAA,sCAAAA,kCAAmC,CAAC,EAAE,cAAtCA,0DAAAA,oCAAwC5M,WAAW,OAAM;;0CAE5D,qBAAClQ,kBAAGA;gCAAC+d,UAAU;;kDACb,oBAAC7d,yBAAUA;wCAAC+Q,SAAQ;kDACjB6L,WAAWY,SAAS,CAACG,YAAY,IAAI;;kDAKxC,oBAAC3d,yBAAUA;wCAAC+Q,SAAQ;wCAAQnB,OAAM;wCAAiBjN,IAAI;4CAAEmP,IAAI;wCAAI;kDAC9DwK,kDAAmBA,CAACM,WAAWkB,UAAU,GAAG,MAAM;4CACjDC,WAAW;4CACXC,QAAQzB,iBAAIA;wCACd;;;;0CAGJ,oBAACzc,kBAAGA;gCAACme,WAAU;0CACb,kCAACrC,mBAAIA;oCACH7X,MAAK;oCACLma,oBAAM,oBAAC/B,yBAAcA;wCAACtM,UAAS;;oCAC/BsJ,OAAOgE,YAAY,QAAQ,GAGxB,OAH2Bb,kDAAmBA,CAACM,WAAWS,UAAU,GAAG,MAAM;wCAC9EU,WAAW;wCACXC,QAAQzB,iBAAIA;oCACd;oCACA3M,OAAOuN,YAAY,UAAU;oCAC7BpM,SAAQ;;;;;oBAKb6L,WAAW9H,OAAO,kBACjB,qBAAC9U,yBAAUA;wBAAC+Q,SAAQ;wBAAQnB,OAAM;wBAAiBjN,IAAI;4BAAEmP,IAAI;4BAAGuI,IAAI;wBAAE;;4BAAG;4BAChEuC,WAAW9H,OAAO;;;kCAI7B,oBAAC9U,yBAAUA;wBAAC+Q,SAAQ;wBAAQnB,OAAM;wBAAUjN,IAAI;4BAAEmN,YAAY;wBAAS;kCAAG;;;;YAK3E,CAACqN,2BACA,qBAACzB,0BAAWA;gBAAC/Y,IAAI;oBAAEqM,gBAAgB;oBAAYmP,IAAI;gBAAE;;kCACnD,oBAACpe,qBAAMA;wBACLgE,MAAK;wBACL6L,OAAM;wBACNiC,yBAAW,oBAACoK,oBAASA;wBACrBnL,SAAS,IAAMmM,cAAc;wBAC7BrL,UAAUkL,gBAAgBC;kCAC3B;;kCAGD,oBAAChd,qBAAMA;wBACLgE,MAAK;wBACL6L,OAAM;wBACNmB,SAAQ;wBACRc,yBAAW,oBAACkK,oBAASA;wBACrBjL,SAAS,IAAMmM,cAAc;wBAC7BrL,UAAUkL,gBAAgBC;kCAC3B;;;;;;AAOX;AAEA,MAAMqB,yBAAmC;IACvC,MAAM,CAACpJ,WAAWC,aAAa,GAAG5V,kBAAQA,CAAU;IACpD,MAAM,CAACiH,OAAOC,SAAS,GAAGlH,kBAAQA,CAAgB;IAClD,MAAM,CAACgf,aAAaC,eAAe,GAAGjf,kBAAQA,CAA2B,EAAE;IAC3E,MAAM,CAACyd,cAAcyB,gBAAgB,GAAGlf,kBAAQA,CAAU;IAE1D,WAAW;IACX,MAAM,CAAC0W,UAAU,GAAGpC,sCAAaA,CAACJ,gBAAIA,EAAE,6BAA6BA,gBAAIA,CAAC/L,IAAI,CAACwO,SAAS,CAACC,UAAU;IAEnG,cAAc;IACd,MAAMuI,yBAAyBtf,qBAAWA,CAAC;QACzC,IAAI,CAAC6W,WAAW;YACduI,eAAe,EAAE;YACjB;QACF;QAEArJ,aAAa;QACb1O,SAAS;QAET,IAAI;gBAKmCkM;YAJrC,MAAMA,MAAM,MAAM6I,qCAAqCA,CAACC,8BAA8B,CAAC;gBACrF3I,QAAQ,CAAC;YACX;YAEA,IAAIH,IAAIgE,SAAS,IAAIhE,IAAIiE,QAAQ,MAAIjE,YAAAA,IAAIjL,IAAI,cAARiL,gCAAAA,UAAUgM,KAAK,GAAE;gBACpDH,eAAe7L,IAAIjL,IAAI,CAAC6W,WAAW,IAAI,EAAE;YAC3C,OAAO;oBACI5L;gBAATlM,SAASkM,EAAAA,aAAAA,IAAIjL,IAAI,cAARiL,iCAAAA,WAAUoE,GAAG,KAAI;YAC5B;QACF,EAAE,OAAOL,KAAK;YACZ3B,QAAQvO,KAAK,CAAC,gBAAgBkQ;YAC9BjQ,SAAS;QACX,SAAU;YACR0O,aAAa;QACf;IACF,GAAG;QAACc;KAAU,GAAG,sBAAsB;IAEvC,OAAO;IACP,MAAM2I,wBAAwBxf,qBAAWA,CAAC,OAAOyf,cAAsBzB;QACrE,IAAI;gBAOsCzK;YANxC8L,gBAAgB;YAEhB,MAAM9L,MAAM,MAAM+J,2DAA8BA,CAACoC,eAAe,CAAC;gBAC/DhM,QAAQ;oBAAEiM,eAAeF;oBAAczB;gBAAO;YAChD;YAEA,IAAI,CAACzK,IAAIgE,SAAS,IAAI,CAAChE,IAAIiE,QAAQ,IAAI,GAACjE,YAAAA,IAAIjL,IAAI,cAARiL,gCAAAA,UAAUgM,KAAK,GAAE;oBACvChM;gBAAhB,MAAM,IAAIlL,MAAMkL,EAAAA,aAAAA,IAAIjL,IAAI,cAARiL,iCAAAA,WAAUoE,GAAG,KAAI;YACnC;YAEA,eAAe;YACfyH,eAAe9a,CAAAA,OAAQA,KAAK4H,MAAM,CAAC0T,CAAAA,SAAUA,OAAOD,aAAa,KAAKF;YAEtE,aAAa;YACbjC,yBAAQA,CAACqC,UAAU,CAACC,IAAI,CAACvC,8BAAaA,CAACwC,iBAAiB;QAE1D,EAAE,OAAOzI,KAAK;YACZ3B,QAAQvO,KAAK,CAAC,WAAWkQ;YACzBjQ,SAASiQ,eAAejP,QAAQiP,IAAI1B,OAAO,GAAG;QAChD,SAAU;YACRyJ,gBAAgB;QAClB;IACF,GAAG,EAAE;IAEL,aAAa;IACbpf,mBAASA,CAAC;QACR0V,QAAQtR,GAAG,CAAC,+CAA+CwS;QAC3D,IAAIA,WAAW;YACb,gBAAgB;YAChByI;QACF,OAAO;YACL,WAAW;YACXF,eAAe,EAAE;QACnB;IACF,GAAG;QAACvI;KAAU,GAAG,eAAe;IAEhC,aAAa;IACb5W,mBAASA,CAAC;QACR,MAAM+f,cAAcxC,yBAAQA,CAACqC,UAAU,CAACI,WAAW,CAAC1C,8BAAaA,CAACwC,iBAAiB,EAAE;YACnFpK,QAAQtR,GAAG,CAAC;YACZib;QACF;QAEA,OAAOU;IACT,GAAG;QAACV;KAAuB,GAAG,6BAA6B;IAE3D,mBAAmB;IACnB,IAAI,CAACzI,WAAW;QACd,OAAO;IACT;IAEA,IAAIf,WAAW;QACb,qBACE,oBAAClV,kBAAGA;YAACgP,SAAQ;YAAOqC,eAAc;YAASpC,YAAW;YAASpJ,GAAG;;IAOtE;IAEA,IAAIW,OAAO;QACT,qBACE,oBAACxG,kBAAGA;YAAC6F,GAAG;sBACN,kCAAC1F,oBAAKA;gBAACgS,UAAS;0BACb3L;;;IAIT;IAEA,IAAI+X,YAAY7M,MAAM,KAAK,GAAG;QAC5B,qBACE,oBAAC1R,kBAAGA;YACFgP,SAAQ;YACRqC,eAAc;YACdpC,YAAW;YACXpJ,GAAG;YACHsY,WAAU;;IAQhB;IAEA,qBACE,qBAACne,kBAAGA;QAAC6F,GAAG;;0BACN,qBAAC7F,kBAAGA;gBAACgP,SAAQ;gBAAOC,YAAW;gBAASsL,IAAI;;kCAC1C,oBAACgC,4BAAiBA;wBAACzM,OAAM;wBAAUjN,IAAI;4BAAEib,IAAI;wBAAE;;kCAC/C,qBAAC5d,yBAAUA;wBAAC+Q,SAAQ;wBAAKnB,OAAM;;4BAAU;4BAC9ByO,YAAY7M,MAAM;4BAAC;;;;;0BAIhC,oBAACqK,oBAAKA;gBAACxK,SAAS;0BACbgN,YAAYhT,GAAG,CAAC,CAACuR,2BAChB,oBAACD;wBAECC,YAAYA;wBACZC,WAAW,CAACK,SAAWwB,sBAAsB9B,WAAWiC,aAAa,EAAE3B;wBACvEJ,cAAcA;uBAHTF,WAAWiC,aAAa;;;;AASzC;AAEA,oFAAeT,sBAAsBA,EAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/R8F;;;;;;ACA/E;AAkB9B;AASM;AACiG;AACQ;AAC7F;AACP;AAC+B;AAEjE,MAAMgD,uBAAuB;AAe7B,MAAMC,wBAAwB;IAC1B;QAAE1J,IAAI;QAAcE,MAAM;IAAO;IACjC;QAAEF,IAAI;QAAgBE,MAAM;IAAO;IACnC;QAAEF,IAAI;QAAeE,MAAM;IAAK;CACnC;AAED,MAAMyJ,qBAKD;QAAC,EAAEpE,MAAM,EAAEqE,QAAQ,EAAEC,QAAQ,EAAEC,SAAS,EAAE;IAC3C,MAAM,EAAEC,UAAU,EAAEC,SAAS,EAAEC,UAAU,EAAEC,SAAS,EAAEC,UAAU,EAAEC,UAAU,EAAE,GAAGhB,oCAAWA,CAAC;QAAEpJ,IAAIuF,OAAOvF,EAAE;IAAC;IAE7G,MAAMjV,QAAQ;QACVmf,WAAWZ,yBAAGA,CAACe,SAAS,CAACtW,QAAQ,CAACmW;QAClCC;QACAxE,SAASyE,aAAa,MAAM;QAC5BE,QAAQF,aAAa,IAAI;IAC7B;IAEA,qBACI,qBAAC1C,oBAAKA;QACFld,KAAKyf;QACLlf,OAAOA;QACPwf,WAAWH,aAAa,IAAI;QAC5Bpf,IAAI;YACAgD,GAAG;YACH0U,IAAI;YACJvL,SAAS;YACTC,YAAY;YACZ6B,KAAK;YACLuR,QAAQJ,aAAa,aAAa;YAClCK,YAAY,aAA6D,OAAhDlF,OAAO9G,IAAI,KAAK,UAAU,YAAY;QACnE;;0BAEA,oBAACtW,kBAAGA;gBAAE,GAAG4hB,UAAU;gBAAG,GAAGC,SAAS;gBAAEhf,IAAI;oBAAEmM,SAAS;oBAAQC,YAAY;gBAAS;0BAC5E,kCAACgR,4BAAiBA;;0BAGtB,oBAACjgB,kBAAGA;gBAAC6C,IAAI;oBAAEkb,UAAU;gBAAE;0BACnB,mCAAC/d,kBAAGA;oBAAC6C,IAAI;wBAAEmM,SAAS;wBAAQC,YAAY;wBAAU6B,KAAK;wBAAGyJ,IAAI;oBAAE;;sCAC5D,oBAACra,yBAAUA;4BAAC+Q,SAAQ;sCACfmM,OAAO9G,IAAI,KAAK,UAAU,OAAO;;sCAEtC,oBAAC/C,wBAASA;4BACNtP,MAAK;4BACLqS,MAAK;4BACL+C,OAAM;4BACNI,OAAO2D,OAAOmF,QAAQ;4BACtB7I,UAAU,CAAC7P,IAAM4X,SAASrE,OAAOvF,EAAE,EAAE;oCAAE0K,UAAUC,SAAS3Y,EAAE8P,MAAM,CAACF,KAAK,EAAE,OAAO;gCAAE;4BACnF5W,IAAI;gCAAEb,OAAO;4BAAI;;wBAGpBob,OAAO9G,IAAI,KAAK,yBACb,qBAACsJ,0BAAWA;4BAAC3b,MAAK;4BAAQpB,IAAI;gCAAE4f,UAAU;4BAAI;;8CAC1C,oBAAC3C,yBAAUA;8CAAC;;8CACZ,oBAACC,qBAAMA;oCACHtG,OAAO2D,OAAOsF,UAAU,IAAI;oCAC5BrJ,OAAM;oCACNK,UAAU,CAAC7P,IAAM4X,SAASrE,OAAOvF,EAAE,EAAE;4CAAE6K,YAAY7Y,EAAE8P,MAAM,CAACF,KAAK;wCAAC;oCAClEkJ,8BACI,oBAAChD,sBAAOA;wCAACzO,OAAM;kDACX,kCAAC9Q,yBAAUA;4CACP6D,MAAK;4CACL+M,SAAS,IAAM2Q,UAAUvE,OAAOsF,UAAU;4CAC1C7f,IAAI;gDAAEib,IAAI;4CAAE;sDAEZ,kCAACuC,wBAASA;gDAACtQ,UAAS;;;;8CAK/BwR,sBAAsBhW,GAAG,CAAC,CAACqX,sBACxB,oBAAC/C,uBAAQA;4CAAgBpG,OAAOmJ,MAAM/K,EAAE;sDACnC+K,MAAM7K,IAAI;2CADA6K,MAAM/K,EAAE;;;;;;;0BAU/C,oBAACzX,yBAAUA;gBAAC4Q,SAAS,IAAM0Q,SAAStE,OAAOvF,EAAE;gBAAG5T,MAAK;gBAAQ6L,OAAM;0BAC/D,kCAACsQ,qBAAMA;;;;AAIvB;AAEA,MAAMyC,kBAA4B;IAC9B,MAAM,CAACC,QAAQC,UAAU,GAAGxjB,kBAAQA,CAAwB;IAC5D,MAAM,CAACyjB,UAAUC,YAAY,GAAG1jB,kBAAQA,CAAC;IACzC,MAAM,CAAC0iB,YAAYiB,cAAc,GAAG3jB,kBAAQA,CAAC;IAE7C,MAAM4jB,iBAAiB/jB,qBAAWA,CAC9BgiB,mBAAQA,CAAC,CAACgC;QACN/B,6BAAgBA,CAACgC,KAAK,CAAC/B,sBAAsB8B;IACjD,GAAG,MACH,EAAE;IAGN,MAAME,UAAUzC,+BAAUA,CACtBD,8BAASA,CAACD,8BAAaA,EAAE;QACrB4C,sBAAsB;YAClBC,UAAU;QACd;IACJ,IACA5C,8BAASA,CAACF,+BAAcA,EAAE;QACtB+C,kBAAkBzC,gDAA2BA;IACjD;IAGJ,2BAA2B;IAC3B7hB,eAAe,CAAC;QACZ,MAAMukB,aAAa;YACf,MAAMC,eAAe,MAAMtC,6BAAgBA,CAACuC,IAAI,CAAiBtC;YACjE,IAAIqC,cAAc;gBACd,8BAA8B;gBAC9B,MAAME,iBAAiBF,aAAaG,OAAO,CAACvY,GAAG,CAAC,CAAC6R,SAAY;wBACzD,GAAGA,MAAM;wBACTvF,IAAIuF,OAAOvF,EAAE,IAAI,UAAkD,OAAxCkM,KAAKC,MAAM,GAAGpY,QAAQ,CAAC,IAAIqY,MAAM,CAAC,GAAG;oBACpE;gBACAlB,UAAU;oBACN,GAAGY,YAAY;oBACfG,SAASD;gBACb;YACJ,OAAO;gBACH,iBAAiB;gBACjBd,UAAU;oBACNmB,SAAS;oBACTJ,SAAS,EAAE;oBACXK,iBAAiB;gBACrB;YACJ;QACJ;QACAT;IACJ,GAAG,EAAE;IAEL,MAAMU,eAAehlB,qBAAWA,CAC5B,CAACilB;QACGtB,UAAU,CAACrf;YACP,IAAI,CAACA,MAAM,OAAO;YAClB,MAAM0f,YAAY;gBAAE,GAAG1f,IAAI;gBAAE,GAAG2gB,OAAO;YAAC;YACxClB,eAAeC;YACf,OAAOA;QACX;IACJ,GACA;QAACD;KAAe;IAGpB,MAAMmB,sBAAsB,CAACvK;QACzBqK,aAAa;YAAEF,SAASnK,MAAMJ,MAAM,CAAC4K,OAAO;QAAC;IACjD;IAEA,MAAMC,kBAAkB,CAAClO;QACrB,MAAMmO,YAA4B;YAC9B5M,IAAI,UAAqB,OAAXyF,KAAKoH,GAAG;YACtBpO;YACAiM,UAAU;YACV,GAAIjM,SAAS,WAAW;gBAAEoM,YAAYnB,qBAAqB,CAAC,EAAE,CAAC1J,EAAE;YAAC,CAAC;QACvE;QACAuM,aAAa;YACTN,SAAS;mBAAKhB,CAAAA,mBAAAA,6BAAAA,OAAQgB,OAAO,KAAI,EAAE;gBAAGW;aAAU;QACpD;IACJ;IAEA,MAAME,qBAAqB,CAAC9M,IAAYwM;QACpC,IAAI,CAACvB,QAAQ;QACbsB,aAAa;YACTN,SAAShB,OAAOgB,OAAO,CAACvY,GAAG,CAAC,CAAC6R,SACzBA,OAAOvF,EAAE,KAAKA,KAAK;oBAAE,GAAGuF,MAAM;oBAAE,GAAGiH,OAAO;gBAAC,IAAIjH;QAEvD;IACJ;IAEA,MAAMwH,qBAAqB,CAAC/M;QACxB,IAAI,CAACiL,QAAQ;QACbsB,aAAa;YACTN,SAAShB,OAAOgB,OAAO,CAACxY,MAAM,CAAC,CAAC8R,SAAWA,OAAOvF,EAAE,KAAKA;QAC7D;IACJ;IAEA,MAAMgN,gBAAgB,CAAC9K;QACnB,MAAM,EAAE+K,MAAM,EAAEC,IAAI,EAAE,GAAGhL;QACzB,IAAI,CAAC+I,UAAU,CAACiC,QAAQD,OAAOjN,EAAE,KAAKkN,KAAKlN,EAAE,EAAE;QAE/C,MAAMmN,WAAWlC,OAAOgB,OAAO,CAACmB,SAAS,CAAC,CAACC,IAAMA,EAAErN,EAAE,KAAKiN,OAAOjN,EAAE;QACnE,MAAMsN,WAAWrC,OAAOgB,OAAO,CAACmB,SAAS,CAAC,CAACC,IAAMA,EAAErN,EAAE,KAAKkN,KAAKlN,EAAE;QAEjE,IAAImN,aAAa,CAAC,KAAKG,aAAa,CAAC,GAAG;YACpCf,aAAa;gBACTN,SAAShD,kCAASA,CAACgC,OAAOgB,OAAO,EAAEkB,UAAUG;YACjD;QACJ;IACJ;IAEA,MAAMC,qBAAqB,CAAC1C;QACxB,IAAI,CAACA,YAAY;QACjB,MAAMxH,SAAS,iEAA4E,OAAXwH,YAAW;QAC3F7H,mCAAaA,CAACO,UAAU,CAACF;IAC7B;IAEA,IAAI,CAAC4H,QAAQ;QACT,qBAAO,oBAAC9iB,kBAAGA;sBAAC;;IAChB;IAEA,qBACI,qBAACA,kBAAGA;QAAC6C,IAAI;YAAE0X,IAAI;QAAE;;0BAEb,qBAACgF,oBAAKA;gBACF6C,WAAW;gBACXvf,IAAI;oBACAgD,GAAG;oBACHmJ,SAAS;oBACTC,YAAY;oBACZC,gBAAgB;oBAChBW,cAAc;gBAClB;;kCAEA,qBAAC7P,kBAAGA;wBAAC6C,IAAI;4BAAEmM,SAAS;4BAAQC,YAAY;4BAAU6B,KAAK;wBAAE;;0CACrD,oBAAC5Q,yBAAUA;gCAAC+Q,SAAQ;0CAAY;;0CAChC,oBAACyO,+BAAgBA;gCACb2F,uBACI,oBAAC/F,qBAAMA;oCACHiF,SAASzB,OAAOoB,OAAO;oCACvBxK,UAAU4K;oCACVxU,OAAM;;gCAGduJ,OAAOyJ,OAAOoB,OAAO,GAAG,QAAQ;;;;kCAIxC,oBAACjkB,qBAAMA;wBACHgR,SAAQ;wBACRhN,MAAK;wBACL8N,WAAWiR,yBAAW,oBAAC9C,yBAAUA,sBAAM,oBAACC,uBAAQA;wBAChDnP,SAAS,IAAMiS,YAAY,CAACD;kCAE3BA,WAAW,SAAS;;;;0BAK7B,oBAACxD,uBAAQA;gBAAC8F,IAAItC;0BACV,mCAACzD,oBAAKA;oBACF6C,WAAW;oBACXvf,IAAI;wBACAmP,IAAI;wBACJnM,GAAG;wBACH0f,QAAQ;wBACR3T,aAAa;wBACb/B,cAAc;oBAClB;;sCAEA,qBAAC7P,kBAAGA;4BAAC6C,IAAI;gCAAE0X,IAAI;4BAAE;;8CACb,oBAACra,yBAAUA;oCAAC+Q,SAAQ;oCAAYY,YAAY;8CAAC;;8CAG7C,oBAAC0B,wBAASA;oCACN0F,SAAS;oCACT3C,MAAK;oCACLmD,OAAOqJ,OAAOqB,eAAe;oCAC7BzK,UAAU,CAAC7P,IACPua,aAAa;4CAAED,iBAAiB3B,SAAS3Y,EAAE8P,MAAM,CAACF,KAAK,EAAE,OAAO;wCAAE;oCAEtExV,MAAK;oCACLwW,YAAY;wCACRC,4BACI,oBAACxa,yBAAUA;4CAAC+Q,SAAQ;4CAAQpO,IAAI;gDAAEoP,IAAI;4CAAE;sDAAG;;oCAInD;;;;sCAIR,oBAACwN,sBAAOA;4BAAC5c,IAAI;gCAAE2iB,IAAI;4BAAE;;sCAErB,qBAACxlB,kBAAGA;4BAAC6C,IAAI;gCAAE0X,IAAI;4BAAE;;8CACb,qBAACva,kBAAGA;oCAAC6C,IAAI;wCAAEmM,SAAS;wCAAQE,gBAAgB;wCAAiBD,YAAY;wCAAUsL,IAAI;oCAAE;;sDACrF,qBAACra,yBAAUA;4CAAC+Q,SAAQ;;gDAAY;gDACrB6R,OAAOgB,OAAO,CAACpS,MAAM;gDAAC;;;sDAEjC,qBAACqK,oBAAKA;4CAAC0J,WAAU;4CAAMlU,SAAS;;8DAC5B,oBAACtR,qBAAMA;oDACHgR,SAAQ;oDACRhN,MAAK;oDACL8N,yBAAW,oBAAC7Q,2BAAYA;oDACxB8P,SAAS,IAAMwT,gBAAgB;8DAClC;;8DAGD,oBAACvkB,qBAAMA;oDACHgR,SAAQ;oDACRhN,MAAK;oDACL8N,yBAAW,oBAACwO,wBAAaA;oDACzBvP,SAAS,IAAMwT,gBAAgB;8DAClC;;;;;;gCAMR1B,OAAOgB,OAAO,CAACpS,MAAM,KAAK,kBACvB,oBAAC6N,oBAAKA;oCACFtO,SAAQ;oCACRpO,IAAI;wCACAgD,GAAG;wCACHsY,WAAW;wCACXrO,OAAO;oCACX;8CAEA,kCAAC5P,yBAAUA;kDAAC;;mDAGhB,oBAACsgB,2BAAUA;oCACP8C,SAASA;oCACToC,oBAAoBjF,8BAAaA;oCACjCkF,aAAa,IAAMzC,cAAc;oCACjC0C,WAAW,CAAC/b;wCACRqZ,cAAc;wCACd2B,cAAchb;oCAClB;oCACAgc,cAAc,IAAM3C,cAAc;8CAElC,kCAACnC,oCAAeA;wCACZ+E,OAAOhD,OAAOgB,OAAO,CAACvY,GAAG,CAAC,CAAC2Z,IAAMA,EAAErN,EAAE;wCACrCkO,UAAU7E,gDAA2BA;kDAErC,kCAAClhB,kBAAGA;4CAAC6C,IAAI;gDAAE2a,SAASyE,aAAa,MAAM;4CAAE;sDACpCa,OAAOgB,OAAO,CAACvY,GAAG,CAAC,CAAC6R,uBACjB,oBAACoE;oDAEGpE,QAAQA;oDACRqE,UAAUkD;oDACVjD,UAAUkD;oDACVjD,WAAWyD;mDAJNhI,OAAOvF,EAAE;;;;;;;;;;;AAgB9D;AAEA,wDAAegL,eAAeA,EAAC;;;;;;AClZmC;AACtB;AACM;AAElD,gCAAgC;AACN;AACwD;AAe3E,SAASoD,cAAc,KAAkC;QAAlC,EAAE3P,IAAI,EAAE4P,IAAI,EAAsB,GAAlC;IAC5B,MAAMC,MAAM,cAAsBD,OAAR5P,MAAK,KAAQ,OAAL4P,MAAK;IACvC,MAAM,CAACE,WAAWC,aAAa,GAAG9mB,kBAAQA,CAAC4mB;IAE3C,MAAM,CAAC/R,MAAMkS,QAAQ,GAAG/mB,kBAAQA,CAAC;IACjC,SAAS8U;QACPiS,QAAQ;IACV;IAEAjnB,mBAASA,CAAC;QACRgnB,aAAa,cAAsBH,OAAR5P,MAAK,KAAQ,OAAL4P,MAAK;IAC1C,GAAG;QAAC5P;QAAM4P;KAAK;IAEf7mB,mBAASA,CAAC;QACR,MAAMknB,MAAmB;YAACC,OAAM;YAAOC,cAAa;QAAC;QACrD,MAAM9T,MAAM0O,6BAAgBA,CAACuC,IAAI,CAAe,WAAgB,OAALtN,OAAQiQ;QACnE,MAAM9M,QAAqB9G,OAAO,WAAWA,MAAMA,MAAM4T;QACzD,IAAG,CAACP,qCAAeA,EAAC;YAClB;QACF;QACA,IAAGvM,MAAM+M,KAAK,EAAC;YACb;QACF;QACA,IAAG/M,MAAMgN,YAAY,IAAIhN,MAAMgN,YAAY,IAAI,KAAMhN,MAAMgN,YAAY,GAAG,IAAI,KAAK,KAAK,KAAK,OAAOnJ,KAAKoH,GAAG,IAAG;YAC7G;QACF;QACA4B,QAAQ;IACV,GAAG,EAAE;IAELjnB,mBAASA,CAAC;QACR,MAAMqnB,gBAAgB,CAAC3M;gBAGA4M;YAFrB,gFAAgF;YAChF,wCAAwC;YACxC,IAAI5M,MAAM6M,MAAM,OAAKD,qBAAAA,UAAU7iB,OAAO,cAAjB6iB,yCAAAA,mBAAmBE,aAAa,GAAE;gBACrD;YACF;YAEA,MAAM,EAAEC,MAAM,EAAEN,KAAK,EAAE,GAAGzM,MAAMrS,IAAI;YAEpC,IAAIof,WAAW,gBAAgB;gBAC7B/R,QAAQtR,GAAG,CAAC,8BAA6D,OAA/B+iB,QAAQ,WAAW;gBAE7D,MAAM/M,QAAqB;oBACzB+M;oBACAC,cAAcD,QAAQ,IAAIlJ,KAAKoH,GAAG;gBACpC;gBACArD,6BAAgBA,CAACgC,KAAK,CAAC,WAAgB,OAAL/M,OAAQmD;gBAC1C,MAAMsN,IAAI,wEACmEtN,OAAhBA,MAAM+M,KAAK,EAAC,MAAuB,OAAnB/M,MAAMgN,YAAY,EAAC;gBAGhG5L,mCAAaA,CAACO,UAAU,CAAC2L;gBAEzB,mBAAmB;gBACnB1S;YACF;QACF;QAEA2S,OAAOC,gBAAgB,CAAC,WAAWP;QAEnC,OAAO;YACLM,OAAOE,mBAAmB,CAAC,WAAWR;QACxC;IACF,GAAG,EAAE;IAEL,MAAMC,YAAYxnB,YAAY,CAAoB;IAElD,qBACE,qBAACgU,qBAAMA;QACLiB,MAAMA;QACNC,SAASA;QACT8S,YAAY;YACVtkB,IAAI;gBACFb,OAAO;gBACPC,QAAQ;gBACR+W,UAAU;YACZ;QACF;;0BACA,oBAAC5Y,yBAAUA;gBACTgnB,cAAW;gBACXpW,SAASqD;gBACTxR,IAAI;oBACFsM,UAAU;oBACVQ,OAAO;oBACPF,KAAK;oBACLK,OAAOuX,CAAAA,QAASA,MAAMC,OAAO,CAACC,IAAI,CAAC,IAAI;gBACzC;0BACA,kCAACpL,oBAASA;;0BAEZ,oBAAC9I,4BAAaA;gBAACxQ,IAAI;oBAAE2kB,SAAS;oBAAG7W,UAAU;gBAAS;0BACjDyV,2BACC,oBAACqB;oBACCplB,KAAKskB;oBACLlJ,KAAK2I;oBACLxjB,OAAO;wBAAEZ,OAAO;wBAAQC,QAAQ;wBAAQsjB,QAAQ;oBAAO;oBACvDrU,OAAO,oBAA4BgV,OAAR5P,MAAK,KAAQ,OAAL4P;;;;;AAM/C;;;;AC1H4C;AACI;AACE;AAG3C,SAASwB,yBAAyB,KAAoB;QAApB,EAACpR,IAAI,EAAe,GAApB;IAErC,MAAM,CAAClC,MAAMkS,QAAQ,GAAG/mB,kBAAQA,CAAC;IACjC,SAAS8U;QACLiS,QAAQ;IACZ;IAEAjnB,mBAASA,CAAC;QACN,MAAMoa,QAAQ4H,6BAAgBA,CAACuC,IAAI,CAAC,WAAgB,OAALtN,OAAQ;QACvDvB,QAAQtR,GAAG,CAAC,oBAAoBgW,OAAO,OAAOA;IAClD,GAAG,EAAE;IACL,qBACI,oBAACwM,aAAaA;QAAC3P,MAAMA;QAAM4P,MAAK;;AAExC;;;;ACnBmD;AACuB;AAC3B;AAIxC,MAAMyB,gBAA0B;IACrC,MAAM,CAACC,WAAWC,aAAa,GAAGtoB,kBAAQA,CAAS;IACnD,MAAM,CAACuoB,cAAcC,gBAAgB,GAAGxoB,kBAAQA,CAAU;IAE1D,4DAA4D;IAE5D,SAASyoB;QAEP,IAAI;YACF,MAAM9M,SAAU;YAGhB,MAAM,EAAC+M,gBAAgB,EAAC,GAAGpN,mCAAaA,CAACO,UAAU,CAACF;YACpD,MAAM4M,eAAeG,qBAAqB;YAC1ClT,QAAQtR,GAAG,CAAC,4BAA4BqkB,cAAcG;YACtDF,gBAAgBD;QAClB,EAAE,OAAOthB,OAAO;YACduO,QAAQvO,KAAK,CAAC,4CAA4CA;QAC5D;IACF;IACAnH,mBAASA,CAAC;QACR2oB;IACF,GAAG,EAAE;IAEL,MAAME,qBAAqB;QACzB,MAAMC,iBAAiBC,WAAWR;QAClC,IAAIS,MAAMF,iBAAiB;YACzBG,MAAM;YACN;QACF;QACA,IAAI;YACF,8CAA8C;YAC9C,MAAMpN,SAAS,oEAAmF,OAAfiN,gBAAe;YAClGtN,mCAAaA,CAACO,UAAU,CAACF;YACzBoN,MAAM,WAA0B,OAAfH;QACnB,EAAE,OAAO3hB,OAAO;YACduO,QAAQvO,KAAK,CAAC,kCAAkCA;YAChD8hB,MAAM;QACR;IACF;IAEA,MAAMC,yBAAyB;QAC7B,IAAI;YACF,IAAIT,cAAc;gBAChB,MAAM5M,SAAU;gBAChBL,mCAAaA,CAACO,UAAU,CAACF;YAC3B,OAAO;gBACL,MAAMA,SAAU;gBAChBL,mCAAaA,CAACO,UAAU,CAACF;YAC3B;YACA8M;QACF,EAAE,OAAOxhB,OAAO;YACduO,QAAQvO,KAAK,CAAC,8BAA8BA;YAC5C8hB,MAAM;QACR;IACF;IAEA,qBACE,qBAAC/I,oBAAKA;QAAC6C,WAAW;QAAGvf,IAAI;YAAE2kB,SAAS;YAAGpO,QAAQ;QAAE;;0BAC/C,oBAAClZ,yBAAUA;gBAAC+Q,SAAQ;gBAAKY,YAAY;0BAAC;;0BAGtC,qBAAC7R,kBAAGA;gBAAC6C,IAAI;oBAAEmM,SAAS;oBAAQC,YAAY;oBAAU6B,KAAK;oBAAG0X,cAAc;gBAAE;;kCACxE,oBAACjV,wBAASA;wBACR8F,OAAM;wBACNpI,SAAQ;wBACRqF,MAAK;wBACLmD,OAAOmO;wBACPlO,UAAU,CAAC7P,IAAMge,aAAahe,EAAE8P,MAAM,CAACF,KAAK;wBAC5CxV,MAAK;;kCAEP,oBAAChE,qBAAMA;wBAACgR,SAAQ;wBAAYD,SAASkX;kCAAoB;;;;0BAI3D,oBAACjoB,qBAAMA;gBACLgR,SAAQ;gBACRnB,OAAOgY,eAAe,UAAU;gBAChC9W,SAASuX;gBACTtP,SAAS;0BAER6O,eAAe,SAAS;;;;AAIjC,EAAE;AAEF,mEAAeH,gDAAAA,aAAaA,EAAAA,EAAC;;;;AC7FkB;AACH;AAGrC,SAASc;IACZ,SAASzX;QACL,MAAMkK,SAAU;QAMhBL,mCAAaA,CAACO,UAAU,CAACF;IAC7B;IACA,qBACI,oBAAClb,kBAAGA;QAAC6C,IAAI;YAACmP,IAAG;YAAQuI,IAAG;QACxB;kBACI,kCAACta,qBAAMA;YAAC+Q,SAASA;sBAAS;;;AAKtC;;;;;;;;;ACtBoD;AACT;AACC;AACO;AAC+B;AAET;AAClB;AAC4C;AACnC;AAC8B;AACjB;AACF;AACnB;AAC3B;AACI;AAEjC,SAASiY;IACP,MAAM,CAACC,kBAAkBC,oBAAoB,GAAG5pB,kBAAQA,CAAC;IAEzD,qBACE,qBAACS,kBAAGA;QAAC6C,IAAI;YAAE2iB,IAAI;YAAG3f,GAAG;QAAE;;0BACrB,oBAAC6hB,wBAAwBA;gBAACpR,MAAK;;0BAE/B,oBAACgI,6CAAsBA;0BACvB,oBAACuE,iBAAeA;0BAEhB,oBAAC/H,kBAAkBA;0BACnB,oBAAC2N,iBAAiBA;0BAClB,qBAACI,oBAAKA;gBAAChY,SAAS;gBAACU,SAAS;gBAAG1O,IAAI;oBAAE0X,IAAI;gBAAE;;kCACvC,oBAACsO,oBAAKA;wBAAC5kB,MAAM;kCACX,kCAAChE,qBAAMA;4BAACgR,SAAQ;4BAAYD,SAAS,IAAMmY,oBAAoB;sCAAO;;;kCAIxE,oBAACH,gBAAIA;wBAACI,MAAK;wBAAYxmB,OAAO;4BAAEymB,gBAAgB;wBAAO;kCAAG;;;;0BAI5D,oBAAC1B,aAAaA;YACbuB,kCAAoB,oBAAC/U,mBAAmBA;gBAACC,MAAM8U;gBAAkB7U,SAAS,IAAM8U,oBAAoB;;0BAErG,oBAAC9W,YAAYA;gBACX9P,UAAS;gBACTC,UAAU,QAAmD,OAA3CuhB,KAAKC,MAAM,GAAGpY,QAAQ,CAAC,IAAI0d,SAAS,CAAC,GAAG;gBAC1DhnB,eAAeymB,0BAASA,CAACQ,SAAS,CAACC,OAAO;;0BAG5C,oBAACZ,0BAAcA;;;AAGrB;AAEe,SAASa;IACtB,qBACE,oBAACf,wBAAQA;kBACP,kCAACC,6BAAeA;YAACe,WAAW;gBAAEC,IAAI;gBAAqCC,KAAK;YAAa;YAAGC,sBAAQ,oBAACf,oBAAMA;sBACzG,kCAACG;;;AAIT;;;;;;;;;;;;;;;;;;;;AC7DwC;AACG;AAEK;AACQ;AACiB;AAOlE,SAASH;IACd,MAAMsB,SAASN,sDAASA;IACxB,MAAM,EAAEO,QAAQ,EAAE,GAAGD;IACrB,MAAM,EAAEvd,CAAC,EAAE,GAAGkd,mEAAcA,CAAC;IAC7B,MAAMO,cAA6B;QACjC;YAAEjR,OAAOxM,EAAE;YAAgB4M,OAAO;YAAK2E,oBAAM,uDAAC4L,yEAAQA;QAAI;QAC1D,kFAAkF;QAClF,8EAA8E;QAC9E;YAAE3Q,OAAOxM,EAAE;YAAoB4M,OAAO;YAAa2E,oBAAM,uDAAC6L,6EAAYA;QAAI;KAC3E;IACD,qBAEE,uDAACC,4HAAgBA;QAACK,UAAU;QAAC9Q,OAAO4Q;kBACjCC,YAAY/e,GAAG,CAAC1B,CAAAA,kBACf,uDAACsgB,4HAAsBA;gBAErB9Q,OAAOxP,EAAEwP,KAAK;gBACd+E,MAAMvU,EAAEuU,IAAI;gBACZoM,WAAS,UAAkB,OAAR3gB,EAAE4P,KAAK;gBAC1B9W,WAAW0nB,aAAaxgB,EAAE4P,KAAK,GAAG,iBAAiB;gBACnDzI,SAAS;oBACP,IAAIqZ,aAAaxgB,EAAE4P,KAAK,EAAE;oBAC1B2Q,OAAO1R,IAAI,CAAC7O,EAAE4P,KAAK;gBACrB;eARK5P,EAAE4P,KAAK;;AAatB;;;;;;;;;;;;;;;;;;;ACxCwP;;;;;;;;;;;;;;;qGCCxP,YAAY;AACqC;AAEe;AACQ;AAE1C;AACG;AAC0B;AACnB;AAEO;AAC/C,IAAIsR,kBAAyB,GAAE,6CAA6C;;AACrE,MAAMC,aAAa,IAAIrpB,eAAGA,CAAC,OAAQ,QAAO;AACjD,MAAMspB,aAAa,CAAC;QAEwBjE;IAD1C,IAAG,KAA6B,EAAC,EAAO;IACxC,MAAMkE,IAAI,IAAIC,IAAInE,OAAOoE,QAAQ,CAAChC,IAAI,MAAIpC,iBAAAA,OAAOqE,MAAM,cAAbrE,qCAAAA,eAAeoE,QAAQ,CAAChC,IAAI;IACtE,0CAA0C;IAC1C,OAAO8B,EAAEI,MAAM,IAAI,QAAQJ,EAAEI,MAAM,IAAI,SAAS,KAAKJ,EAAEI,MAAM;AAC/D;AACA,MAAMC,iBAAiB;IACrBC,UAAU,SAAUC,IAAc,EAAEC,UAAoB;QACtD,MAAMjoB,MAAMunB,WAAWlpB,GAAG,CAAC,OAAQ;QACnC2B,IAAIkoB,KAAK,GAAG;QACZ,MAAMC,MAAMH,IAAI,CAAC,EAAE;QACnB,IAAI5lB,IAAK;QACT,sEAAsE;QACtE,yCAAyC;QACzC,kEAAkE;QAClE,MAAMgmB,KAAKH,UAAU,CAAC,EAAE,CAACrT,KAAK,CAAC;QAC/BwT,GAAGC,MAAM,CAACD,GAAGna,MAAM,GAAG,GAAG,GAAGka;QAC5B,0DAA0D;QAC1D,yDAAyD;QACzD/lB,IAAI,WAAwB,OAAbgmB,GAAGrU,IAAI,CAAC,MAAK;QAC5B/T,IAAIA,GAAG,CAAE,SAAQgoB;QACjBhoB,IAAIA,GAAG,CAAE,eAAcioB;QACvBjoB,IAAIA,GAAG,CAAC,MAAMoC;QACdA,IAAIilB,mCAAYA,CAACiB,OAAO,CAAC,IAAM,OAAFlmB;QAC7B,2BAA2B;QAC3BA,IAAI,GAAiBA,OAAdolB,YAAW,KAAK,OAAFplB;QACrB,OAAOA;IAET;IACAmmB,OAAO,SACLtkB,IAAY,EACZukB,SAA6B,EAC7BP,UAA8B;QAE9B,MAAMjoB,MAAMunB,WAAWlpB,GAAG,CAAC,OAAQ;QACnC2B,IAAIkoB,KAAK,GAAG;QACZ,mDAAmD;QACnD,MAAMO,IAAI7kB,KAAK2kB,KAAK,CAACtkB;QACrBjE,IAAI0oB,KAAK,CAAE;QACX,yBAAyB;QACzB,+EAA+E;QAC/E1oB,IAAIA,GAAG,CAAE,WAAUwoB,WAAWP;QAC9B,OAAOQ;IACT;AACF;AACA,MAAME,UAAU,IAAIzB,kBAAOA;AAC3ByB,QAAQC,IAAI,CAAC,MAAMd;AACZ,MAAMe,OAAO1B,uBAAOA,CAAC;AAC5B,uCAAuC;AACvC,kBAAkB;AAClB,yCAAyC;AACzC,UAAU;AACV,aAAa;AACb,uCAAuC;AACvC,UAAU;AACV,KAAK;AAGL0B,KAAKzhB,EAAE,CAAC,mBAAmB,eAAgB+gB,GAAG;IAC5C,MAAMnoB,MAAMunB,WAAWlpB,GAAG,CAAC,OAAQ;IACnC2B,IAAIkoB,KAAK,GAAG;IACZloB,IAAIA,GAAG,CAAE,WAAUmoB;AACnB,cAAc;AACd,wEAAwE;AAC1E;AAKO,SAASW;QAASC,mBAAAA,iEAAwB;IAC/CzB,kBAAkByB;IAClBF,KACCG,GAAG,CAAC/B,6CAAgBA,EACpB+B,GAAG,CAACL,SACJK,GAAG,CAAChC,2BAAgBA,EACpB4B,IAAI,CAAqB;QACxBK,MAAM;QACN,eAAe;QACf,0DAA0D;QAC1D,aAAa;QACbC,aAAa9B,oBAAQA,GAAG,OAAO;QAC/B,wBAAwB;QACxB,gBAAgB;QAChB+B,yBAAwB;QACxBjD,IAAG,EAAE;QAELkD,OAAO;QACPC,eAAe;YACbC,aAAa;QACf;QACAC,WAAW;YACTC,QAAQ;gBAAC;aAAe;QAC1B;IACF;AACF;AACAX,KAAKzhB,EAAE,CAAC,cAAc,SAAU4gB,IAAI,EAAEyB,SAAS,EAAEtD,GAAG,EAAEjX,GAAG;IACvDoC,QAAQvO,KAAK,CACX,0DACAilB,MACAyB,WACAtD,KACAjX;AAEJ;AAEA2Z,KAAKzhB,EAAE,CAAC,UAAU,SAAUsiB,MAAM;IAChC,MAAM1pB,MAAMunB,WAAWlpB,GAAG,CAAC,OAAQ;IACnC2B,IAAIkoB,KAAK,GAAG;IACZloB,IAAIA,GAAG,CAAE,sBAAqB0pB;AAChC;AAEAb,KAAKzhB,EAAE,CAAC,iBAAiB,SAAU+gB,GAAG,EAAEjC,EAAE,EAAE5S,GAAG;IAC7C,MAAMtT,MAAMunB,WAAWlpB,GAAG,CAAC,OAAQ;IACnC2B,IAAIkoB,KAAK,GAAG;IACZloB,IAAIA,GAAG,CAAE,2BAA0BmoB,KAAKjC,IAAI5S;AAC9C;AAEAuV,KAAKzhB,EAAE,CAAC,SAAS;IACfkK,QAAQtR,GAAG,CAAC,SAAS2pB;AACvB;AAEA,gDAAed,gDAAAA,IAAIA,EAAAA,EAAC;;;;;;;;;;;ACxIkB;AACK;AAC3C,wCAAwC;AACxC,MAAMvF,IAAIuG,6BAAUA,CAACJ,SAAS,CAAC;AAO/B,SAASK;IACL,qBAAOF,cAActG;AACzB;AACO,MAAMyG,iCAAmBH,uBAAaA,CAAMtG,GAAE;AAE9C,MAAM0G,wCAA0BJ,uBAAaA,CAAsB,CAAC,GAAE;;;;;;;;AFf2K;;;;AGC1G;AACtG;AACS;AACI;AACL;AAEhDS;AACAvB,QAAQA;AAGR,SAASuB;IACP,IAAG,KAA6B,EAAC;IACjC,IAAGF,gBAASA,GAAGG,mBAAmB,CAACC,aAAa,EAAC;QAC/C;IACF;IACA,kCAAkC;IAClC,wCAAwC;IACxC,MAAMC,eAAe,IAAI9C,IAAInE,OAAOoE,QAAQ,CAAChC,IAAI,EAAE6E,YAAY;IAC/D,MAAMC,kBAAkBD,aAAaE,GAAG,CAAC;IACzC,IAAI,CAACD,iBAAiB;QACpB,MAAME,SAAS,IAAIjD,IAAInE,OAAOoE,QAAQ,CAAChC,IAAI;QAC3CgF,OAAOH,YAAY,CAACI,GAAG,CAAC,oBAAoBC,OAAOhR,KAAKoH,GAAG;QAC3DsC,OAAOoE,QAAQ,CAAChC,IAAI,GAAGgF,OAAOxiB,QAAQ;QACtC;IACF;IAEA,MAAM2iB,cAAcC,OAAON;IAC3B,IAAIK,cAAc,IAAI,KAAK,OAAOjR,KAAKoH,GAAG,IAAI;QAC5C,MAAM0J,SAAS,IAAIjD,IAAInE,OAAOoE,QAAQ,CAAChC,IAAI;QAC3CgF,OAAOH,YAAY,CAACI,GAAG,CAAC,oBAAoBC,OAAOhR,KAAKoH,GAAG;QAC3DsC,OAAOoE,QAAQ,CAAChC,IAAI,GAAGgF,OAAOxiB,QAAQ;IACxC;AACF;AACO,SAAS8c,SAAS,KAA+B;QAA/B,EAAE+F,QAAQ,EAAqB,GAA/B;IACvB,MAAMrE,SAASN,yBAASA;IACxB,MAAM4E,YAAY;IAClB,MAAMtF,OAAOpC,OAAOoE,QAAQ,CAAChC,IAAI,CAAC/Q,KAAK,CAAC,IAAI,CAAC,EAAE;IAC/C,MAAMsW,aAAa,WAAgB,OAALvF;IAC9B,MAAMrC,IAAIuG,6BAAUA,CAACJ,SAAS,CAACyB;IAC/B,IAAIC,IAAuC7H,EAAEnD,IAAI,CAAC+K;IAClD,IAAI,CAACC,GAAG;QACNA,IAAI,CAAC;QACL7H,EAAE1D,KAAK,CAACsL,YAAYC;IACtB;IACAA,IAAIlB,8BAAOA,CAACkB;IACZvvB,mBAASA,CAAC;QAER+qB,OAAOyE,cAAc,CAAC,CAACtkB;YACrBwc,EAAE+H,QAAQ;YACV,OAAO;QACT;IACF;IACAzvB,mBAASA,CAAC;QACR0nB,EAAE1D,KAAK,CAACsL,YAAYC;QACpB,OAAOjB,oCAAYA,CAACiB,GAAG;YACrB7H,EAAE1D,KAAK,CAACsL,YAAYC;QACtB;IACF,GAAG,EAAE;IACLvvB,mBAASA,CAAC;QACR,MAAM0vB,OAAQhI,EAAEnD,IAAI,CAAC8K,cAAc;YAAEM,GAAG;YAAGC,GAAG;QAAE;QAChD,qDAAqD;QACrD,IAAIF,KAAKC,CAAC,IAAI,KAAKD,KAAKE,CAAC,IAAI,GAAG;YAC9BC;QACF,OAAO;YACLlI,OAAOmI,qBAAqB,CAAC;gBAC3BnI,OAAOoI,QAAQ,CAACL,KAAKC,CAAC,EAAED,KAAKE,CAAC;gBAC9BC;YACF;QACF;QACA,SAASG,SAASxlB,CAAQ;YACxB,+EAA+E;YAC/Ekd,EAAE1D,KAAK,CAACqL,WAAW;gBAAEM,GAAGhI,OAAOsI,OAAO;gBAAEL,GAAGjI,OAAOuI,OAAO;YAAC;QAC5D;QACA,SAASL;YACPlI,OAAOC,gBAAgB,CAAC,UAAUoI;QACpC;QAEA,SAASG;YACPxI,OAAOE,mBAAmB,CAAC,UAAUmI;QACvC;QACA,OAAOG;IACT;IACA,qBACE,oBAAChC,gBAAgBA;QAAC/T,OAAOsN;kBACvB,kCAAC0G,uBAAuBA;YAAChU,OAAOmV;sBAE9B,kCAACf,0BAAeA;gBAACvB,MAAMA,IAAIA;0BACxBmC;;;;AAKX;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7FuD;AACyB;AAES;AAE9C;AAG3C,SAASoB;IACP,IAAG,CAACF,iBAAKA,EAAC,qBAAO;kBAAE;;IACnB,MAAM,EAAC9iB,CAAC,EAAC,GAAGkd,6BAAcA,CAAC;IAC3B,qBACE,qBAAC/pB,kBAAGA;;0BACF,oBAACC,qBAAMA;gBAAC+Q,SAAS;oBAAOgW,OAAOoE,QAAQ,CAAC0E,MAAM;gBAAE;0BAAIjjB,EAAE;;YACrD,IAAIyQ,OAAOyS,cAAc;;;AAGhC;AAEA,MAAMC,wBAAU3C,uBAAaA,CAAC;IAAE2B,GAAG;IAAGC,GAAG;AAAE;AAC3C,IAAIgB,QAAQ;AACG,SAASC,YAAY,KAAkG;QAAlG,EAAEzB,QAAQ,EAAE/E,SAAS,EAAEoG,MAAM,EAAqE,GAAlG;IAClCG;IACA,MAAME,SAAST,oBAAUA,CAACM;IAC1B,MAAMI,QAAQ,GAA2C,OAAxC9S,KAAKoH,GAAG,KAAKX,KAAKC,MAAM,KAAK1G,KAAKoH,GAAG;IACtDrlB,mBAASA,CAAC;QACR,eAAegxB;YACb,IAAG,CAAC3G,WAAU;YACd,IAAIxY,QAAQwY,UAAUxY,KAAK;YAC3B,IAAGwY,UAAUC,EAAE,EAAC;gBACdzY,QAAQ,MAAM0e,0CAAaA,CAAClG,UAAUC,EAAE,EAAED,UAAUE,GAAG,IAAI;YAC7D;YACA,IAAG,CAAC1Y,OAAM;YACVof,SAASpf,KAAK,GAAGA;QACnB;QACAmf;IACF,GAAG,EAAE;IACLhxB,mBAASA,CAAC;QACR,MAAMwR,YAAYyf,SAASC,sBAAsB,CAACH,MAAM,CAAC,EAAE;QAC3D,IAAI,CAACvf,WAAW;QAChBA,UAAU2f,SAAS,GAAGL,OAAOlB,CAAC;QAC9B,MAAMI,WAAW;YACf,IAAImB,YAAY3f,UAAU2f,SAAS;YACnCL,OAAOlB,CAAC,GAAGuB;QACb;QACA3f,UAAUqW,mBAAmB,CAAC,UAAUmI;QACxCxe,UAAUoW,gBAAgB,CAAC,UAAUoI,UAAU;YAAEoB,SAAS;QAAK;QAC/D,OAAO,IAAM5f,UAAUqW,mBAAmB,CAAC,UAAUmI;IACvD,GAAG;QAACe;QAAOD;KAAO;IAClB,qBAEE,oBAACV,wBAASA;QAAC9sB,WAAWytB;QAAOvtB,IAAI;YAAEkb,UAAU;YAAGpN,UAAU;YAAQ6W,SAAS;QAAM;kBAC/E,mCAACxnB,kBAAGA;;gBACA8vB,CAAAA,UAAWA,UAAUzjB,SAAS,mBAAM,oBAACwjB;gBAEtCpB;;;;AAIT;;;;AC1DwC;AAEzB,SAASiC,mBAAmB,KAAkG;QAAlG,EAAEjC,QAAQ,EAAE/E,SAAS,EAAEoG,MAAM,EAAqE,GAAlG;IACvC,qBACI,oBAACI,WAAWA;QAACxG,WAAWA;QAAWoG,QAAQA;kBACtCrB;;AAGb;;;;;;;;;;;;;;;ACR6B;AACwB;AAuDrD;;CAEC,GACM,eAAekC,mCACpBje,IAAgD;IAEhD,OAAOH,4DAAOA,CACZC,8CAAGA,CAACI,IAAI,EACRJ,8CAAGA,CAACoe,sBAAsB,EAC1Ble,KAAKI,MAAM,EACXJ,KAAKK,OAAO,EACZL,KAAKM,OAAO;AAEhB;AAEA;;;;;CAKC,GACM,eAAe6d,yBACpBhS,YAAoB,EACpBiS,UAAmB;IAEnB,MAAM1T,SAAS0T,aAAa,WAAW;IACvC,OAAOpU,+BAA+BoC,eAAe,CAAC;QACpDhM,QAAQ;YACNiM,eAAeF;YACfzB;QACF;IACF;AACF;AAEA;;CAEC,GACM,eAAe2T,gCACpBre,IAA6C;IAE7C,OAAOH,4DAAOA,CACZC,8CAAGA,CAACI,IAAI,EACRJ,8CAAGA,CAACwe,mBAAmB,EACvBte,KAAKI,MAAM,EACXJ,KAAKK,OAAO,EACZL,KAAKM,OAAO;AAEhB;AAEA,SAAS;AACF,MAAM0J,iCAAiC;IAC5CuU,oBAAoBN;IACpB7R,iBAAiBiS;AACnB,EAAE;AAEF,sEAAerU,gDAAAA,8BAA8BA,EAAAA,EAAC;;;;;;;;;;;;;;;;;;;AC/G2D;AAMxD;AAGW;AAE5D,0BAA0B;AAC1B,mBAAmB;AACnB,mBAAmB;AACnB,2BAA2B;AAC3B,IAAI;AAEJ,SAASyU,UAAU,KAAkC;QAAlC,EAACtH,MAAM,EAA2B,GAAlC;IACjB,qBAAO,uDAACtK,gHAAKA;QACX1H,IAAG;QACHhV,IAAI;YAAEsM,UAAU;YAASS,QAAQ;YAAGF,MAAM;YAAGC,OAAO;QAAE;QACtDyS,WAAW;kBAEVyH;;AAEL;AACA,sBAAsB;AACtB,gCAAgC;AAChC,iCAAiC;AACjC,sEAAsE;AACtE,yCAAyC;AACzC,oEAAoE;AACpE,yFAAyF;AACzF,qFAAqF;AACrF,oFAAoF;AACpF,OAAO;AACP,aAAa;AAEb,qDAAqD;AACrD,gCAAgC;AAChC,kCAAkC;AAClC,0BAA0B;AAC1B,4BAA4B;AAC5B,0BAA0B;AAC1B,0CAA0C;AAC1C,mEAAmE;AACnE,6BAA6B;AAC7B,gDAAgD;AAChD,oCAAoC;AACpC,eAAe;AACf,aAAa;AACb,YAAY;AACZ,0BAA0B;AAC1B,OAAO;AACP,IAAI;AAGJ,qBAAqB;AACd,SAASlB,gBAAgB,KAAwG;QAAxG,EAAE8F,QAAQ,EAAE/E,SAAS,EAAEG,MAAM,EAA2E,GAAxG;IAC9B,qBACE,wDAAC7pB,gHAAGA;QAAC6C,IAAI;YAAEmM,SAAS;YAAQqC,eAAe;YAAU+f,SAAS;QAAQ;;0BACpE,uDAACF,iHAAWA;0BACZ,wDAACnV,gHAAKA;gBAAC0J,WAAW;gBAAUlU,SAAS;;kCAGnC,uDAACmf,yEAAkBA;wBAAChH,WAAWA;kCAC5B+E;;kCAEH,uDAAC0C;wBAAUtH,QAAQA;;;;;;AAI3B","sources":["webpack://_N_E/../../libs/im/livekit/src/livekit-meeting/MeetingRoom5.tsx","webpack://_N_E/../../libs/app/model/src/remote/emc/inviteContacts.ts","webpack://_N_E/../../libs/app/model/src/remote/emc/tmsEmcGetContactTypes.ts","webpack://_N_E/./src/components/dialogs/InviteContactDialog.tsx","webpack://_N_E/./src/components/jpush/IsInitialized.tsx","webpack://_N_E/../../libs/app/model/src/remote/emergency-call/list_pending_received_invitations.ts","webpack://_N_E/./src/components/PendingInvitationsList/PendingInvitationsList.tsx","webpack://_N_E/../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/lodash.js","webpack://_N_E/./src/components/pre-alarm-config2/index.tsx","webpack://_N_E/./src/components/privacies/PrivacyDialog.tsx","webpack://_N_E/./src/components/privacies/ListenShowPrivacyContent.tsx","webpack://_N_E/./src/components/sensor-monitor/SensorMonitor.tsx","webpack://_N_E/./src/components/test/TestEmergencyCall.tsx","webpack://_N_E/./src/pages/home/index.tsx","webpack://_N_E/./src/components/navbar/NavBar.tsx","webpack://_N_E/../../node_modules/.pnpm/react-i18next@15.6.0_i18next@24.2.3_typescript@5.7.3__react-dom@19.1.0_react@19.1.0__react@19.1.0_typescript@5.7.3/node_modules/react-i18next/dist/es/index.js","webpack://_N_E/../../libs/fanfanlo/src/i18n/i18n-init.ts","webpack://_N_E/../../libs/fanfanlo/src/storage/store-page-context.tsx","webpack://_N_E/../../libs/app/ui/src/components/app/AppShell.tsx","webpack://_N_E/../../libs/app/ui/src/components/page/PageContent.tsx","webpack://_N_E/../../libs/app/ui/src/components/page/AndroidPageContent.tsx","webpack://_N_E/../../libs/app/model/src/remote/emergency-call/list_all_invitations.ts","webpack://_N_E/../../libs/app/ui/src/components/tabbar/Tabbar.tsx"],"sourcesContent":["import React, {\r\n    useCallback,\r\n    useEffect,\r\n    useRef,\r\n    useState,\r\n    forwardRef,\r\n    ForwardedRef\r\n} from 'react';\r\nimport {\r\n    Room,\r\n    RoomEvent,\r\n    Participant,\r\n    RemoteParticipant,\r\n    RemoteTrack,\r\n    Track,\r\n    LocalTrack,\r\n    LocalVideoTrack,\r\n    LocalAudioTrack,\r\n    createLocalAudioTrack,\r\n    createLocalVideoTrack,\r\n    VideoPreset,\r\n    VideoPresets,\r\n    TrackPublication,\r\n    LocalParticipant\r\n} from 'livekit-client';\r\nimport {\r\n    Box,\r\n    Button,\r\n    Typography,\r\n    Alert,\r\n    IconButton,\r\n    CircularProgress,\r\n    Stack,\r\n    SxProps,\r\n    Theme\r\n} from '@mui/material';\r\nimport Grid from '@mui/material/Grid';\r\nimport {\r\n    Mic as MicIcon,\r\n    MicOff as MicOffIcon,\r\n    ScreenShare as ScreenShareIcon,\r\n    StopScreenShare as StopScreenShareIcon,\r\n    Videocam as VideoIcon,\r\n    VideocamOff as VideoOffIcon,\r\n    CallEnd as CallEndIcon,\r\n    Settings as SettingsIcon,\r\n    VolumeUp as VolumeUpIcon,\r\n    VolumeOff as VolumeOffIcon,\r\n    Fullscreen as FullscreenIcon,\r\n    FullscreenExit as FullscreenExitIcon,\r\n    Refresh as RefreshIcon,\r\n    Visibility as VisibilityIcon,\r\n    VisibilityOff as VisibilityOffIcon\r\n} from '@mui/icons-material';\r\nimport { Log } from '@fanfanlo';\r\n// import { mainModel } from '@src/libs/mc/main/MainModel';\r\nimport { MeetingRoomProps, VideoPresetConfig, ExtendedParticipantState, ParticipantState } from './meeting-room.intf';\r\n\r\n// \r\nconst logger = new Log(false, 'livekit-meeting.MeetingRoom');\r\nconst uiLogger = logger.sub(false, 'MeetingRoom_ui');\r\n\r\n// \r\nconst VIDEO_PRESET: VideoPresetConfig = {\r\n    width: 1280,\r\n    height: 720,\r\n    // @ts-ignore - frameRate is used by LiveKit internally\r\n    frameRate: 24,\r\n    maxBitrate: 3000 * 1000, // 3Mbps\r\n};\r\n\r\n//  meetint-room.intf.ts\r\n\r\n\r\n// function getTokenEndpoint(): string {\r\n//     if (!mainModel.appConfig?.livekit?.jwt) {\r\n//         throw new Error('LiveKit JWT endpoint is not configured');\r\n//     }\r\n//     return `${mainModel.appConfig.livekit.jwt}/token`;\r\n// }\r\n// \r\nfunction MeetingRoomComponent(\r\n    {\r\n        livekitConfig,\r\n        roomName,\r\n        userName,\r\n        onDisconnect,\r\n        onError,\r\n        className = '',\r\n        style,\r\n        sx,\r\n        directly = false,\r\n    }: MeetingRoomProps,\r\n    ref: ForwardedRef<HTMLDivElement>\r\n) {\r\n    // \r\n    const [globalMediaState, setGlobalMediaState] = useState<{\r\n        isAudioEnabled: boolean;\r\n        isVideoEnabled: boolean;\r\n    }>({\r\n        isAudioEnabled: true,\r\n        isVideoEnabled: true,\r\n    });\r\n\r\n    // \r\n    const [remoteMediaState, setRemoteMediaState] = useState({\r\n        isAudioSubscribed: true,\r\n        isVideoSubscribed: true\r\n    });\r\n\r\n    // \r\n    const toggleRemoteAudio = useCallback(() => {\r\n        const newState = !remoteMediaState.isAudioSubscribed;\r\n        logger.log('Toggling remote audio subscription to:', newState);\r\n        \r\n        // \r\n        setRemoteMediaState(prev => {\r\n            logger.log('Remote audio subscription state changed:', { \r\n                from: prev.isAudioSubscribed, \r\n                to: newState \r\n            });\r\n            return {\r\n                ...prev,\r\n                isAudioSubscribed: newState\r\n            };\r\n        });\r\n        \r\n        // \r\n        if (roomRef.current) {\r\n            const participantCount = roomRef.current.remoteParticipants.size;\r\n            logger.log(`Updating audio subscription for ${participantCount} remote participants`);\r\n            \r\n            roomRef.current.remoteParticipants.forEach((participant, identity) => {\r\n                let audioTrackCount = 0;\r\n                participant.trackPublications.forEach(publication => {\r\n                    if (publication.kind === Track.Kind.Audio) {\r\n                        audioTrackCount++;\r\n                        logger.log(`Setting audio subscription for ${identity} to ${newState}`, {\r\n                            trackSid: publication.trackSid,\r\n                            isSubscribed: publication.isSubscribed\r\n                        });\r\n                        publication.setSubscribed(newState);\r\n                    }\r\n                });\r\n                logger.log(`Processed ${audioTrackCount} audio tracks for participant: ${identity}`);\r\n            });\r\n        }\r\n    }, [remoteMediaState.isAudioSubscribed]);\r\n\r\n    // \r\n    const toggleRemoteVideo = useCallback(() => {\r\n        const newState = !remoteMediaState.isVideoSubscribed;\r\n        logger.log('Toggling remote video subscription to:', newState);\r\n        \r\n        // \r\n        setRemoteMediaState(prev => {\r\n            logger.log('Remote video subscription state changed:', { \r\n                from: prev.isVideoSubscribed, \r\n                to: newState \r\n            });\r\n            return {\r\n                ...prev,\r\n                isVideoSubscribed: newState\r\n            };\r\n        });\r\n        \r\n        // \r\n        if (roomRef.current) {\r\n            const participantCount = roomRef.current.remoteParticipants.size;\r\n            logger.log(`Updating video subscription for ${participantCount} remote participants`);\r\n            \r\n            roomRef.current.remoteParticipants.forEach((participant, identity) => {\r\n                let videoTrackCount = 0;\r\n                participant.trackPublications.forEach(publication => {\r\n                    if (publication.kind === Track.Kind.Video) {\r\n                        videoTrackCount++;\r\n                        logger.log(`Setting video subscription for ${identity} to ${newState}`, {\r\n                            trackSid: publication.trackSid,\r\n                            isSubscribed: publication.isSubscribed\r\n                        });\r\n                        publication.setSubscribed(newState);\r\n                    }\r\n                });\r\n                logger.log(`Processed ${videoTrackCount} video tracks for participant: ${identity}`);\r\n            });\r\n        }\r\n    }, [remoteMediaState.isVideoSubscribed]);\r\n\r\n    // \r\n    const handleParticipantConnected = useCallback((participant: RemoteParticipant) => {\r\n        logger.log('Participant connected:', participant.identity, {\r\n            audioSubscribed: remoteMediaState.isAudioSubscribed,\r\n            videoSubscribed: remoteMediaState.isVideoSubscribed\r\n        });\r\n        \r\n        // \r\n        let audioTracksProcessed = 0;\r\n        let videoTracksProcessed = 0;\r\n        \r\n        participant.trackPublications.forEach(publication => {\r\n            if (publication.kind === Track.Kind.Audio || publication.kind === Track.Kind.Video) {\r\n                const isAudio = publication.kind === Track.Kind.Audio;\r\n                const shouldSubscribe = isAudio ? \r\n                    remoteMediaState.isAudioSubscribed : \r\n                    remoteMediaState.isVideoSubscribed;\r\n                \r\n                logger.log(`Setting ${isAudio ? 'audio' : 'video'} subscription for new participant ${participant.identity} to ${shouldSubscribe}`, {\r\n                    trackSid: publication.trackSid,\r\n                    isSubscribed: publication.isSubscribed\r\n                });\r\n                \r\n                publication.setSubscribed(shouldSubscribe);\r\n                \r\n                if (isAudio) audioTracksProcessed++;\r\n                else videoTracksProcessed++;\r\n            }\r\n        });\r\n        \r\n        logger.log(`Processed tracks for new participant ${participant.identity}:`, {\r\n            audioTracks: audioTracksProcessed,\r\n            videoTracks: videoTracksProcessed\r\n        });\r\n        \r\n        // \r\n        setParticipants(prev => {\r\n            const exists = prev.some(p => p.identity === participant.identity);\r\n            if (!exists) {\r\n                logger.log('Adding participant to state:', participant.identity);\r\n                return [...prev, participant];\r\n            }\r\n            logger.log('Participant already in state, not adding again:', participant.identity);\r\n            return prev;\r\n        });\r\n    }, [remoteMediaState]);\r\n\r\n    // Refs\r\n    const roomRef = useRef<Room | null>(null);\r\n    const localTracksRef = useRef<LocalTrack[]>([]);\r\n    const videoElements = useRef<Record<string, HTMLVideoElement>>({});\r\n    const audioElements = useRef<Record<string, HTMLAudioElement>>({});\r\n    const [participantStates, setParticipantStates] = useState<Record<string, ExtendedParticipantState>>({});\r\n    const isUnmountedRef = useRef(false);\r\n\r\n    // State\r\n    const [isConnecting, setIsConnecting] = useState(false);\r\n    const [hasConnected, setHasConnected] = useState(false);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [isMuted, setIsMuted] = useState(false);\r\n    const [isVideoEnabled, setIsVideoEnabled] = useState(true);\r\n    const [participants, setParticipants] = useState<RemoteParticipant[]>([]);\r\n\r\n    //  token\r\n    const fetchToken = useCallback(async (roomName: string, identity: string) => {\r\n        try {\r\n            const response = await fetch(`${livekitConfig.jwt}/token`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({\r\n                    room_name: roomName,\r\n                    identity,\r\n                }),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                throw new Error(' token ');\r\n            }\r\n\r\n            const data = await response.json();\r\n            return data.token;\r\n        } catch (error) {\r\n            uiLogger.error(' token :', error);\r\n            throw error;\r\n        }\r\n    }, []);\r\n\r\n    // \r\n    const connectToRoom = useCallback(async () => {\r\n        if (isConnecting || hasConnected) return;\r\n\r\n        setIsConnecting(true);\r\n        setError(null);\r\n\r\n        try {\r\n            // 1.  token\r\n            const token = await fetchToken(roomName, userName);\r\n            uiLogger.log('token:', token);\r\n\r\n            // 2. \r\n            const { audioTrack, videoTrack } = await createLocalTracks();\r\n            localTracksRef.current = [audioTrack, videoTrack];\r\n            uiLogger.log('audioTrack:', audioTrack);\r\n            uiLogger.log('videoTrack:', videoTrack);\r\n            // 3. \r\n            const room = new Room({\r\n                adaptiveStream: true,\r\n                dynacast: true,\r\n                videoCaptureDefaults: {\r\n                    resolution: VIDEO_PRESET,\r\n                },\r\n                // @ts-ignore - publishDefaults is a valid option\r\n                publishDefaults: {\r\n                    dtx: true,\r\n                    red: true,\r\n                    forceStereo: false,\r\n                    simulcast: true,\r\n                } as any, // Type assertion to bypass type checking for now\r\n            });\r\n            uiLogger.log('room:', room);\r\n            // 4. \r\n            setupRoomListeners(room);\r\n\r\n            // 5. \r\n            await room.connect(\r\n                livekitConfig.wsUrl,\r\n                token,\r\n                {\r\n                    autoSubscribe: true,\r\n                }\r\n            );\r\n            uiLogger.log('room connected');\r\n            // 6. \r\n            try {\r\n                await Promise.all([\r\n                    room.localParticipant.publishTrack(audioTrack),\r\n                    room.localParticipant.publishTrack(videoTrack)\r\n                ]);\r\n            } catch (publishError) {\r\n                uiLogger.error(':', publishError);\r\n                // \r\n            }\r\n\r\n            // 7. \r\n            roomRef.current = room;\r\n            setHasConnected(true);\r\n\r\n            // 8. \r\n            const remoteParticipants = Array.from(room.remoteParticipants.values());\r\n            setParticipants(remoteParticipants);\r\n\r\n            // 9. \r\n            updateParticipantState(room.localParticipant.identity, {\r\n                isAudioEnabled: true,\r\n                isVideoEnabled: true,\r\n                audioTrack,\r\n                videoTrack,\r\n            });\r\n\r\n            // 10. \r\n            remoteParticipants.forEach(participant => {\r\n                // \r\n                initParticipantState(participant);\r\n                uiLogger.log(':', participant.identity);\r\n                \r\n                //  getTrackPublications \r\n                participant.getTrackPublications().forEach(publication => {\r\n                    if (publication.track && publication.track instanceof RemoteTrack) {\r\n                        handleTrackSubscribed(publication.track, publication, participant);\r\n                    }\r\n                });\r\n            });\r\n            \r\n            // \r\n            if (room.localParticipant) {\r\n                initParticipantState(room.localParticipant);\r\n                uiLogger.log(':', room.localParticipant.identity);\r\n            }\r\n\r\n            uiLogger.log('');\r\n\r\n        } catch (error) {\r\n            uiLogger.error(':', error);\r\n            setError('');\r\n            // \r\n            cleanupTracks(localTracksRef.current);\r\n            localTracksRef.current = [];\r\n\r\n            if (roomRef.current) {\r\n                try {\r\n                    await roomRef.current.disconnect();\r\n                } catch (e) {\r\n                    uiLogger.error(':', e);\r\n                }\r\n                roomRef.current = null;\r\n            }\r\n        } finally {\r\n            setIsConnecting(false);\r\n        }\r\n    }, [roomName, userName, isConnecting, hasConnected, fetchToken]);\r\n\r\n    // \r\n    const createLocalTracks = useCallback(async () => {\r\n        try {\r\n            const [audioTrack, videoTrack] = await Promise.all([\r\n                createLocalAudioTrack({\r\n                    echoCancellation: true,\r\n                    noiseSuppression: true,\r\n                    autoGainControl: true,\r\n                }),\r\n                createLocalVideoTrack({\r\n                    resolution: {\r\n                        width: 1280,\r\n                        height: 720,\r\n                        frameRate: 24,\r\n                    },\r\n                }),\r\n            ]);\r\n            return { audioTrack, videoTrack };\r\n        } catch (error) {\r\n            uiLogger.error(':', error);\r\n            throw error;\r\n        }\r\n    }, []);\r\n\r\n    // \r\n    const cleanupTracks = useCallback((tracks: LocalTrack[]) => {\r\n        tracks.forEach(track => {\r\n            track.stop();\r\n            track.detach();\r\n        });\r\n    }, []);\r\n\r\n    // \r\n    const trackElementsRef = useRef<Record<string, boolean>>({});\r\n    const videoElementsRef = useRef<Record<string, HTMLVideoElement>>({});\r\n    const audioElementsRef = useRef<Record<string, HTMLAudioElement>>({});\r\n\r\n    // \r\n    const updateParticipantState = useCallback((identity: string, state: Partial<ParticipantState>) => {\r\n        setParticipantStates(prev => ({\r\n            ...prev,\r\n            [identity]: {\r\n                ...(prev[identity] || {\r\n                    isAudioEnabled: true,\r\n                    isVideoEnabled: true,\r\n                    isAudioEnabledGlobal: true,\r\n                    isVideoEnabledGlobal: true,\r\n                }),\r\n                ...state,\r\n            },\r\n        }));\r\n    }, []);\r\n    // \r\n    const handleTrackSubscribed = useCallback((\r\n        track: RemoteTrack,\r\n        publication: TrackPublication,\r\n        participant: Participant\r\n    ) => {\r\n        if (!track) return () => { };\r\n\r\n        const { identity } = participant;\r\n        const isVideoTrack = track.kind === Track.Kind.Video;\r\n\r\n        uiLogger.log(` ${track.kind} :`, identity, track);\r\n\r\n        // \r\n        const updateTrackState = () => {\r\n            const isMuted = track.isMuted;\r\n            const stateUpdate: Partial<ParticipantState> = {};\r\n\r\n            if (track.kind === Track.Kind.Audio) {\r\n                stateUpdate.isAudioEnabled = !isMuted;\r\n            } else if (track.kind === Track.Kind.Video) {\r\n                stateUpdate.isVideoEnabled = !isMuted;\r\n            }\r\n\r\n            updateParticipantState(identity, stateUpdate);\r\n\r\n            //  ParticipantVideo \r\n            if (isVideoTrack) {\r\n                setParticipants(prev => [...prev]);\r\n            }\r\n        };\r\n\r\n        // /\r\n        track.on('muted', updateTrackState);\r\n        track.on('unmuted', updateTrackState);\r\n\r\n        // \r\n        updateTrackState();\r\n\r\n        // \r\n        // \r\n        setParticipants(prev => {\r\n            const participantExists = prev.some(p => p.identity === identity);\r\n            if (!participantExists) {\r\n                return [...prev, participant as RemoteParticipant];\r\n            }\r\n            return [...prev];\r\n        });\r\n\r\n\r\n        // \r\n        return () => {\r\n            track.off('muted', updateTrackState);\r\n            track.off('unmuted', updateTrackState);\r\n        };\r\n    }, [updateParticipantState]);\r\n\r\n    // \r\n    const setupRoomListeners = useCallback((room: Room) => {\r\n        // \r\n        type EventHandler = (...args: any[]) => void;\r\n        const eventHandlers: Record<string, EventHandler> = {\r\n            // \r\n            participantConnected: (participant: RemoteParticipant) => {\r\n                if (!(participant instanceof RemoteParticipant)) return;\r\n\r\n                uiLogger.log(':', participant.identity);\r\n\r\n                // \r\n                setParticipants(prev => {\r\n                    // \r\n                    if (prev.some(p => p.identity === participant.identity)) {\r\n                        return prev;\r\n                    }\r\n                    return [...prev, participant];\r\n                });\r\n\r\n                // \r\n                const handleTrackPublished = (publication: TrackPublication) => {\r\n                    uiLogger.log(':', publication.kind, participant.identity);\r\n                    if (publication.track) {\r\n                        handleTrackSubscribed(publication.track as RemoteTrack, publication, participant);\r\n                    } else {\r\n                        publication.once('subscribed', (track: RemoteTrack) => {\r\n                            handleTrackSubscribed(track, publication, participant);\r\n                        });\r\n                    }\r\n                };\r\n\r\n                // \r\n                participant.on('trackPublished', handleTrackPublished);\r\n\r\n                // \r\n                participant.trackPublications.forEach(publication => {\r\n                    if (publication.track) {\r\n                        handleTrackSubscribed(publication.track as RemoteTrack, publication, participant);\r\n                    }\r\n                });\r\n\r\n                // \r\n                return () => {\r\n                    participant.off('trackPublished', handleTrackPublished);\r\n                };\r\n            },\r\n\r\n            // \r\n            participantDisconnected: (participant: RemoteParticipant) => {\r\n                uiLogger.log(':', participant.identity);\r\n                setParticipants(prev => {\r\n                    const newParticipants = prev.filter(p => p.identity !== participant.identity);\r\n                    uiLogger.log(':', newParticipants.map(p => p.identity));\r\n                    return newParticipants;\r\n                });\r\n            },\r\n\r\n            // \r\n            trackSubscribed: (track: RemoteTrack, publication: TrackPublication, participant: Participant) => {\r\n                if (!track) return;\r\n                uiLogger.log(':', track.kind, participant.identity);\r\n                // \r\n                handleTrackSubscribed(track, publication, participant as RemoteParticipant);\r\n            },\r\n\r\n            disconnected: (reason?: any) => {\r\n                const reasonStr = reason?.toString?.() || '';\r\n                uiLogger.log(':', reasonStr);\r\n                //  handleDisconnect\r\n                setHasConnected(false);\r\n                setParticipants([]);\r\n                setError(null);\r\n            },\r\n\r\n            reconnecting: () => {\r\n                uiLogger.log('...');\r\n                setError('...');\r\n            },\r\n\r\n            reconnected: () => {\r\n                uiLogger.log('');\r\n                setError(null);\r\n            }\r\n        };\r\n\r\n        // \r\n        room\r\n            .on(RoomEvent.Disconnected, eventHandlers.disconnected)\r\n            .on(RoomEvent.Reconnecting, eventHandlers.reconnecting)\r\n            .on(RoomEvent.Reconnected, eventHandlers.reconnected)\r\n            .on(RoomEvent.ParticipantConnected, handleParticipantConnected) // \r\n            .on(RoomEvent.ParticipantDisconnected, eventHandlers.participantDisconnected)\r\n            .on(RoomEvent.TrackSubscribed, eventHandlers.trackSubscribed);\r\n\r\n        // \r\n        return () => {\r\n            if (!room) return;\r\n            room\r\n                .off(RoomEvent.Disconnected, eventHandlers.disconnected)\r\n                .off(RoomEvent.Reconnecting, eventHandlers.reconnecting)\r\n                .off(RoomEvent.Reconnected, eventHandlers.reconnected)\r\n                .off(RoomEvent.ParticipantConnected, eventHandlers.participantConnected)\r\n                .off(RoomEvent.ParticipantDisconnected, eventHandlers.participantDisconnected)\r\n                .off(RoomEvent.TrackSubscribed, eventHandlers.trackSubscribed);\r\n\r\n            //  void\r\n            return undefined;\r\n        };\r\n    }, [handleTrackSubscribed]);\r\n\r\n    // \r\n    const leaveMeeting = useCallback(async () => {\r\n        uiLogger.log('...');\r\n        try {\r\n            // \r\n            cleanupTracks(localTracksRef.current);\r\n\r\n            // \r\n            if (roomRef.current) {\r\n                await roomRef.current.disconnect();\r\n                roomRef.current = null;\r\n            }\r\n\r\n            // \r\n            setHasConnected(false);\r\n            setParticipants([]);\r\n            setError(null);\r\n\r\n            // \r\n            Object.values(videoElements.current).forEach(el => el && el.remove());\r\n            Object.values(audioElements.current).forEach(el => el && el.remove());\r\n            videoElements.current = {};\r\n            audioElements.current = {};\r\n\r\n            // \r\n            if (onDisconnect) {\r\n                onDisconnect();\r\n            }\r\n\r\n            uiLogger.log('');\r\n        } catch (error) {\r\n            uiLogger.error(':', error);\r\n            setError('');\r\n        }\r\n    }, [onDisconnect]);\r\n\r\n    // \r\n    const cleanup = useCallback(async (isUnmounting = false) => {\r\n        // \r\n        if (isUnmounting) {\r\n            isUnmountedRef.current = true;\r\n        }\r\n\r\n        uiLogger.log('...');\r\n        if (!roomRef.current) return;\r\n\r\n        const localParticipant = roomRef.current.localParticipant;\r\n        const audioTrack = localTracksRef.current.find(\r\n            t => t.kind === Track.Kind.Audio\r\n        ) as LocalAudioTrack | undefined;\r\n        const videoTrack = localTracksRef.current.find(\r\n            t => t.kind === Track.Kind.Video\r\n        ) as LocalVideoTrack | undefined;\r\n\r\n        try {\r\n            if (audioTrack) {\r\n                await audioTrack.stop();\r\n            }\r\n            if (videoTrack) {\r\n                await videoTrack.stop();\r\n            }\r\n        } catch (error) {\r\n            uiLogger.error(':', error);\r\n        }\r\n\r\n        // \r\n        cleanupTracks(localTracksRef.current);\r\n        localTracksRef.current = [];\r\n\r\n        // \r\n        if (roomRef.current) {\r\n            roomRef.current.disconnect();\r\n            roomRef.current = null;\r\n        }\r\n\r\n        // \r\n        setHasConnected(false);\r\n        setParticipants([]);\r\n        setParticipantStates({});\r\n    }, []);\r\n\r\n    // \r\n    const updateGlobalMediaState = useCallback((audioEnabled: boolean, videoEnabled: boolean) => {\r\n        setGlobalMediaState(prev => ({\r\n            ...prev,\r\n            isAudioEnabled: audioEnabled,\r\n            isVideoEnabled: videoEnabled,\r\n        }));\r\n    }, []);\r\n\r\n    // \r\n    const toggleMute = useCallback(async () => {\r\n        if (!roomRef.current) return;\r\n\r\n        const localParticipant = roomRef.current.localParticipant;\r\n        const audioTrack = localTracksRef.current.find(\r\n            t => t.kind === Track.Kind.Audio\r\n        ) as LocalAudioTrack | undefined;\r\n\r\n        if (!audioTrack) return;\r\n\r\n        try {\r\n            // \r\n            const newGlobalAudioState = !globalMediaState.isAudioEnabled;\r\n\r\n            // \r\n            if (newGlobalAudioState) {\r\n                await audioTrack.unmute();\r\n            } else {\r\n                await audioTrack.mute();\r\n            }\r\n\r\n            // UI\r\n            setIsMuted(!newGlobalAudioState);\r\n            updateParticipantState(localParticipant.identity, { isAudioEnabled: newGlobalAudioState });\r\n\r\n            // \r\n            updateGlobalMediaState(newGlobalAudioState, globalMediaState.isVideoEnabled);\r\n        } catch (error) {\r\n            uiLogger.error(':', error);\r\n            setError('');\r\n        }\r\n    }, [globalMediaState, updateParticipantState, updateGlobalMediaState]);\r\n\r\n    // \r\n    const toggleVideo = useCallback(async () => {\r\n        if (!roomRef.current) return;\r\n\r\n        const localParticipant = roomRef.current.localParticipant;\r\n        const videoTrack = localTracksRef.current.find(\r\n            t => t.kind === Track.Kind.Video\r\n        ) as LocalVideoTrack | undefined;\r\n\r\n        if (!videoTrack) return;\r\n\r\n        try {\r\n            // \r\n            const newGlobalVideoState = !globalMediaState.isVideoEnabled;\r\n\r\n            // \r\n            if (newGlobalVideoState) {\r\n                await videoTrack.unmute();\r\n            } else {\r\n                await videoTrack.mute();\r\n            }\r\n\r\n            // UI\r\n            setIsVideoEnabled(newGlobalVideoState);\r\n            updateParticipantState(localParticipant.identity, { isVideoEnabled: newGlobalVideoState });\r\n\r\n            // \r\n            updateGlobalMediaState(globalMediaState.isAudioEnabled, newGlobalVideoState);\r\n        } catch (error) {\r\n            uiLogger.error(':', error);\r\n            setError('');\r\n        }\r\n    }, [globalMediaState, updateParticipantState, updateGlobalMediaState]);\r\n\r\n    // tile\r\n    const handleLocalMuteToggle = useCallback(async () => {\r\n        if (!roomRef.current) return;\r\n\r\n        const localParticipant = roomRef.current.localParticipant;\r\n        const audioTrack = localTracksRef.current.find(\r\n            t => t.kind === Track.Kind.Audio\r\n        ) as LocalAudioTrack | undefined;\r\n\r\n        if (!audioTrack) return;\r\n\r\n        try {\r\n            const newMutedState = !isMuted;\r\n            if (newMutedState) {\r\n                await audioTrack.mute();\r\n            } else {\r\n                await audioTrack.unmute();\r\n            }\r\n\r\n            setIsMuted(newMutedState);\r\n            updateParticipantState(localParticipant.identity, { isAudioEnabled: !newMutedState });\r\n        } catch (error) {\r\n            uiLogger.error(':', error);\r\n            setError('');\r\n        }\r\n    }, [isMuted, updateParticipantState]);\r\n\r\n    // tile\r\n    const handleLocalVideoToggle = useCallback(async () => {\r\n        if (!roomRef.current) return;\r\n\r\n        const localParticipant = roomRef.current.localParticipant;\r\n        const videoTrack = localTracksRef.current.find(\r\n            t => t.kind === Track.Kind.Video\r\n        ) as LocalVideoTrack | undefined;\r\n\r\n        if (!videoTrack) return;\r\n\r\n        try {\r\n            const newVideoState = !isVideoEnabled;\r\n            if (newVideoState) {\r\n                await videoTrack.unmute();\r\n            } else {\r\n                await videoTrack.mute();\r\n            }\r\n\r\n            setIsVideoEnabled(newVideoState);\r\n            updateParticipantState(localParticipant.identity, { isVideoEnabled: newVideoState });\r\n        } catch (error) {\r\n            uiLogger.error(':', error);\r\n            setError('');\r\n        }\r\n    }, [isVideoEnabled, updateParticipantState]);\r\n\r\n    // \r\n    useEffect(() => {\r\n        return () => {\r\n            // \r\n            cleanup(true);\r\n        };\r\n    }, []);\r\n\r\n    // \r\n    const getParticipantState = useCallback((identity: string): ParticipantState => {\r\n        return participantStates[identity] || {\r\n            isAudioEnabled: true,\r\n            isVideoEnabled: true,\r\n            isAudioEnabledGlobal: true,\r\n            isVideoEnabledGlobal: true,\r\n        };\r\n    }, [participantStates]);\r\n\r\n    // \r\n    const initParticipantState = useCallback((participant: Participant) => {\r\n        const state = getParticipantState(participant.identity);\r\n\r\n        // \r\n        const audioTrack = participant.getTrackPublications().find(\r\n            pub => pub.kind === Track.Kind.Audio\r\n        )?.track as LocalAudioTrack | undefined;\r\n\r\n        // \r\n        const videoTrack = participant.getTrackPublications().find(\r\n            pub => pub.kind === Track.Kind.Video\r\n        )?.track as LocalVideoTrack | undefined;\r\n\r\n        updateParticipantState(participant.identity, {\r\n            ...state,\r\n            isAudioEnabled: audioTrack ? !audioTrack.isMuted : false,\r\n            isVideoEnabled: videoTrack ? !videoTrack.isMuted : false\r\n        });\r\n    }, [getParticipantState, updateParticipantState]);\r\n\r\n    // \r\n    const handleToggleAudio = useCallback((participant: Participant) => {\r\n        const currentState = participantStates[participant.identity] || {\r\n            isAudioEnabled: true,\r\n            isVideoEnabled: true,\r\n            isAudioEnabledGlobal: true,\r\n            isVideoEnabledGlobal: true,\r\n        };\r\n\r\n        updateParticipantState(participant.identity, {\r\n            ...currentState,\r\n            isAudioEnabled: !currentState.isAudioEnabled\r\n        });\r\n    }, [participantStates, updateParticipantState]);\r\n\r\n    // \r\n    const handleToggleVideo = useCallback((participant: Participant) => {\r\n        const currentState = participantStates[participant.identity] || {\r\n            isAudioEnabled: true,\r\n            isVideoEnabled: true,\r\n            isAudioEnabledGlobal: true,\r\n            isVideoEnabledGlobal: true,\r\n        };\r\n\r\n        updateParticipantState(participant.identity, {\r\n            ...currentState,\r\n            isVideoEnabled: !currentState.isVideoEnabled\r\n        });\r\n    }, [participantStates, updateParticipantState]);\r\n\r\n    // \r\n    const getEffectiveMediaState = useCallback((participantId: string) => {\r\n        const state = participantStates[participantId];\r\n        if (!state) return { isAudioEnabled: true, isVideoEnabled: true };\r\n\r\n        return {\r\n            isAudioEnabled: globalMediaState.isAudioEnabled ? state.isAudioEnabled : false,\r\n            isVideoEnabled: globalMediaState.isVideoEnabled ? state.isVideoEnabled : false,\r\n        };\r\n    }, [globalMediaState, participantStates]);\r\n\r\n    // \r\n    const ParticipantVideo = React.memo(({\r\n        participant,\r\n        isLocal,\r\n        isVideoEnabled\r\n    }: {\r\n        participant: Participant;\r\n        isLocal: boolean;\r\n        isVideoEnabled: boolean;\r\n    }) => {\r\n        const videoRef = useRef<HTMLVideoElement>(null);\r\n        const [videoTrack, setVideoTrack] = useState<RemoteTrack | LocalVideoTrack | Track | null>(null);\r\n\r\n        // \r\n        useEffect(() => {\r\n            if (!participant) return;\r\n\r\n            // \r\n            const videoPublication = Array.from(participant.trackPublications.values())\r\n                .find(pub => pub.kind === Track.Kind.Video);\r\n\r\n            // \r\n            if (videoPublication && videoPublication.track) {\r\n                setVideoTrack(videoPublication.track);\r\n            }\r\n\r\n            // \r\n            const handleTrackSubscribed = (track: Track) => {\r\n                if (track.kind === Track.Kind.Video) {\r\n                    setVideoTrack(track as RemoteTrack | LocalVideoTrack);\r\n                }\r\n            };\r\n\r\n            // \r\n            const handleTrackUnsubscribed = (track: Track) => {\r\n                if (track.kind === Track.Kind.Video) {\r\n                    setVideoTrack(null);\r\n                }\r\n            };\r\n\r\n            // \r\n            participant.on(RoomEvent.TrackSubscribed, handleTrackSubscribed);\r\n            participant.on(RoomEvent.TrackUnsubscribed, handleTrackUnsubscribed);\r\n\r\n            // \r\n            return () => {\r\n                participant.off(RoomEvent.TrackSubscribed, handleTrackSubscribed);\r\n                participant.off(RoomEvent.TrackUnsubscribed, handleTrackUnsubscribed);\r\n            };\r\n        }, [participant]);\r\n\r\n        // /\r\n        useEffect(() => {\r\n            const videoElement = videoRef.current;\r\n            if (!videoElement || !videoTrack) return;\r\n\r\n            // \r\n            while (videoElement.firstChild) {\r\n                videoElement.removeChild(videoElement.firstChild);\r\n            }\r\n\r\n            // \r\n            if (isVideoEnabled) {\r\n                videoTrack.attach(videoElement);\r\n            }\r\n\r\n            return () => {\r\n                if (videoTrack) {\r\n                    videoTrack.detach(videoElement);\r\n                }\r\n            };\r\n        }, [videoTrack, isVideoEnabled]);\r\n\r\n        return (\r\n            <Box\r\n                sx={{\r\n                    width: '100%',\r\n                    aspectRatio: '16/9',\r\n                    bgcolor: 'grey.800',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    position: 'relative',\r\n                }}\r\n            >\r\n                <video\r\n                    ref={videoRef}\r\n                    autoPlay\r\n                    playsInline\r\n                    muted={isLocal}\r\n                    style={{\r\n                        width: '100%',\r\n                        height: '100%',\r\n                        objectFit: 'cover',\r\n                        display: isVideoEnabled ? 'block' : 'none'\r\n                    }}\r\n                />\r\n                {!isVideoEnabled && (\r\n                    <Box\r\n                        sx={{\r\n                            position: 'absolute',\r\n                            top: 0,\r\n                            left: 0,\r\n                            right: 0,\r\n                            bottom: 0,\r\n                            display: 'flex',\r\n                            alignItems: 'center',\r\n                            justifyContent: 'center',\r\n                            bgcolor: 'grey.900',\r\n                        }}\r\n                    >\r\n                        <Box\r\n                            sx={{\r\n                                width: 80,\r\n                                height: 80,\r\n                                borderRadius: '50%',\r\n                                display: 'flex',\r\n                                alignItems: 'center',\r\n                                justifyContent: 'center',\r\n                                bgcolor: 'primary.main',\r\n                                color: 'white',\r\n                                fontSize: 32,\r\n                                fontWeight: 'bold',\r\n                            }}\r\n                        >\r\n                            {participant.identity.charAt(0).toUpperCase()}\r\n                        </Box>\r\n                    </Box>\r\n                )}\r\n            </Box>\r\n        );\r\n    });\r\n\r\n    // \r\n    const ParticipantAudio = React.memo(({\r\n        participant,\r\n        isMuted,\r\n    }: {\r\n        participant: Participant;\r\n        isMuted: boolean;\r\n    }) => {\r\n        const audioRef = useRef<HTMLAudioElement>(null);\r\n        const [audioTrack, setAudioTrack] = useState<RemoteTrack | LocalAudioTrack | Track | null>(null);\r\n\r\n        useEffect(() => {\r\n            if (!participant) return;\r\n\r\n            const handleTrackSubscribed = (track: Track) => {\r\n                if (track.kind === Track.Kind.Audio) {\r\n                    setAudioTrack(track as RemoteTrack | LocalAudioTrack);\r\n                }\r\n            };\r\n\r\n            const handleTrackUnsubscribed = (track: Track) => {\r\n                if (track.kind === Track.Kind.Audio) {\r\n                    setAudioTrack(null);\r\n                }\r\n            };\r\n\r\n            // \r\n            const audioPublication = Array.from(participant.trackPublications.values())\r\n                .find(pub => pub.kind === Track.Kind.Audio);\r\n\r\n            if (audioPublication && audioPublication.track) {\r\n                setAudioTrack(audioPublication.track);\r\n            }\r\n\r\n            participant.on(RoomEvent.TrackSubscribed, handleTrackSubscribed);\r\n            participant.on(RoomEvent.TrackUnsubscribed, handleTrackUnsubscribed);\r\n\r\n            return () => {\r\n                participant.off(RoomEvent.TrackSubscribed, handleTrackSubscribed);\r\n                participant.off(RoomEvent.TrackUnsubscribed, handleTrackUnsubscribed);\r\n            };\r\n        }, [participant]);\r\n\r\n        useEffect(() => {\r\n            const audioElement = audioRef.current;\r\n            if (audioElement && audioTrack) {\r\n                audioTrack.attach(audioElement);\r\n                // \r\n                audioElement.muted = isMuted;\r\n                return () => {\r\n                    audioTrack.detach(audioElement);\r\n                };\r\n            }\r\n        }, [audioTrack, isMuted]);\r\n\r\n        return <audio ref={audioRef} autoPlay playsInline />;\r\n    });\r\n\r\n    // \r\n    const renderParticipant = useCallback((participant: Participant, isLocal: boolean) => {\r\n        const effectiveState = getEffectiveMediaState(participant.identity);\r\n\r\n        return (\r\n            <Box\r\n                key={participant.identity}\r\n                sx={{\r\n                    position: 'relative',\r\n                    borderRadius: 2,\r\n                    overflow: 'hidden',\r\n                    bgcolor: 'background.paper',\r\n                    boxShadow: 1,\r\n                }}\r\n            >\r\n                {/*  */}\r\n                <ParticipantVideo\r\n                    participant={participant}\r\n                    isLocal={isLocal}\r\n                    isVideoEnabled={effectiveState.isVideoEnabled}\r\n                />\r\n\r\n                {/*  */}\r\n                {!isLocal && (\r\n                    <ParticipantAudio\r\n                        participant={participant}\r\n                        isMuted={!effectiveState.isAudioEnabled}\r\n                    />\r\n                )}\r\n\r\n                {/*  */}\r\n                <Grid container\r\n                    sx={{\r\n                        position: 'absolute',\r\n                        bottom: 0,\r\n                        left: 0,\r\n                        right: 0,\r\n                        p: 1,\r\n                        bgcolor: 'rgba(0, 0, 0, 0.6)',\r\n                        justifyContent: 'center',\r\n                        gap: 1,\r\n                    }}\r\n                >\r\n                    <Grid item>\r\n                        <IconButton\r\n                            size=\"small\"\r\n                            color={effectiveState.isAudioEnabled ? 'primary' : 'error'}\r\n                            onClick={() => handleToggleAudio(participant)}\r\n                        >\r\n                            {effectiveState.isAudioEnabled ? <VolumeUpIcon /> : <VolumeOffIcon />}\r\n                        </IconButton>\r\n                    </Grid>\r\n                    <Grid item>\r\n                        <IconButton\r\n                            size=\"small\"\r\n                            color={effectiveState.isVideoEnabled ? 'primary' : 'error'}\r\n                            onClick={() => handleToggleVideo(participant)}\r\n                        >\r\n                            {effectiveState.isVideoEnabled ? <VisibilityIcon /> : <VisibilityOffIcon />}\r\n                        </IconButton>\r\n                    </Grid>\r\n                    <Grid item>\r\n                        <Typography variant=\"caption\" color=\"white\">\r\n                            {participant.identity} {isLocal && '()'}\r\n                        </Typography>\r\n                    </Grid>\r\n\r\n                    {/*  */}\r\n                    {isLocal && (\r\n                        <Grid item>\r\n                            <IconButton\r\n                                size=\"small\"\r\n                                onClick={handleLocalMuteToggle}\r\n                                color={isMuted ? 'error' : 'primary'}\r\n                                sx={{ color: 'white' }}\r\n                                title={isMuted ? '' : ''}\r\n                            >\r\n                                {isMuted ? <MicOffIcon /> : <MicIcon />}\r\n                            </IconButton>\r\n                        </Grid>\r\n                    )}\r\n\r\n                    {/*  */}\r\n                    {isLocal && (\r\n                        <Grid item>\r\n                            <IconButton\r\n                                size=\"small\"\r\n                                onClick={handleLocalVideoToggle}\r\n                                color={isVideoEnabled ? 'primary' : 'error'}\r\n                                sx={{ color: 'white' }}\r\n                                title={isVideoEnabled ? '' : ''}\r\n                            >\r\n                                {isVideoEnabled ? <VideoIcon /> : <VideoOffIcon />}\r\n                            </IconButton>\r\n                        </Grid>\r\n                    )}\r\n                </Grid>\r\n            </Box>\r\n        );\r\n    }, [isMuted, isVideoEnabled, getEffectiveMediaState, handleToggleAudio, handleToggleVideo, handleLocalMuteToggle, handleLocalVideoToggle]);\r\n\r\n    // \r\n    function renderControlButtons() {\r\n        return (\r\n            <Box sx={{ display: 'flex', gap: 1, p: 1, bgcolor: 'background.paper' }}>\r\n                {/*  */}\r\n                <IconButton\r\n                    color={isMuted ? 'error' : 'primary'}\r\n                    onClick={toggleMute}\r\n                    title={isMuted ? '' : ''}\r\n                >\r\n                    {isMuted ? <MicOffIcon /> : <MicIcon />}\r\n                </IconButton>\r\n\r\n                {/*  */}\r\n                <IconButton\r\n                    color={isVideoEnabled ? 'primary' : 'error'}\r\n                    onClick={toggleVideo}\r\n                    title={isVideoEnabled ? '' : ''}\r\n                >\r\n                    {isVideoEnabled ? <VideoIcon /> : <VideoOffIcon />}\r\n                </IconButton>\r\n\r\n                {/*  */}\r\n                <IconButton\r\n                    color={remoteMediaState.isAudioSubscribed ? 'primary' : 'error'}\r\n                    onClick={toggleRemoteAudio}\r\n                    title={remoteMediaState.isAudioSubscribed ? '' : ''}\r\n                >\r\n                    {remoteMediaState.isAudioSubscribed ? <VolumeUpIcon /> : <VolumeOffIcon />}\r\n                </IconButton>\r\n\r\n                {/*  */}\r\n                <IconButton\r\n                    color={remoteMediaState.isVideoSubscribed ? 'primary' : 'error'}\r\n                    onClick={toggleRemoteVideo}\r\n                    title={remoteMediaState.isVideoSubscribed ? '' : ''}\r\n                >\r\n                    {remoteMediaState.isVideoSubscribed ? <VisibilityIcon /> : <VisibilityOffIcon />}\r\n                </IconButton>\r\n\r\n                {/*  */}\r\n                <IconButton\r\n                    color=\"error\"\r\n                    onClick={leaveMeeting}\r\n                    title=\"\"\r\n                >\r\n                    <CallEndIcon />\r\n                </IconButton>\r\n            </Box>\r\n        );\r\n    }\r\n\r\n    // \r\n    function renderMainContent() {\r\n        // \r\n        if (hasConnected && roomRef.current) {\r\n            return (\r\n                <Box className={className} sx={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\r\n                    <Box sx={{ flex: 1, overflow: 'auto', p: 2 }}>\r\n                        <Grid container spacing={2}>\r\n                            <Grid item xs={12} md={participants.length === 0 ? 12 : 6}>\r\n                                {renderParticipant(roomRef.current.localParticipant, true)}\r\n                            </Grid>\r\n                            {participants.map(function (participant) {\r\n                                return (\r\n                                    <Grid item xs={12} md={6} key={participant.identity}>\r\n                                        {renderParticipant(participant, false)}\r\n                                    </Grid>\r\n                                );\r\n                            })}\r\n                        </Grid>\r\n                    </Box>\r\n                    {/*  */}\r\n                    <Box sx={{ p: 1, borderTop: '1px solid', borderColor: 'divider' }}>\r\n                        {renderControlButtons()}\r\n                    </Box>\r\n                </Box>\r\n            );\r\n        }\r\n\r\n        // \r\n        return (\r\n            <Box className={className} sx={{\r\n                height: '100%',\r\n                display: 'flex',\r\n                flexDirection: 'column',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                p: 3\r\n            }}>\r\n                <Typography variant=\"h6\" gutterBottom>\r\n                    \r\n                </Typography>\r\n                <Button\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    onClick={connectToRoom}\r\n                    disabled={isConnecting}\r\n                    startIcon={<VideoIcon />}\r\n                    sx={{ mt: 2 }}\r\n                >\r\n                    \r\n                    {isConnecting && (\r\n                        <CircularProgress\r\n                            size={16}\r\n                            sx={{\r\n                                color: 'inherit',\r\n                                ml: 1\r\n                            }}\r\n                        />\r\n                    )}\r\n                </Button>\r\n            </Box>\r\n        );\r\n    }\r\n\r\n    //  return  hooks \r\n    let content: React.ReactNode;\r\n    if (isConnecting) {\r\n        content = (\r\n            <Box sx={{\r\n                display: 'flex',\r\n                flexDirection: 'column',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                height: '100%',\r\n                p: 3\r\n            }}>\r\n                <CircularProgress />\r\n                <Typography variant=\"body1\" sx={{ mt: 2 }}>...</Typography>\r\n            </Box>\r\n        );\r\n    } else if (error) {\r\n        content = (\r\n            <Alert severity=\"error\" sx={{ m: 2 }}>\r\n                <Typography variant=\"body1\">{error}</Typography>\r\n                <Button\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    onClick={connectToRoom}\r\n                    startIcon={<RefreshIcon />}\r\n                    sx={{ mt: 1 }}\r\n                >\r\n                    \r\n                </Button>\r\n            </Alert>\r\n        );\r\n    } else {\r\n        content = renderMainContent();\r\n    }\r\n\r\n    useEffect(()=>{\r\n        if(directly){\r\n            connectToRoom();\r\n        }\r\n    }, [directly])\r\n    // \r\n    return (\r\n        <Box ref={ref} sx={sx} style={style}>\r\n            {content}\r\n        </Box>\r\n    );\r\n}\r\n\r\n//  forwardRef \r\nconst MeetingRoom5 = forwardRef(MeetingRoomComponent);\r\nMeetingRoom5.displayName = 'MeetingRoom5';\r\n\r\nexport { MeetingRoom5 };","import { IRequestParams, IResultContent, request } from \"@fanfanlo\";\nimport { tms } from \"../tms\";\nimport { IRequestOptions } from \"../IRequestOptions\";\n\n/**\n * @description \n */\nexport interface IEmcContactIdentity {\n    identity: string;\n    identityType: 'email' | 'mobile';\n}\n\n/**\n * @description \n */\nexport interface IEmcInviteContactsParams extends IRequestParams {\n    contacts: IEmcContactIdentity[];\n    remark?: string;\n    type: string;\n    message?: string;\n    matrix_access_token: string; //  Matrix  Token\n}\n\n/**\n * @description \n */\nexport interface IEmcInviteResultItem {\n    identity: string;\n    result_code: string; //  ResultCode \n    msg: string;\n}\n\n/**\n * @description \n */\n// export interface IEmcInviteContactsResult extends IResultContent {\n//     data: {\n//         data: {\n//             results: IEmcInviteResultItem[];\n//             msg?: string;\n//         };\n//         msg?: string;\n//     };\n//     results?: IEmcInviteResultItem[]; // \n// }\n\nexport interface IEmcInviteContactsResult extends IResultContent {\n    data: {\n        is_ok:boolean;\n        results: IEmcInviteResultItem[];\n        msg?: string;\n    };\n}\n\n/**\n * @description \n * @param opts  params, gateway, handler \n */\nexport async function tmsEmcInviteContacts(opts: IRequestOptions<IEmcInviteContactsParams>) {\n    const res = await request<IEmcInviteContactsResult>(tms.TEmc, tms.MEmcInviteContacts, opts.params, opts.gateway, opts.handler);\n    return res;\n}","import { IRequestParams, IResultContent, request } from \"@fanfanlo\";\nimport { tms } from \"../tms\";\nimport { IRequestOptions } from \"../IRequestOptions\";\n\n/**\n * @description \n */\nexport interface IEmcGetContactTypesParams extends IRequestParams {\n    // \n}\n\n/**\n * @description \n */\nexport interface IEmcContactTypeItem {\n    id: string;\n    name: string;\n    //  icon, description \n}\n\n/**\n * @description \n */\nexport interface IEmcGetContactTypesResult extends IResultContent {\n    data: {\n        types: Array<{\n            uuid: string;\n            name: string;\n            is_system: boolean;\n        }>;\n    };\n}\n\n/**\n * @description \n * @param opts  params, gateway, handler \n */\nexport async function tmsEmcGetContactTypes(opts: IRequestOptions<IEmcGetContactTypesParams>) {\n    const res = await request<IEmcGetContactTypesResult>(tms.TEmc, tms.MEmcGetContactTypes, opts.params, opts.gateway, opts.handler);\n    return res;\n}\n","import {\n    Button,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogTitle,\n    TextField,\n    Box,\n    CircularProgress,\n    Autocomplete,\n} from '@mui/material';\nimport { useState, useCallback, useEffect, useRef, SyntheticEvent } from 'react';\nimport { \n    IEmcInviteContactsParams, \n    tmsEmcInviteContacts, \n    IEmcContactIdentity, \n    user, \n    tmsEmcGetContactTypes,\n    IEmcGetContactTypesResult,\n    IEmcContactTypeItem,\n    IEmcInviteResultItem,\n} from '@app/model';\nimport toast from 'react-hot-toast';\nimport { matrixUser } from '@im/matrix';\nimport { authService } from '@src/services/authService';\nimport { Log, useProxyWatch,\n    IRequestResult } from '@fanfanlo';\nconst fileLogger = new Log(false, 'InviteContactDialog.tsx');\n\nconst isValidIdentity = (text: string) => /(^\\d{11}$)|(^[a-zA-Z0-9]{32}$)/.test(text);\nconst is11DigitNumber = (text: string) => /^\\d{11}$/.test(text);\n\ninterface InviteContactDialogProps {\n    open: boolean;\n    onClose: () => void;\n    onInviteSent?: () => void;\n}\n\nexport function InviteContactDialog({ open, onClose, onInviteSent }: InviteContactDialogProps) {\n    const uiLogger = fileLogger.sub(false, 'InviteContactDialog_ui');\n\n    const [contacts, setContacts] = useState('');\n    const [remark, setRemark] = useState('');\n    const [callType, setCallType] = useState<string | null>(null);\n    const [availableCallTypes, setAvailableCallTypes] = useState<readonly IEmcContactTypeItem[]>([]);\n    \n    // Debug effect to log availableCallTypes changes\n    useEffect(() => {\n        console.log('availableCallTypes updated:', availableCallTypes);\n    }, [availableCallTypes]);\n    \n    // Debug effect to log callType changes\n    useEffect(() => {\n        console.log('callType updated:', callType);\n    }, [callType]);\n    const [message, setMessage] = useState('');\n    const [isLoading, setIsLoading] = useState(false);\n    const [isTypesLoading, setIsTypesLoading] = useState(false);\n\n    const [pendingParams, setPendingParams] = useState<Omit<IEmcInviteContactsParams, 'matrix_access_token'> | null>(null);\n    const executionLock = useRef(false);\n    const [accessToken] = useProxyWatch(matrixUser.userData.userInfo, 'loginResponse.access_token', matrixUser.userData.userInfo.loginResponse?.access_token);\n    const [isUserLoggedIn] = useProxyWatch(user.data.sessionData, 'global_user_info', !!user.data.sessionData.global_user_info);\n    const [userToken] = useProxyWatch(user, 'data.storeData.user_token', user.data.storeData.user_token);\n    useEffect(() => {\n        if (accessToken && pendingParams && !executionLock.current) {\n            executionLock.current = true;\n            const finalParams: IEmcInviteContactsParams = {\n                ...pendingParams,\n                matrix_access_token: accessToken,\n                contacts: pendingParams?.contacts || [],\n                type: pendingParams?.type || ''\n            };\n            executeApiCall(finalParams);\n        }\n    }, [accessToken, pendingParams]);\n\n    const executeApiCall = useCallback(async (params: IEmcInviteContactsParams) => {\n        if (!params.contacts || !params.type) {\n            toast.error('');\n            return;\n        }\n\n        setIsLoading(true);\n        \n        try {\n            const res = await tmsEmcInviteContacts({\n                params,\n                handler: { printLog: true }\n            });\n\n            console.log('Invite response:', res);\n\n            // \n            if (res.err || !res.shellIsOk || !res.dataIsOk) {\n                const errorMessage = res.err?.message || '';\n                toast.error(errorMessage);\n                return;\n            }\n\n            // \n            const responseData = res.data;\n            if (!responseData?.data?.results) {\n                const errorMessage = responseData?.data?.msg || res.data?.msg || '';\n                toast.error(errorMessage);\n                return;\n            }\n            \n            const results: IEmcInviteResultItem[] = responseData.data.results;\n\n            // \n            const successResults = results.filter(r => r.result_code === 'SUCCESS');\n            const infoResults = results.filter(r => r.result_code === 'INVITE_ALREADY_SENT' || r.result_code === 'ALREADY_A_CONTACT');\n            const errorResults = results.filter(r => r.result_code !== 'SUCCESS' && r.result_code !== 'INVITE_ALREADY_SENT' && r.result_code !== 'ALREADY_A_CONTACT');\n\n            if (successResults.length > 0) {\n                toast.success(` ${successResults.length} `);\n                onInviteSent?.();\n            }\n            \n            if (infoResults.length > 0) {\n                const infoMessages = infoResults.map(r => r.msg).filter(Boolean).join('\\n');\n                if (infoMessages) {\n                    //  toast  toast.info\n                    toast(infoMessages);\n                }\n            }\n            \n            if (errorResults.length > 0) {\n                const errorMessages = errorResults.map(r => r.msg).filter(Boolean).join('\\n');\n                if (errorMessages) {\n                    toast.error(`\\n${errorMessages}`);\n                }\n            }\n        } catch (error) {\n            console.error('Error in executeApiCall:', error);\n            toast.error('');\n        } finally {\n            setIsLoading(false);\n        }\n    }, [onInviteSent]);\n\n    const fetchCallTypes = useCallback(async () => {\n        const logger = uiLogger.sub(false, 'fetchCallTypes_fn');\n        logger.log('Fetching call types...');\n        setIsTypesLoading(true);\n        const res: IRequestResult<IEmcGetContactTypesResult, any> = await tmsEmcGetContactTypes({ params: {}, handler: { printLog: true } });\n        logger.log('Call types response:', JSON.stringify(res));\n        setIsTypesLoading(false);\n\n        if (res.err || !res.shellIsOk || !res.dataIsOk) {\n            const errorMessage = res.err?.message || '';\n            toast.error(errorMessage);\n            setAvailableCallTypes([]);\n            logger.error('Failed to load call types:', errorMessage);\n        } else {\n            //  res.data.data.types \n            const types = res.data?.data?.types || [];\n            logger.log('Setting availableCallTypes:', JSON.stringify(types));\n            \n            //  IEmcContactTypeItem[] \n            const formattedTypes = types.map(type => ({\n                id: type.uuid,\n                name: type.name,\n                is_system: type.is_system\n            }));\n            \n            setAvailableCallTypes(formattedTypes);\n            \n            //  callType \n            if (formattedTypes.length > 0 && !callType) {\n                const defaultType = formattedTypes[0].name;\n                logger.log('Setting default call type:', defaultType);\n                setCallType(defaultType);\n            } else if (formattedTypes.length === 0) {\n                logger.warn('No call types available');\n            }\n        }\n    }, []); //  callType \n\n    useEffect(() => {\n        if (open) {\n            fetchCallTypes();\n        } else {\n            setContacts('');\n            setRemark('');\n            setCallType(null);\n            setAvailableCallTypes([]);\n            setMessage('');\n            setIsLoading(false);\n            setPendingParams(null);\n            executionLock.current = false;\n        }\n    }, [open, fetchCallTypes]);\n\n    const handleSendInvitation = useCallback(async () => {\n        const contactInputs = contacts.split('\\n').map(c => c.trim()).filter(c => c);\n        if (contactInputs.length === 0) {\n            toast.error('');\n            return;\n        }\n\n        const contactIdentities: IEmcContactIdentity[] = [];\n        for (const input of contactInputs) {\n            if (isValidIdentity(input)) {\n                const type = is11DigitNumber(input) ? 'mobile' : 'email';\n                contactIdentities.push({ identity: input, identityType: type });\n            } else {\n                toast.error(`: ${input}1132`);\n                return;\n            }\n        }\n\n        if (!callType || callType.trim() === '') {\n            toast.error('');\n            return;\n        }\n\n        setIsLoading(true);\n\n        if (!userToken) {\n            const appLoggedIn = await authService.showLoginDialog();\n            if (!appLoggedIn) {\n                setIsLoading(false);\n                return; \n            }\n        }\n\n        const currentAccessToken = matrixUser.userData.userInfo.loginResponse?.access_token;\n        const params: Omit<IEmcInviteContactsParams, 'matrix_access_token'> = {\n            contacts: contactIdentities,\n            type: callType.trim(),\n            remark: remark.trim(),\n            message: message.trim(),\n        };\n\n        if (currentAccessToken) {\n            executionLock.current = true;\n            const apiParams: IEmcInviteContactsParams = {\n                ...params,\n                matrix_access_token: currentAccessToken,\n                contacts: params.contacts || [],\n                type: params.type || ''\n            };\n            executeApiCall(apiParams);\n        } else {\n            toast('...');\n            setPendingParams(params);\n        }\n\n    }, [contacts, remark, callType, message, executeApiCall, isUserLoggedIn]);\n\n    return (\n        <Dialog open={open} onClose={() => onClose()} maxWidth=\"sm\" fullWidth>\n            <DialogTitle></DialogTitle>\n            <DialogContent>\n                <Box component=\"form\" sx={{ mt: 2 }}>\n                    <TextField\n                        autoFocus\n                        margin=\"dense\"\n                        id=\"contacts\"\n                        label=\" (1132ID)\"\n                        type=\"text\"\n                        fullWidth\n                        multiline\n                        rows={4}\n                        variant=\"outlined\"\n                        placeholder=\"13800138000&#10;550e8400e29b41d4a716446655440000\"\n                        value={contacts}\n                        onChange={(e) => setContacts(e.target.value)}\n                        disabled={isLoading}\n                    />\n                    <TextField\n                        margin=\"dense\"\n                        id=\"remark\"\n                        label=\" ()\"\n                        type=\"text\"\n                        fullWidth\n                        variant=\"outlined\"\n                        value={remark}\n                        onChange={(e) => setRemark(e.target.value)}\n                        disabled={isLoading}\n                    />\n                    <Autocomplete\n                        freeSolo\n                        id=\"call-type-autocomplete\"\n                        options={availableCallTypes.map((option) => option.name)}\n                        value={callType || ''}\n                        onChange={(event: SyntheticEvent, newValue: string | null) => {\n                            console.log('Call type changed to:', newValue);\n                            setCallType(newValue);\n                        }}\n                        inputValue={callType || ''}\n                        onInputChange={(event, newInputValue, reason) => {\n                            // Only update when the user is typing, not when an option is selected\n                            if (reason === 'input') {\n                                console.log('Input value changed to:', newInputValue);\n                                setCallType(newInputValue);\n                            }\n                        }}\n                        disablePortal\n                        disableClearable\n                        forcePopupIcon={!isTypesLoading}\n                        sx={{ mt: 1, mb: 1, width: '100%' }}\n                        renderInput={(params) => (\n                            <TextField\n                                {...params}\n                                label=\"\"\n                                variant=\"outlined\"\n                                fullWidth\n                                InputProps={{\n                                    ...params.InputProps,\n                                    endAdornment: (\n                                        <>\n                                            {isTypesLoading ? <CircularProgress color=\"inherit\" size={20} /> : null}\n                                            {params.InputProps.endAdornment}\n                                        </>\n                                    ),\n                                }}\n                            />\n                        )}\n                        ListboxProps={{\n                            style: {\n                                maxHeight: '200px',\n                                overflow: 'auto',\n                            },\n                        }}\n                    />\n                    <TextField\n                        margin=\"dense\"\n                        id=\"message\"\n                        label=\" ()\"\n                        type=\"text\"\n                        fullWidth\n                        multiline\n                        rows={3}\n                        variant=\"outlined\"\n                        placeholder=\"\"\n                        value={message}\n                        onChange={(e) => setMessage(e.target.value)}\n                        disabled={isLoading}\n                    />\n                </Box>\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={() => onClose()} disabled={isLoading}></Button>\n                <Button onClick={handleSendInvitation} variant=\"contained\" disabled={isLoading}>\n                    {isLoading ? <CircularProgress size={24} /> : ''}\n                </Button>\n            </DialogActions>\n        </Dialog>\n    );\n}","import { autoWebViewJs } from \"@droid/android\";\r\nimport { Box, Button } from \"@mui/material\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\n\r\nexport function JpushIsInitialized(){\r\n    const [isInitialized, setIsInitialized] = useState(false);\r\n    function refresh(){\r\n        const script = `var bl = com.fanfanlo.emergencycall.jpush.JpushManager.readIsJpushInitialized();\r\n        bl;`\r\n        const {javaResultData} = autoWebViewJs.callScript<boolean>(script);\r\n        setIsInitialized(typeof javaResultData == \"undefined\" ? false : javaResultData);\r\n    }\r\n    useEffect(() => {\r\n        refresh();\r\n    }, []);\r\n\r\n    return(\r\n        <Box>\r\n            <span>:</span><span>{isInitialized ? \"\" : \"\"}</span>\r\n            <span><Button onClick={refresh}></Button></span>\r\n        </Box>\r\n    )\r\n}","import { IRequestOptions } from \"../IRequestOptions\";\nimport { tms } from \"../tms\";\nimport { request } from \"@fanfanlo\";\n\n/**\n * \n */\nexport interface IParamsListPendingReceivedInvitations {\n  // \n  page?: number;\n  page_size?: number;\n}\n\n/**\n * \n */\nexport interface IPendingInvitationInfo {\n  invitation_id: string;\n  user_info: {\n    user_id: string;\n    display_name: string;\n    avatar_url?: string;\n  };\n  status: 'pending';\n  message: string;\n  created_at: number;\n  expires_at: number;\n}\n\n/**\n * \n */\nexport interface IResultListPendingReceivedInvitations {\n  is_ok: boolean;\n  msg?: string;\n  invitations: IPendingInvitationInfo[];\n}\n\n/**\n * \n */\nexport async function tmsEmergencyCallListPendingReceivedInvitations(\n  opts: IRequestOptions<IParamsListPendingReceivedInvitations>\n) {\n  return request<IResultListPendingReceivedInvitations, IParamsListPendingReceivedInvitations>(\n    tms.TEmc,\n    tms.MEmcListPendingReceivedInvitations,\n    opts.params,\n    opts.gateway,\n    opts.handler\n  );\n}\n\n// \nexport const emergencyCallPendingInvitationService = {\n  listPendingReceivedInvitations: tmsEmergencyCallListPendingReceivedInvitations,\n};\n\nexport default emergencyCallPendingInvitationService;","import React, { useState, useEffect, useCallback } from 'react';\nimport {\n  Box,\n  Typography,\n  Button,\n  Card,\n  CardContent,\n  CardActions,\n  CircularProgress,\n  Avatar,\n  Chip,\n  Alert,\n  Stack,\n} from '@mui/material';\nimport {\n  Check as CheckIcon,\n  Close as CloseIcon,\n  AccessTime as AccessTimeIcon,\n  Person as PersonIcon,\n  Notifications as NotificationsIcon,\n} from '@mui/icons-material';\nimport { formatDistanceToNow } from 'date-fns';\nimport { zhCN } from 'date-fns/locale';\nimport { \n  emergencyCallPendingInvitationService,\n  emergencyCallInvitationService,\n  IPendingInvitationInfo,\n  user,\n  AppModelEvent,\n  appModel\n} from '@app/model';\nimport { useProxyWatch } from '@fanfanlo';\n\n// \nfunction PendingInvitationCard({ \n  invitation,\n  onRespond,\n  isProcessing = false,\n}: { \n  invitation: IPendingInvitationInfo;\n  onRespond?: (action: 'accept' | 'decline') => Promise<void>;\n  isProcessing?: boolean;\n}) {\n  const [isProcessingAction, setIsProcessingAction] = useState(false);\n\n  const handleRespond = async (action: 'accept' | 'decline') => {\n    if (!onRespond) return;\n    \n    try {\n      setIsProcessingAction(true);\n      await onRespond(action);\n    } finally {\n      setIsProcessingAction(false);\n    }\n  };\n\n  const isExpired = new Date(invitation.expires_at * 1000) < new Date();\n\n  return (\n    <Card variant=\"outlined\" sx={{ mb: 2, opacity: isProcessing ? 0.7 : 1 }}>\n      <CardContent>\n        <Box display=\"flex\" alignItems=\"center\" mb={2}>\n          <Avatar \n            src={invitation.user_info.avatar_url} \n            alt={invitation.user_info.display_name}\n            sx={{ width: 50, height: 50, mr: 2 }}\n          >\n            {invitation.user_info.display_name?.[0]?.toUpperCase() || '?'}\n          </Avatar>\n          <Box flexGrow={1}>\n            <Typography variant=\"h6\">\n              {invitation.user_info.display_name || ''}\n            </Typography>\n            {/* <Typography variant=\"body2\" color=\"text.secondary\">\n              ID: {invitation.user_info.user_id}\n            </Typography> */}\n            <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 0.5 }}>\n              {formatDistanceToNow(invitation.created_at * 1000, { \n                addSuffix: true, \n                locale: zhCN \n              })}\n            </Typography>\n          </Box>\n          <Box textAlign=\"right\">\n            <Chip \n              size=\"small\"\n              icon={<AccessTimeIcon fontSize=\"small\" />}\n              label={isExpired ? '' : `${formatDistanceToNow(invitation.expires_at * 1000, { \n                addSuffix: true, \n                locale: zhCN \n              })}`}\n              color={isExpired ? 'error' : 'primary'}\n              variant=\"outlined\"\n            />\n          </Box>\n        </Box>\n        \n        {invitation.message && (\n          <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1, mb: 1 }}>\n            : {invitation.message}\n          </Typography>\n        )}\n\n        <Typography variant=\"body2\" color=\"primary\" sx={{ fontWeight: 'medium' }}>\n          \n        </Typography>\n      </CardContent>\n      \n      {!isExpired && (\n        <CardActions sx={{ justifyContent: 'flex-end', pt: 0 }}>\n          <Button \n            size=\"small\" \n            color=\"error\"\n            startIcon={<CloseIcon />}\n            onClick={() => handleRespond('decline')}\n            disabled={isProcessing || isProcessingAction}\n          >\n            \n          </Button>\n          <Button \n            size=\"small\" \n            color=\"primary\"\n            variant=\"contained\"\n            startIcon={<CheckIcon />}\n            onClick={() => handleRespond('accept')}\n            disabled={isProcessing || isProcessingAction}\n          >\n            \n          </Button>\n        </CardActions>\n      )}\n    </Card>\n  );\n}\n\nconst PendingInvitationsList: React.FC = () => {\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n  const [error, setError] = useState<string | null>(null);\n  const [invitations, setInvitations] = useState<IPendingInvitationInfo[]>([]);\n  const [isProcessing, setIsProcessing] = useState<boolean>(false);\n\n  // \n  const [userToken] = useProxyWatch(user, 'data.storeData.user_token', user.data.storeData.user_token);\n\n  // \n  const loadPendingInvitations = useCallback(async () => {\n    if (!userToken) {\n      setInvitations([]);\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      const res = await emergencyCallPendingInvitationService.listPendingReceivedInvitations({\n        params: {},\n      } as any);\n      \n      if (res.shellIsOk && res.dataIsOk && res.data?.is_ok) {\n        setInvitations(res.data.invitations || []);\n      } else {\n        setError(res.data?.msg || '');\n      }\n    } catch (err) {\n      console.error(':', err);\n      setError('');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [userToken]); // userToken\n\n  // \n  const handleRespondToInvite = useCallback(async (invitationId: string, action: 'accept' | 'decline'): Promise<void> => {\n    try {\n      setIsProcessing(true);\n\n      const res = await emergencyCallInvitationService.respondToInvite({\n        params: { invitation_id: invitationId, action },\n      } as any);\n\n      if (!res.shellIsOk || !res.dataIsOk || !res.data?.is_ok) {\n        throw new Error(res.data?.msg || '');\n      }\n      \n      // \n      setInvitations(prev => prev.filter(invite => invite.invitation_id !== invitationId));\n      \n      // \n      appModel.dispatcher.emit(AppModelEvent.InviteListUpdated);\n      \n    } catch (err) {\n      console.error(':', err);\n      setError(err instanceof Error ? err.message : '');\n    } finally {\n      setIsProcessing(false);\n    }\n  }, []);\n\n  // \n  useEffect(() => {\n    console.log('PendingInvitationsList - userToken changed:', userToken);\n    if (userToken) {\n      // \n      loadPendingInvitations();\n    } else {\n      // \n      setInvitations([]);\n    }\n  }, [userToken]); // userToken\n\n  // \n  useEffect(() => {\n    const unsubscribe = appModel.dispatcher.addListener(AppModelEvent.InviteListUpdated, () => {\n      console.log('AppModelEvent.InviteListUpdated - ');\n      loadPendingInvitations();\n    });\n\n    return unsubscribe;\n  }, [loadPendingInvitations]); // loadPendingInvitations\n\n  // \n  if (!userToken) {\n    return null;\n  }\n\n  if (isLoading) {\n    return (\n      <Box display=\"flex\" flexDirection=\"column\" alignItems=\"center\" p={2}>\n        {/* <CircularProgress size={24} />\n        <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1 }}>\n          ...\n        </Typography> */}\n      </Box>\n    );\n  }\n\n  if (error) {\n    return (\n      <Box p={2}>\n        <Alert severity=\"error\">\n          {error}\n        </Alert>\n      </Box>\n    );\n  }\n\n  if (invitations.length === 0) {\n    return (\n      <Box \n        display=\"flex\" \n        flexDirection=\"column\" \n        alignItems=\"center\" \n        p={2}\n        textAlign=\"center\"\n      >\n        {/* <NotificationsIcon color=\"disabled\" sx={{ fontSize: 48, mb: 1 }} />\n        <Typography variant=\"body2\" color=\"textSecondary\">\n          \n        </Typography> */}\n      </Box>\n    );\n  }\n\n  return (\n    <Box p={2}>\n      <Box display=\"flex\" alignItems=\"center\" mb={2}>\n        <NotificationsIcon color=\"primary\" sx={{ mr: 1 }} />\n        <Typography variant=\"h6\" color=\"primary\">\n           ({invitations.length})\n        </Typography>\n      </Box>\n\n      <Stack spacing={2}>\n        {invitations.map((invitation) => (\n          <PendingInvitationCard\n            key={invitation.invitation_id}\n            invitation={invitation}\n            onRespond={(action) => handleRespondToInvite(invitation.invitation_id, action)}\n            isProcessing={isProcessing}\n          />\n        ))}\n      </Stack>\n    </Box>\n  );\n};\n\nexport default PendingInvitationsList;","export * from \"C:\\\\work\\\\android-droid\\\\html\\\\website-2024-12\\\\node_modules\\\\.pnpm\\\\lodash@4.17.21\\\\node_modules\\\\lodash\\\\lodash.js\"","import React, { useState, useCallback } from 'react';\r\nimport {\r\n    Box,\r\n    Switch,\r\n    Button,\r\n    Typography,\r\n    Paper,\r\n    Collapse,\r\n    Divider,\r\n    IconButton,\r\n    TextField,\r\n    FormControlLabel,\r\n    Tooltip,\r\n    Stack,\r\n    FormControl,\r\n    MenuItem,\r\n    InputLabel,\r\n    Select,\r\n} from '@mui/material';\r\nimport { \r\n    DragIndicator as DragIndicatorIcon, \r\n    ExpandLess, \r\n    Settings, \r\n    Delete, \r\n    PlayArrow,\r\n    VolumeUp as VolumeUpIcon,\r\n    Vibration as VibrationIcon\r\n} from '@mui/icons-material';\r\nimport { DndContext, closestCenter, KeyboardSensor, PointerSensor, useSensor, useSensors, DragEndEvent } from '@dnd-kit/core';\r\nimport { arrayMove, SortableContext, sortableKeyboardCoordinates, useSortable, verticalListSortingStrategy } from '@dnd-kit/sortable';\r\nimport { CSS } from '@dnd-kit/utilities';\r\nimport { debounce } from 'lodash';\r\nimport { autoJsStoreUtils, autoWebViewJs } from '@droid/android'; \r\n\r\nconst PRE_ALARM_CONFIG_KEY = 'PRE_ALARM_ACTIONS_CONFIG';\r\n\r\ninterface PreAlarmAction {\r\n    id: string;\r\n    type: 'sound' | 'vibration';\r\n    duration: number;\r\n    resourceId?: string;\r\n}\r\n\r\ninterface PreAlarmConfig {\r\n    enabled: boolean;\r\n    actions: PreAlarmAction[];\r\n    maxWaitDuration: number;\r\n}\r\n\r\nconst defaultSoundResources = [\r\n    { id: 'beep_short', name: '' },\r\n    { id: 'siren_gentle', name: '' },\r\n    { id: 'alarm_clock', name: '' },\r\n];\r\n\r\nconst SortableActionItem: React.FC<{\r\n    action: PreAlarmAction;\r\n    onUpdate: (id: string, updates: Partial<Omit<PreAlarmAction, 'id'>>) => void;\r\n    onRemove: (id: string) => void;\r\n    onPreview: (resourceId?: string) => void;\r\n}> = ({ action, onUpdate, onRemove, onPreview }) => {\r\n    const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({ id: action.id });\r\n\r\n    const style = {\r\n        transform: CSS.Transform.toString(transform),\r\n        transition,\r\n        opacity: isDragging ? 0.8 : 1,\r\n        zIndex: isDragging ? 1 : 'auto',\r\n    };\r\n\r\n    return (\r\n        <Paper\r\n            ref={setNodeRef}\r\n            style={style}\r\n            elevation={isDragging ? 3 : 1}\r\n            sx={{\r\n                p: 2,\r\n                mb: 1,\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: 2,\r\n                cursor: isDragging ? 'grabbing' : 'grab',\r\n                borderLeft: `3px solid ${action.type === 'sound' ? '#3f51b5' : '#9c27b0'}`,\r\n            }}\r\n        >\r\n            <Box {...attributes} {...listeners} sx={{ display: 'flex', alignItems: 'center' }}>\r\n                <DragIndicatorIcon />\r\n            </Box>\r\n            \r\n            <Box sx={{ flexGrow: 1 }}>\r\n                <Box sx={{ display: 'flex', alignItems: 'center', gap: 2, mb: 1 }}>\r\n                    <Typography variant=\"subtitle2\">\r\n                        {action.type === 'sound' ? '' : ''}\r\n                    </Typography>\r\n                    <TextField\r\n                        size=\"small\"\r\n                        type=\"number\"\r\n                        label=\" (ms)\"\r\n                        value={action.duration}\r\n                        onChange={(e) => onUpdate(action.id, { duration: parseInt(e.target.value, 10) || 0 })}\r\n                        sx={{ width: 120 }}\r\n                    />\r\n                    \r\n                    {action.type === 'sound' && (\r\n                        <FormControl size=\"small\" sx={{ minWidth: 120 }}>\r\n                            <InputLabel></InputLabel>\r\n                            <Select\r\n                                value={action.resourceId || ''}\r\n                                label=\"\"\r\n                                onChange={(e) => onUpdate(action.id, { resourceId: e.target.value })}\r\n                                startAdornment={\r\n                                    <Tooltip title=\"\">\r\n                                        <IconButton\r\n                                            size=\"small\"\r\n                                            onClick={() => onPreview(action.resourceId)}\r\n                                            sx={{ mr: 1 }}\r\n                                        >\r\n                                            <PlayArrow fontSize=\"small\" />\r\n                                        </IconButton>\r\n                                    </Tooltip>\r\n                                }\r\n                            >\r\n                                {defaultSoundResources.map((sound) => (\r\n                                    <MenuItem key={sound.id} value={sound.id}>\r\n                                        {sound.name}\r\n                                    </MenuItem>\r\n                                ))}\r\n                            </Select>\r\n                        </FormControl>\r\n                    )}\r\n                </Box>\r\n            </Box>\r\n            \r\n            <IconButton onClick={() => onRemove(action.id)} size=\"small\" color=\"error\">\r\n                <Delete />\r\n            </IconButton>\r\n        </Paper>\r\n    );\r\n};\r\n\r\nconst PreAlarmConfig2: React.FC = () => {\r\n    const [config, setConfig] = useState<PreAlarmConfig | null>(null);\r\n    const [expanded, setExpanded] = useState(false);\r\n    const [isDragging, setIsDragging] = useState(false);\r\n\r\n    const debouncedWrite = useCallback(\r\n        debounce((newConfig: PreAlarmConfig) => {\r\n            autoJsStoreUtils.write(PRE_ALARM_CONFIG_KEY, newConfig);\r\n        }, 500),\r\n        []\r\n    );\r\n\r\n    const sensors = useSensors(\r\n        useSensor(PointerSensor, {\r\n            activationConstraint: {\r\n                distance: 8,\r\n            },\r\n        }),\r\n        useSensor(KeyboardSensor, {\r\n            coordinateGetter: sortableKeyboardCoordinates,\r\n        })\r\n    );\r\n\r\n    // Load config from storage\r\n    React.useEffect(() => {\r\n        const loadConfig = async () => {\r\n            const storedConfig = await autoJsStoreUtils.read<PreAlarmConfig>(PRE_ALARM_CONFIG_KEY);\r\n            if (storedConfig) {\r\n                // Ensure all actions have IDs\r\n                const actionsWithIds = storedConfig.actions.map((action) => ({\r\n                    ...action,\r\n                    id: action.id || `action-${Math.random().toString(36).substr(2, 9)}`,\r\n                }));\r\n                setConfig({\r\n                    ...storedConfig,\r\n                    actions: actionsWithIds,\r\n                });\r\n            } else {\r\n                // Default config\r\n                setConfig({\r\n                    enabled: true,\r\n                    actions: [],\r\n                    maxWaitDuration: 30000, // 30 seconds\r\n                });\r\n            }\r\n        };\r\n        loadConfig();\r\n    }, []);\r\n\r\n    const updateConfig = useCallback(\r\n        (updates: Partial<PreAlarmConfig>) => {\r\n            setConfig((prev) => {\r\n                if (!prev) return null;\r\n                const newConfig = { ...prev, ...updates };\r\n                debouncedWrite(newConfig);\r\n                return newConfig;\r\n            });\r\n        },\r\n        [debouncedWrite]\r\n    );\r\n\r\n    const handleToggleEnabled = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n        updateConfig({ enabled: event.target.checked });\r\n    };\r\n\r\n    const handleAddAction = (type: 'sound' | 'vibration') => {\r\n        const newAction: PreAlarmAction = {\r\n            id: `action-${Date.now()}`,\r\n            type,\r\n            duration: 3000, // 3 seconds default\r\n            ...(type === 'sound' && { resourceId: defaultSoundResources[0].id }),\r\n        };\r\n        updateConfig({\r\n            actions: [...(config?.actions || []), newAction],\r\n        });\r\n    };\r\n\r\n    const handleUpdateAction = (id: string, updates: Partial<Omit<PreAlarmAction, 'id'>>) => {\r\n        if (!config) return;\r\n        updateConfig({\r\n            actions: config.actions.map((action) =>\r\n                action.id === id ? { ...action, ...updates } : action\r\n            ),\r\n        });\r\n    };\r\n\r\n    const handleRemoveAction = (id: string) => {\r\n        if (!config) return;\r\n        updateConfig({\r\n            actions: config.actions.filter((action) => action.id !== id),\r\n        });\r\n    };\r\n\r\n    const handleDragEnd = (event: DragEndEvent) => {\r\n        const { active, over } = event;\r\n        if (!config || !over || active.id === over.id) return;\r\n\r\n        const oldIndex = config.actions.findIndex((a) => a.id === active.id);\r\n        const newIndex = config.actions.findIndex((a) => a.id === over.id);\r\n\r\n        if (oldIndex !== -1 && newIndex !== -1) {\r\n            updateConfig({\r\n                actions: arrayMove(config.actions, oldIndex, newIndex),\r\n            });\r\n        }\r\n    };\r\n\r\n    const handlePreviewSound = (resourceId?: string) => {\r\n        if (!resourceId) return;\r\n        const script = `com.fanfanlo.emergencycall.manager.SoundManager.previewSound(\"${resourceId}\");`;\r\n        autoWebViewJs.callScript(script);\r\n    };\r\n\r\n    if (!config) {\r\n        return <Box>...</Box>;\r\n    }\r\n\r\n    return (\r\n        <Box sx={{ mb: 3 }}>\r\n            {/* Header with toggle and settings button */}\r\n            <Paper \r\n                elevation={1} \r\n                sx={{ \r\n                    p: 2, \r\n                    display: 'flex', \r\n                    alignItems: 'center',\r\n                    justifyContent: 'space-between',\r\n                    borderRadius: 1,\r\n                }}\r\n            >\r\n                <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\r\n                    <Typography variant=\"subtitle1\"></Typography>\r\n                    <FormControlLabel\r\n                        control={\r\n                            <Switch\r\n                                checked={config.enabled}\r\n                                onChange={handleToggleEnabled}\r\n                                color=\"primary\"\r\n                            />\r\n                        }\r\n                        label={config.enabled ? '' : ''}\r\n                    />\r\n                </Box>\r\n                \r\n                <Button\r\n                    variant=\"outlined\"\r\n                    size=\"small\"\r\n                    startIcon={expanded ? <ExpandLess /> : <Settings />}\r\n                    onClick={() => setExpanded(!expanded)}\r\n                >\r\n                    {expanded ? '' : ''}\r\n                </Button>\r\n            </Paper>\r\n\r\n            {/* Collapsible content */}\r\n            <Collapse in={expanded}>\r\n                <Paper \r\n                    elevation={0} \r\n                    sx={{ \r\n                        mt: 1, \r\n                        p: 2, \r\n                        border: '1px solid', \r\n                        borderColor: 'divider',\r\n                        borderRadius: 1,\r\n                    }}\r\n                >\r\n                    <Box sx={{ mb: 3 }}>\r\n                        <Typography variant=\"subtitle2\" gutterBottom>\r\n                             ()\r\n                        </Typography>\r\n                        <TextField\r\n                            fullWidth\r\n                            type=\"number\"\r\n                            value={config.maxWaitDuration}\r\n                            onChange={(e) =>\r\n                                updateConfig({ maxWaitDuration: parseInt(e.target.value, 10) || 0 })\r\n                            }\r\n                            size=\"small\"\r\n                            InputProps={{\r\n                                endAdornment: (\r\n                                    <Typography variant=\"body2\" sx={{ ml: 1 }}>\r\n                                        \r\n                                    </Typography>\r\n                                ),\r\n                            }}\r\n                        />\r\n                    </Box>\r\n\r\n                    <Divider sx={{ my: 2 }} />\r\n\r\n                    <Box sx={{ mb: 2 }}>\r\n                        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\r\n                            <Typography variant=\"subtitle2\">\r\n                                 ({config.actions.length})\r\n                            </Typography>\r\n                            <Stack direction=\"row\" spacing={1}>\r\n                                <Button\r\n                                    variant=\"outlined\"\r\n                                    size=\"small\"\r\n                                    startIcon={<VolumeUpIcon />}\r\n                                    onClick={() => handleAddAction('sound')}\r\n                                >\r\n                                    \r\n                                </Button>\r\n                                <Button\r\n                                    variant=\"outlined\"\r\n                                    size=\"small\"\r\n                                    startIcon={<VibrationIcon />}\r\n                                    onClick={() => handleAddAction('vibration')}\r\n                                >\r\n                                    \r\n                                </Button>\r\n                            </Stack>\r\n                        </Box>\r\n\r\n                        {config.actions.length === 0 ? (\r\n                            <Paper\r\n                                variant=\"outlined\"\r\n                                sx={{\r\n                                    p: 3,\r\n                                    textAlign: 'center',\r\n                                    color: 'text.secondary',\r\n                                }}\r\n                            >\r\n                                <Typography></Typography>\r\n                            </Paper>\r\n                        ) : (\r\n                            <DndContext\r\n                                sensors={sensors}\r\n                                collisionDetection={closestCenter}\r\n                                onDragStart={() => setIsDragging(true)}\r\n                                onDragEnd={(e) => {\r\n                                    setIsDragging(false);\r\n                                    handleDragEnd(e);\r\n                                }}\r\n                                onDragCancel={() => setIsDragging(false)}\r\n                            >\r\n                                <SortableContext\r\n                                    items={config.actions.map((a) => a.id)}\r\n                                    strategy={verticalListSortingStrategy}\r\n                                >\r\n                                    <Box sx={{ opacity: isDragging ? 0.8 : 1 }}>\r\n                                        {config.actions.map((action) => (\r\n                                            <SortableActionItem\r\n                                                key={action.id}\r\n                                                action={action}\r\n                                                onUpdate={handleUpdateAction}\r\n                                                onRemove={handleRemoveAction}\r\n                                                onPreview={handlePreviewSound}\r\n                                            />\r\n                                        ))}\r\n                                    </Box>\r\n                                </SortableContext>\r\n                            </DndContext>\r\n                        )}\r\n                    </Box>\r\n                </Paper>\r\n            </Collapse>\r\n        </Box>\r\n    );\r\n};\r\n\r\nexport default PreAlarmConfig2;\r\n","import { Dialog, DialogContent, IconButton } from '@mui/material';\nimport { useEffect, useState } from 'react';\nimport CloseIcon from '@mui/icons-material/Close';\n\n// Add a React import for useRef\nimport React from 'react';\nimport { autoJsStoreUtils, autoWebViewJs, isRealInAndroid } from '@droid/android';\n\ninterface PrivacyDialogProps {\n  // open: boolean;\n  // onClose: () => void;\n  // onResult: (agree: boolean) => void;\n  type: string;\n  area: string;\n}\n\ninterface IPrivacyInfo{\n  agree:boolean;\n  disagreeTime:number;\n}\n\nexport function PrivacyDialog({ type, area }: PrivacyDialogProps) {\n  const url = `/privacies/${type}/${area}.html`;\n  const [iframeSrc, setIframeSrc] = useState(url);\n\n  const [open, setOpen] = useState(false);\n  function onClose() {\n    setOpen(false);\n  }\n\n  useEffect(()=>{\n    setIframeSrc(`/privacies/${type}/${area}.html`)\n  }, [type, area]);\n\n  useEffect(() => {\n    const def:IPrivacyInfo = {agree:false, disagreeTime:0}\n    const res = autoJsStoreUtils.read<IPrivacyInfo>(`privacy_${type}`, def);\n    const value:IPrivacyInfo = res && 'agree' in res ? res : def;\n    if(!isRealInAndroid){\n      return;\n    }\n    if(value.agree){\n      return\n    }\n    if(value.disagreeTime && value.disagreeTime != 0 &&  value.disagreeTime + 3 * 24 * 60 * 60 * 1000 > Date.now()){\n      return;\n    }\n    setOpen(true)\n  }, []);\n\n  useEffect(() => {\n    const handleMessage = (event: MessageEvent) => {\n      // Basic security check: ensure the message is from a trusted source if possible\n      // For now, we check the data structure.\n      if (event.source !== iframeRef.current?.contentWindow) {\n        return;\n      }\n\n      const { sender, agree } = event.data;\n\n      if (sender === 'privacy_page') {\n        console.log(`Received privacy decision: ${agree ? 'Agreed' : 'Disagreed'}`);\n\n        const value:IPrivacyInfo = {\n          agree,\n          disagreeTime: agree ? 0 : Date.now()\n        }\n        autoJsStoreUtils.write(`privacy_${type}`, value);\n        const s = `\n        var data = new com.fanfanlo.emergencycall.data.PrivacyData(${value.agree}, ${value.disagreeTime});\n        com.fanfanlo.emergencycall.data.PrivacyStateHolder.updateMainPrivacyByJs(data);\n        `\n        autoWebViewJs.callScript(s);\n\n        // onResult(agree);\n        onClose();\n      }\n    };\n\n    window.addEventListener('message', handleMessage);\n\n    return () => {\n      window.removeEventListener('message', handleMessage);\n    };\n  }, []);\n\n  const iframeRef = React.useRef<HTMLIFrameElement>(null);\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      PaperProps={{\n        sx: {\n          width: '80%',\n          height: '80%',\n          maxWidth: 'none',\n        },\n      }}>\n      <IconButton\n        aria-label=\"close\"\n        onClick={onClose}\n        sx={{\n          position: 'absolute',\n          right: 8,\n          top: 8,\n          color: theme => theme.palette.grey[500],\n        }}>\n        <CloseIcon />\n      </IconButton>\n      <DialogContent sx={{ padding: 0, overflow: 'hidden' }}>\n        {iframeSrc && (\n          <iframe\n            ref={iframeRef}\n            src={iframeSrc}\n            style={{ width: '100%', height: '100%', border: 'none' }}\n            title={`Privacy Policy - ${type}/${area}`}\n          />\n        )}\n      </DialogContent>\n    </Dialog>\n  );\n}\n\n\n","import { useEffect, useState } from \"react\";\r\nimport { PrivacyDialog } from \"./PrivacyDialog\";\r\nimport { autoJsStoreUtils } from \"@droid/android\";\r\n\r\n\r\nexport function ListenShowPrivacyContent({type}:{type:string}){\r\n\r\n    const [open, setOpen] = useState(false);\r\n    function onClose() {\r\n        setOpen(false);\r\n    }\r\n\r\n    useEffect(()=>{\r\n        const value = autoJsStoreUtils.read(`privacy_${type}`, false)\r\n        console.log('privacy value is', value, typeof value);\r\n    }, [])\r\n    return(\r\n        <PrivacyDialog type={type} area=\"zh-cn\" />\r\n    )\r\n}","import React, { useState, useEffect } from 'react';\nimport { Box, TextField, Button, Typography, Paper } from '@mui/material';\nimport { autoWebViewJs } from '@droid/android';\n\n\n\nexport const SensorMonitor: React.FC = () => {\n  const [threshold, setThreshold] = useState<string>('15.0');\n  const [isMonitoring, setIsMonitoring] = useState<boolean>(false);\n\n  // Effect to fetch the initial monitoring state from Android\n\n  function readIsMonitoring(){\n\n    try {\n      const script = `\n      var isMonitoring = com.fanfanlo.emergencycall.manager.SensorManager.isMonitoring();\n      isMonitoring;`;\n      const {javaResultString} = autoWebViewJs.callScript(script);\n      const isMonitoring = javaResultString === \"true\";\n      console.log(\"script get isMonitoring=\", isMonitoring, javaResultString);\n      setIsMonitoring(isMonitoring);\n    } catch (error) {\n      console.error('Error fetching initial monitoring state:', error);\n    }\n  }\n  useEffect(() => {\n    readIsMonitoring();\n  }, []);\n\n  const handleSetThreshold = () => {\n    const thresholdValue = parseFloat(threshold);\n    if (isNaN(thresholdValue)) {\n      alert('');\n      return;\n    }\n    try {\n      // This script now ONLY updates the threshold.\n      const script = `com.fanfanlo.emergencycall.manager.SensorManager.updateThreshold(${thresholdValue});`;\n      autoWebViewJs.callScript(script);\n      alert(`: ${thresholdValue}`);\n    } catch (error) {\n      console.error('Error calling updateThreshold:', error);\n      alert('');\n    }\n  };\n\n  const handleToggleMonitoring = () => {\n    try {\n      if (isMonitoring) {\n        const script = `com.fanfanlo.emergencycall.manager.SensorManager.stopMonitoring();`;\n        autoWebViewJs.callScript(script);\n      } else {\n        const script = `com.fanfanlo.emergencycall.manager.SensorManager.startMonitoring();`;\n        autoWebViewJs.callScript(script);\n      }\n      readIsMonitoring();\n    } catch (error) {\n      console.error('Error toggling monitoring:', error);\n      alert('');\n    }\n  };\n\n  return (\n    <Paper elevation={3} sx={{ padding: 2, margin: 2 }}>\n      <Typography variant=\"h6\" gutterBottom>\n        \n      </Typography>\n      <Box sx={{ display: 'flex', alignItems: 'center', gap: 2, marginBottom: 2 }}>\n        <TextField\n          label=\"\"\n          variant=\"outlined\"\n          type=\"number\"\n          value={threshold}\n          onChange={(e) => setThreshold(e.target.value)}\n          size=\"small\"\n        />\n        <Button variant=\"contained\" onClick={handleSetThreshold}>\n          \n        </Button>\n      </Box>\n      <Button\n        variant=\"contained\"\n        color={isMonitoring ? 'error' : 'primary'}\n        onClick={handleToggleMonitoring}\n        fullWidth\n      >\n        {isMonitoring ? '' : ''}\n      </Button>\n    </Paper>\n  );\n};\n\nexport default SensorMonitor;\n\n\n","import { autoWebViewJs } from \"@droid/android\";\r\nimport { Box, Button } from \"@mui/material\";\r\n\r\n\r\nexport function TestEmergencyCall() {\r\n    function onClick(){\r\n        const script = `\r\n        var instance = com.fanfanlo.emergencycall.service.SensorMonitoringService.instance;\r\n        if(instance){\r\n            instance.triggerEmergencyCall();\r\n        }\r\n        `\r\n        autoWebViewJs.callScript(script);\r\n    }\r\n    return(\r\n        <Box sx={{mt:\"10px\", mb:\"10px\"\r\n        }}>\r\n            <Button onClick={onClick}>\r\n                \r\n            </Button>\r\n        </Box>  \r\n    )\r\n}","import { AppShell, TabbarContainer } from '@app/ui';\nimport { MeetingRoom5 } from '@im/livekit';\nimport { IMOpenPageLink } from '@im/matrix';\nimport { Box, Button, Grid2 } from '@mui/material';\nimport { InviteContactDialog } from '@src/components/dialogs/InviteContactDialog';\nimport InvitationManager from '@src/components/InvitationManager/InvitationManager';\nimport { JpushIsInitialized } from '@src/components/jpush/IsInitialized';\nimport { NavBar } from '@src/components/navbar/NavBar';\nimport PendingInvitationsList from '@src/components/PendingInvitationsList/PendingInvitationsList';\nimport PreAlarmConfig2 from '@src/components/pre-alarm-config2';\nimport { ListenShowPrivacyContent } from '@src/components/privacies/ListenShowPrivacyContent';\nimport { SensorMonitor } from '@src/components/sensor-monitor/SensorMonitor';\nimport { TestEmergencyCall } from '@src/components/test/TestEmergencyCall';\nimport { mainModel } from '@src/libs/mc/main/MainModel';\nimport Link from 'next/link';\nimport { useState } from 'react';\n\nfunction Content() {\n  const [openInviteDialog, setOpenInviteDialog] = useState(false);\n\n  return (\n    <Box sx={{ my: 2, p: 2 }}>\n      <ListenShowPrivacyContent type=\"main\" />\n      {/* <InvitationManager /> */}\n      <PendingInvitationsList />\n      <PreAlarmConfig2 />\n      {/* <PreAlarmConfigComponent /> */}\n      <JpushIsInitialized />\n      <TestEmergencyCall />\n      <Grid2 container spacing={2} sx={{ mb: 2 }}>\n        <Grid2 size={6}>\n          <Button variant=\"contained\" onClick={() => setOpenInviteDialog(true)}>\n            \n          </Button>\n        </Grid2>\n        <Link href=\"/contacts\" style={{ textDecoration: 'none' }}>\n          \n        </Link>\n      </Grid2>\n      <SensorMonitor />\n      {openInviteDialog && <InviteContactDialog open={openInviteDialog} onClose={() => setOpenInviteDialog(false)} />}\n\n      <MeetingRoom5\n        roomName=\"test-room\"\n        userName={`user-${Math.random().toString(36).substring(2, 8)}`}\n        livekitConfig={mainModel.appConfig.livekit}\n        // role=\"initiator\" // Add role for testing\n      />\n      <IMOpenPageLink />\n    </Box>\n  );\n}\n\nexport default function Home() {\n  return (\n    <AppShell>\n      <TabbarContainer titleConf={{ ns: 'emergency-call/pages/home/content', key: 'home.title' }} navBar={<NavBar />}>\n        <Content />\n      </TabbarContainer>\n    </AppShell>\n  );\n}\n","import { useRouter } from \"next/router\";\r\nimport { useTranslation } from \"@fanfanlo\";\r\n\r\nimport HomeIcon from '@mui/icons-material/Home';\r\nimport SettingsIcon from '@mui/icons-material/Settings';\r\nimport { BottomNavigation, BottomNavigationAction } from \"@mui/material\";\r\ninterface TabInfoType {\r\n  label: string;\r\n  value: string;\r\n  icon: React.ReactNode;\r\n}\r\n\r\nexport function NavBar() {\r\n  const router = useRouter();\r\n  const { pathname } = router;\r\n  const { t } = useTranslation('emergency-call/components/navbar/content');\r\n  const tabInfoList: TabInfoType[] = [\r\n    { label: t('NavBar.home'), value: '/', icon: <HomeIcon /> },\r\n    // { label: t('content.create'), value: '/script-creator', icon: <CreateIcon /> },\r\n    // { label: t('content.market'), value: '/market', icon: <StorefrontIcon /> },\r\n    { label: t('NavBar.settings'), value: '/settings', icon: <SettingsIcon /> },\r\n  ];\r\n  return (\r\n\r\n    <BottomNavigation showLabels value={pathname}>\r\n      {tabInfoList.map(e => (\r\n        <BottomNavigationAction\r\n          key={e.value}\r\n          label={e.label}\r\n          icon={e.icon}\r\n          data-id={`tabbar-${e.value}`}\r\n          className={pathname === e.value ? 'Mui-selected' : ''}\r\n          onClick={() => {\r\n            if (pathname === e.value) return;\r\n            router.push(e.value);\r\n          }}\r\n        />\r\n      ))}\r\n    </BottomNavigation>\r\n  );\r\n}","export * from \"C:\\\\work\\\\android-droid\\\\html\\\\website-2024-12\\\\node_modules\\\\.pnpm\\\\react-i18next@15.6.0_i18next@24.2.3_typescript@5.7.3__react-dom@19.1.0_react@19.1.0__react@19.1.0_typescript@5.7.3\\\\node_modules\\\\react-i18next\\\\dist\\\\es\\\\index.js\"","\"use client\";\r\n// \r\nimport { initReactI18next } from \"react-i18next\";\r\n\r\nimport LanguageDetector from \"i18next-browser-languagedetector\";\r\nimport Backend, { type HttpBackendOptions } from \"i18next-http-backend\";\r\n\r\nimport i18next from \"i18next\";\r\nimport { Log } from \"../log/Log\";\r\nimport { getBuildTime, isServer } from \"../nextjs/env/env\";\r\nimport { fileMapUtils } from \"../utils\";\r\n;\r\nexport { useTranslation } from 'react-i18next';\r\nlet fileDateVersion:string = ''// = getConfig().publicRuntimeConfig?.version\r\nexport const i18nLogger = new Log(false, `i18n`);\r\nconst windowHref = (()=>{\r\n  if(typeof window === 'undefined')return ''\r\n  const u = new URL(window.location.href || window.parent?.location.href);\r\n  // iframehref.\r\n  return u.origin == null || u.origin == 'null' ? '' : u.origin\r\n})()\r\nconst backendOptions = {\r\n  loadPath: function (lngs: string[], namespaces: string[]) {\r\n    const log = i18nLogger.sub(false, `i18n loadpath`);\r\n    log.pause = true;\r\n    const lng = lngs[0]\r\n    let p = ``\r\n    // p = `/options/_locales/${lngs[0].replace(\"-\", \"_\")}/messages.json`;\r\n    // p = `/locales/zh-CN/ns1/content.json`;\r\n    // p = `locales/${lng}/${namespaces[0]}.json?v=${fileDateVersion}`\r\n    const ps = namespaces[0].split('/')\r\n    ps.splice(ps.length - 1, 0, lng)\r\n    // p = `locales/${ps.join('/')}.json?v=${fileDateVersion}`\r\n    // p = `locales/${ps.join('/')}.json?v=${getBuildTime()}`\r\n    p = `locales/${ps.join('/')}.json`\r\n    log.log(`lngs=`, lngs);\r\n    log.log(`namespaces=`, namespaces);\r\n    log.log(\"p=\", p);\r\n    p = fileMapUtils.getFile(`/${p}`);\r\n    // console.log('map p=', p)\r\n    p = `${windowHref}/${p}`\r\n    return p;\r\n\r\n  },\r\n  parse: function (\r\n    data: string,\r\n    languages?: string | string[],\r\n    namespaces?: string | string[]\r\n  ) {\r\n    const log = i18nLogger.sub(false, `i18n backend parse`);\r\n    log.pause = true;\r\n    // log.log(`parrrse`, data, languages, namespaces);\r\n    const l = JSON.parse(data);\r\n    log.print(`before set i18ndata`);\r\n    // i18nData = l as II18n;\r\n    // log.log(`i18nData.rule.scripts.sys.rules`, i18nData.rule.scripts.sys.rules);\r\n    log.log(`parrrse`, languages, namespaces);\r\n    return l;\r\n  },\r\n};\r\nconst backend = new Backend();\r\nbackend.init(null, backendOptions);\r\nexport const i18n = i18next;\r\n// export const resources: Resource = {\r\n//   // 'zh-CN': {\r\n//   //   translation: _.merge({}, zhCN),\r\n//   // },\r\n//   // en: {\r\n//   //   translation: _.merge({}, en),\r\n//   // },\r\n// };\r\n\r\n\r\ni18n.on(\"languageChanged\", async function (lng) {\r\n  const log = i18nLogger.sub(false, `onlanguageChanged`);\r\n  log.pause = true;\r\n  log.log(`lllllng`, lng);\r\n  // lng = \"en\";\r\n  // const p = `/options/_locales/${lng.replace(\"-\", \"_\")}/messages.json`;\r\n});\r\n\r\n\r\n\r\n\r\nexport function i18nInit(_fileDateVersion:string=''){\r\n  fileDateVersion = _fileDateVersion\r\n  i18n\r\n  .use(LanguageDetector)\r\n  .use(backend)\r\n  .use(initReactI18next)\r\n  .init<HttpBackendOptions>({\r\n    load: \"currentOnly\",\r\n    // load: \"all\",\r\n    // supportedLngs: ['zh-CN', 'zh-TW', 'en', 'en-GB', 'ja'],\r\n    // resources,\r\n    fallbackLng: isServer ? \"en\" : \"zh-CN\",\r\n    // fallbackLng: \"zh-CN\",\r\n    // lng: \"zh-CN\",\r\n    partialBundledLanguages:true,\r\n    ns:[],\r\n    \r\n    debug: false,\r\n    interpolation: {\r\n      escapeValue: false, // not needed for react as it escapes by default\r\n    },\r\n    detection: {\r\n      caches: [\"localStorage\"],\r\n    },\r\n  });\r\n}\r\ni18n.on(\"missingKey\", function (lngs, namespace, key, res) {\r\n  console.error(\r\n    \"i18n mssing key, lngs=%s, namespace=%s, key=%s, res=%s\",\r\n    lngs,\r\n    namespace,\r\n    key,\r\n    res\r\n  );\r\n});\r\n\r\ni18n.on(\"loaded\", function (loaded) {\r\n  const log = i18nLogger.sub(false, `onloaded`);\r\n  log.pause = true;\r\n  log.log(`onloaded arguments`, loaded);\r\n});\r\n\r\ni18n.on(\"failedLoading\", function (lng, ns, msg) {\r\n  const log = i18nLogger.sub(false, `onfailedLoading`);\r\n  log.pause = true;\r\n  log.log(`failedLoading arguments`, lng, ns, msg);\r\n});\r\n\r\ni18n.on(\"added\", function () {\r\n  console.log('added', arguments)\r\n});   \r\n\r\nexport default i18n;","import { createContext } from \"react\";\r\nimport { storeUtils } from \"./store-utils\";\r\n// import { storeUtils } from \"./store\";\r\nconst s = storeUtils.namespace('store-page-context')\r\n\r\nexport interface IPageScrollPosition{\r\n    x:number\r\n    y:number\r\n}\r\n\r\nfunction create(){\r\n    return createContext(s)\r\n}\r\nexport const StorePageContext = createContext<any>(s)\r\n\r\nexport const StorePageDynamicContext = createContext<Record<string, any>>({})","'use client'\r\nimport { i18n, i18nInit, IPageScrollPosition, StorePageContext, StorePageDynamicContext, toProxy, watchUpdates, storeUtils } from \"@fanfanlo\";\r\nimport { useRouter } from \"next/router\";\r\nimport getConfig from \"node_modules/next/config\";\r\nimport { PropsWithChildren, useEffect } from \"react\";\r\nimport { I18nextProvider } from \"react-i18next\";\r\n\r\ncheckReloadPage();\r\ni18nInit()\r\n\r\n\r\nfunction checkReloadPage(){\r\n  if(typeof window === 'undefined')return\r\n  if(getConfig().publicRuntimeConfig.isDevelopment){\r\n    return\r\n  }\r\n  // url_htmlRefreshTime\r\n  // _htmlRefresTime\r\n  const searchParams = new URL(window.location.href).searchParams\r\n  const htmlRefreshTime = searchParams.get('_htmlRefreshTime')\r\n  if (!htmlRefreshTime) {\r\n    const newUrl = new URL(window.location.href)\r\n    newUrl.searchParams.set('_htmlRefreshTime', String(Date.now()))\r\n    window.location.href = newUrl.toString()\r\n    return\r\n  }\r\n\r\n  const refreshTime = Number(htmlRefreshTime)\r\n  if (refreshTime + 2 * 60 * 1000 < Date.now()) {\r\n    const newUrl = new URL(window.location.href)\r\n    newUrl.searchParams.set('_htmlRefreshTime', String(Date.now()))\r\n    window.location.href = newUrl.toString()\r\n  }\r\n}\r\nexport function AppShell({ children }: PropsWithChildren) {\r\n  const router = useRouter();\r\n  const scrollKey = 'scrollPositionInfo'\r\n  const href = window.location.href.split(\"#\")[0]\r\n  const dynamicKey = `dynamic-${href}`\r\n  const s = storeUtils.namespace(dynamicKey);\r\n  let o: Record<string, unknown>|undefined = s.read(dynamicKey)\r\n  if (!o) {\r\n    o = {}\r\n    s.write(dynamicKey, o)\r\n  }\r\n  o = toProxy(o)\r\n  useEffect(() => {\r\n\r\n    router.beforePopState((state) => {\r\n      s.clearAll()\r\n      return true\r\n    })\r\n  })\r\n  useEffect(() => {\r\n    s.write(dynamicKey, o)\r\n    return watchUpdates(o, () => {\r\n      s.write(dynamicKey, o)\r\n    })\r\n  }, [])\r\n  useEffect(() => {\r\n    const info = (s.read(scrollKey) || { x: 0, y: 0 }) as IPageScrollPosition\r\n    // console.log('app shell scroll info info = ', info)\r\n    if (info.x == 0 && info.y == 0) {\r\n      listenScroll()\r\n    } else {\r\n      window.requestAnimationFrame(() => {\r\n        window.scrollTo(info.x, info.y)\r\n        listenScroll()\r\n      })\r\n    }\r\n    function onScroll(e: Event) {\r\n      // console.log('app shell on scroll', { x: window.scrollX, y: window.scrollY })\r\n      s.write(scrollKey, { x: window.scrollX, y: window.scrollY })\r\n    }\r\n    function listenScroll() {\r\n      window.addEventListener('scroll', onScroll)\r\n    }\r\n\r\n    function unsub() {\r\n      window.removeEventListener('scroll', onScroll)\r\n    }\r\n    return unsub\r\n  });\r\n  return (\r\n    <StorePageContext value={s}>\r\n      <StorePageDynamicContext value={o}>\r\n\r\n        <I18nextProvider i18n={i18n}>\r\n          {children}\r\n        </I18nextProvider>\r\n      </StorePageDynamicContext>\r\n    </StorePageContext>\r\n  )\r\n}","import { Box, Button, Container } from '@mui/material';\r\nimport { createContext, PropsWithChildren, useContext, useEffect } from 'react';\r\nimport { ITitleI18nConf, ITitleI18nNsConf, ITitleI18nTitleConf } from '.';\r\nimport { isBuild, isDev, isServer, loadI18nValue, publicRuntimeConfig } from '@fanfanlo';\r\nimport { read } from 'fs';\r\nimport { useTranslation } from '@fanfanlo';\r\n\r\n\r\nfunction Reload(){\r\n  if(!isDev)return <>  </>\r\n  const {t} = useTranslation(\"app-ui/components/page/content\")\r\n  return(\r\n    <Box>\r\n      <Button onClick={() => {window.location.reload()}}>{t(\"PageContent.refresh\")}</Button>\r\n      {new Date().toLocaleString()}\r\n    </Box>\r\n  )\r\n}\r\n\r\nconst ScrollP = createContext({ x: 0, y: 0 });\r\nlet index = 0;\r\nexport default function PageContent({ children, titleConf, reload }: {titleConf?:ITitleI18nConf, reload?: boolean} & PropsWithChildren) {\r\n  index++;\r\n  const scroll = useContext(ScrollP);\r\n  const clazz = `${Date.now() + Math.random() * Date.now()}`;\r\n  useEffect(()=>{\r\n    async function loadTitle(){\r\n      if(!titleConf)return\r\n      let title = titleConf.title\r\n      if(titleConf.ns){\r\n        title = await loadI18nValue(titleConf.ns, titleConf.key || \"content.title\")\r\n      }\r\n      if(!title)return\r\n      document.title = title\r\n    }\r\n    loadTitle()\r\n  }, [])\r\n  useEffect(() => {\r\n    const container = document.getElementsByClassName(clazz)[0];\r\n    if (!container) return;\r\n    container.scrollTop = scroll.y;\r\n    const onScroll = () => {\r\n      var scrollTop = container.scrollTop;\r\n      scroll.y = scrollTop;\r\n    };\r\n    container.removeEventListener('scroll', onScroll);\r\n    container.addEventListener('scroll', onScroll, { passive: true });\r\n    return () => container.removeEventListener('scroll', onScroll);\r\n  }, [clazz, scroll]);\r\n  return (\r\n\r\n    <Container className={clazz} sx={{ flexGrow: 1, overflow: 'auto', padding: \"0px\" }}>\r\n      <Box>\r\n        {(reload || (reload == undefined)) && <Reload />}\r\n        \r\n        {children}\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n","import { PropsWithChildren } from \"react\";\r\nimport PageContent from \"./PageContent\";\r\nimport { ITitleI18nConf } from \".\";\r\nexport default function AndroidPageContent({ children, titleConf, reload }: {titleConf?:ITitleI18nConf, reload?: boolean} & PropsWithChildren)  {\r\n    return (\r\n        <PageContent titleConf={titleConf} reload={reload}>\r\n            {children}\r\n        </PageContent>\r\n    )\r\n}\r\n","import { IRequestOptions } from \"../IRequestOptions\";\nimport { tms } from \"../tms\";\nimport { IRequestHandler, request } from \"@fanfanlo\";\n\n/**\n * \n */\nexport interface IParamsListAllInvitations {\n  // \n  page?: number;\n  page_size?: number;\n}\n\n/**\n * \n */\nexport interface IInvitationUserInfo {\n  user_id: string;\n  display_name: string;\n  avatar_url?: string;\n}\n\n// \nexport type InviteStatus = 'pending' | 'accepted' | 'declined' | 'expired' | 'cancelled';\n\n// \nexport interface IInvitationDetails {\n  invitation_id: string;\n  user_info: {\n    user_id: string;\n    display_name: string;\n    avatar_url?: string;\n  };\n  status: InviteStatus;\n  message: string;\n  created_at: number;\n  expires_at: number;\n}\n\n/**\n * \n */\nexport interface IResultListAllInvitations {\n  is_ok: boolean;\n  msg?: string;\n  sent_invitations: IInvitationDetails[];\n  received_invitations: IInvitationDetails[];\n}\n\n/**\n * \n */\nexport interface IParamsRespondToInvite {\n  invitation_id: string;\n  action: 'accept' | 'decline' | 'cancel' | 'remove';\n}\n\n/**\n * \n */\nexport async function tmsEmergencyCallListAllInvitations(\n  opts: IRequestOptions<IParamsListAllInvitations>\n) {\n  return request<IResultListAllInvitations, IParamsListAllInvitations>(\n    tms.TEmc,\n    tms.MEmcListAllInvitations,\n    opts.params,\n    opts.gateway,\n    opts.handler\n  );\n}\n\n/**\n * \n * @param invitationId ID\n * @param isReceived \n * @returns Promise\n */\nexport async function cancelOrRemoveInvitation(\n  invitationId: string,\n  isReceived: boolean\n) {\n  const action = isReceived ? 'remove' : 'cancel';\n  return emergencyCallInvitationService.respondToInvite({\n    params: {\n      invitation_id: invitationId,\n      action\n    }\n  } as any);\n}\n\n/**\n * \n */\nexport async function tmsEmergencyCallRespondToInvite(\n  opts: IRequestOptions<IParamsRespondToInvite>\n) {\n  return request<{ is_ok: boolean; msg?: string }, IParamsRespondToInvite>(\n    tms.TEmc,\n    tms.MEmcRespondToInvite,\n    opts.params,\n    opts.gateway,\n    opts.handler\n  );\n}\n\n// \nexport const emergencyCallInvitationService = {\n  listAllInvitations: tmsEmergencyCallListAllInvitations,\n  respondToInvite: tmsEmergencyCallRespondToInvite,\n};\n\nexport default emergencyCallInvitationService;\n","'use client';\r\nimport { BottomNavigation, BottomNavigationAction, Box, CssBaseline, Paper, Stack } from '@mui/material';\r\n\r\nimport HomeIcon from '@mui/icons-material/Home';\r\nimport SettingsIcon from '@mui/icons-material/Settings';\r\nimport StorefrontIcon from '@mui/icons-material/Storefront';\r\nimport { useRouter } from 'next/router';\r\nimport React, { PropsWithChildren } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { ITitleI18nConf } from '../page';\r\nimport AndroidPageContent from '../page/AndroidPageContent';\r\nimport CreateIcon from '@mui/icons-material/Create';\r\n// interface TabInfoType {\r\n//   label: string;\r\n//   value: string;\r\n//   icon: React.ReactNode;\r\n// }\r\n\r\nfunction BottomBar({navBar}:{navBar?:React.ReactNode}) {\r\n  return <Paper\r\n    id=\"bottom-navigation\"\r\n    sx={{ position: 'fixed', bottom: 0, left: 0, right: 0 }}\r\n    elevation={3}>\r\n    {/* <NavBar /> */}\r\n    {navBar}\r\n  </Paper>;\r\n}\r\n// function NavBar() {\r\n//   const router = useRouter();\r\n//   const { pathname } = router;\r\n//   const { t } = useTranslation('app-ui/components/tabbar/content');\r\n//   const tabInfoList: TabInfoType[] = [\r\n//     { label: t('content.home'), value: '/', icon: <HomeIcon /> },\r\n//     // { label: t('content.create'), value: '/script-creator', icon: <CreateIcon /> },\r\n//     // { label: t('content.market'), value: '/market', icon: <StorefrontIcon /> },\r\n//     { label: t('content.settings'), value: '/settings', icon: <SettingsIcon /> },\r\n//   ];\r\n//   return (\r\n\r\n//     <BottomNavigation showLabels value={pathname}>\r\n//       {tabInfoList.map(e => (\r\n//         <BottomNavigationAction\r\n//           key={e.value}\r\n//           label={e.label}\r\n//           icon={e.icon}\r\n//           data-id={`tabbar-${e.value}`}\r\n//           className={pathname === e.value ? 'Mui-selected' : ''}\r\n//           onClick={() => {\r\n//             if (pathname === e.value) return;\r\n//             router.push(e.value);\r\n//           }}\r\n//         />\r\n//       ))}\r\n//     </BottomNavigation>\r\n//   );\r\n// }\r\n\r\n\r\n// testWatchUpdates()\r\nexport function TabbarContainer({ children, titleConf, navBar }: {titleConf?:ITitleI18nConf, navBar:React.ReactNode} & PropsWithChildren)  {\r\n  return (\r\n    <Box sx={{ display: 'flex', flexDirection: 'column', height2: '100vh' }}>\r\n      <CssBaseline />\r\n      <Stack direction={\"column\"} spacing={3}\r\n      \r\n      >\r\n        <AndroidPageContent titleConf={titleConf}>\r\n          {children}\r\n        </AndroidPageContent>\r\n        <BottomBar navBar={navBar} />\r\n      </Stack>\r\n    </Box>\r\n  );\r\n}\r\n\r\n"],"names":["React","useCallback","useEffect","useRef","useState","forwardRef","Room","RoomEvent","RemoteParticipant","RemoteTrack","Track","createLocalAudioTrack","createLocalVideoTrack","Box","Button","Typography","Alert","IconButton","CircularProgress","Grid","Mic","MicIcon","MicOff","MicOffIcon","Videocam","VideoIcon","VideocamOff","VideoOffIcon","CallEnd","CallEndIcon","VolumeUp","VolumeUpIcon","VolumeOff","VolumeOffIcon","Refresh","RefreshIcon","Visibility","VisibilityIcon","VisibilityOff","VisibilityOffIcon","Log","logger","uiLogger","sub","VIDEO_PRESET","width","height","frameRate","maxBitrate","MeetingRoomComponent","ref","livekitConfig","roomName","userName","onDisconnect","onError","className","style","sx","directly","globalMediaState","setGlobalMediaState","isAudioEnabled","isVideoEnabled","remoteMediaState","setRemoteMediaState","isAudioSubscribed","isVideoSubscribed","toggleRemoteAudio","newState","log","prev","from","to","roomRef","current","participantCount","remoteParticipants","size","forEach","participant","identity","audioTrackCount","trackPublications","publication","kind","Kind","Audio","trackSid","isSubscribed","setSubscribed","toggleRemoteVideo","videoTrackCount","Video","handleParticipantConnected","audioSubscribed","videoSubscribed","audioTracksProcessed","videoTracksProcessed","isAudio","shouldSubscribe","audioTracks","videoTracks","setParticipants","exists","some","p","localTracksRef","videoElements","audioElements","participantStates","setParticipantStates","isUnmountedRef","isConnecting","setIsConnecting","hasConnected","setHasConnected","error","setError","isMuted","setIsMuted","setIsVideoEnabled","participants","fetchToken","response","fetch","jwt","method","headers","body","JSON","stringify","room_name","ok","Error","data","json","token","connectToRoom","audioTrack","videoTrack","createLocalTracks","room","adaptiveStream","dynacast","videoCaptureDefaults","resolution","publishDefaults","dtx","red","forceStereo","simulcast","setupRoomListeners","connect","wsUrl","autoSubscribe","Promise","all","localParticipant","publishTrack","publishError","Array","values","updateParticipantState","initParticipantState","getTrackPublications","track","handleTrackSubscribed","cleanupTracks","disconnect","e","echoCancellation","noiseSuppression","autoGainControl","tracks","stop","detach","trackElementsRef","videoElementsRef","audioElementsRef","state","isAudioEnabledGlobal","isVideoEnabledGlobal","isVideoTrack","updateTrackState","stateUpdate","on","participantExists","off","eventHandlers","participantConnected","handleTrackPublished","once","participantDisconnected","newParticipants","filter","map","trackSubscribed","disconnected","reason","reasonStr","toString","reconnecting","reconnected","Disconnected","Reconnecting","Reconnected","ParticipantConnected","ParticipantDisconnected","TrackSubscribed","undefined","leaveMeeting","Object","el","remove","cleanup","isUnmounting","find","t","updateGlobalMediaState","audioEnabled","videoEnabled","toggleMute","newGlobalAudioState","unmute","mute","toggleVideo","newGlobalVideoState","handleLocalMuteToggle","newMutedState","handleLocalVideoToggle","newVideoState","getParticipantState","pub","handleToggleAudio","currentState","handleToggleVideo","getEffectiveMediaState","participantId","ParticipantVideo","memo","isLocal","videoRef","setVideoTrack","videoPublication","handleTrackUnsubscribed","TrackUnsubscribed","videoElement","firstChild","removeChild","attach","aspectRatio","bgcolor","display","alignItems","justifyContent","position","video","autoPlay","playsInline","muted","objectFit","top","left","right","bottom","borderRadius","color","fontSize","fontWeight","charAt","toUpperCase","ParticipantAudio","audioRef","setAudioTrack","audioPublication","audioElement","audio","renderParticipant","effectiveState","overflow","boxShadow","container","gap","item","onClick","variant","title","renderControlButtons","renderMainContent","flexDirection","flex","spacing","xs","md","length","borderTop","borderColor","gutterBottom","disabled","startIcon","mt","ml","content","severity","m","MeetingRoom5","displayName","request","tms","tmsEmcInviteContacts","opts","res","TEmc","MEmcInviteContacts","params","gateway","handler","tmsEmcGetContactTypes","MEmcGetContactTypes","Dialog","DialogActions","DialogContent","DialogTitle","TextField","Autocomplete","user","toast","matrixUser","authService","useProxyWatch","fileLogger","isValidIdentity","text","test","is11DigitNumber","InviteContactDialog","open","onClose","onInviteSent","contacts","setContacts","remark","setRemark","callType","setCallType","availableCallTypes","setAvailableCallTypes","console","message","setMessage","isLoading","setIsLoading","isTypesLoading","setIsTypesLoading","pendingParams","setPendingParams","executionLock","accessToken","userData","userInfo","loginResponse","access_token","isUserLoggedIn","sessionData","global_user_info","userToken","storeData","user_token","finalParams","matrix_access_token","type","executeApiCall","responseData","printLog","err","shellIsOk","dataIsOk","errorMessage","results","msg","successResults","r","result_code","infoResults","errorResults","success","infoMessages","Boolean","join","errorMessages","fetchCallTypes","types","formattedTypes","id","uuid","name","is_system","defaultType","warn","handleSendInvitation","contactInputs","split","c","trim","contactIdentities","input","push","identityType","appLoggedIn","showLoginDialog","currentAccessToken","apiParams","maxWidth","fullWidth","component","autoFocus","margin","label","multiline","rows","placeholder","value","onChange","target","freeSolo","options","option","event","newValue","inputValue","onInputChange","newInputValue","disablePortal","disableClearable","forcePopupIcon","mb","renderInput","InputProps","endAdornment","ListboxProps","maxHeight","autoWebViewJs","JpushIsInitialized","isInitialized","setIsInitialized","refresh","script","javaResultData","callScript","span","tmsEmergencyCallListPendingReceivedInvitations","MEmcListPendingReceivedInvitations","emergencyCallPendingInvitationService","listPendingReceivedInvitations","Card","CardContent","CardActions","Avatar","Chip","Stack","Check","CheckIcon","Close","CloseIcon","AccessTime","AccessTimeIcon","Notifications","NotificationsIcon","formatDistanceToNow","zhCN","emergencyCallInvitationService","AppModelEvent","appModel","PendingInvitationCard","invitation","onRespond","isProcessing","isProcessingAction","setIsProcessingAction","handleRespond","action","isExpired","Date","expires_at","opacity","src","user_info","avatar_url","alt","display_name","mr","flexGrow","created_at","addSuffix","locale","textAlign","icon","pt","PendingInvitationsList","invitations","setInvitations","setIsProcessing","loadPendingInvitations","is_ok","handleRespondToInvite","invitationId","respondToInvite","invitation_id","invite","dispatcher","emit","InviteListUpdated","unsubscribe","addListener","Switch","Paper","Collapse","Divider","FormControlLabel","Tooltip","FormControl","MenuItem","InputLabel","Select","DragIndicator","DragIndicatorIcon","ExpandLess","Settings","Delete","PlayArrow","Vibration","VibrationIcon","DndContext","closestCenter","KeyboardSensor","PointerSensor","useSensor","useSensors","arrayMove","SortableContext","sortableKeyboardCoordinates","useSortable","verticalListSortingStrategy","CSS","debounce","autoJsStoreUtils","PRE_ALARM_CONFIG_KEY","defaultSoundResources","SortableActionItem","onUpdate","onRemove","onPreview","attributes","listeners","setNodeRef","transform","transition","isDragging","Transform","zIndex","elevation","cursor","borderLeft","duration","parseInt","minWidth","resourceId","startAdornment","sound","PreAlarmConfig2","config","setConfig","expanded","setExpanded","setIsDragging","debouncedWrite","newConfig","write","sensors","activationConstraint","distance","coordinateGetter","loadConfig","storedConfig","read","actionsWithIds","actions","Math","random","substr","enabled","maxWaitDuration","updateConfig","updates","handleToggleEnabled","checked","handleAddAction","newAction","now","handleUpdateAction","handleRemoveAction","handleDragEnd","active","over","oldIndex","findIndex","a","newIndex","handlePreviewSound","control","in","border","my","direction","collisionDetection","onDragStart","onDragEnd","onDragCancel","items","strategy","isRealInAndroid","PrivacyDialog","area","url","iframeSrc","setIframeSrc","setOpen","def","agree","disagreeTime","handleMessage","iframeRef","source","contentWindow","sender","s","window","addEventListener","removeEventListener","PaperProps","aria-label","theme","palette","grey","padding","iframe","ListenShowPrivacyContent","SensorMonitor","threshold","setThreshold","isMonitoring","setIsMonitoring","readIsMonitoring","javaResultString","handleSetThreshold","thresholdValue","parseFloat","isNaN","alert","handleToggleMonitoring","marginBottom","TestEmergencyCall","AppShell","TabbarContainer","IMOpenPageLink","Grid2","NavBar","mainModel","Link","Content","openInviteDialog","setOpenInviteDialog","href","textDecoration","substring","appConfig","livekit","Home","titleConf","ns","key","navBar","useRouter","useTranslation","HomeIcon","SettingsIcon","BottomNavigation","BottomNavigationAction","router","pathname","tabInfoList","showLabels","data-id","initReactI18next","LanguageDetector","Backend","i18next","isServer","fileMapUtils","fileDateVersion","i18nLogger","windowHref","u","URL","location","parent","origin","backendOptions","loadPath","lngs","namespaces","pause","lng","ps","splice","getFile","parse","languages","l","print","backend","init","i18n","i18nInit","_fileDateVersion","use","load","fallbackLng","partialBundledLanguages","debug","interpolation","escapeValue","detection","caches","namespace","loaded","arguments","createContext","storeUtils","create","StorePageContext","StorePageDynamicContext","toProxy","watchUpdates","getConfig","I18nextProvider","checkReloadPage","publicRuntimeConfig","isDevelopment","searchParams","htmlRefreshTime","get","newUrl","set","String","refreshTime","Number","children","scrollKey","dynamicKey","o","beforePopState","clearAll","info","x","y","listenScroll","requestAnimationFrame","scrollTo","onScroll","scrollX","scrollY","unsub","Container","useContext","isDev","loadI18nValue","Reload","reload","toLocaleString","ScrollP","index","PageContent","scroll","clazz","loadTitle","document","getElementsByClassName","scrollTop","passive","AndroidPageContent","tmsEmergencyCallListAllInvitations","MEmcListAllInvitations","cancelOrRemoveInvitation","isReceived","tmsEmergencyCallRespondToInvite","MEmcRespondToInvite","listAllInvitations","CssBaseline","BottomBar","height2"],"sourceRoot":"","ignoreList":[7,15]}