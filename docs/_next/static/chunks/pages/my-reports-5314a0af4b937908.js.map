{"version":3,"file":"static/chunks/pages/my-reports-5314a0af4b937908.js","mappings":"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","sources":["webpack://_N_E/../../libs/app/model/src/remote/report/getMyList.ts","webpack://_N_E/./src/components/report/MyReportsList/index.tsx","webpack://_N_E/./src/pages/my-reports/index.tsx","webpack://_N_E/?ac50","webpack://_N_E/../../libs/app/model/src/remote/report/submit.ts","webpack://_N_E/./src/components/report/ReportSubmitModal/index.tsx"],"sourcesContent":["import { IRequestParams, IResultContent, request } from \"@fanfanlo\";\nimport { tms } from \"../tms\";\nimport { IUserReport } from \"./types\"; // 引用通用的类型\n\n// --- 获取我的举报列表 ---\n\n/**\n * @description 获取我的举报列表的请求参数\n */\nexport interface IGetMyReportsParams {\n    page?: number;\n    limit?: number;\n}\n\n/**\n * @description 获取我的举报列表的响应结果\n */\nexport interface IGetMyReportsResult {\n    is_ok: boolean;\n    msg: string;\n    reports: IUserReport[];\n    total: number;\n    page: number;\n    limit: number;\n}\n\n/**\n * @description 获取当前用户提交的举报列表\n * @param {IGetMyReportsParams} params - 分页参数\n * @returns {Promise<IGetMyReportsResult>}\n */\nexport async function getMyReports(params: IGetMyReportsParams) {\n    const res = await request<IGetMyReportsResult>(\n        tms.TReport,\n        tms.MReportGetMyList,\n        params\n    );\n    return res\n}\n","import React, { useState, useEffect } from 'react';\nimport {\n    Box,\n    List,\n    ListItem,\n    ListItemText,\n    Typography,\n    CircularProgress,\n    Alert,\n    Chip,\n    Divider,\n    Pagination,\n    Button,\n} from '@mui/material';\nimport AddCommentIcon from '@mui/icons-material/AddComment';\nimport { getMyReports } from '@app/model';\nimport { IUserReport } from '@app/model';\nimport { ReportSubmitModal } from '../ReportSubmitModal';\n\n// Helper function to render status with appropriate color\nconst getStatusChip = (status: IUserReport['status']) => {\n    switch (status) {\n        case 'resolved':\n            return <Chip label=\"已处理\" color=\"success\" size=\"small\" />;\n        case 'dismissed':\n            return <Chip label=\"已驳回\" color=\"warning\" size=\"small\" />;\n        case 'pending':\n        default:\n            return <Chip label=\"待处理\" color=\"info\" size=\"small\" />;\n    }\n};\n\nexport const MyReportsList: React.FC = () => {\n    const [reports, setReports] = useState<IUserReport[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState('');\n    const [page, setPage] = useState(1);\n    const [totalPages, setTotalPages] = useState(0);\n    const [modalOpen, setModalOpen] = useState(false); // State for the modal\n    const limit = 10;\n\n    useEffect(() => {\n        const fetchReports = async () => {\n            setLoading(true);\n            setError('');\n            try {\n                const result = await getMyReports({ page, limit });\n                if (result.shellIsOk && result.data) {\n                    setReports(result.data?.reports ||[]);\n                    setTotalPages(Math.ceil(result.data.total / limit));\n                } else {\n                    setError(result.err?.message || '您未登录，无法加载举报列表。');\n                }\n            } catch (e) {\n                setError('网络错误，请稍后重试。');\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        fetchReports();\n    }, [page]);\n\n    const handlePageChange = (event: React.ChangeEvent<unknown>, value: number) => {\n        setPage(value);\n    };\n\n    if (loading) {\n        return (\n            <Box sx={{ display: 'flex', justifyContent: 'center', my: 4 }}>\n                <CircularProgress />\n            </Box>\n        );\n    }\n\n    if (error) {\n        return <Alert severity=\"error\">{error}</Alert>;\n    }\n\n    return (\n        <Box>\n            <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n                <Typography variant=\"h6\">\n                    我的举报记录\n                </Typography>\n                <Button\n                    variant=\"contained\"\n                    startIcon={<AddCommentIcon />}\n                    onClick={() => setModalOpen(true)}\n                >\n                    发起举报\n                </Button>\n            </Box>\n\n            {reports.length === 0 ? (\n                <Typography>您还没有任何举报记录。</Typography>\n            ) : (\n                <>\n                    <List>\n                        {reports.map((report, index) => (\n                            <React.Fragment key={report.uuid}>\n                                <ListItem alignItems=\"flex-start\">\n                                    <ListItemText\n                                        primary={\n                                            <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                                                <Typography variant=\"subtitle1\">\n                                                    举报对象: {report.reported_uuid}\n                                                </Typography>\n                                                {getStatusChip(report.status)}\n                                            </Box>\n                                        }\n                                        secondary={\n                                            <>\n                                                <Typography\n                                                    sx={{ display: 'block' }}\n                                                    component=\"span\"\n                                                    variant=\"body2\"\n                                                    color=\"text.primary\"\n                                                >\n                                                    原因: {report.reason}\n                                                </Typography>\n                                                <Typography variant=\"caption\" color=\"text.secondary\">\n                                                    {new Date(report.created_at).toLocaleString()}\n                                                </Typography>\n                                            </>\n                                        }\n                                    />\n                                </ListItem>\n                                {index < reports.length - 1 && <Divider variant=\"inset\" component=\"li\" />}\n                            </React.Fragment>\n                        ))}\n                    </List>\n                    {totalPages > 1 && (\n                        <Box sx={{ display: 'flex', justifyContent: 'center', mt: 2 }}>\n                            <Pagination\n                                count={totalPages}\n                                page={page}\n                                onChange={handlePageChange}\n                                color=\"primary\"\n                            />\n                        </Box>\n                    )}\n                </>\n            )}\n\n            <ReportSubmitModal\n                open={modalOpen}\n                onClose={() => setModalOpen(false)}\n                onSuccess={() => {\n                    // Per user instruction, no refresh needed.\n                    // A snackbar could be triggered here in a real app.\n                    console.log('New report submitted successfully.');\n                }}\n            />\n        </Box>\n    );\n};\n","import { AppbarContainer, AppShell } from \"@app/ui\";\r\nimport { HowToUseContent } from \"@src/components/pages/how-to-use/content/HowToUseContent\";\r\nimport { MyReportsList } from \"@src/components/report/MyReportsList\";\r\n\r\n\r\nexport default function HowToUsePage() {\r\n    return (\r\n\r\n            <AppShell>\r\n                <AppbarContainer appbarProps={{title:\"举报列表\", back:true}}>\r\n                  <MyReportsList />\r\n                </AppbarContainer>\r\n            </AppShell>\r\n    )\r\n}","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/my-reports\",\n      function () {\n        return require(\"private-next-pages/my-reports/index.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/my-reports\"])\n      });\n    }\n  ","\nimport { request } from \"@fanfanlo\";\nimport { tms } from \"../tms\";\n\n// --- 类型定义 ---\n\n/**\n * @description 提交举报的请求参数\n */\nexport interface ISubmitReportParams {\n    reported_mobile: string; // 改为手机号\n    report_type: string;\n    target_ref?: string;\n    reason: string;\n    content_snapshot?: any;\n}\n\n/**\n * @description 提交举报的响应结果\n */\nexport interface ISubmitReportResult {\n    is_ok: boolean;\n    msg: string;\n    report_id?: string;\n}\n\n/**\n * @description 提交一个新的举报\n * @param {ISubmitReportParams} params - 举报的详细信息\n * @returns {Promise<ISubmitReportResult>}\n */\nexport async function submitReport(params: ISubmitReportParams)  {\n    return await request<ISubmitReportResult>(\n        tms.TReport,\n        tms.MReportSubmit,\n        params\n    );\n}\n","import React, { useState } from 'react';\nimport {\n    Button,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogContentText,\n    DialogTitle,\n    TextField,\n    CircularProgress,\n    Box\n} from '@mui/material';\nimport { submitReport } from '@app/model';\n\ninterface ReportSubmitModalProps {\n    open: boolean;\n    onClose: () => void;\n    onSuccess?: () => void; // Optional: callback on successful submission\n}\n\nexport const ReportSubmitModal: React.FC<ReportSubmitModalProps> = ({ open, onClose, onSuccess }) => {\n    const [mobile, setMobile] = useState('');\n    const [reason, setReason] = useState('');\n    const [error, setError] = useState('');\n    const [loading, setLoading] = useState(false);\n\n    const handleClose = () => {\n        // Reset state on close\n        setMobile('');\n        setReason('');\n        setError('');\n        setLoading(false);\n        onClose();\n    };\n\n    const handleSubmit = async () => {\n        if (!mobile || !reason) {\n            setError('手机号和举报原因均不能为空。');\n            return;\n        }\n        setError('');\n        setLoading(true);\n\n        try {\n            const result = await submitReport({\n                reported_mobile: mobile,\n                reason: reason,\n                report_type: 'user_report_from_app', // or make this dynamic if needed\n            });\n\n            if (result.shellIsOk) {\n                // alert('举报成功，感谢您的反馈！'); // Or use a Snackbar for better UX\n                if (onSuccess) {\n                    onSuccess();\n                }\n                handleClose();\n            } else {\n                setError(result.err?.message || '提交失败，请稍后再试。');\n            }\n        } catch (e) {\n            setError('网络错误，请检查您的连接。');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <Dialog open={open} onClose={handleClose}>\n            <DialogTitle>提交举报</DialogTitle>\n            <DialogContent>\n                <DialogContentText>\n                    请输入您要举报的用户的手机号码和具体原因。我们会尽快处理您的举报。\n                </DialogContentText>\n                <TextField\n                    autoFocus\n                    margin=\"dense\"\n                    id=\"mobile\"\n                    label=\"被举报人手机号、账号或ID\"\n                    type=\"tel\"\n                    fullWidth\n                    variant=\"standard\"\n                    value={mobile}\n                    onChange={(e) => setMobile(e.target.value)}\n                    disabled={loading}\n                />\n                <TextField\n                    margin=\"dense\"\n                    id=\"reason\"\n                    label=\"举报原因\"\n                    type=\"text\"\n                    fullWidth\n                    multiline\n                    rows={4}\n                    variant=\"standard\"\n                    value={reason}\n                    onChange={(e) => setReason(e.target.value)}\n                    disabled={loading}\n                />\n                {error && (\n                    <Box sx={{ color: 'error.main', mt: 2 }}>\n                        {error}\n                    </Box>\n                )}\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={handleClose} disabled={loading}>取消</Button>\n                <Button onClick={handleSubmit} disabled={loading}>\n                    {loading ? <CircularProgress size={24} /> : '提交'}\n                </Button>\n            </DialogActions>\n        </Dialog>\n    );\n};\n\n"],"names":["request","tms","getMyReports","params","res","TReport","MReportGetMyList","React","useState","useEffect","Box","List","ListItem","ListItemText","Typography","CircularProgress","Alert","Chip","Divider","Pagination","Button","AddCommentIcon","ReportSubmitModal","getStatusChip","status","label","color","size","MyReportsList","reports","setReports","loading","setLoading","error","setError","page","setPage","totalPages","setTotalPages","modalOpen","setModalOpen","limit","fetchReports","result","shellIsOk","data","Math","ceil","total","err","message","e","handlePageChange","event","value","sx","display","justifyContent","my","severity","alignItems","mb","variant","startIcon","onClick","length","map","report","index","Fragment","primary","reported_uuid","secondary","component","reason","Date","created_at","toLocaleString","uuid","mt","count","onChange","open","onClose","onSuccess","console","log","AppbarContainer","AppShell","HowToUsePage","appbarProps","title","back","submitReport","MReportSubmit","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","TextField","mobile","setMobile","setReason","handleClose","handleSubmit","reported_mobile","report_type","autoFocus","margin","id","type","fullWidth","target","disabled","multiline","rows"],"sourceRoot":"","ignoreList":[]}