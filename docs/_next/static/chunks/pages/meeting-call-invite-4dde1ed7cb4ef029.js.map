{"version":3,"file":"static/chunks/pages/meeting-call-invite-4dde1ed7cb4ef029.js","mappings":";;;;;;AACA;AACA;AACA;AACA,eAAe,mBAAO,CAAC,KAAkD;AACzE;AACA;AACA,OAAO,KAAU,EAAE,EAId;AACL;;;;;;;;;;;;;;;;;;;;ACZ0C;AACwB;AACV;AACZ;AAE7B,SAASO;IACtB,MAAM,CAACC,WAAWC,aAAa,GAAGH,+CAAQA,CAAC;IAC3C,MAAM,CAACI,kBAAkBC,oBAAoB,GAAGL,+CAAQA,CAAC;IAEzD,UAAU;IACV,MAAMM,YAAY,IAAIC,IAAIC,OAAOC,QAAQ,CAACC,IAAI,EAAEC,YAAY;IAC5D,MAAMC,SAASN,UAAUO,GAAG,CAAC,aAAa;IAC1C,MAAMC,YAAYR,UAAUO,GAAG,CAAC,gBAAgB;IAChD,MAAME,OAAQT,UAAUO,GAAG,CAAC,WAAW;IACvC,MAAMG,YAAaV,UAAUO,GAAG,CAAC,gBAAgB;IAEjD,YAAY;IACZd,gDAASA,CAAC;QACR,MAAMkB,6BAA6B,CAACC;YAClCC,QAAQC,GAAG,CAAC,0BAA0BF,MAAMG,MAAM;YAClDhB,oBAAoBiB,CAAAA,OAAQA,OAAO;YACnC,IAAIlB,qBAAqB,GAAG;gBAC1B,mBAAmB;gBACnBD,aAAa;YACf;QACF;QAEA,MAAMoB,gCAAgC,CAACL;YACrCC,QAAQC,GAAG,CAAC,6BAA6BF,MAAMG,MAAM;YACrDhB,oBAAoBiB,CAAAA,OAAQE,KAAKC,GAAG,CAAC,GAAGH,OAAO;QACjD;QAEA,cAAc;QACdd,OAAOkB,gBAAgB,CAAC,gCAAgCT;QACxDT,OAAOkB,gBAAgB,CAAC,mCAAmCH;QAE3D,OAAO;YACLf,OAAOmB,mBAAmB,CAAC,gCAAgCV;YAC3DT,OAAOmB,mBAAmB,CAAC,mCAAmCJ;QAChE;IACF,GAAG;QAACnB;KAAiB;IAErB,SAAS;IACT,MAAMwB,YAAY,kBAChB,wDAACjC,oHAAGA;YACFkC,IAAI;gBACFC,QAAQ;gBACRC,SAAS;gBACTC,eAAe;gBACfC,gBAAgB;gBAChBC,YAAY;gBACZC,iBAAiB;YACnB;;8BAEA,uDAACtC,oHAAgBA;oBAACuC,MAAM;oBAAIP,IAAI;wBAAEQ,IAAI;wBAAGC,OAAO;oBAAU;;8BAC1D,uDAAC1C,oHAAUA;oBAAC2C,SAAQ;oBAAKV,IAAI;wBAAEQ,IAAI;wBAAGG,YAAY;oBAAI;8BAAG;;8BAGzD,wDAAC5C,oHAAUA;oBAAC2C,SAAQ;oBAAQV,IAAI;wBAAES,OAAO;wBAAkBG,WAAW;oBAAS;;wBAAG;sCAEhF,uDAACC;wBAAK;wBACC5B;;;;;IAKb,qBACE,uDAACnB,oHAAGA;QAACkC,IAAI;YAACC,QAAQ;QAAO;kBACtB5B,0BACC,uDAAC0B,+BAED,uDAAClC,6DAAWA;YACViD,UAAU/B;YACVgC,UAAU;YACVC,UAAU,QAAmD,OAA3CrB,KAAKsB,MAAM,GAAGC,QAAQ,CAAC,IAAIC,SAAS,CAAC,GAAG;YAC1DC,eAAenD,2EAASA,CAACoD,SAAS,CAACC,OAAO;YAC1CC,qBAAqB;YACrBC,qBAAqB;YACrBtC,MAAMA;YACNC,WAAWA;YACXsC,iBAAiB;YACjBC,wBAAwB,IAAMpD,aAAa;;;AAKrD","sources":["webpack://_N_E/?4661","webpack://_N_E/./src/pages/meeting-call-invite/index.tsx"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/meeting-call-invite\",\n      function () {\n        return require(\"private-next-pages/meeting-call-invite/index.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/meeting-call-invite\"])\n      });\n    }\n  ","import { MeetingRoom } from '@im/livekit';\nimport { Box, Typography, CircularProgress } from '@mui/material';\nimport { mainModel } from '@src/libs/mc/main/MainModel';\nimport { useEffect, useState } from 'react';\n\nexport default function JoinCall() {\n  const [isWaiting, setIsWaiting] = useState(true);\n  const [participantCount, setParticipantCount] = useState(0);\n  \n  // 获取URL参数\n  const urlParams = new URL(window.location.href).searchParams;\n  const roomId = urlParams.get(\"roomId\") || \"test\";\n  const sessionId = urlParams.get(\"sessionId\") || \"\";\n  const role = (urlParams.get(\"role\") || \"initiator\") as 'initiator' | 'responder';\n  const eventType = (urlParams.get(\"eventType\") || \"security\") as 'medical' | 'security';\n\n  // 监听参与者连接事件\n  useEffect(() => {\n    const handleParticipantConnected = (event: CustomEvent) => {\n      console.log('Participant connected:', event.detail);\n      setParticipantCount(prev => prev + 1);\n      if (participantCount === 0) {\n        // 第一个参与者加入，切换到视频界面\n        setIsWaiting(false);\n      }\n    };\n\n    const handleParticipantDisconnected = (event: CustomEvent) => {\n      console.log('Participant disconnected:', event.detail);\n      setParticipantCount(prev => Math.max(0, prev - 1));\n    };\n\n    // 监听LiveKit事件\n    window.addEventListener('livekit.participantConnected', handleParticipantConnected as EventListener);\n    window.addEventListener('livekit.participantDisconnected', handleParticipantDisconnected as EventListener);\n\n    return () => {\n      window.removeEventListener('livekit.participantConnected', handleParticipantConnected as EventListener);\n      window.removeEventListener('livekit.participantDisconnected', handleParticipantDisconnected as EventListener);\n    };\n  }, [participantCount]);\n\n  // 等待中的UI\n  const WaitingUI = () => (\n    <Box \n      sx={{ \n        height: '100vh', \n        display: 'flex', \n        flexDirection: 'column',\n        justifyContent: 'center', \n        alignItems: 'center',\n        backgroundColor: '#f5f5f5'\n      }}\n    >\n      <CircularProgress size={60} sx={{ mb: 3, color: '#2196f3' }} />\n      <Typography variant=\"h5\" sx={{ mb: 2, fontWeight: 600 }}>\n        正在发起视频会议...\n      </Typography>\n      <Typography variant=\"body1\" sx={{ color: 'text.secondary', textAlign: 'center' }}>\n        等待其他成员接听\n        <br />\n        会话ID: {sessionId}\n      </Typography>\n    </Box>\n  );\n\n  return (\n    <Box sx={{height: '100vh'}}>\n      {isWaiting ? (\n        <WaitingUI />\n      ) : (\n        <MeetingRoom\n          roomName={roomId}\n          directly={true}\n          userName={`user-${Math.random().toString(36).substring(2, 8)}`}\n          livekitConfig={mainModel.appConfig.livekit}\n          initialAudioEnabled={true}\n          initialVideoEnabled={true}\n          role={role}\n          eventType={eventType}\n          canControlMedia={true}\n          onParticipantConnected={() => setIsWaiting(false)}\n        />\n      )}\n    </Box>\n  );\n}\n"],"names":["MeetingRoom","Box","Typography","CircularProgress","mainModel","useEffect","useState","JoinCall","isWaiting","setIsWaiting","participantCount","setParticipantCount","urlParams","URL","window","location","href","searchParams","roomId","get","sessionId","role","eventType","handleParticipantConnected","event","console","log","detail","prev","handleParticipantDisconnected","Math","max","addEventListener","removeEventListener","WaitingUI","sx","height","display","flexDirection","justifyContent","alignItems","backgroundColor","size","mb","color","variant","fontWeight","textAlign","br","roomName","directly","userName","random","toString","substring","livekitConfig","appConfig","livekit","initialAudioEnabled","initialVideoEnabled","canControlMedia","onParticipantConnected"],"sourceRoot":"","ignoreList":[]}